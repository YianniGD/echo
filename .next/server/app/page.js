(()=>{var e={};e.id=974,e.ids=[974],e.modules={225:(e,t,n)=>{Promise.resolve().then(n.bind(n,9737))},440:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>i});var r=n(1658);let i=async e=>[{type:"image/x-icon",sizes:"32x32",url:(0,r.fillMetadataSegment)(".",await e.params,"favicon.ico")+""}]},554:(e,t)=>{"use strict";function n(e){return e.endsWith("/route")}Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"isAppRouteRoute",{enumerable:!0,get:function(){return n}})},660:(e,t)=>{"use strict";function n(e){let t=5381;for(let n=0;n<e.length;n++)t=(t<<5)+t+e.charCodeAt(n)|0;return t>>>0}function r(e){return n(e).toString(36).slice(0,5)}Object.defineProperty(t,"__esModule",{value:!0}),!function(e,t){for(var n in t)Object.defineProperty(e,n,{enumerable:!0,get:t[n]})}(t,{djb2Hash:function(){return n},hexHash:function(){return r}})},846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},944:(e,t,n)=>{Promise.resolve().then(n.t.bind(n,6346,23)),Promise.resolve().then(n.t.bind(n,7924,23)),Promise.resolve().then(n.t.bind(n,5656,23)),Promise.resolve().then(n.t.bind(n,99,23)),Promise.resolve().then(n.t.bind(n,8243,23)),Promise.resolve().then(n.t.bind(n,8827,23)),Promise.resolve().then(n.t.bind(n,2763,23)),Promise.resolve().then(n.t.bind(n,7173,23))},1135:()=>{},1204:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>r});let r=(0,n(2907).registerClientReference)(function(){throw Error("Attempted to call the default export of \"/Users/yiannigaliatsatos/Documents/GitHub/echo/src/app/page.tsx\" from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"/Users/yiannigaliatsatos/Documents/GitHub/echo/src/app/page.tsx","default")},1437:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),!function(e,t){for(var n in t)Object.defineProperty(e,n,{enumerable:!0,get:t[n]})}(t,{INTERCEPTION_ROUTE_MARKERS:function(){return i},extractInterceptionRouteInformation:function(){return o},isInterceptionRouteAppPath:function(){return s}});let r=n(4722),i=["(..)(..)","(.)","(..)","(...)"];function s(e){return void 0!==e.split("/").find(e=>i.find(t=>e.startsWith(t)))}function o(e){let t,n,s;for(let r of e.split("/"))if(n=i.find(e=>r.startsWith(e))){[t,s]=e.split(n,2);break}if(!t||!n||!s)throw Object.defineProperty(Error("Invalid interception route: "+e+". Must be in the format /<intercepting route>/(..|...|..)(..)/<intercepted route>"),"__NEXT_ERROR_CODE",{value:"E269",enumerable:!1,configurable:!0});switch(t=(0,r.normalizeAppPath)(t),n){case"(.)":s="/"===t?"/"+s:t+"/"+s;break;case"(..)":if("/"===t)throw Object.defineProperty(Error("Invalid interception route: "+e+". Cannot use (..) marker at the root level, use (.) instead."),"__NEXT_ERROR_CODE",{value:"E207",enumerable:!1,configurable:!0});s=t.split("/").slice(0,-1).concat(s).join("/");break;case"(...)":s="/"+s;break;case"(..)(..)":let o=t.split("/");if(o.length<=2)throw Object.defineProperty(Error("Invalid interception route: "+e+". Cannot use (..)(..) marker at the root level or one level up."),"__NEXT_ERROR_CODE",{value:"E486",enumerable:!1,configurable:!0});s=o.slice(0,-2).concat(s).join("/");break;default:throw Object.defineProperty(Error("Invariant: unexpected marker"),"__NEXT_ERROR_CODE",{value:"E112",enumerable:!1,configurable:!0})}return{interceptingRoute:t,interceptedRoute:s}}},1658:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),!function(e,t){for(var n in t)Object.defineProperty(e,n,{enumerable:!0,get:t[n]})}(t,{fillMetadataSegment:function(){return h},normalizeMetadataPageToRoute:function(){return f},normalizeMetadataRoute:function(){return p}});let r=n(8304),i=function(e){return e&&e.__esModule?e:{default:e}}(n(8671)),s=n(6341),o=n(4396),a=n(660),l=n(4722),c=n(2958),d=n(5499);function u(e){let t=i.default.dirname(e);if(e.endsWith("/sitemap"))return"";let n="";return t.split("/").some(e=>(0,d.isGroupSegment)(e)||(0,d.isParallelRouteSegment)(e))&&(n=(0,a.djb2Hash)(t).toString(36).slice(0,6)),n}function h(e,t,n){let r=(0,l.normalizeAppPath)(e),a=(0,o.getNamedRouteRegex)(r,{prefixRouteKeys:!1}),d=(0,s.interpolateDynamicPath)(r,t,a),{name:h,ext:p}=i.default.parse(n),f=u(i.default.posix.join(e,h)),m=f?`-${f}`:"";return(0,c.normalizePathSep)(i.default.join(d,`${h}${m}${p}`))}function p(e){if(!(0,r.isMetadataPage)(e))return e;let t=e,n="";if("/robots"===e?t+=".txt":"/manifest"===e?t+=".webmanifest":n=u(e),!t.endsWith("/route")){let{dir:e,name:r,ext:s}=i.default.parse(t);t=i.default.posix.join(e,`${r}${n?`-${n}`:""}${s}`,"route")}return t}function f(e,t){let n=e.endsWith("/route"),r=n?e.slice(0,-6):e,i=r.endsWith("/sitemap")?".xml":"";return(t?`${r}/[__metadata_id__]`:`${r}${i}`)+(n?"/route":"")}},2437:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"getPathMatch",{enumerable:!0,get:function(){return i}});let r=n(5362);function i(e,t){let n=[],i=(0,r.pathToRegexp)(e,n,{delimiter:"/",sensitive:"boolean"==typeof(null==t?void 0:t.sensitive)&&t.sensitive,strict:null==t?void 0:t.strict}),s=(0,r.regexpToFunction)((null==t?void 0:t.regexModifier)?new RegExp(t.regexModifier(i.source),i.flags):i,n);return(e,r)=>{if("string"!=typeof e)return!1;let i=s(e);if(!i)return!1;if(null==t?void 0:t.removeUnnamedParams)for(let e of n)"number"==typeof e.name&&delete i.params[e.name];return{...r,...i.params}}}},2785:(e,t)=>{"use strict";function n(e){let t={};for(let[n,r]of e.entries()){let e=t[n];void 0===e?t[n]=r:Array.isArray(e)?e.push(r):t[n]=[e,r]}return t}function r(e){return"string"==typeof e?e:("number"!=typeof e||isNaN(e))&&"boolean"!=typeof e?"":String(e)}function i(e){let t=new URLSearchParams;for(let[n,i]of Object.entries(e))if(Array.isArray(i))for(let e of i)t.append(n,r(e));else t.set(n,r(i));return t}function s(e){for(var t=arguments.length,n=Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];for(let t of n){for(let n of t.keys())e.delete(n);for(let[n,r]of t.entries())e.append(n,r)}return e}Object.defineProperty(t,"__esModule",{value:!0}),!function(e,t){for(var n in t)Object.defineProperty(e,n,{enumerable:!0,get:t[n]})}(t,{assign:function(){return s},searchParamsToUrlQuery:function(){return n},urlQueryToSearchParams:function(){return i}})},2958:(e,t)=>{"use strict";function n(e){return e.replace(/\\/g,"/")}Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"normalizePathSep",{enumerable:!0,get:function(){return n}})},3033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},3226:(e,t,n)=>{"use strict";n.r(t),n.d(t,{GlobalError:()=>o.a,__next_app__:()=>u,pages:()=>d,routeModule:()=>h,tree:()=>c});var r=n(5239),i=n(8088),s=n(8170),o=n.n(s),a=n(893),l={};for(let e in a)0>["default","tree","pages","GlobalError","__next_app__","routeModule"].indexOf(e)&&(l[e]=()=>a[e]);n.d(t,l);let c={children:["",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(n.bind(n,1204)),"/Users/yiannigaliatsatos/Documents/GitHub/echo/src/app/page.tsx"],metadata:{icon:[async e=>(await Promise.resolve().then(n.bind(n,440))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]},{layout:[()=>Promise.resolve().then(n.bind(n,4431)),"/Users/yiannigaliatsatos/Documents/GitHub/echo/src/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(n.t.bind(n,7398,23)),"next/dist/client/components/not-found-error"],forbidden:[()=>Promise.resolve().then(n.t.bind(n,9999,23)),"next/dist/client/components/forbidden-error"],unauthorized:[()=>Promise.resolve().then(n.t.bind(n,5284,23)),"next/dist/client/components/unauthorized-error"],metadata:{icon:[async e=>(await Promise.resolve().then(n.bind(n,440))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]}.children,d=["/Users/yiannigaliatsatos/Documents/GitHub/echo/src/app/page.tsx"],u={require:n,loadChunk:()=>Promise.resolve()},h=new r.AppPageRouteModule({definition:{kind:i.RouteKind.APP_PAGE,page:"/page",pathname:"/",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:c}})},3293:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"escapeStringRegexp",{enumerable:!0,get:function(){return i}});let n=/[|\\{}()[\]^$+*?.-]/,r=/[|\\{}()[\]^$+*?.-]/g;function i(e){return n.test(e)?e.replace(r,"\\$&"):e}},3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},3736:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"parseRelativeUrl",{enumerable:!0,get:function(){return i}}),n(4827);let r=n(2785);function i(e,t,n){void 0===n&&(n=!0);let i=new URL("http://n"),s=t?new URL(t,i):e.startsWith(".")?new URL("http://n"):i,{pathname:o,searchParams:a,search:l,hash:c,href:d,origin:u}=new URL(e,s);if(u!==i.origin)throw Object.defineProperty(Error("invariant: invalid relative URL, router received "+e),"__NEXT_ERROR_CODE",{value:"E159",enumerable:!1,configurable:!0});return{pathname:o,query:n?(0,r.searchParamsToUrlQuery)(a):void 0,search:l,hash:c,href:d.slice(u.length)}}},3873:e=>{"use strict";e.exports=require("path")},4396:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),!function(e,t){for(var n in t)Object.defineProperty(e,n,{enumerable:!0,get:t[n]})}(t,{getNamedMiddlewareRegex:function(){return m},getNamedRouteRegex:function(){return f},getRouteRegex:function(){return u},parseParameter:function(){return l}});let r=n(6143),i=n(1437),s=n(3293),o=n(2887),a=/^([^[]*)\[((?:\[[^\]]*\])|[^\]]+)\](.*)$/;function l(e){let t=e.match(a);return t?c(t[2]):c(e)}function c(e){let t=e.startsWith("[")&&e.endsWith("]");t&&(e=e.slice(1,-1));let n=e.startsWith("...");return n&&(e=e.slice(3)),{key:e,repeat:n,optional:t}}function d(e,t,n){let r={},l=1,d=[];for(let u of(0,o.removeTrailingSlash)(e).slice(1).split("/")){let e=i.INTERCEPTION_ROUTE_MARKERS.find(e=>u.startsWith(e)),o=u.match(a);if(e&&o&&o[2]){let{key:t,optional:n,repeat:i}=c(o[2]);r[t]={pos:l++,repeat:i,optional:n},d.push("/"+(0,s.escapeStringRegexp)(e)+"([^/]+?)")}else if(o&&o[2]){let{key:e,repeat:t,optional:i}=c(o[2]);r[e]={pos:l++,repeat:t,optional:i},n&&o[1]&&d.push("/"+(0,s.escapeStringRegexp)(o[1]));let a=t?i?"(?:/(.+?))?":"/(.+?)":"/([^/]+?)";n&&o[1]&&(a=a.substring(1)),d.push(a)}else d.push("/"+(0,s.escapeStringRegexp)(u));t&&o&&o[3]&&d.push((0,s.escapeStringRegexp)(o[3]))}return{parameterizedRoute:d.join(""),groups:r}}function u(e,t){let{includeSuffix:n=!1,includePrefix:r=!1,excludeOptionalTrailingSlash:i=!1}=void 0===t?{}:t,{parameterizedRoute:s,groups:o}=d(e,n,r),a=s;return i||(a+="(?:/)?"),{re:RegExp("^"+a+"$"),groups:o}}function h(e){let t,{interceptionMarker:n,getSafeRouteKey:r,segment:i,routeKeys:o,keyPrefix:a,backreferenceDuplicateKeys:l}=e,{key:d,optional:u,repeat:h}=c(i),p=d.replace(/\W/g,"");a&&(p=""+a+p);let f=!1;(0===p.length||p.length>30)&&(f=!0),isNaN(parseInt(p.slice(0,1)))||(f=!0),f&&(p=r());let m=p in o;a?o[p]=""+a+d:o[p]=d;let g=n?(0,s.escapeStringRegexp)(n):"";return t=m&&l?"\\k<"+p+">":h?"(?<"+p+">.+?)":"(?<"+p+">[^/]+?)",u?"(?:/"+g+t+")?":"/"+g+t}function p(e,t,n,l,c){let d,u=(d=0,()=>{let e="",t=++d;for(;t>0;)e+=String.fromCharCode(97+(t-1)%26),t=Math.floor((t-1)/26);return e}),p={},f=[];for(let d of(0,o.removeTrailingSlash)(e).slice(1).split("/")){let e=i.INTERCEPTION_ROUTE_MARKERS.some(e=>d.startsWith(e)),o=d.match(a);if(e&&o&&o[2])f.push(h({getSafeRouteKey:u,interceptionMarker:o[1],segment:o[2],routeKeys:p,keyPrefix:t?r.NEXT_INTERCEPTION_MARKER_PREFIX:void 0,backreferenceDuplicateKeys:c}));else if(o&&o[2]){l&&o[1]&&f.push("/"+(0,s.escapeStringRegexp)(o[1]));let e=h({getSafeRouteKey:u,segment:o[2],routeKeys:p,keyPrefix:t?r.NEXT_QUERY_PARAM_PREFIX:void 0,backreferenceDuplicateKeys:c});l&&o[1]&&(e=e.substring(1)),f.push(e)}else f.push("/"+(0,s.escapeStringRegexp)(d));n&&o&&o[3]&&f.push((0,s.escapeStringRegexp)(o[3]))}return{namedParameterizedRoute:f.join(""),routeKeys:p}}function f(e,t){var n,r,i;let s=p(e,t.prefixRouteKeys,null!=(n=t.includeSuffix)&&n,null!=(r=t.includePrefix)&&r,null!=(i=t.backreferenceDuplicateKeys)&&i),o=s.namedParameterizedRoute;return t.excludeOptionalTrailingSlash||(o+="(?:/)?"),{...u(e,t),namedRegex:"^"+o+"$",routeKeys:s.routeKeys}}function m(e,t){let{parameterizedRoute:n}=d(e,!1,!1),{catchAll:r=!0}=t;if("/"===n)return{namedRegex:"^/"+(r?".*":"")+"$"};let{namedParameterizedRoute:i}=p(e,!1,!1,!1,!1);return{namedRegex:"^"+i+(r?"(?:(/.*)?)":"")+"$"}}},4431:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>o,metadata:()=>s});var r=n(7413);n(1135);var i=n(9737);let s={title:"echo",description:"A calm, introspective journal to organize your thoughts, track your well-being, and reflect on your daily life.",manifest:"/manifest.json"};function o({children:e}){return(0,r.jsxs)("html",{lang:"en",suppressHydrationWarning:!0,children:[(0,r.jsxs)("head",{children:[(0,r.jsx)("meta",{name:"theme-color",content:"#9D7CBF"}),(0,r.jsx)("link",{rel:"apple-touch-icon",href:"/icons/icon-192x192.png"}),(0,r.jsx)("link",{rel:"preconnect",href:"https://fonts.googleapis.com"}),(0,r.jsx)("link",{rel:"preconnect",href:"https://fonts.gstatic.com",crossOrigin:"anonymous"}),(0,r.jsx)("link",{href:"https://fonts.googleapis.com/css2?family=Geologica:wght@500&family=Noto+Sans:wght@400;500;600;700&family=Noto+Serif:ital,wght@0,400;0,600;0,900;1,400;1,600&display=swap",rel:"stylesheet"})]}),(0,r.jsxs)("body",{children:[e,(0,r.jsx)(i.Toaster,{})]})]})}},4722:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),!function(e,t){for(var n in t)Object.defineProperty(e,n,{enumerable:!0,get:t[n]})}(t,{normalizeAppPath:function(){return s},normalizeRscURL:function(){return o}});let r=n(5531),i=n(5499);function s(e){return(0,r.ensureLeadingSlash)(e.split("/").reduce((e,t,n,r)=>!t||(0,i.isGroupSegment)(t)||"@"===t[0]||("page"===t||"route"===t)&&n===r.length-1?e:e+"/"+t,""))}function o(e){return e.replace(/\.rsc($|\?)/,"$1")}},4780:(e,t,n)=>{"use strict";n.d(t,{cn:()=>s});var r=n(9384),i=n(2348);function s(...e){return(0,i.QP)((0,r.$)(e))}},4827:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),!function(e,t){for(var n in t)Object.defineProperty(e,n,{enumerable:!0,get:t[n]})}(t,{DecodeError:function(){return f},MiddlewareNotFoundError:function(){return x},MissingStaticPage:function(){return y},NormalizeError:function(){return m},PageNotFoundError:function(){return g},SP:function(){return h},ST:function(){return p},WEB_VITALS:function(){return n},execOnce:function(){return r},getDisplayName:function(){return l},getLocationOrigin:function(){return o},getURL:function(){return a},isAbsoluteUrl:function(){return s},isResSent:function(){return c},loadGetInitialProps:function(){return u},normalizeRepeatedSlashes:function(){return d},stringifyError:function(){return v}});let n=["CLS","FCP","FID","INP","LCP","TTFB"];function r(e){let t,n=!1;return function(){for(var r=arguments.length,i=Array(r),s=0;s<r;s++)i[s]=arguments[s];return n||(n=!0,t=e(...i)),t}}let i=/^[a-zA-Z][a-zA-Z\d+\-.]*?:/,s=e=>i.test(e);function o(){let{protocol:e,hostname:t,port:n}=window.location;return e+"//"+t+(n?":"+n:"")}function a(){let{href:e}=window.location,t=o();return e.substring(t.length)}function l(e){return"string"==typeof e?e:e.displayName||e.name||"Unknown"}function c(e){return e.finished||e.headersSent}function d(e){let t=e.split("?");return t[0].replace(/\\/g,"/").replace(/\/\/+/g,"/")+(t[1]?"?"+t.slice(1).join("?"):"")}async function u(e,t){let n=t.res||t.ctx&&t.ctx.res;if(!e.getInitialProps)return t.ctx&&t.Component?{pageProps:await u(t.Component,t.ctx)}:{};let r=await e.getInitialProps(t);if(n&&c(n))return r;if(!r)throw Object.defineProperty(Error('"'+l(e)+'.getInitialProps()" should resolve to an object. But found "'+r+'" instead.'),"__NEXT_ERROR_CODE",{value:"E394",enumerable:!1,configurable:!0});return r}let h="undefined"!=typeof performance,p=h&&["mark","measure","getEntriesByName"].every(e=>"function"==typeof performance[e]);class f extends Error{}class m extends Error{}class g extends Error{constructor(e){super(),this.code="ENOENT",this.name="PageNotFoundError",this.message="Cannot find module for page: "+e}}class y extends Error{constructor(e,t){super(),this.message="Failed to load static file for page: "+e+" "+t}}class x extends Error{constructor(){super(),this.code="ENOENT",this.message="Cannot find the middleware module"}}function v(e){return JSON.stringify({message:e.message,stack:e.stack})}},4947:(e,t,n)=>{"use strict";n.d(t,{Toaster:()=>y});var r=n(687),i=n(9867),s=n(3210),o=n(8810),a=n(4224),l=n(8726),c=n(4780);let d=o.Kq,u=s.forwardRef(({className:e,...t},n)=>(0,r.jsx)(o.LM,{ref:n,className:(0,c.cn)("fixed top-0 z-[100] flex max-h-screen w-full flex-col-reverse p-4 sm:bottom-0 sm:right-0 sm:top-auto sm:flex-col md:max-w-[420px]",e),...t}));u.displayName=o.LM.displayName;let h=(0,a.F)("group pointer-events-auto relative flex w-full items-center justify-between space-x-4 overflow-hidden rounded-md border p-6 pr-8 shadow-lg transition-all data-[swipe=cancel]:translate-x-0 data-[swipe=end]:translate-x-[var(--radix-toast-swipe-end-x)] data-[swipe=move]:translate-x-[var(--radix-toast-swipe-move-x)] data-[swipe=move]:transition-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[swipe=end]:animate-out data-[state=closed]:fade-out-80 data-[state=closed]:slide-out-to-right-full data-[state=open]:slide-in-from-top-full data-[state=open]:sm:slide-in-from-bottom-full",{variants:{variant:{default:"border bg-background text-foreground",destructive:"destructive group border-destructive bg-destructive text-destructive-foreground"}},defaultVariants:{variant:"default"}}),p=s.forwardRef(({className:e,variant:t,...n},i)=>(0,r.jsx)(o.bL,{ref:i,className:(0,c.cn)(h({variant:t}),e),...n}));p.displayName=o.bL.displayName,s.forwardRef(({className:e,...t},n)=>(0,r.jsx)(o.rc,{ref:n,className:(0,c.cn)("inline-flex h-8 shrink-0 items-center justify-center rounded-md border bg-transparent px-3 text-sm font-medium ring-offset-background transition-colors hover:bg-secondary focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 group-[.destructive]:border-muted/40 group-[.destructive]:hover:border-destructive/30 group-[.destructive]:hover:bg-destructive group-[.destructive]:hover:text-destructive-foreground group-[.destructive]:focus:ring-destructive",e),...t})).displayName=o.rc.displayName;let f=s.forwardRef(({className:e,...t},n)=>(0,r.jsx)(o.bm,{ref:n,className:(0,c.cn)("absolute right-2 top-2 rounded-md p-1 text-foreground/50 opacity-0 transition-opacity hover:text-foreground focus:opacity-100 focus:outline-none focus:ring-2 group-hover:opacity-100 group-[.destructive]:text-red-300 group-[.destructive]:hover:text-red-50 group-[.destructive]:focus:ring-red-400 group-[.destructive]:focus:ring-offset-red-600",e),"toast-close":"",...t,children:(0,r.jsx)(l.A,{className:"h-4 w-4"})}));f.displayName=o.bm.displayName;let m=s.forwardRef(({className:e,...t},n)=>(0,r.jsx)(o.hE,{ref:n,className:(0,c.cn)("text-sm font-semibold",e),...t}));m.displayName=o.hE.displayName;let g=s.forwardRef(({className:e,...t},n)=>(0,r.jsx)(o.VY,{ref:n,className:(0,c.cn)("text-sm opacity-90",e),...t}));function y(){let{toasts:e}=(0,i.dj)();return(0,r.jsxs)(d,{children:[e.map(function({id:e,title:t,description:n,action:i,...s}){return(0,r.jsxs)(p,{...s,children:[(0,r.jsxs)("div",{className:"grid gap-1",children:[t&&(0,r.jsx)(m,{children:t}),n&&(0,r.jsx)(g,{children:n})]}),i,(0,r.jsx)(f,{})]},e)}),(0,r.jsx)(u,{})]})}g.displayName=o.VY.displayName},5362:e=>{(()=>{"use strict";"undefined"!=typeof __nccwpck_require__&&(__nccwpck_require__.ab=__dirname+"/");var t={};(()=>{function e(e,t){void 0===t&&(t={});for(var n=function(e){for(var t=[],n=0;n<e.length;){var r=e[n];if("*"===r||"+"===r||"?"===r){t.push({type:"MODIFIER",index:n,value:e[n++]});continue}if("\\"===r){t.push({type:"ESCAPED_CHAR",index:n++,value:e[n++]});continue}if("{"===r){t.push({type:"OPEN",index:n,value:e[n++]});continue}if("}"===r){t.push({type:"CLOSE",index:n,value:e[n++]});continue}if(":"===r){for(var i="",s=n+1;s<e.length;){var o=e.charCodeAt(s);if(o>=48&&o<=57||o>=65&&o<=90||o>=97&&o<=122||95===o){i+=e[s++];continue}break}if(!i)throw TypeError("Missing parameter name at "+n);t.push({type:"NAME",index:n,value:i}),n=s;continue}if("("===r){var a=1,l="",s=n+1;if("?"===e[s])throw TypeError('Pattern cannot start with "?" at '+s);for(;s<e.length;){if("\\"===e[s]){l+=e[s++]+e[s++];continue}if(")"===e[s]){if(0==--a){s++;break}}else if("("===e[s]&&(a++,"?"!==e[s+1]))throw TypeError("Capturing groups are not allowed at "+s);l+=e[s++]}if(a)throw TypeError("Unbalanced pattern at "+n);if(!l)throw TypeError("Missing pattern at "+n);t.push({type:"PATTERN",index:n,value:l}),n=s;continue}t.push({type:"CHAR",index:n,value:e[n++]})}return t.push({type:"END",index:n,value:""}),t}(e),r=t.prefixes,s=void 0===r?"./":r,o="[^"+i(t.delimiter||"/#?")+"]+?",a=[],l=0,c=0,d="",u=function(e){if(c<n.length&&n[c].type===e)return n[c++].value},h=function(e){var t=u(e);if(void 0!==t)return t;var r=n[c];throw TypeError("Unexpected "+r.type+" at "+r.index+", expected "+e)},p=function(){for(var e,t="";e=u("CHAR")||u("ESCAPED_CHAR");)t+=e;return t};c<n.length;){var f=u("CHAR"),m=u("NAME"),g=u("PATTERN");if(m||g){var y=f||"";-1===s.indexOf(y)&&(d+=y,y=""),d&&(a.push(d),d=""),a.push({name:m||l++,prefix:y,suffix:"",pattern:g||o,modifier:u("MODIFIER")||""});continue}var x=f||u("ESCAPED_CHAR");if(x){d+=x;continue}if(d&&(a.push(d),d=""),u("OPEN")){var y=p(),v=u("NAME")||"",b=u("PATTERN")||"",w=p();h("CLOSE"),a.push({name:v||(b?l++:""),pattern:v&&!b?o:b,prefix:y,suffix:w,modifier:u("MODIFIER")||""});continue}h("END")}return a}function n(e,t){void 0===t&&(t={});var n=s(t),r=t.encode,i=void 0===r?function(e){return e}:r,o=t.validate,a=void 0===o||o,l=e.map(function(e){if("object"==typeof e)return RegExp("^(?:"+e.pattern+")$",n)});return function(t){for(var n="",r=0;r<e.length;r++){var s=e[r];if("string"==typeof s){n+=s;continue}var o=t?t[s.name]:void 0,c="?"===s.modifier||"*"===s.modifier,d="*"===s.modifier||"+"===s.modifier;if(Array.isArray(o)){if(!d)throw TypeError('Expected "'+s.name+'" to not repeat, but got an array');if(0===o.length){if(c)continue;throw TypeError('Expected "'+s.name+'" to not be empty')}for(var u=0;u<o.length;u++){var h=i(o[u],s);if(a&&!l[r].test(h))throw TypeError('Expected all "'+s.name+'" to match "'+s.pattern+'", but got "'+h+'"');n+=s.prefix+h+s.suffix}continue}if("string"==typeof o||"number"==typeof o){var h=i(String(o),s);if(a&&!l[r].test(h))throw TypeError('Expected "'+s.name+'" to match "'+s.pattern+'", but got "'+h+'"');n+=s.prefix+h+s.suffix;continue}if(!c){var p=d?"an array":"a string";throw TypeError('Expected "'+s.name+'" to be '+p)}}return n}}function r(e,t,n){void 0===n&&(n={});var r=n.decode,i=void 0===r?function(e){return e}:r;return function(n){var r=e.exec(n);if(!r)return!1;for(var s=r[0],o=r.index,a=Object.create(null),l=1;l<r.length;l++)!function(e){if(void 0!==r[e]){var n=t[e-1];"*"===n.modifier||"+"===n.modifier?a[n.name]=r[e].split(n.prefix+n.suffix).map(function(e){return i(e,n)}):a[n.name]=i(r[e],n)}}(l);return{path:s,index:o,params:a}}}function i(e){return e.replace(/([.+*?=^!:${}()[\]|/\\])/g,"\\$1")}function s(e){return e&&e.sensitive?"":"i"}function o(e,t,n){void 0===n&&(n={});for(var r=n.strict,o=void 0!==r&&r,a=n.start,l=n.end,c=n.encode,d=void 0===c?function(e){return e}:c,u="["+i(n.endsWith||"")+"]|$",h="["+i(n.delimiter||"/#?")+"]",p=void 0===a||a?"^":"",f=0;f<e.length;f++){var m=e[f];if("string"==typeof m)p+=i(d(m));else{var g=i(d(m.prefix)),y=i(d(m.suffix));if(m.pattern)if(t&&t.push(m),g||y)if("+"===m.modifier||"*"===m.modifier){var x="*"===m.modifier?"?":"";p+="(?:"+g+"((?:"+m.pattern+")(?:"+y+g+"(?:"+m.pattern+"))*)"+y+")"+x}else p+="(?:"+g+"("+m.pattern+")"+y+")"+m.modifier;else p+="("+m.pattern+")"+m.modifier;else p+="(?:"+g+y+")"+m.modifier}}if(void 0===l||l)o||(p+=h+"?"),p+=n.endsWith?"(?="+u+")":"$";else{var v=e[e.length-1],b="string"==typeof v?h.indexOf(v[v.length-1])>-1:void 0===v;o||(p+="(?:"+h+"(?="+u+"))?"),b||(p+="(?="+h+"|"+u+")")}return new RegExp(p,s(n))}function a(t,n,r){if(t instanceof RegExp){if(!n)return t;var i=t.source.match(/\((?!\?)/g);if(i)for(var l=0;l<i.length;l++)n.push({name:l,prefix:"",suffix:"",modifier:"",pattern:""});return t}return Array.isArray(t)?RegExp("(?:"+t.map(function(e){return a(e,n,r).source}).join("|")+")",s(r)):o(e(t,r),n,r)}Object.defineProperty(t,"__esModule",{value:!0}),t.parse=e,t.compile=function(t,r){return n(e(t,r),r)},t.tokensToFunction=n,t.match=function(e,t){var n=[];return r(a(e,n,t),n,t)},t.regexpToFunction=r,t.tokensToRegexp=o,t.pathToRegexp=a})(),e.exports=t})()},5526:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),!function(e,t){for(var n in t)Object.defineProperty(e,n,{enumerable:!0,get:t[n]})}(t,{compileNonPath:function(){return d},matchHas:function(){return c},parseDestination:function(){return u},prepareDestination:function(){return h}});let r=n(5362),i=n(3293),s=n(6759),o=n(1437),a=n(8212);function l(e){return e.replace(/__ESC_COLON_/gi,":")}function c(e,t,n,r){void 0===n&&(n=[]),void 0===r&&(r=[]);let i={},s=n=>{let r,s=n.key;switch(n.type){case"header":s=s.toLowerCase(),r=e.headers[s];break;case"cookie":r="cookies"in e?e.cookies[n.key]:(0,a.getCookieParser)(e.headers)()[n.key];break;case"query":r=t[s];break;case"host":{let{host:t}=(null==e?void 0:e.headers)||{};r=null==t?void 0:t.split(":",1)[0].toLowerCase()}}if(!n.value&&r)return i[function(e){let t="";for(let n=0;n<e.length;n++){let r=e.charCodeAt(n);(r>64&&r<91||r>96&&r<123)&&(t+=e[n])}return t}(s)]=r,!0;if(r){let e=RegExp("^"+n.value+"$"),t=Array.isArray(r)?r.slice(-1)[0].match(e):r.match(e);if(t)return Array.isArray(t)&&(t.groups?Object.keys(t.groups).forEach(e=>{i[e]=t.groups[e]}):"host"===n.type&&t[0]&&(i.host=t[0])),!0}return!1};return!(!n.every(e=>s(e))||r.some(e=>s(e)))&&i}function d(e,t){if(!e.includes(":"))return e;for(let n of Object.keys(t))e.includes(":"+n)&&(e=e.replace(RegExp(":"+n+"\\*","g"),":"+n+"--ESCAPED_PARAM_ASTERISKS").replace(RegExp(":"+n+"\\?","g"),":"+n+"--ESCAPED_PARAM_QUESTION").replace(RegExp(":"+n+"\\+","g"),":"+n+"--ESCAPED_PARAM_PLUS").replace(RegExp(":"+n+"(?!\\w)","g"),"--ESCAPED_PARAM_COLON"+n));return e=e.replace(/(:|\*|\?|\+|\(|\)|\{|\})/g,"\\$1").replace(/--ESCAPED_PARAM_PLUS/g,"+").replace(/--ESCAPED_PARAM_COLON/g,":").replace(/--ESCAPED_PARAM_QUESTION/g,"?").replace(/--ESCAPED_PARAM_ASTERISKS/g,"*"),(0,r.compile)("/"+e,{validate:!1})(t).slice(1)}function u(e){let t=e.destination;for(let n of Object.keys({...e.params,...e.query}))n&&(t=t.replace(RegExp(":"+(0,i.escapeStringRegexp)(n),"g"),"__ESC_COLON_"+n));let n=(0,s.parseUrl)(t),r=n.pathname;r&&(r=l(r));let o=n.href;o&&(o=l(o));let a=n.hostname;a&&(a=l(a));let c=n.hash;return c&&(c=l(c)),{...n,pathname:r,hostname:a,href:o,hash:c}}function h(e){let t,n,i=Object.assign({},e.query),s=u(e),{hostname:a,query:c}=s,h=s.pathname;s.hash&&(h=""+h+s.hash);let p=[],f=[];for(let e of((0,r.pathToRegexp)(h,f),f))p.push(e.name);if(a){let e=[];for(let t of((0,r.pathToRegexp)(a,e),e))p.push(t.name)}let m=(0,r.compile)(h,{validate:!1});for(let[n,i]of(a&&(t=(0,r.compile)(a,{validate:!1})),Object.entries(c)))Array.isArray(i)?c[n]=i.map(t=>d(l(t),e.params)):"string"==typeof i&&(c[n]=d(l(i),e.params));let g=Object.keys(e.params).filter(e=>"nextInternalLocale"!==e);if(e.appendParamsToQuery&&!g.some(e=>p.includes(e)))for(let t of g)t in c||(c[t]=e.params[t]);if((0,o.isInterceptionRouteAppPath)(h))for(let t of h.split("/")){let n=o.INTERCEPTION_ROUTE_MARKERS.find(e=>t.startsWith(e));if(n){"(..)(..)"===n?(e.params["0"]="(..)",e.params["1"]="(..)"):e.params["0"]=n;break}}try{let[r,i]=(n=m(e.params)).split("#",2);t&&(s.hostname=t(e.params)),s.pathname=r,s.hash=(i?"#":"")+(i||""),delete s.search}catch(e){if(e.message.match(/Expected .*? to not repeat, but got an array/))throw Object.defineProperty(Error("To use a multi-match in the destination you must add `*` at the end of the param name to signify it should repeat. https://nextjs.org/docs/messages/invalid-multi-match"),"__NEXT_ERROR_CODE",{value:"E329",enumerable:!1,configurable:!0});throw e}return s.query={...i,...s.query},{newUrl:n,destQuery:c,parsedDestination:s}}},5531:(e,t)=>{"use strict";function n(e){return e.startsWith("/")?e:"/"+e}Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"ensureLeadingSlash",{enumerable:!0,get:function(){return n}})},6341:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),!function(e,t){for(var n in t)Object.defineProperty(e,n,{enumerable:!0,get:t[n]})}(t,{getPreviouslyRevalidatedTags:function(){return y},getUtils:function(){return g},interpolateDynamicPath:function(){return f},normalizeDynamicRouteParams:function(){return m},normalizeVercelUrl:function(){return p}});let r=n(9551),i=n(1959),s=n(2437),o=n(4396),a=n(8034),l=n(5526),c=n(2887),d=n(4722),u=n(6143),h=n(7912);function p(e,t,n){let i=(0,r.parse)(e.url,!0);for(let e of(delete i.search,Object.keys(i.query))){let r=e!==u.NEXT_QUERY_PARAM_PREFIX&&e.startsWith(u.NEXT_QUERY_PARAM_PREFIX),s=e!==u.NEXT_INTERCEPTION_MARKER_PREFIX&&e.startsWith(u.NEXT_INTERCEPTION_MARKER_PREFIX);(r||s||t.includes(e)||n&&Object.keys(n.groups).includes(e))&&delete i.query[e]}e.url=(0,r.format)(i)}function f(e,t,n){if(!n)return e;for(let r of Object.keys(n.groups)){let i,{optional:s,repeat:o}=n.groups[r],a=`[${o?"...":""}${r}]`;s&&(a=`[${a}]`);let l=t[r];i=Array.isArray(l)?l.map(e=>e&&encodeURIComponent(e)).join("/"):l?encodeURIComponent(l):"",e=e.replaceAll(a,i)}return e}function m(e,t,n,r){let i={};for(let s of Object.keys(t.groups)){let o=e[s];"string"==typeof o?o=(0,d.normalizeRscURL)(o):Array.isArray(o)&&(o=o.map(d.normalizeRscURL));let a=n[s],l=t.groups[s].optional;if((Array.isArray(a)?a.some(e=>Array.isArray(o)?o.some(t=>t.includes(e)):null==o?void 0:o.includes(e)):null==o?void 0:o.includes(a))||void 0===o&&!(l&&r))return{params:{},hasValidParams:!1};l&&(!o||Array.isArray(o)&&1===o.length&&("index"===o[0]||o[0]===`[[...${s}]]`))&&(o=void 0,delete e[s]),o&&"string"==typeof o&&t.groups[s].repeat&&(o=o.split("/")),o&&(i[s]=o)}return{params:i,hasValidParams:!0}}function g({page:e,i18n:t,basePath:n,rewrites:r,pageIsDynamic:d,trailingSlash:u,caseSensitive:g}){let y,x,v;return d&&(y=(0,o.getNamedRouteRegex)(e,{prefixRouteKeys:!1}),v=(x=(0,a.getRouteMatcher)(y))(e)),{handleRewrites:function(o,a){let h={},p=a.pathname,f=r=>{let c=(0,s.getPathMatch)(r.source+(u?"(/)?":""),{removeUnnamedParams:!0,strict:!0,sensitive:!!g});if(!a.pathname)return!1;let f=c(a.pathname);if((r.has||r.missing)&&f){let e=(0,l.matchHas)(o,a.query,r.has,r.missing);e?Object.assign(f,e):f=!1}if(f){let{parsedDestination:s,destQuery:o}=(0,l.prepareDestination)({appendParamsToQuery:!0,destination:r.destination,params:f,query:a.query});if(s.protocol)return!0;if(Object.assign(h,o,f),Object.assign(a.query,s.query),delete s.query,Object.assign(a,s),!(p=a.pathname))return!1;if(n&&(p=p.replace(RegExp(`^${n}`),"")||"/"),t){let e=(0,i.normalizeLocalePath)(p,t.locales);p=e.pathname,a.query.nextInternalLocale=e.detectedLocale||f.nextInternalLocale}if(p===e)return!0;if(d&&x){let e=x(p);if(e)return a.query={...a.query,...e},!0}}return!1};for(let e of r.beforeFiles||[])f(e);if(p!==e){let t=!1;for(let e of r.afterFiles||[])if(t=f(e))break;if(!t&&!(()=>{let t=(0,c.removeTrailingSlash)(p||"");return t===(0,c.removeTrailingSlash)(e)||(null==x?void 0:x(t))})()){for(let e of r.fallback||[])if(t=f(e))break}}return h},defaultRouteRegex:y,dynamicRouteMatcher:x,defaultRouteMatches:v,getParamsFromRouteMatches:function(e){if(!y)return null;let{groups:t,routeKeys:n}=y,r=(0,a.getRouteMatcher)({re:{exec:e=>{let r=Object.fromEntries(new URLSearchParams(e));for(let[e,t]of Object.entries(r)){let n=(0,h.normalizeNextQueryParam)(e);n&&(r[n]=t,delete r[e])}let i={};for(let e of Object.keys(n)){let s=n[e];if(!s)continue;let o=t[s],a=r[e];if(!o.optional&&!a)return null;i[o.pos]=a}return i}},groups:t})(e);return r||null},normalizeDynamicRouteParams:(e,t)=>y&&v?m(e,y,v,t):{params:{},hasValidParams:!1},normalizeVercelUrl:(e,t)=>p(e,t,y),interpolateDynamicPath:(e,t)=>f(e,t,y)}}function y(e,t){return"string"==typeof e[u.NEXT_CACHE_REVALIDATED_TAGS_HEADER]&&e[u.NEXT_CACHE_REVALIDATE_TAG_TOKEN_HEADER]===t?e[u.NEXT_CACHE_REVALIDATED_TAGS_HEADER].split(","):[]}},6415:e=>{(()=>{"use strict";"undefined"!=typeof __nccwpck_require__&&(__nccwpck_require__.ab=__dirname+"/");var t={};(()=>{t.parse=function(t,n){if("string"!=typeof t)throw TypeError("argument str must be a string");for(var i={},s=t.split(r),o=(n||{}).decode||e,a=0;a<s.length;a++){var l=s[a],c=l.indexOf("=");if(!(c<0)){var d=l.substr(0,c).trim(),u=l.substr(++c,l.length).trim();'"'==u[0]&&(u=u.slice(1,-1)),void 0==i[d]&&(i[d]=function(e,t){try{return t(e)}catch(t){return e}}(u,o))}}return i},t.serialize=function(e,t,r){var s=r||{},o=s.encode||n;if("function"!=typeof o)throw TypeError("option encode is invalid");if(!i.test(e))throw TypeError("argument name is invalid");var a=o(t);if(a&&!i.test(a))throw TypeError("argument val is invalid");var l=e+"="+a;if(null!=s.maxAge){var c=s.maxAge-0;if(isNaN(c)||!isFinite(c))throw TypeError("option maxAge is invalid");l+="; Max-Age="+Math.floor(c)}if(s.domain){if(!i.test(s.domain))throw TypeError("option domain is invalid");l+="; Domain="+s.domain}if(s.path){if(!i.test(s.path))throw TypeError("option path is invalid");l+="; Path="+s.path}if(s.expires){if("function"!=typeof s.expires.toUTCString)throw TypeError("option expires is invalid");l+="; Expires="+s.expires.toUTCString()}if(s.httpOnly&&(l+="; HttpOnly"),s.secure&&(l+="; Secure"),s.sameSite)switch("string"==typeof s.sameSite?s.sameSite.toLowerCase():s.sameSite){case!0:case"strict":l+="; SameSite=Strict";break;case"lax":l+="; SameSite=Lax";break;case"none":l+="; SameSite=None";break;default:throw TypeError("option sameSite is invalid")}return l};var e=decodeURIComponent,n=encodeURIComponent,r=/; */,i=/^[\u0009\u0020-\u007e\u0080-\u00ff]+$/})(),e.exports=t})()},6673:(e,t,n)=>{Promise.resolve().then(n.bind(n,4947))},6759:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"parseUrl",{enumerable:!0,get:function(){return s}});let r=n(2785),i=n(3736);function s(e){if(e.startsWith("/"))return(0,i.parseRelativeUrl)(e);let t=new URL(e);return{hash:t.hash,hostname:t.hostname,href:t.href,pathname:t.pathname,port:t.port,protocol:t.protocol,query:(0,r.searchParamsToUrlQuery)(t.searchParams),search:t.search}}},7392:(e,t,n)=>{Promise.resolve().then(n.t.bind(n,6444,23)),Promise.resolve().then(n.t.bind(n,6042,23)),Promise.resolve().then(n.t.bind(n,8170,23)),Promise.resolve().then(n.t.bind(n,9477,23)),Promise.resolve().then(n.t.bind(n,9345,23)),Promise.resolve().then(n.t.bind(n,2089,23)),Promise.resolve().then(n.t.bind(n,6577,23)),Promise.resolve().then(n.t.bind(n,1307,23))},7619:(e,t,n)=>{Promise.resolve().then(n.bind(n,7699))},7699:(e,t,n)=>{"use strict";let r;n.r(t),n.d(t,{default:()=>vX});var i,s,o,a,l,c,d,u=n(687),h=n(3210),p=n.t(h,2),f=n.n(h);let m="echo_journal_entries",g="echo_thought_records",y="echo_daily_plans",x="echo_weekly_plans",v="echo_medications",b="echo_medication_logs",w="echo_theme",k="echo_palette",j="echo_medication_groups",N="echo_calendar_events",S="echo_profile_data",C=e=>{try{localStorage.setItem(m,JSON.stringify(e))}catch(e){console.error("Error saving journal entries to localStorage:",e)}},M=()=>{try{let e=localStorage.getItem(m);return e?JSON.parse(e):[]}catch(e){return console.error("Error loading journal entries from localStorage:",e),[]}},E=e=>{let t="data:text/json;charset=utf-8,"+encodeURIComponent(JSON.stringify(e,null,2)),n=document.createElement("a");n.setAttribute("href",t),n.setAttribute("download",`echo_journal_backup_${new Date().toISOString().slice(0,10)}.json`),document.body.appendChild(n),n.click(),n.remove()},T=e=>{try{localStorage.setItem(g,JSON.stringify(e))}catch(e){console.error("Error saving thought records to localStorage:",e)}},A=()=>{try{let e=localStorage.getItem(g);return e?JSON.parse(e):[]}catch(e){return console.error("Error loading thought records from localStorage:",e),[]}},D=e=>{try{localStorage.setItem(y,JSON.stringify(e))}catch(e){console.error("Error saving daily plans to localStorage:",e)}},O=()=>{try{let e=localStorage.getItem(y);return e?JSON.parse(e):{}}catch(e){return console.error("Error loading daily plans from localStorage:",e),{}}},R=e=>{try{localStorage.setItem(x,JSON.stringify(e))}catch(e){console.error("Error saving weekly plans to localStorage:",e)}},P=()=>{try{let e=localStorage.getItem(x);return e?JSON.parse(e):{}}catch(e){return console.error("Error loading weekly plans from localStorage:",e),{}}},I=e=>{try{localStorage.setItem(v,JSON.stringify(e))}catch(e){console.error("Error saving medications to localStorage:",e)}},L=()=>{try{let e=localStorage.getItem(v);return e?JSON.parse(e):[]}catch(e){return console.error("Error loading medications from localStorage:",e),[]}},z=e=>{try{localStorage.setItem(b,JSON.stringify(e))}catch(e){console.error("Error saving medication logs to localStorage:",e)}},V=()=>{try{let e=localStorage.getItem(b);return e?JSON.parse(e):[]}catch(e){return console.error("Error loading medication logs from localStorage:",e),[]}},$=e=>{try{localStorage.setItem(j,JSON.stringify(e))}catch(e){console.error("Error saving medication groups to localStorage:",e)}},_=()=>{try{let e=localStorage.getItem(j);return e?JSON.parse(e):[]}catch(e){return console.error("Error loading medication groups from localStorage:",e),[]}},F=e=>{try{localStorage.setItem(N,JSON.stringify(e))}catch(e){console.error("Error saving calendar events to localStorage:",e)}},B=()=>{try{let e=localStorage.getItem(N);return e?JSON.parse(e):[]}catch(e){return console.error("Error loading calendar events from localStorage:",e),[]}},W=e=>{try{localStorage.setItem(S,JSON.stringify(e))}catch(e){console.error("Error saving profile data to localStorage:",e)}},q=()=>{let e={planner:!0,medication:!0,copingMechanisms:!0,affirmations:!0};try{let t=localStorage.getItem(S);if(t){let n=JSON.parse(t);return n.dashboardWidgets={...e,...n.dashboardWidgets||{}},n.strengths=n.strengths||[],n.favoriteAffirmations=n.favoriteAffirmations||[],n}}catch(e){console.error("Error loading profile data from localStorage:",e)}return{name:"",strengths:[],copingMechanisms:[],dashboardWidgets:e,favoriteAffirmations:[]}},H=e=>{try{localStorage.setItem(k,e)}catch(e){console.error("Error saving palette to localStorage:",e)}},U=()=>{try{let e=localStorage.getItem(k);return"ocean"===e&&(e="buttercup",H("buttercup")),e||"echo"}catch(e){return console.error("Error loading palette from localStorage:",e),"echo"}};var K=n(2614);let J=(0,K.A)("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]),G=(0,K.A)("Menu",[["line",{x1:"4",x2:"20",y1:"12",y2:"12",key:"1e0a9i"}],["line",{x1:"4",x2:"20",y1:"6",y2:"6",key:"1owob3"}],["line",{x1:"4",x2:"20",y1:"18",y2:"18",key:"yk5zj1"}]]),Y=(0,K.A)("Cloud",[["path",{d:"M17.5 19H9a7 7 0 1 1 6.71-9h1.79a4.5 4.5 0 1 1 0 9Z",key:"p7xjir"}]]);var X=n(4780);let Z=e=>{switch(e){case"filled":return"bg-primary text-primary-foreground shadow-sm";case"tonal":return"bg-secondary-container text-on-secondary-container shadow-sm";case"outlined":return"border border-outline bg-transparent text-primary hover:bg-primary-container/20";case"text":return"bg-transparent text-primary shadow-none";case"elevated":return"bg-surface-container-low shadow-md text-primary";default:return""}},Q=({children:e,variant:t="filled",size:n="md",className:r="",isIconOnly:i=!1,leadingIcon:s,trailingIcon:o,...a})=>{let l=`
    inline-flex items-center justify-center font-medium
    focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-offset-2 
    dark:focus-visible:ring-offset-surface-dark
    disabled:opacity-40 disabled:cursor-not-allowed disabled:shadow-none
    transition-all duration-500 ease-in-out 
    hover:brightness-110 active:brightness-90
    dark:hover:brightness-125 dark:active:brightness-90
  `,c={sm:`h-8 ${i?"w-8 px-0":"text-label-md px-3"} rounded-full`,md:`h-10 ${i?"w-10 px-0":"text-label-lg px-6"} rounded-full`,lg:`h-12 ${i?"w-12 px-0":"text-label-lg px-8"} rounded-full`},d={sm:"w-4 h-4",md:"w-5 h-5",lg:"w-6 h-6"},h=e=>{if(f().isValidElement(e)){let t=e.props.className||"",r=(0,X.cn)(t,d[n]);return f().cloneElement(e,{className:r})}return e};return(0,u.jsx)("button",{className:(0,X.cn)(l,c[n],Z(t),r),...a,children:i?h(s||e):(0,u.jsxs)(u.Fragment,{children:[s&&(0,u.jsx)("span",{className:"mr-2",children:h(s)}),e,o&&(0,u.jsx)("span",{className:"ml-2",children:h(o)})]})})},ee=[{label:"Dashboard",view:"dashboard","aria-label":"Navigate to Dashboard"},{label:"Journal",view:"journal","aria-label":"Navigate to Journal page"},{label:"Planner",view:"planner","aria-label":"Navigate to Planner and Calendar page"},{label:"Thought Record",view:"thoughtRecord","aria-label":"Navigate to Thought Record page"},{label:"Affirmations",view:"affirmations","aria-label":"Navigate to Affirmations page"},{label:"Med Tracker",view:"medication","aria-label":"Navigate to Med Tracker page"},{label:"Resources",view:"resources","aria-label":"Navigate to Resources Page"}],et=[{label:"Profile",view:"profile",icon:(0,u.jsx)(J,{className:"w-5 h-5"}),"aria-label":"Navigate to Profile & Settings Page"}],en=(e,t)=>"journal"===t?e.startsWith("journal"):"thoughtRecord"===t?e.startsWith("thoughtRecord"):"resources"===t?e.startsWith("resources")||"understanding-cbt"===e||"crisis-support"===e:e===t,er=({onToggleDrawer:e,onNavigateToView:t,currentView:n,desktopAudioPlayer:r})=>(0,u.jsx)("nav",{className:"bg-surface-container shadow-md sticky top-0 z-40 h-20",children:(0,u.jsxs)("div",{className:"px-4 sm:px-6 lg:px-8 flex items-center justify-between h-full",children:[(0,u.jsxs)("div",{className:"flex items-center gap-2",children:[(0,u.jsx)("div",{className:"md:hidden",children:(0,u.jsx)(Q,{onClick:e,variant:"text",size:"md",isIconOnly:!0,title:"Open navigation menu","aria-label":"Open navigation menu",className:"text-primary",leadingIcon:(0,u.jsx)(G,{className:"w-6 h-6"})})}),(0,u.jsxs)("div",{className:"flex items-center space-x-3 cursor-pointer p-2 rounded-lg transition-opacity duration-200 ease-in-out hover:opacity-80 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-primary-container",onClick:()=>{t("dashboard")},onKeyDown:e=>{("Enter"===e.key||" "===e.key)&&(e.preventDefault(),t("dashboard"))},role:"button",tabIndex:0,"aria-label":"echo - Navigate to Dashboard",children:[(0,u.jsx)(Y,{className:"w-7 h-7 text-primary"}),(0,u.jsx)("h1",{className:"font-geologica font-medium text-2xl text-primary hidden sm:block",children:"echo"})]})]}),(0,u.jsx)("div",{className:"hidden md:flex items-center h-full gap-4",children:ee.map(e=>{let r=en(n,e.view);return(0,u.jsx)("button",{onClick:()=>t(e.view),"aria-label":e["aria-label"],"aria-current":r?"page":void 0,className:(0,X.cn)("h-full inline-flex items-center px-3 border-b-2 text-sm font-medium transition-colors duration-200","focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-background",r?"border-primary text-primary":"border-transparent text-surface-on-variant hover:text-primary"),children:e.label},e.view)})}),(0,u.jsxs)("div",{className:"flex items-center space-x-2",children:[r,(0,u.jsxs)("div",{className:"hidden md:flex items-center gap-1",children:[(0,u.jsx)("div",{className:"h-6 w-px bg-outline-variant mx-2"}),et.map(e=>{let r=en(n,e.view);return(0,u.jsx)(Q,{variant:"text",size:"md",isIconOnly:!0,title:e.label,onClick:()=>t(e.view),className:(0,X.cn)("text-surface-on-variant hover:bg-surface-on-variant/10",r&&"text-primary bg-primary-container/40"),"aria-label":e["aria-label"],"aria-current":r?"page":void 0,children:e.icon},e.view)})]}),(0,u.jsx)("div",{className:"md:hidden",children:(0,u.jsx)(Q,{onClick:()=>t("profile"),variant:"text",size:"md",isIconOnly:!0,title:"View Profile","aria-label":"View your profile",className:"text-primary",leadingIcon:(0,u.jsx)(J,{className:"w-6 h-6"})})})]})]})}),ei=(0,K.A)("House",[["path",{d:"M15 21v-8a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v8",key:"5wwlr5"}],["path",{d:"M3 10a2 2 0 0 1 .709-1.528l7-5.999a2 2 0 0 1 2.582 0l7 5.999A2 2 0 0 1 21 10v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"1d0kgt"}]]),es=(0,K.A)("PenLine",[["path",{d:"M12 20h9",key:"t2du7b"}],["path",{d:"M16.376 3.622a1 1 0 0 1 3.002 3.002L7.368 18.635a2 2 0 0 1-.855.506l-2.872.838a.5.5 0 0 1-.62-.62l.838-2.872a2 2 0 0 1 .506-.854z",key:"1ykcvy"}]]),eo=(0,K.A)("Calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]),ea=(0,K.A)("Clipboard",[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}]]),el=(0,K.A)("Sunrise",[["path",{d:"M12 2v8",key:"1q4o3n"}],["path",{d:"m4.93 10.93 1.41 1.41",key:"2a7f42"}],["path",{d:"M2 18h2",key:"j10viu"}],["path",{d:"M20 18h2",key:"wocana"}],["path",{d:"m19.07 10.93-1.41 1.41",key:"15zs5n"}],["path",{d:"M22 22H2",key:"19qnx5"}],["path",{d:"m8 6 4-4 4 4",key:"ybng9g"}],["path",{d:"M16 18a4 4 0 0 0-8 0",key:"1lzouq"}]]),ec=(0,K.A)("CircleMinus",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 12h8",key:"1wcyev"}]]),ed=(0,K.A)("CircleHelp",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3",key:"1u773s"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);var eu=n(8726);let eh=[{label:"Dashboard",view:"dashboard",icon:(0,u.jsx)(ei,{className:"w-6 h-6"}),"aria-label":"Navigate to Dashboard"},{label:"Journal",view:"journal",icon:(0,u.jsx)(es,{className:"w-6 h-6"}),"aria-label":"Navigate to Journal page"},{label:"Planner",view:"planner",icon:(0,u.jsx)(eo,{className:"w-6 h-6"}),"aria-label":"Navigate to Planner and Calendar page"},{label:"Thought Record",view:"thoughtRecord",icon:(0,u.jsx)(ea,{className:"w-6 h-6"}),"aria-label":"Navigate to Thought Record page"},{label:"Affirmations",view:"affirmations",icon:(0,u.jsx)(el,{className:"w-6 h-6"}),"aria-label":"Navigate to Affirmations page"},{label:"Med Tracker",view:"medication",icon:(0,u.jsx)(ec,{className:"w-6 h-6 transform rotate-90"}),"aria-label":"Navigate to Med Tracker page"},{label:"Resources",view:"resources",icon:(0,u.jsx)(ed,{className:"w-6 h-6"}),"aria-label":"Navigate to Resources Page"}],ep=[{label:"Profile & Settings",view:"profile",icon:(0,u.jsx)(J,{className:"w-6 h-6"}),"aria-label":"Navigate to Profile & Settings Page"}],ef=({isOpen:e,onClose:t,onNavigateToView:n,currentView:r})=>{let[i,s]=(0,h.useState)(e),[o,a]=(0,h.useState)(!1);if((0,h.useEffect)(()=>{let t,n,r;return e?(s(!0),t=requestAnimationFrame(()=>{n=requestAnimationFrame(()=>{a(!0)})})):(a(!1),r=window.setTimeout(()=>{s(!1)},1e3)),()=>{cancelAnimationFrame(t),cancelAnimationFrame(n),clearTimeout(r)}},[e]),!i)return null;let l=e=>"journal"===e?r.startsWith("journal"):"thoughtRecord"===e?r.startsWith("thoughtRecord"):"resources"===e?r.startsWith("resources")||"understanding-cbt"===r||"crisis-support"===r:r===e,c=({item:e,isActive:r})=>(0,u.jsx)(Q,{variant:r?"tonal":"text",size:"lg",className:`w-full justify-start ${r?"text-primary bg-primary-container/30":"text-surface-on hover:bg-surface-container"}`,leadingIcon:e.icon,onClick:()=>{n(e.view),t()},"aria-label":e["aria-label"],"aria-current":r?"page":void 0,children:e.label});return(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)("div",{className:`
          fixed inset-0 z-40 bg-scrim/60 backdrop-blur-sm 
          transition-opacity ease-[cubic-bezier(0.16,1,0.3,1)] duration-[1000ms]
          md:hidden 
          ${o&&e?"opacity-100":"opacity-0"}
        `,onClick:t,"aria-hidden":"true"}),(0,u.jsx)("aside",{className:`
          fixed top-0 left-0 z-50 w-72 sm:w-80 h-full 
          bg-surface-container-highest shadow-xl 
          transform transition-transform ease-[cubic-bezier(0.16,1,0.3,1)] duration-[1000ms]
          md:hidden 
          ${o&&e?"translate-x-0":"-translate-x-full"}
        `,role:"dialog","aria-modal":"true","aria-labelledby":"sidebar-title",children:(0,u.jsxs)("div",{className:"flex flex-col h-full",children:[(0,u.jsxs)("div",{className:"relative flex items-center justify-center p-4 border-b border-outline-variant h-20",children:[(0,u.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,u.jsx)(Y,{className:"w-7 h-7 text-primary"}),(0,u.jsx)("h2",{id:"sidebar-title",className:"font-geologica font-medium text-2xl text-primary",children:"echo"})]}),(0,u.jsx)("div",{className:"absolute right-4 top-1/2 transform -translate-y-1/2",children:(0,u.jsx)(Q,{variant:"text",size:"sm",isIconOnly:!0,onClick:t,className:"text-surface-on-variant hover:bg-surface-on-variant/10","aria-label":"Close navigation menu",children:(0,u.jsx)(eu.A,{className:"w-6 h-6"})})})]}),(0,u.jsxs)("nav",{className:"flex-grow p-6 space-y-3 overflow-y-auto",children:[eh.map(e=>(0,u.jsx)(c,{item:e,isActive:l(e.view)},e.view)),(0,u.jsx)("hr",{className:"my-3 border-outline-variant"}),ep.map(e=>(0,u.jsx)(c,{item:e,isActive:l(e.view)},e.view))]}),(0,u.jsx)("div",{className:"p-6 border-t border-outline-variant",children:(0,u.jsxs)("p",{className:"text-label-sm text-center text-surface-on-variant",children:["echo \xa9 ",new Date().getFullYear()]})})]})})]})},em=(0,K.A)("Coffee",[["path",{d:"M10 2v2",key:"7u0qdc"}],["path",{d:"M14 2v2",key:"6buw04"}],["path",{d:"M16 8a1 1 0 0 1 1 1v8a4 4 0 0 1-4 4H7a4 4 0 0 1-4-4V9a1 1 0 0 1 1-1h14a4 4 0 1 1 0 8h-1",key:"pwadti"}],["path",{d:"M6 2v2",key:"colzsn"}]]),eg=(0,K.A)("Sun",[["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}],["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"M12 20v2",key:"1lh1kg"}],["path",{d:"m4.93 4.93 1.41 1.41",key:"149t6j"}],["path",{d:"m17.66 17.66 1.41 1.41",key:"ptbguv"}],["path",{d:"M2 12h2",key:"1t8f8n"}],["path",{d:"M20 12h2",key:"1q8mjw"}],["path",{d:"m6.34 17.66-1.41 1.41",key:"1m8zz5"}],["path",{d:"m19.07 4.93-1.41 1.41",key:"1shlcs"}]]),ey=(0,K.A)("Moon",[["path",{d:"M12 3a6 6 0 0 0 9 9 9 9 0 1 1-9-9Z",key:"a7tn18"}]]),ex=()=>{let[e,t]=(0,h.useState)({greeting:"Hello",Icon:em,formattedDate:""});(0,h.useEffect)(()=>{let e=new Date,n="Hello",r=em,i=e.getHours();i<12?(n="Good Morning",r=eg):i<18?(n="Good Afternoon",r=em):(n="Good Evening",r=ey),t({greeting:n,Icon:r,formattedDate:e.toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"})})},[]);let{greeting:n,Icon:r,formattedDate:i}=e;return(0,u.jsx)("div",{className:"bg-primary-container p-8 rounded-2xl shadow-lg text-on-primary-container",children:(0,u.jsx)("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-start gap-4",children:(0,u.jsxs)("div",{className:"flex-grow",children:[(0,u.jsxs)("div",{className:"flex items-center gap-4",children:[(0,u.jsx)(r,{size:48,className:"opacity-70 flex-shrink-0"}),(0,u.jsxs)("div",{children:[(0,u.jsxs)("h1",{className:"font-serif text-headline-md sm:text-headline-lg",children:[n,"!"]}),(0,u.jsx)("p",{className:"text-title-md sm:text-title-lg opacity-90 min-h-[1.75rem]",children:i})]})]}),(0,u.jsx)("p",{className:"text-body-lg mt-4 opacity-80 max-w-2xl",children:"Welcome back. Capture your thoughts, organize your day, and reflect on your well-being."})]})})})},ev=(0,K.A)("Target",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]]),eb=(0,K.A)("SquareCheckBig",[["path",{d:"M21 10.5V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h12.5",key:"1uzm8b"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]),ew=(0,K.A)("List",[["path",{d:"M3 12h.01",key:"nlz23k"}],["path",{d:"M3 18h.01",key:"1tta3j"}],["path",{d:"M3 6h.01",key:"1rqtza"}],["path",{d:"M8 12h13",key:"1za7za"}],["path",{d:"M8 18h13",key:"1lx6n3"}],["path",{d:"M8 6h13",key:"ik3vkj"}]]),ek=({todaysGoals:e,selectedDate:t,onNavigate:n,totalGoalsToday:r,completedGoalsToday:i})=>{let[s,o]=(0,h.useState)("");return(0,h.useEffect)(()=>{o(t.toLocaleDateString("en-US",{weekday:"short",month:"long",day:"numeric"}))},[t]),(0,u.jsxs)("div",{className:"bg-surface-container-low p-8 rounded-xl shadow-md hover:shadow-lg transition-shadow duration-300 flex flex-col justify-between h-full",children:[(0,u.jsxs)("div",{children:[(0,u.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,u.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,u.jsx)(ev,{className:"w-7 h-7 text-secondary"}),(0,u.jsx)("h3",{className:"font-serif text-headline-sm text-surface-on",children:"Today's Goals"})]}),r>0&&(0,u.jsxs)("span",{className:"text-xs font-medium px-2 py-0.5 bg-secondary-container text-on-secondary-container rounded-full",children:[i,"/",r," done"]})]}),(0,u.jsx)("p",{className:"text-label-lg text-surface-on-variant mb-3 min-h-[1.25rem]",children:s}),e.length>0?(0,u.jsx)("ul",{className:"space-y-2 mb-4 max-h-32 overflow-y-auto",children:e.map(e=>(0,u.jsxs)("li",{className:"flex items-center p-2 bg-surface rounded-md",children:[(0,u.jsx)(eb,{className:`w-4 h-4 mr-2 flex-shrink-0 ${e.completed?"text-secondary":"text-outline-variant"}`}),(0,u.jsx)("span",{className:`text-body-sm text-surface-on truncate ${e.completed?"line-through text-surface-on-variant":""}`,title:e.text,children:e.text})]},e.id))}):(0,u.jsx)("p",{className:"text-body-md text-surface-on-variant mb-4",children:"No specific goals set for today. Plan your day!"})]}),(0,u.jsx)(Q,{variant:"tonal",size:"md",leadingIcon:(0,u.jsx)(ew,{}),onClick:()=>n("planner"),"aria-label":"Open Goal Tracker page",className:"w-full mt-auto",children:"View Today's Focus"})]})},ej=(0,K.A)("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]),eN=({medicationsCount:e,medicationGroupsCount:t,onNavigate:n})=>(0,u.jsxs)("div",{className:"bg-surface-container-low p-8 rounded-xl shadow-md hover:shadow-lg transition-shadow duration-300 flex flex-col justify-between h-full",children:[(0,u.jsxs)("div",{children:[(0,u.jsx)("div",{className:"flex items-center justify-between mb-3",children:(0,u.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,u.jsx)(ec,{className:"w-7 h-7 text-error transform rotate-90"}),(0,u.jsx)("h3",{className:"font-serif text-headline-sm text-surface-on",children:"Medication"})]})}),(0,u.jsxs)("div",{className:"space-y-2 mb-4",children:[(0,u.jsxs)("div",{className:"flex justify-between items-center p-2.5 bg-surface rounded-lg",children:[(0,u.jsx)("p",{className:"text-body-md text-surface-on",children:"Tracked Medications:"}),(0,u.jsx)("span",{className:"font-semibold text-primary",children:e})]}),(0,u.jsxs)("div",{className:"flex justify-between items-center p-2.5 bg-surface rounded-lg",children:[(0,u.jsx)("p",{className:"text-body-md text-surface-on",children:"Medication Bundles:"}),(0,u.jsx)("span",{className:"font-semibold text-secondary",children:t})]})]}),0===e&&(0,u.jsx)("p",{className:"text-body-md text-surface-on-variant mb-4",children:"Add your medications to start tracking."})]}),(0,u.jsx)(Q,{variant:"filled",style:{backgroundColor:"var(--error-container)",color:"var(--on-error-container)"},size:"md",leadingIcon:(0,u.jsx)(ej,{}),onClick:()=>n("medication"),"aria-label":"Manage medications and view log",className:"w-full mt-auto",children:"Manage Medications"})]}),eS=(0,K.A)("LifeBuoy",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m4.93 4.93 4.24 4.24",key:"1ymg45"}],["path",{d:"m14.83 9.17 4.24-4.24",key:"1cb5xl"}],["path",{d:"m14.83 14.83 4.24 4.24",key:"q42g0n"}],["path",{d:"m9.17 14.83-4.24 4.24",key:"bqpfvv"}],["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}]]),eC=(0,K.A)("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]),eM=(0,K.A)("CirclePlus",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 12h8",key:"1wcyev"}],["path",{d:"M12 8v8",key:"napkw2"}]]);function eE({className:e,...t}){return(0,u.jsx)("div",{className:(0,X.cn)("animate-pulse rounded-md bg-muted",e),...t})}let eT=({copingMechanisms:e,onNavigate:t,className:n=""})=>{let[r,i]=f().useState(null),[s,o]=f().useState(!1);return f().useEffect(()=>{o(!0)},[]),f().useEffect(()=>{s&&e.length>0?i(e[Math.floor(Math.random()*e.length)]):i(null)},[s,e]),(0,u.jsxs)("div",{className:`bg-surface-container-low p-8 rounded-xl shadow-md hover:shadow-lg transition-shadow duration-300 flex flex-col justify-between h-full ${n}`,children:[(0,u.jsxs)("div",{children:[(0,u.jsxs)("div",{className:"flex items-center space-x-2 mb-3",children:[(0,u.jsx)(eS,{className:"w-7 h-7 text-green-500"}),(0,u.jsx)("h3",{className:"font-serif text-headline-sm text-surface-on",children:"My Coping Strategies"})]}),s?r?(0,u.jsx)("div",{className:"mb-4 p-4 bg-surface rounded-lg min-h-[80px] flex items-center justify-center text-center",children:(0,u.jsxs)("p",{className:"text-body-lg font-medium text-surface-on",children:['"',r.text,'"']})}):(0,u.jsx)("p",{className:"text-body-md text-surface-on-variant mb-4",children:"Add your personal coping mechanisms in your profile to see them here."}):(0,u.jsx)(eE,{className:"h-[80px] w-full"})]}),(0,u.jsxs)("div",{className:"mt-auto grid grid-cols-1 sm:grid-cols-2 gap-3",children:[e.length>0?(0,u.jsx)(Q,{variant:"tonal",size:"md",leadingIcon:(0,u.jsx)(eC,{}),onClick:()=>{if(e.length>1){let t=r;for(;t&&t.id===r?.id;)t=e[Math.floor(Math.random()*e.length)];i(t)}},"aria-label":"Show another coping mechanism",className:"w-full",disabled:!s||e.length<2,children:"Show Another"}):(0,u.jsx)(Q,{variant:"filled",size:"md",leadingIcon:(0,u.jsx)(eM,{}),onClick:()=>t("profile"),"aria-label":"Add coping mechanisms",className:"w-full sm:col-span-2",children:"Add Mechanisms"}),e.length>0&&(0,u.jsx)(Q,{variant:"filled",size:"md",leadingIcon:(0,u.jsx)(J,{}),onClick:()=>t("profile"),"aria-label":"Manage your coping mechanisms",className:"w-full",children:"Manage"})]})]})},eA=(0,K.A)("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]),eD=(0,h.createContext)({});function eO(e){let t=(0,h.useRef)(null);return null===t.current&&(t.current=e()),t.current}let eR=(0,h.createContext)(null),eP=(0,h.createContext)({transformPagePoint:e=>e,isStatic:!1,reducedMotion:"never"});class eI extends h.Component{getSnapshotBeforeUpdate(e){let t=this.props.childRef.current;if(t&&e.isPresent&&!this.props.isPresent){let e=this.props.sizeRef.current;e.height=t.offsetHeight||0,e.width=t.offsetWidth||0,e.top=t.offsetTop,e.left=t.offsetLeft}return null}componentDidUpdate(){}render(){return this.props.children}}function eL({children:e,isPresent:t}){let n=(0,h.useId)(),r=(0,h.useRef)(null),i=(0,h.useRef)({width:0,height:0,top:0,left:0}),{nonce:s}=(0,h.useContext)(eP);return(0,h.useInsertionEffect)(()=>{let{width:e,height:o,top:a,left:l}=i.current;if(t||!r.current||!e||!o)return;r.current.dataset.motionPopId=n;let c=document.createElement("style");return s&&(c.nonce=s),document.head.appendChild(c),c.sheet&&c.sheet.insertRule(`
          [data-motion-pop-id="${n}"] {
            position: absolute !important;
            width: ${e}px !important;
            height: ${o}px !important;
            top: ${a}px !important;
            left: ${l}px !important;
          }
        `),()=>{document.head.removeChild(c)}},[t]),(0,u.jsx)(eI,{isPresent:t,childRef:r,sizeRef:i,children:h.cloneElement(e,{ref:r})})}let ez=({children:e,initial:t,isPresent:n,onExitComplete:r,custom:i,presenceAffectsLayout:s,mode:o})=>{let a=eO(eV),l=(0,h.useId)(),c=(0,h.useCallback)(e=>{for(let t of(a.set(e,!0),a.values()))if(!t)return;r&&r()},[a,r]),d=(0,h.useMemo)(()=>({id:l,initial:t,isPresent:n,custom:i,onExitComplete:c,register:e=>(a.set(e,!1),()=>a.delete(e))}),s?[Math.random(),c]:[n,c]);return(0,h.useMemo)(()=>{a.forEach((e,t)=>a.set(t,!1))},[n]),h.useEffect(()=>{n||a.size||!r||r()},[n]),"popLayout"===o&&(e=(0,u.jsx)(eL,{isPresent:n,children:e})),(0,u.jsx)(eR.Provider,{value:d,children:e})};function eV(){return new Map}function e$(e=!0){let t=(0,h.useContext)(eR);if(null===t)return[!0,null];let{isPresent:n,onExitComplete:r,register:i}=t,s=(0,h.useId)();(0,h.useEffect)(()=>{e&&i(s)},[e]);let o=(0,h.useCallback)(()=>e&&r&&r(s),[s,r,e]);return!n&&r?[!1,o]:[!0]}let e_=e=>e.key||"";function eF(e){let t=[];return h.Children.forEach(e,e=>{(0,h.isValidElement)(e)&&t.push(e)}),t}let eB="undefined"!=typeof window,eW=eB?h.useLayoutEffect:h.useEffect,eq=({children:e,custom:t,initial:n=!0,onExitComplete:r,presenceAffectsLayout:i=!0,mode:s="sync",propagate:o=!1})=>{let[a,l]=e$(o),c=(0,h.useMemo)(()=>eF(e),[e]),d=o&&!a?[]:c.map(e_),p=(0,h.useRef)(!0),f=(0,h.useRef)(c),m=eO(()=>new Map),[g,y]=(0,h.useState)(c),[x,v]=(0,h.useState)(c);eW(()=>{p.current=!1,f.current=c;for(let e=0;e<x.length;e++){let t=e_(x[e]);d.includes(t)?m.delete(t):!0!==m.get(t)&&m.set(t,!1)}},[x,d.length,d.join("-")]);let b=[];if(c!==g){let e=[...c];for(let t=0;t<x.length;t++){let n=x[t],r=e_(n);d.includes(r)||(e.splice(t,0,n),b.push(n))}"wait"===s&&b.length&&(e=b),v(eF(e)),y(c);return}let{forceRender:w}=(0,h.useContext)(eD);return(0,u.jsx)(u.Fragment,{children:x.map(e=>{let h=e_(e),g=(!o||!!a)&&(c===x||d.includes(h));return(0,u.jsx)(ez,{isPresent:g,initial:(!p.current||!!n)&&void 0,custom:g?void 0:t,presenceAffectsLayout:i,mode:s,onExitComplete:g?void 0:()=>{if(!m.has(h))return;m.set(h,!0);let e=!0;m.forEach(t=>{t||(e=!1)}),e&&(null==w||w(),v(f.current),o&&(null==l||l()),r&&r())},children:e},h)})})};function eH(e){return null!==e&&"object"==typeof e&&"function"==typeof e.start}let eU=e=>Array.isArray(e);function eK(e,t){if(!Array.isArray(t))return!1;let n=t.length;if(n!==e.length)return!1;for(let r=0;r<n;r++)if(t[r]!==e[r])return!1;return!0}function eJ(e){return"string"==typeof e||Array.isArray(e)}function eG(e){let t=[{},{}];return null==e||e.values.forEach((e,n)=>{t[0][n]=e.get(),t[1][n]=e.getVelocity()}),t}function eY(e,t,n,r){if("function"==typeof t){let[i,s]=eG(r);t=t(void 0!==n?n:e.custom,i,s)}if("string"==typeof t&&(t=e.variants&&e.variants[t]),"function"==typeof t){let[i,s]=eG(r);t=t(void 0!==n?n:e.custom,i,s)}return t}function eX(e,t,n){let r=e.getProps();return eY(r,t,void 0!==n?n:r.custom,e)}let eZ=["animate","whileInView","whileFocus","whileHover","whileTap","whileDrag","exit"],eQ=["initial",...eZ];function e0(e){let t;return()=>(void 0===t&&(t=e()),t)}let e1=e0(()=>void 0!==window.ScrollTimeline);class e2{constructor(e){this.stop=()=>this.runAll("stop"),this.animations=e.filter(Boolean)}get finished(){return Promise.all(this.animations.map(e=>"finished"in e?e.finished:e))}getAll(e){return this.animations[0][e]}setAll(e,t){for(let n=0;n<this.animations.length;n++)this.animations[n][e]=t}attachTimeline(e,t){let n=this.animations.map(n=>e1()&&n.attachTimeline?n.attachTimeline(e):"function"==typeof t?t(n):void 0);return()=>{n.forEach((e,t)=>{e&&e(),this.animations[t].stop()})}}get time(){return this.getAll("time")}set time(e){this.setAll("time",e)}get speed(){return this.getAll("speed")}set speed(e){this.setAll("speed",e)}get startTime(){return this.getAll("startTime")}get duration(){let e=0;for(let t=0;t<this.animations.length;t++)e=Math.max(e,this.animations[t].duration);return e}runAll(e){this.animations.forEach(t=>t[e]())}flatten(){this.runAll("flatten")}play(){this.runAll("play")}pause(){this.runAll("pause")}cancel(){this.runAll("cancel")}complete(){this.runAll("complete")}}class e4 extends e2{then(e,t){return Promise.all(this.animations).then(e).catch(t)}}function e3(e,t){return e?e[t]||e.default||e:void 0}function e5(e){let t=0,n=e.next(t);for(;!n.done&&t<2e4;)t+=50,n=e.next(t);return t>=2e4?1/0:t}function e6(e){return"function"==typeof e}function e8(e,t){e.timeline=t,e.onfinish=null}let e9=e=>Array.isArray(e)&&"number"==typeof e[0],e7={linearEasing:void 0},te=function(e,t){let n=e0(e);return()=>{var e;return null!=(e=e7[t])?e:n()}}(()=>{try{document.createElement("div").animate({opacity:0},{easing:"linear(0, 1)"})}catch(e){return!1}return!0},"linearEasing"),tt=(e,t,n)=>{let r=t-e;return 0===r?1:(n-e)/r},tn=(e,t,n=10)=>{let r="",i=Math.max(Math.round(t/n),2);for(let t=0;t<i;t++)r+=e(tt(0,i-1,t))+", ";return`linear(${r.substring(0,r.length-2)})`},tr=([e,t,n,r])=>`cubic-bezier(${e}, ${t}, ${n}, ${r})`,ti={linear:"linear",ease:"ease",easeIn:"ease-in",easeOut:"ease-out",easeInOut:"ease-in-out",circIn:tr([0,.65,.55,1]),circOut:tr([.55,0,1,.45]),backIn:tr([.31,.01,.66,-.59]),backOut:tr([.33,1.53,.69,.99])},ts={x:!1,y:!1};function to(e,t){let n=function(e,t,n){if(e instanceof Element)return[e];if("string"==typeof e){let t=document.querySelectorAll(e);return t?Array.from(t):[]}return Array.from(e)}(e),r=new AbortController;return[n,{passive:!0,...t,signal:r.signal},()=>r.abort()]}function ta(e){return t=>{"touch"===t.pointerType||ts.x||ts.y||e(t)}}let tl=(e,t)=>!!t&&(e===t||tl(e,t.parentElement)),tc=e=>"mouse"===e.pointerType?"number"!=typeof e.button||e.button<=0:!1!==e.isPrimary,td=new Set(["BUTTON","INPUT","SELECT","TEXTAREA","A"]),tu=new WeakSet;function th(e){return t=>{"Enter"===t.key&&e(t)}}function tp(e,t){e.dispatchEvent(new PointerEvent("pointer"+t,{isPrimary:!0,bubbles:!0}))}let tf=(e,t)=>{let n=e.currentTarget;if(!n)return;let r=th(()=>{if(tu.has(n))return;tp(n,"down");let e=th(()=>{tp(n,"up")});n.addEventListener("keyup",e,t),n.addEventListener("blur",()=>tp(n,"cancel"),t)});n.addEventListener("keydown",r,t),n.addEventListener("blur",()=>n.removeEventListener("keydown",r),t)};function tm(e){return tc(e)&&!(ts.x||ts.y)}let tg=e=>1e3*e,ty=e=>e/1e3,tx=e=>e,tv=["transformPerspective","x","y","z","translateX","translateY","translateZ","scale","scaleX","scaleY","rotate","rotateX","rotateY","rotateZ","skew","skewX","skewY"],tb=new Set(tv),tw=new Set(["width","height","top","left","right","bottom",...tv]),tk=e=>!!(e&&"object"==typeof e&&e.mix&&e.toValue),tj=e=>eU(e)?e[e.length-1]||0:e,tN={skipAnimations:!1,useManualTiming:!1},tS=["read","resolveKeyframes","update","preRender","render","postRender"];function tC(e,t){let n=!1,r=!0,i={delta:0,timestamp:0,isProcessing:!1},s=()=>n=!0,o=tS.reduce((e,t)=>(e[t]=function(e){let t=new Set,n=new Set,r=!1,i=!1,s=new WeakSet,o={delta:0,timestamp:0,isProcessing:!1};function a(t){s.has(t)&&(l.schedule(t),e()),t(o)}let l={schedule:(e,i=!1,o=!1)=>{let a=o&&r?t:n;return i&&s.add(e),a.has(e)||a.add(e),e},cancel:e=>{n.delete(e),s.delete(e)},process:e=>{if(o=e,r){i=!0;return}r=!0,[t,n]=[n,t],t.forEach(a),t.clear(),r=!1,i&&(i=!1,l.process(e))}};return l}(s),e),{}),{read:a,resolveKeyframes:l,update:c,preRender:d,render:u,postRender:h}=o,p=()=>{let s=tN.useManualTiming?i.timestamp:performance.now();n=!1,i.delta=r?1e3/60:Math.max(Math.min(s-i.timestamp,40),1),i.timestamp=s,i.isProcessing=!0,a.process(i),l.process(i),c.process(i),d.process(i),u.process(i),h.process(i),i.isProcessing=!1,n&&t&&(r=!1,e(p))},f=()=>{n=!0,r=!0,i.isProcessing||e(p)};return{schedule:tS.reduce((e,t)=>{let r=o[t];return e[t]=(e,t=!1,i=!1)=>(n||f(),r.schedule(e,t,i)),e},{}),cancel:e=>{for(let t=0;t<tS.length;t++)o[tS[t]].cancel(e)},state:i,steps:o}}let{schedule:tM,cancel:tE,state:tT,steps:tA}=tC("undefined"!=typeof requestAnimationFrame?requestAnimationFrame:tx,!0);function tD(){r=void 0}let tO={now:()=>(void 0===r&&tO.set(tT.isProcessing||tN.useManualTiming?tT.timestamp:performance.now()),r),set:e=>{r=e,queueMicrotask(tD)}};function tR(e,t){-1===e.indexOf(t)&&e.push(t)}function tP(e,t){let n=e.indexOf(t);n>-1&&e.splice(n,1)}class tI{constructor(){this.subscriptions=[]}add(e){return tR(this.subscriptions,e),()=>tP(this.subscriptions,e)}notify(e,t,n){let r=this.subscriptions.length;if(r)if(1===r)this.subscriptions[0](e,t,n);else for(let i=0;i<r;i++){let r=this.subscriptions[i];r&&r(e,t,n)}}getSize(){return this.subscriptions.length}clear(){this.subscriptions.length=0}}let tL=e=>!isNaN(parseFloat(e)),tz={current:void 0};class tV{constructor(e,t={}){this.version="11.18.2",this.canTrackVelocity=null,this.events={},this.updateAndNotify=(e,t=!0)=>{let n=tO.now();this.updatedAt!==n&&this.setPrevFrameValue(),this.prev=this.current,this.setCurrent(e),this.current!==this.prev&&this.events.change&&this.events.change.notify(this.current),t&&this.events.renderRequest&&this.events.renderRequest.notify(this.current)},this.hasAnimated=!1,this.setCurrent(e),this.owner=t.owner}setCurrent(e){this.current=e,this.updatedAt=tO.now(),null===this.canTrackVelocity&&void 0!==e&&(this.canTrackVelocity=tL(this.current))}setPrevFrameValue(e=this.current){this.prevFrameValue=e,this.prevUpdatedAt=this.updatedAt}onChange(e){return this.on("change",e)}on(e,t){this.events[e]||(this.events[e]=new tI);let n=this.events[e].add(t);return"change"===e?()=>{n(),tM.read(()=>{this.events.change.getSize()||this.stop()})}:n}clearListeners(){for(let e in this.events)this.events[e].clear()}attach(e,t){this.passiveEffect=e,this.stopPassiveEffect=t}set(e,t=!0){t&&this.passiveEffect?this.passiveEffect(e,this.updateAndNotify):this.updateAndNotify(e,t)}setWithVelocity(e,t,n){this.set(t),this.prev=void 0,this.prevFrameValue=e,this.prevUpdatedAt=this.updatedAt-n}jump(e,t=!0){this.updateAndNotify(e),this.prev=e,this.prevUpdatedAt=this.prevFrameValue=void 0,t&&this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}get(){return tz.current&&tz.current.push(this),this.current}getPrevious(){return this.prev}getVelocity(){var e;let t=tO.now();if(!this.canTrackVelocity||void 0===this.prevFrameValue||t-this.updatedAt>30)return 0;let n=Math.min(this.updatedAt-this.prevUpdatedAt,30);return e=parseFloat(this.current)-parseFloat(this.prevFrameValue),n?1e3/n*e:0}start(e){return this.stop(),new Promise(t=>{this.hasAnimated=!0,this.animation=e(t),this.events.animationStart&&this.events.animationStart.notify()}).then(()=>{this.events.animationComplete&&this.events.animationComplete.notify(),this.clearAnimation()})}stop(){this.animation&&(this.animation.stop(),this.events.animationCancel&&this.events.animationCancel.notify()),this.clearAnimation()}isAnimating(){return!!this.animation}clearAnimation(){delete this.animation}destroy(){this.clearListeners(),this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}}function t$(e,t){return new tV(e,t)}let t_=e=>!!(e&&e.getVelocity);function tF(e,t){let n=e.getValue("willChange");if(t_(n)&&n.add)return n.add(t)}let tB=e=>e.replace(/([a-z])([A-Z])/gu,"$1-$2").toLowerCase(),tW="data-"+tB("framerAppearId"),tq={current:!1},tH=(e,t,n)=>(((1-3*n+3*t)*e+(3*n-6*t))*e+3*t)*e;function tU(e,t,n,r){if(e===t&&n===r)return tx;let i=t=>(function(e,t,n,r,i){let s,o,a=0;do(s=tH(o=t+(n-t)/2,r,i)-e)>0?n=o:t=o;while(Math.abs(s)>1e-7&&++a<12);return o})(t,0,1,e,n);return e=>0===e||1===e?e:tH(i(e),t,r)}let tK=e=>t=>t<=.5?e(2*t)/2:(2-e(2*(1-t)))/2,tJ=e=>t=>1-e(1-t),tG=tU(.33,1.53,.69,.99),tY=tJ(tG),tX=tK(tY),tZ=e=>(e*=2)<1?.5*tY(e):.5*(2-Math.pow(2,-10*(e-1))),tQ=e=>1-Math.sin(Math.acos(e)),t0=tJ(tQ),t1=tK(tQ),t2=e=>/^0[^.\s]+$/u.test(e),t4=(e,t,n)=>n>t?t:n<e?e:n,t3={test:e=>"number"==typeof e,parse:parseFloat,transform:e=>e},t5={...t3,transform:e=>t4(0,1,e)},t6={...t3,default:1},t8=e=>Math.round(1e5*e)/1e5,t9=/-?(?:\d+(?:\.\d+)?|\.\d+)/gu,t7=/^(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))$/iu,ne=(e,t)=>n=>!!("string"==typeof n&&t7.test(n)&&n.startsWith(e)||t&&null!=n&&Object.prototype.hasOwnProperty.call(n,t)),nt=(e,t,n)=>r=>{if("string"!=typeof r)return r;let[i,s,o,a]=r.match(t9);return{[e]:parseFloat(i),[t]:parseFloat(s),[n]:parseFloat(o),alpha:void 0!==a?parseFloat(a):1}},nn=e=>t4(0,255,e),nr={...t3,transform:e=>Math.round(nn(e))},ni={test:ne("rgb","red"),parse:nt("red","green","blue"),transform:({red:e,green:t,blue:n,alpha:r=1})=>"rgba("+nr.transform(e)+", "+nr.transform(t)+", "+nr.transform(n)+", "+t8(t5.transform(r))+")"},ns={test:ne("#"),parse:function(e){let t="",n="",r="",i="";return e.length>5?(t=e.substring(1,3),n=e.substring(3,5),r=e.substring(5,7),i=e.substring(7,9)):(t=e.substring(1,2),n=e.substring(2,3),r=e.substring(3,4),i=e.substring(4,5),t+=t,n+=n,r+=r,i+=i),{red:parseInt(t,16),green:parseInt(n,16),blue:parseInt(r,16),alpha:i?parseInt(i,16)/255:1}},transform:ni.transform},no=e=>({test:t=>"string"==typeof t&&t.endsWith(e)&&1===t.split(" ").length,parse:parseFloat,transform:t=>`${t}${e}`}),na=no("deg"),nl=no("%"),nc=no("px"),nd=no("vh"),nu=no("vw"),nh={...nl,parse:e=>nl.parse(e)/100,transform:e=>nl.transform(100*e)},np={test:ne("hsl","hue"),parse:nt("hue","saturation","lightness"),transform:({hue:e,saturation:t,lightness:n,alpha:r=1})=>"hsla("+Math.round(e)+", "+nl.transform(t8(t))+", "+nl.transform(t8(n))+", "+t8(t5.transform(r))+")"},nf={test:e=>ni.test(e)||ns.test(e)||np.test(e),parse:e=>ni.test(e)?ni.parse(e):np.test(e)?np.parse(e):ns.parse(e),transform:e=>"string"==typeof e?e:e.hasOwnProperty("red")?ni.transform(e):np.transform(e)},nm=/(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))/giu,ng="number",ny="color",nx=/var\s*\(\s*--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)|#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\)|-?(?:\d+(?:\.\d+)?|\.\d+)/giu;function nv(e){let t=e.toString(),n=[],r={color:[],number:[],var:[]},i=[],s=0,o=t.replace(nx,e=>(nf.test(e)?(r.color.push(s),i.push(ny),n.push(nf.parse(e))):e.startsWith("var(")?(r.var.push(s),i.push("var"),n.push(e)):(r.number.push(s),i.push(ng),n.push(parseFloat(e))),++s,"${}")).split("${}");return{values:n,split:o,indexes:r,types:i}}function nb(e){return nv(e).values}function nw(e){let{split:t,types:n}=nv(e),r=t.length;return e=>{let i="";for(let s=0;s<r;s++)if(i+=t[s],void 0!==e[s]){let t=n[s];t===ng?i+=t8(e[s]):t===ny?i+=nf.transform(e[s]):i+=e[s]}return i}}let nk=e=>"number"==typeof e?0:e,nj={test:function(e){var t,n;return isNaN(e)&&"string"==typeof e&&((null==(t=e.match(t9))?void 0:t.length)||0)+((null==(n=e.match(nm))?void 0:n.length)||0)>0},parse:nb,createTransformer:nw,getAnimatableNone:function(e){let t=nb(e);return nw(e)(t.map(nk))}},nN=new Set(["brightness","contrast","saturate","opacity"]);function nS(e){let[t,n]=e.slice(0,-1).split("(");if("drop-shadow"===t)return e;let[r]=n.match(t9)||[];if(!r)return e;let i=n.replace(r,""),s=+!!nN.has(t);return r!==n&&(s*=100),t+"("+s+i+")"}let nC=/\b([a-z-]*)\(.*?\)/gu,nM={...nj,getAnimatableNone:e=>{let t=e.match(nC);return t?t.map(nS).join(" "):e}},nE={...t3,transform:Math.round},nT={borderWidth:nc,borderTopWidth:nc,borderRightWidth:nc,borderBottomWidth:nc,borderLeftWidth:nc,borderRadius:nc,radius:nc,borderTopLeftRadius:nc,borderTopRightRadius:nc,borderBottomRightRadius:nc,borderBottomLeftRadius:nc,width:nc,maxWidth:nc,height:nc,maxHeight:nc,top:nc,right:nc,bottom:nc,left:nc,padding:nc,paddingTop:nc,paddingRight:nc,paddingBottom:nc,paddingLeft:nc,margin:nc,marginTop:nc,marginRight:nc,marginBottom:nc,marginLeft:nc,backgroundPositionX:nc,backgroundPositionY:nc,rotate:na,rotateX:na,rotateY:na,rotateZ:na,scale:t6,scaleX:t6,scaleY:t6,scaleZ:t6,skew:na,skewX:na,skewY:na,distance:nc,translateX:nc,translateY:nc,translateZ:nc,x:nc,y:nc,z:nc,perspective:nc,transformPerspective:nc,opacity:t5,originX:nh,originY:nh,originZ:nc,zIndex:nE,size:nc,fillOpacity:t5,strokeOpacity:t5,numOctaves:nE},nA={...nT,color:nf,backgroundColor:nf,outlineColor:nf,fill:nf,stroke:nf,borderColor:nf,borderTopColor:nf,borderRightColor:nf,borderBottomColor:nf,borderLeftColor:nf,filter:nM,WebkitFilter:nM},nD=e=>nA[e];function nO(e,t){let n=nD(e);return n!==nM&&(n=nj),n.getAnimatableNone?n.getAnimatableNone(t):void 0}let nR=new Set(["auto","none","0"]),nP=e=>e===t3||e===nc,nI=(e,t)=>parseFloat(e.split(", ")[t]),nL=(e,t)=>(n,{transform:r})=>{if("none"===r||!r)return 0;let i=r.match(/^matrix3d\((.+)\)$/u);if(i)return nI(i[1],t);{let t=r.match(/^matrix\((.+)\)$/u);return t?nI(t[1],e):0}},nz=new Set(["x","y","z"]),nV=tv.filter(e=>!nz.has(e)),n$={width:({x:e},{paddingLeft:t="0",paddingRight:n="0"})=>e.max-e.min-parseFloat(t)-parseFloat(n),height:({y:e},{paddingTop:t="0",paddingBottom:n="0"})=>e.max-e.min-parseFloat(t)-parseFloat(n),top:(e,{top:t})=>parseFloat(t),left:(e,{left:t})=>parseFloat(t),bottom:({y:e},{top:t})=>parseFloat(t)+(e.max-e.min),right:({x:e},{left:t})=>parseFloat(t)+(e.max-e.min),x:nL(4,13),y:nL(5,14)};n$.translateX=n$.x,n$.translateY=n$.y;let n_=new Set,nF=!1,nB=!1;function nW(){if(nB){let e=Array.from(n_).filter(e=>e.needsMeasurement),t=new Set(e.map(e=>e.element)),n=new Map;t.forEach(e=>{let t=function(e){let t=[];return nV.forEach(n=>{let r=e.getValue(n);void 0!==r&&(t.push([n,r.get()]),r.set(+!!n.startsWith("scale")))}),t}(e);t.length&&(n.set(e,t),e.render())}),e.forEach(e=>e.measureInitialState()),t.forEach(e=>{e.render();let t=n.get(e);t&&t.forEach(([t,n])=>{var r;null==(r=e.getValue(t))||r.set(n)})}),e.forEach(e=>e.measureEndState()),e.forEach(e=>{void 0!==e.suspendedScrollY&&window.scrollTo(0,e.suspendedScrollY)})}nB=!1,nF=!1,n_.forEach(e=>e.complete()),n_.clear()}function nq(){n_.forEach(e=>{e.readKeyframes(),e.needsMeasurement&&(nB=!0)})}class nH{constructor(e,t,n,r,i,s=!1){this.isComplete=!1,this.isAsync=!1,this.needsMeasurement=!1,this.isScheduled=!1,this.unresolvedKeyframes=[...e],this.onComplete=t,this.name=n,this.motionValue=r,this.element=i,this.isAsync=s}scheduleResolve(){this.isScheduled=!0,this.isAsync?(n_.add(this),nF||(nF=!0,tM.read(nq),tM.resolveKeyframes(nW))):(this.readKeyframes(),this.complete())}readKeyframes(){let{unresolvedKeyframes:e,name:t,element:n,motionValue:r}=this;for(let i=0;i<e.length;i++)if(null===e[i])if(0===i){let i=null==r?void 0:r.get(),s=e[e.length-1];if(void 0!==i)e[0]=i;else if(n&&t){let r=n.readValue(t,s);null!=r&&(e[0]=r)}void 0===e[0]&&(e[0]=s),r&&void 0===i&&r.set(e[0])}else e[i]=e[i-1]}setFinalKeyframe(){}measureInitialState(){}renderEndStyles(){}measureEndState(){}complete(){this.isComplete=!0,this.onComplete(this.unresolvedKeyframes,this.finalKeyframe),n_.delete(this)}cancel(){this.isComplete||(this.isScheduled=!1,n_.delete(this))}resume(){this.isComplete||this.scheduleResolve()}}let nU=e=>/^-?(?:\d+(?:\.\d+)?|\.\d+)$/u.test(e),nK=e=>t=>"string"==typeof t&&t.startsWith(e),nJ=nK("--"),nG=nK("var(--"),nY=e=>!!nG(e)&&nX.test(e.split("/*")[0].trim()),nX=/var\(--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)$/iu,nZ=/^var\(--(?:([\w-]+)|([\w-]+), ?([a-zA-Z\d ()%#.,-]+))\)/u,nQ=e=>t=>t.test(e),n0=[t3,nc,nl,na,nu,nd,{test:e=>"auto"===e,parse:e=>e}],n1=e=>n0.find(nQ(e));class n2 extends nH{constructor(e,t,n,r,i){super(e,t,n,r,i,!0)}readKeyframes(){let{unresolvedKeyframes:e,element:t,name:n}=this;if(!t||!t.current)return;super.readKeyframes();for(let n=0;n<e.length;n++){let r=e[n];if("string"==typeof r&&nY(r=r.trim())){let i=function e(t,n,r=1){tx(r<=4,`Max CSS variable fallback depth detected in property "${t}". This may indicate a circular fallback dependency.`);let[i,s]=function(e){let t=nZ.exec(e);if(!t)return[,];let[,n,r,i]=t;return[`--${null!=n?n:r}`,i]}(t);if(!i)return;let o=window.getComputedStyle(n).getPropertyValue(i);if(o){let e=o.trim();return nU(e)?parseFloat(e):e}return nY(s)?e(s,n,r+1):s}(r,t.current);void 0!==i&&(e[n]=i),n===e.length-1&&(this.finalKeyframe=r)}}if(this.resolveNoneKeyframes(),!tw.has(n)||2!==e.length)return;let[r,i]=e,s=n1(r),o=n1(i);if(s!==o)if(nP(s)&&nP(o))for(let t=0;t<e.length;t++){let n=e[t];"string"==typeof n&&(e[t]=parseFloat(n))}else this.needsMeasurement=!0}resolveNoneKeyframes(){let{unresolvedKeyframes:e,name:t}=this,n=[];for(let t=0;t<e.length;t++){var r;("number"==typeof(r=e[t])?0===r:null===r||"none"===r||"0"===r||t2(r))&&n.push(t)}n.length&&function(e,t,n){let r,i=0;for(;i<e.length&&!r;){let t=e[i];"string"==typeof t&&!nR.has(t)&&nv(t).values.length&&(r=e[i]),i++}if(r&&n)for(let i of t)e[i]=nO(n,r)}(e,n,t)}measureInitialState(){let{element:e,unresolvedKeyframes:t,name:n}=this;if(!e||!e.current)return;"height"===n&&(this.suspendedScrollY=window.pageYOffset),this.measuredOrigin=n$[n](e.measureViewportBox(),window.getComputedStyle(e.current)),t[0]=this.measuredOrigin;let r=t[t.length-1];void 0!==r&&e.getValue(n,r).jump(r,!1)}measureEndState(){var e;let{element:t,name:n,unresolvedKeyframes:r}=this;if(!t||!t.current)return;let i=t.getValue(n);i&&i.jump(this.measuredOrigin,!1);let s=r.length-1,o=r[s];r[s]=n$[n](t.measureViewportBox(),window.getComputedStyle(t.current)),null!==o&&void 0===this.finalKeyframe&&(this.finalKeyframe=o),(null==(e=this.removedTransforms)?void 0:e.length)&&this.removedTransforms.forEach(([e,n])=>{t.getValue(e).set(n)}),this.resolveNoneKeyframes()}}let n4=(e,t)=>"zIndex"!==t&&!!("number"==typeof e||Array.isArray(e)||"string"==typeof e&&(nj.test(e)||"0"===e)&&!e.startsWith("url(")),n3=e=>null!==e;function n5(e,{repeat:t,repeatType:n="loop"},r){let i=e.filter(n3),s=t&&"loop"!==n&&t%2==1?0:i.length-1;return s&&void 0!==r?r:i[s]}class n6{constructor({autoplay:e=!0,delay:t=0,type:n="keyframes",repeat:r=0,repeatDelay:i=0,repeatType:s="loop",...o}){this.isStopped=!1,this.hasAttemptedResolve=!1,this.createdAt=tO.now(),this.options={autoplay:e,delay:t,type:n,repeat:r,repeatDelay:i,repeatType:s,...o},this.updateFinishedPromise()}calcStartTime(){return this.resolvedAt&&this.resolvedAt-this.createdAt>40?this.resolvedAt:this.createdAt}get resolved(){return this._resolved||this.hasAttemptedResolve||(nq(),nW()),this._resolved}onKeyframesResolved(e,t){this.resolvedAt=tO.now(),this.hasAttemptedResolve=!0;let{name:n,type:r,velocity:i,delay:s,onComplete:o,onUpdate:a,isGenerator:l}=this.options;if(!l&&!function(e,t,n,r){let i=e[0];if(null===i)return!1;if("display"===t||"visibility"===t)return!0;let s=e[e.length-1],o=n4(i,t),a=n4(s,t);return tx(o===a,`You are trying to animate ${t} from "${i}" to "${s}". ${i} is not an animatable value - to enable this animation set ${i} to a value animatable to ${s} via the \`style\` property.`),!!o&&!!a&&(function(e){let t=e[0];if(1===e.length)return!0;for(let n=0;n<e.length;n++)if(e[n]!==t)return!0}(e)||("spring"===n||e6(n))&&r)}(e,n,r,i))if(tq.current||!s){a&&a(n5(e,this.options,t)),o&&o(),this.resolveFinishedPromise();return}else this.options.duration=0;let c=this.initPlayback(e,t);!1!==c&&(this._resolved={keyframes:e,finalKeyframe:t,...c},this.onPostResolved())}onPostResolved(){}then(e,t){return this.currentFinishedPromise.then(e,t)}flatten(){this.options.type="keyframes",this.options.ease="linear"}updateFinishedPromise(){this.currentFinishedPromise=new Promise(e=>{this.resolveFinishedPromise=e})}}let n8=(e,t,n)=>e+(t-e)*n;function n9(e,t,n){return(n<0&&(n+=1),n>1&&(n-=1),n<1/6)?e+(t-e)*6*n:n<.5?t:n<2/3?e+(t-e)*(2/3-n)*6:e}function n7(e,t){return n=>n>0?t:e}let re=(e,t,n)=>{let r=e*e,i=n*(t*t-r)+r;return i<0?0:Math.sqrt(i)},rt=[ns,ni,np],rn=e=>rt.find(t=>t.test(e));function rr(e){let t=rn(e);if(tx(!!t,`'${e}' is not an animatable color. Use the equivalent color code instead.`),!t)return!1;let n=t.parse(e);return t===np&&(n=function({hue:e,saturation:t,lightness:n,alpha:r}){e/=360,n/=100;let i=0,s=0,o=0;if(t/=100){let r=n<.5?n*(1+t):n+t-n*t,a=2*n-r;i=n9(a,r,e+1/3),s=n9(a,r,e),o=n9(a,r,e-1/3)}else i=s=o=n;return{red:Math.round(255*i),green:Math.round(255*s),blue:Math.round(255*o),alpha:r}}(n)),n}let ri=(e,t)=>{let n=rr(e),r=rr(t);if(!n||!r)return n7(e,t);let i={...n};return e=>(i.red=re(n.red,r.red,e),i.green=re(n.green,r.green,e),i.blue=re(n.blue,r.blue,e),i.alpha=n8(n.alpha,r.alpha,e),ni.transform(i))},rs=(e,t)=>n=>t(e(n)),ro=(...e)=>e.reduce(rs),ra=new Set(["none","hidden"]);function rl(e,t){return n=>n8(e,t,n)}function rc(e){return"number"==typeof e?rl:"string"==typeof e?nY(e)?n7:nf.test(e)?ri:rh:Array.isArray(e)?rd:"object"==typeof e?nf.test(e)?ri:ru:n7}function rd(e,t){let n=[...e],r=n.length,i=e.map((e,n)=>rc(e)(e,t[n]));return e=>{for(let t=0;t<r;t++)n[t]=i[t](e);return n}}function ru(e,t){let n={...e,...t},r={};for(let i in n)void 0!==e[i]&&void 0!==t[i]&&(r[i]=rc(e[i])(e[i],t[i]));return e=>{for(let t in r)n[t]=r[t](e);return n}}let rh=(e,t)=>{let n=nj.createTransformer(t),r=nv(e),i=nv(t);return r.indexes.var.length===i.indexes.var.length&&r.indexes.color.length===i.indexes.color.length&&r.indexes.number.length>=i.indexes.number.length?ra.has(e)&&!i.values.length||ra.has(t)&&!r.values.length?function(e,t){return ra.has(e)?n=>n<=0?e:t:n=>n>=1?t:e}(e,t):ro(rd(function(e,t){var n;let r=[],i={color:0,var:0,number:0};for(let s=0;s<t.values.length;s++){let o=t.types[s],a=e.indexes[o][i[o]],l=null!=(n=e.values[a])?n:0;r[s]=l,i[o]++}return r}(r,i),i.values),n):(tx(!0,`Complex values '${e}' and '${t}' too different to mix. Ensure all colors are of the same type, and that each contains the same quantity of number and color values. Falling back to instant transition.`),n7(e,t))};function rp(e,t,n){return"number"==typeof e&&"number"==typeof t&&"number"==typeof n?n8(e,t,n):rc(e)(e,t)}function rf(e,t,n){var r,i;let s=Math.max(t-5,0);return r=n-e(s),(i=t-s)?1e3/i*r:0}let rm={stiffness:100,damping:10,mass:1,velocity:0,duration:800,bounce:.3,visualDuration:.3,restSpeed:{granular:.01,default:2},restDelta:{granular:.005,default:.5},minDuration:.01,maxDuration:10,minDamping:.05,maxDamping:1};function rg(e,t){return e*Math.sqrt(1-t*t)}let ry=["duration","bounce"],rx=["stiffness","damping","mass"];function rv(e,t){return t.some(t=>void 0!==e[t])}function rb(e=rm.visualDuration,t=rm.bounce){let n,r="object"!=typeof e?{visualDuration:e,keyframes:[0,1],bounce:t}:e,{restSpeed:i,restDelta:s}=r,o=r.keyframes[0],a=r.keyframes[r.keyframes.length-1],l={done:!1,value:o},{stiffness:c,damping:d,mass:u,duration:h,velocity:p,isResolvedFromDuration:f}=function(e){let t={velocity:rm.velocity,stiffness:rm.stiffness,damping:rm.damping,mass:rm.mass,isResolvedFromDuration:!1,...e};if(!rv(e,rx)&&rv(e,ry))if(e.visualDuration){let n=2*Math.PI/(1.2*e.visualDuration),r=n*n,i=2*t4(.05,1,1-(e.bounce||0))*Math.sqrt(r);t={...t,mass:rm.mass,stiffness:r,damping:i}}else{let n=function({duration:e=rm.duration,bounce:t=rm.bounce,velocity:n=rm.velocity,mass:r=rm.mass}){let i,s;tx(e<=tg(rm.maxDuration),"Spring duration must be 10 seconds or less");let o=1-t;o=t4(rm.minDamping,rm.maxDamping,o),e=t4(rm.minDuration,rm.maxDuration,ty(e)),o<1?(i=t=>{let r=t*o,i=r*e;return .001-(r-n)/rg(t,o)*Math.exp(-i)},s=t=>{let r=t*o*e,s=Math.pow(o,2)*Math.pow(t,2)*e,a=Math.exp(-r),l=rg(Math.pow(t,2),o);return(r*n+n-s)*a*(-i(t)+.001>0?-1:1)/l}):(i=t=>-.001+Math.exp(-t*e)*((t-n)*e+1),s=t=>e*e*(n-t)*Math.exp(-t*e));let a=function(e,t,n){let r=n;for(let n=1;n<12;n++)r-=e(r)/t(r);return r}(i,s,5/e);if(e=tg(e),isNaN(a))return{stiffness:rm.stiffness,damping:rm.damping,duration:e};{let t=Math.pow(a,2)*r;return{stiffness:t,damping:2*o*Math.sqrt(r*t),duration:e}}}(e);(t={...t,...n,mass:rm.mass}).isResolvedFromDuration=!0}return t}({...r,velocity:-ty(r.velocity||0)}),m=p||0,g=d/(2*Math.sqrt(c*u)),y=a-o,x=ty(Math.sqrt(c/u)),v=5>Math.abs(y);if(i||(i=v?rm.restSpeed.granular:rm.restSpeed.default),s||(s=v?rm.restDelta.granular:rm.restDelta.default),g<1){let e=rg(x,g);n=t=>a-Math.exp(-g*x*t)*((m+g*x*y)/e*Math.sin(e*t)+y*Math.cos(e*t))}else if(1===g)n=e=>a-Math.exp(-x*e)*(y+(m+x*y)*e);else{let e=x*Math.sqrt(g*g-1);n=t=>{let n=Math.exp(-g*x*t),r=Math.min(e*t,300);return a-n*((m+g*x*y)*Math.sinh(r)+e*y*Math.cosh(r))/e}}let b={calculatedDuration:f&&h||null,next:e=>{let t=n(e);if(f)l.done=e>=h;else{let r=0;g<1&&(r=0===e?tg(m):rf(n,e,t));let o=Math.abs(a-t)<=s;l.done=Math.abs(r)<=i&&o}return l.value=l.done?a:t,l},toString:()=>{let e=Math.min(e5(b),2e4),t=tn(t=>b.next(e*t).value,e,30);return e+"ms "+t}};return b}function rw({keyframes:e,velocity:t=0,power:n=.8,timeConstant:r=325,bounceDamping:i=10,bounceStiffness:s=500,modifyTarget:o,min:a,max:l,restDelta:c=.5,restSpeed:d}){let u,h,p=e[0],f={done:!1,value:p},m=e=>void 0!==a&&e<a||void 0!==l&&e>l,g=e=>void 0===a?l:void 0===l||Math.abs(a-e)<Math.abs(l-e)?a:l,y=n*t,x=p+y,v=void 0===o?x:o(x);v!==x&&(y=v-p);let b=e=>-y*Math.exp(-e/r),w=e=>v+b(e),k=e=>{let t=b(e),n=w(e);f.done=Math.abs(t)<=c,f.value=f.done?v:n},j=e=>{m(f.value)&&(u=e,h=rb({keyframes:[f.value,g(f.value)],velocity:rf(w,e,f.value),damping:i,stiffness:s,restDelta:c,restSpeed:d}))};return j(0),{calculatedDuration:null,next:e=>{let t=!1;return(h||void 0!==u||(t=!0,k(e),j(e)),void 0!==u&&e>=u)?h.next(e-u):(t||k(e),f)}}}let rk=tU(.42,0,1,1),rj=tU(0,0,.58,1),rN=tU(.42,0,.58,1),rS=e=>Array.isArray(e)&&"number"!=typeof e[0],rC={linear:tx,easeIn:rk,easeInOut:rN,easeOut:rj,circIn:tQ,circInOut:t1,circOut:t0,backIn:tY,backInOut:tX,backOut:tG,anticipate:tZ},rM=e=>{if(e9(e)){tx(4===e.length,"Cubic bezier arrays must contain four numerical values.");let[t,n,r,i]=e;return tU(t,n,r,i)}return"string"==typeof e?(tx(void 0!==rC[e],`Invalid easing type '${e}'`),rC[e]):e};function rE({duration:e=300,keyframes:t,times:n,ease:r="easeInOut"}){var i;let s=rS(r)?r.map(rM):rM(r),o={done:!1,value:t[0]},a=function(e,t,{clamp:n=!0,ease:r,mixer:i}={}){let s=e.length;if(tx(s===t.length,"Both input and output ranges must be the same length"),1===s)return()=>t[0];if(2===s&&t[0]===t[1])return()=>t[1];let o=e[0]===e[1];e[0]>e[s-1]&&(e=[...e].reverse(),t=[...t].reverse());let a=function(e,t,n){let r=[],i=n||rp,s=e.length-1;for(let n=0;n<s;n++){let s=i(e[n],e[n+1]);t&&(s=ro(Array.isArray(t)?t[n]||tx:t,s)),r.push(s)}return r}(t,r,i),l=a.length,c=n=>{if(o&&n<e[0])return t[0];let r=0;if(l>1)for(;r<e.length-2&&!(n<e[r+1]);r++);let i=tt(e[r],e[r+1],n);return a[r](i)};return n?t=>c(t4(e[0],e[s-1],t)):c}((i=n&&n.length===t.length?n:function(e){let t=[0];return!function(e,t){let n=e[e.length-1];for(let r=1;r<=t;r++){let i=tt(0,t,r);e.push(n8(n,1,i))}}(t,e.length-1),t}(t),i.map(t=>t*e)),t,{ease:Array.isArray(s)?s:t.map(()=>s||rN).splice(0,t.length-1)});return{calculatedDuration:e,next:t=>(o.value=a(t),o.done=t>=e,o)}}let rT=e=>{let t=({timestamp:t})=>e(t);return{start:()=>tM.update(t,!0),stop:()=>tE(t),now:()=>tT.isProcessing?tT.timestamp:tO.now()}},rA={decay:rw,inertia:rw,tween:rE,keyframes:rE,spring:rb},rD=e=>e/100;class rO extends n6{constructor(e){super(e),this.holdTime=null,this.cancelTime=null,this.currentTime=0,this.playbackSpeed=1,this.pendingPlayState="running",this.startTime=null,this.state="idle",this.stop=()=>{if(this.resolver.cancel(),this.isStopped=!0,"idle"===this.state)return;this.teardown();let{onStop:e}=this.options;e&&e()};let{name:t,motionValue:n,element:r,keyframes:i}=this.options,s=(null==r?void 0:r.KeyframeResolver)||nH;this.resolver=new s(i,(e,t)=>this.onKeyframesResolved(e,t),t,n,r),this.resolver.scheduleResolve()}flatten(){super.flatten(),this._resolved&&Object.assign(this._resolved,this.initPlayback(this._resolved.keyframes))}initPlayback(e){let t,n,{type:r="keyframes",repeat:i=0,repeatDelay:s=0,repeatType:o,velocity:a=0}=this.options,l=e6(r)?r:rA[r]||rE;l!==rE&&"number"!=typeof e[0]&&(t=ro(rD,rp(e[0],e[1])),e=[0,100]);let c=l({...this.options,keyframes:e});"mirror"===o&&(n=l({...this.options,keyframes:[...e].reverse(),velocity:-a})),null===c.calculatedDuration&&(c.calculatedDuration=e5(c));let{calculatedDuration:d}=c,u=d+s;return{generator:c,mirroredGenerator:n,mapPercentToKeyframes:t,calculatedDuration:d,resolvedDuration:u,totalDuration:u*(i+1)-s}}onPostResolved(){let{autoplay:e=!0}=this.options;this.play(),"paused"!==this.pendingPlayState&&e?this.state=this.pendingPlayState:this.pause()}tick(e,t=!1){let{resolved:n}=this;if(!n){let{keyframes:e}=this.options;return{done:!0,value:e[e.length-1]}}let{finalKeyframe:r,generator:i,mirroredGenerator:s,mapPercentToKeyframes:o,keyframes:a,calculatedDuration:l,totalDuration:c,resolvedDuration:d}=n;if(null===this.startTime)return i.next(0);let{delay:u,repeat:h,repeatType:p,repeatDelay:f,onUpdate:m}=this.options;this.speed>0?this.startTime=Math.min(this.startTime,e):this.speed<0&&(this.startTime=Math.min(e-c/this.speed,this.startTime)),t?this.currentTime=e:null!==this.holdTime?this.currentTime=this.holdTime:this.currentTime=Math.round(e-this.startTime)*this.speed;let g=this.currentTime-u*(this.speed>=0?1:-1),y=this.speed>=0?g<0:g>c;this.currentTime=Math.max(g,0),"finished"===this.state&&null===this.holdTime&&(this.currentTime=c);let x=this.currentTime,v=i;if(h){let e=Math.min(this.currentTime,c)/d,t=Math.floor(e),n=e%1;!n&&e>=1&&(n=1),1===n&&t--,(t=Math.min(t,h+1))%2&&("reverse"===p?(n=1-n,f&&(n-=f/d)):"mirror"===p&&(v=s)),x=t4(0,1,n)*d}let b=y?{done:!1,value:a[0]}:v.next(x);o&&(b.value=o(b.value));let{done:w}=b;y||null===l||(w=this.speed>=0?this.currentTime>=c:this.currentTime<=0);let k=null===this.holdTime&&("finished"===this.state||"running"===this.state&&w);return k&&void 0!==r&&(b.value=n5(a,this.options,r)),m&&m(b.value),k&&this.finish(),b}get duration(){let{resolved:e}=this;return e?ty(e.calculatedDuration):0}get time(){return ty(this.currentTime)}set time(e){e=tg(e),this.currentTime=e,null!==this.holdTime||0===this.speed?this.holdTime=e:this.driver&&(this.startTime=this.driver.now()-e/this.speed)}get speed(){return this.playbackSpeed}set speed(e){let t=this.playbackSpeed!==e;this.playbackSpeed=e,t&&(this.time=ty(this.currentTime))}play(){if(this.resolver.isScheduled||this.resolver.resume(),!this._resolved){this.pendingPlayState="running";return}if(this.isStopped)return;let{driver:e=rT,onPlay:t,startTime:n}=this.options;this.driver||(this.driver=e(e=>this.tick(e))),t&&t();let r=this.driver.now();null!==this.holdTime?this.startTime=r-this.holdTime:this.startTime?"finished"===this.state&&(this.startTime=r):this.startTime=null!=n?n:this.calcStartTime(),"finished"===this.state&&this.updateFinishedPromise(),this.cancelTime=this.startTime,this.holdTime=null,this.state="running",this.driver.start()}pause(){var e;if(!this._resolved){this.pendingPlayState="paused";return}this.state="paused",this.holdTime=null!=(e=this.currentTime)?e:0}complete(){"running"!==this.state&&this.play(),this.pendingPlayState=this.state="finished",this.holdTime=null}finish(){this.teardown(),this.state="finished";let{onComplete:e}=this.options;e&&e()}cancel(){null!==this.cancelTime&&this.tick(this.cancelTime),this.teardown(),this.updateFinishedPromise()}teardown(){this.state="idle",this.stopDriver(),this.resolveFinishedPromise(),this.updateFinishedPromise(),this.startTime=this.cancelTime=null,this.resolver.cancel()}stopDriver(){this.driver&&(this.driver.stop(),this.driver=void 0)}sample(e){return this.startTime=0,this.tick(e,!0)}}let rR=new Set(["opacity","clipPath","filter","transform"]),rP=e0(()=>Object.hasOwnProperty.call(Element.prototype,"animate")),rI={anticipate:tZ,backInOut:tX,circInOut:t1};class rL extends n6{constructor(e){super(e);let{name:t,motionValue:n,element:r,keyframes:i}=this.options;this.resolver=new n2(i,(e,t)=>this.onKeyframesResolved(e,t),t,n,r),this.resolver.scheduleResolve()}initPlayback(e,t){var n;let{duration:r=300,times:i,ease:s,type:o,motionValue:a,name:l,startTime:c}=this.options;if(!a.owner||!a.owner.current)return!1;if("string"==typeof s&&te()&&s in rI&&(s=rI[s]),e6((n=this.options).type)||"spring"===n.type||!function e(t){return!!("function"==typeof t&&te()||!t||"string"==typeof t&&(t in ti||te())||e9(t)||Array.isArray(t)&&t.every(e))}(n.ease)){let{onComplete:t,onUpdate:n,motionValue:a,element:l,...c}=this.options,d=function(e,t){let n=new rO({...t,keyframes:e,repeat:0,delay:0,isGenerator:!0}),r={done:!1,value:e[0]},i=[],s=0;for(;!r.done&&s<2e4;)i.push((r=n.sample(s)).value),s+=10;return{times:void 0,keyframes:i,duration:s-10,ease:"linear"}}(e,c);1===(e=d.keyframes).length&&(e[1]=e[0]),r=d.duration,i=d.times,s=d.ease,o="keyframes"}let d=function(e,t,n,{delay:r=0,duration:i=300,repeat:s=0,repeatType:o="loop",ease:a="easeInOut",times:l}={}){let c={[t]:n};l&&(c.offset=l);let d=function e(t,n){if(t)return"function"==typeof t&&te()?tn(t,n):e9(t)?tr(t):Array.isArray(t)?t.map(t=>e(t,n)||ti.easeOut):ti[t]}(a,i);return Array.isArray(d)&&(c.easing=d),e.animate(c,{delay:r,duration:i,easing:Array.isArray(d)?"linear":d,fill:"both",iterations:s+1,direction:"reverse"===o?"alternate":"normal"})}(a.owner.current,l,e,{...this.options,duration:r,times:i,ease:s});return d.startTime=null!=c?c:this.calcStartTime(),this.pendingTimeline?(e8(d,this.pendingTimeline),this.pendingTimeline=void 0):d.onfinish=()=>{let{onComplete:n}=this.options;a.set(n5(e,this.options,t)),n&&n(),this.cancel(),this.resolveFinishedPromise()},{animation:d,duration:r,times:i,type:o,ease:s,keyframes:e}}get duration(){let{resolved:e}=this;if(!e)return 0;let{duration:t}=e;return ty(t)}get time(){let{resolved:e}=this;if(!e)return 0;let{animation:t}=e;return ty(t.currentTime||0)}set time(e){let{resolved:t}=this;if(!t)return;let{animation:n}=t;n.currentTime=tg(e)}get speed(){let{resolved:e}=this;if(!e)return 1;let{animation:t}=e;return t.playbackRate}set speed(e){let{resolved:t}=this;if(!t)return;let{animation:n}=t;n.playbackRate=e}get state(){let{resolved:e}=this;if(!e)return"idle";let{animation:t}=e;return t.playState}get startTime(){let{resolved:e}=this;if(!e)return null;let{animation:t}=e;return t.startTime}attachTimeline(e){if(this._resolved){let{resolved:t}=this;if(!t)return tx;let{animation:n}=t;e8(n,e)}else this.pendingTimeline=e;return tx}play(){if(this.isStopped)return;let{resolved:e}=this;if(!e)return;let{animation:t}=e;"finished"===t.playState&&this.updateFinishedPromise(),t.play()}pause(){let{resolved:e}=this;if(!e)return;let{animation:t}=e;t.pause()}stop(){if(this.resolver.cancel(),this.isStopped=!0,"idle"===this.state)return;this.resolveFinishedPromise(),this.updateFinishedPromise();let{resolved:e}=this;if(!e)return;let{animation:t,keyframes:n,duration:r,type:i,ease:s,times:o}=e;if("idle"===t.playState||"finished"===t.playState)return;if(this.time){let{motionValue:e,onUpdate:t,onComplete:a,element:l,...c}=this.options,d=new rO({...c,keyframes:n,duration:r,type:i,ease:s,times:o,isGenerator:!0}),u=tg(this.time);e.setWithVelocity(d.sample(u-10).value,d.sample(u).value,10)}let{onStop:a}=this.options;a&&a(),this.cancel()}complete(){let{resolved:e}=this;e&&e.animation.finish()}cancel(){let{resolved:e}=this;e&&e.animation.cancel()}static supports(e){let{motionValue:t,name:n,repeatDelay:r,repeatType:i,damping:s,type:o}=e;if(!t||!t.owner||!(t.owner.current instanceof HTMLElement))return!1;let{onUpdate:a,transformTemplate:l}=t.owner.getProps();return rP()&&n&&rR.has(n)&&!a&&!l&&!r&&"mirror"!==i&&0!==s&&"inertia"!==o}}let rz={type:"spring",stiffness:500,damping:25,restSpeed:10},rV=e=>({type:"spring",stiffness:550,damping:0===e?2*Math.sqrt(550):30,restSpeed:10}),r$={type:"keyframes",duration:.8},r_={type:"keyframes",ease:[.25,.1,.35,1],duration:.3},rF=(e,{keyframes:t})=>t.length>2?r$:tb.has(e)?e.startsWith("scale")?rV(t[1]):rz:r_,rB=(e,t,n,r={},i,s)=>o=>{let a=e3(r,e)||{},l=a.delay||r.delay||0,{elapsed:c=0}=r;c-=tg(l);let d={keyframes:Array.isArray(n)?n:[null,n],ease:"easeOut",velocity:t.getVelocity(),...a,delay:-c,onUpdate:e=>{t.set(e),a.onUpdate&&a.onUpdate(e)},onComplete:()=>{o(),a.onComplete&&a.onComplete()},name:e,motionValue:t,element:s?void 0:i};!function({when:e,delay:t,delayChildren:n,staggerChildren:r,staggerDirection:i,repeat:s,repeatType:o,repeatDelay:a,from:l,elapsed:c,...d}){return!!Object.keys(d).length}(a)&&(d={...d,...rF(e,d)}),d.duration&&(d.duration=tg(d.duration)),d.repeatDelay&&(d.repeatDelay=tg(d.repeatDelay)),void 0!==d.from&&(d.keyframes[0]=d.from);let u=!1;if(!1!==d.type&&(0!==d.duration||d.repeatDelay)||(d.duration=0,0===d.delay&&(u=!0)),(tq.current||tN.skipAnimations)&&(u=!0,d.duration=0,d.delay=0),u&&!s&&void 0!==t.get()){let e=n5(d.keyframes,a);if(void 0!==e)return tM.update(()=>{d.onUpdate(e),d.onComplete()}),new e4([])}return!s&&rL.supports(d)?new rL(d):new rO(d)};function rW(e,t,{delay:n=0,transitionOverride:r,type:i}={}){var s;let{transition:o=e.getDefaultTransition(),transitionEnd:a,...l}=t;r&&(o=r);let c=[],d=i&&e.animationState&&e.animationState.getState()[i];for(let t in l){let r=e.getValue(t,null!=(s=e.latestValues[t])?s:null),i=l[t];if(void 0===i||d&&function({protectedKeys:e,needsAnimating:t},n){let r=e.hasOwnProperty(n)&&!0!==t[n];return t[n]=!1,r}(d,t))continue;let a={delay:n,...e3(o||{},t)},u=!1;if(window.MotionHandoffAnimation){let n=e.props[tW];if(n){let e=window.MotionHandoffAnimation(n,t,tM);null!==e&&(a.startTime=e,u=!0)}}tF(e,t),r.start(rB(t,r,i,e.shouldReduceMotion&&tw.has(t)?{type:!1}:a,e,u));let h=r.animation;h&&c.push(h)}return a&&Promise.all(c).then(()=>{tM.update(()=>{a&&function(e,t){let{transitionEnd:n={},transition:r={},...i}=eX(e,t)||{};for(let t in i={...i,...n}){let n=tj(i[t]);e.hasValue(t)?e.getValue(t).set(n):e.addValue(t,t$(n))}}(e,a)})}),c}function rq(e,t,n={}){var r;let i=eX(e,t,"exit"===n.type?null==(r=e.presenceContext)?void 0:r.custom:void 0),{transition:s=e.getDefaultTransition()||{}}=i||{};n.transitionOverride&&(s=n.transitionOverride);let o=i?()=>Promise.all(rW(e,i,n)):()=>Promise.resolve(),a=e.variantChildren&&e.variantChildren.size?(r=0)=>{let{delayChildren:i=0,staggerChildren:o,staggerDirection:a}=s;return function(e,t,n=0,r=0,i=1,s){let o=[],a=(e.variantChildren.size-1)*r,l=1===i?(e=0)=>e*r:(e=0)=>a-e*r;return Array.from(e.variantChildren).sort(rH).forEach((e,r)=>{e.notify("AnimationStart",t),o.push(rq(e,t,{...s,delay:n+l(r)}).then(()=>e.notify("AnimationComplete",t)))}),Promise.all(o)}(e,t,i+r,o,a,n)}:()=>Promise.resolve(),{when:l}=s;if(!l)return Promise.all([o(),a(n.delay)]);{let[e,t]="beforeChildren"===l?[o,a]:[a,o];return e().then(()=>t())}}function rH(e,t){return e.sortNodePosition(t)}let rU=eQ.length,rK=[...eZ].reverse(),rJ=eZ.length;function rG(e=!1){return{isActive:e,protectedKeys:{},needsAnimating:{},prevResolvedValues:{}}}function rY(){return{animate:rG(!0),whileInView:rG(),whileHover:rG(),whileTap:rG(),whileDrag:rG(),whileFocus:rG(),exit:rG()}}class rX{constructor(e){this.isMounted=!1,this.node=e}update(){}}class rZ extends rX{constructor(e){super(e),e.animationState||(e.animationState=function(e){let t=t=>Promise.all(t.map(({animation:t,options:n})=>(function(e,t,n={}){let r;if(e.notify("AnimationStart",t),Array.isArray(t))r=Promise.all(t.map(t=>rq(e,t,n)));else if("string"==typeof t)r=rq(e,t,n);else{let i="function"==typeof t?eX(e,t,n.custom):t;r=Promise.all(rW(e,i,n))}return r.then(()=>{e.notify("AnimationComplete",t)})})(e,t,n))),n=rY(),r=!0,i=t=>(n,r)=>{var i;let s=eX(e,r,"exit"===t?null==(i=e.presenceContext)?void 0:i.custom:void 0);if(s){let{transition:e,transitionEnd:t,...r}=s;n={...n,...r,...t}}return n};function s(s){let{props:o}=e,a=function e(t){if(!t)return;if(!t.isControllingVariants){let n=t.parent&&e(t.parent)||{};return void 0!==t.props.initial&&(n.initial=t.props.initial),n}let n={};for(let e=0;e<rU;e++){let r=eQ[e],i=t.props[r];(eJ(i)||!1===i)&&(n[r]=i)}return n}(e.parent)||{},l=[],c=new Set,d={},u=1/0;for(let t=0;t<rJ;t++){var h,p;let f=rK[t],m=n[f],g=void 0!==o[f]?o[f]:a[f],y=eJ(g),x=f===s?m.isActive:null;!1===x&&(u=t);let v=g===a[f]&&g!==o[f]&&y;if(v&&r&&e.manuallyAnimateOnMount&&(v=!1),m.protectedKeys={...d},!m.isActive&&null===x||!g&&!m.prevProp||eH(g)||"boolean"==typeof g)continue;let b=(h=m.prevProp,"string"==typeof(p=g)?p!==h:!!Array.isArray(p)&&!eK(p,h)),w=b||f===s&&m.isActive&&!v&&y||t>u&&y,k=!1,j=Array.isArray(g)?g:[g],N=j.reduce(i(f),{});!1===x&&(N={});let{prevResolvedValues:S={}}=m,C={...S,...N},M=t=>{w=!0,c.has(t)&&(k=!0,c.delete(t)),m.needsAnimating[t]=!0;let n=e.getValue(t);n&&(n.liveStyle=!1)};for(let e in C){let t=N[e],n=S[e];if(d.hasOwnProperty(e))continue;let r=!1;(eU(t)&&eU(n)?eK(t,n):t===n)?void 0!==t&&c.has(e)?M(e):m.protectedKeys[e]=!0:null!=t?M(e):c.add(e)}m.prevProp=g,m.prevResolvedValues=N,m.isActive&&(d={...d,...N}),r&&e.blockInitialAnimation&&(w=!1);let E=!(v&&b)||k;w&&E&&l.push(...j.map(e=>({animation:e,options:{type:f}})))}if(c.size){let t={};c.forEach(n=>{let r=e.getBaseTarget(n),i=e.getValue(n);i&&(i.liveStyle=!0),t[n]=null!=r?r:null}),l.push({animation:t})}let f=!!l.length;return r&&(!1===o.initial||o.initial===o.animate)&&!e.manuallyAnimateOnMount&&(f=!1),r=!1,f?t(l):Promise.resolve()}return{animateChanges:s,setActive:function(t,r){var i;if(n[t].isActive===r)return Promise.resolve();null==(i=e.variantChildren)||i.forEach(e=>{var n;return null==(n=e.animationState)?void 0:n.setActive(t,r)}),n[t].isActive=r;let o=s(t);for(let e in n)n[e].protectedKeys={};return o},setAnimateFunction:function(n){t=n(e)},getState:()=>n,reset:()=>{n=rY(),r=!0}}}(e))}updateAnimationControlsSubscription(){let{animate:e}=this.node.getProps();eH(e)&&(this.unmountControls=e.subscribe(this.node))}mount(){this.updateAnimationControlsSubscription()}update(){let{animate:e}=this.node.getProps(),{animate:t}=this.node.prevProps||{};e!==t&&this.updateAnimationControlsSubscription()}unmount(){var e;this.node.animationState.reset(),null==(e=this.unmountControls)||e.call(this)}}let rQ=0;class r0 extends rX{constructor(){super(...arguments),this.id=rQ++}update(){if(!this.node.presenceContext)return;let{isPresent:e,onExitComplete:t}=this.node.presenceContext,{isPresent:n}=this.node.prevPresenceContext||{};if(!this.node.animationState||e===n)return;let r=this.node.animationState.setActive("exit",!e);t&&!e&&r.then(()=>t(this.id))}mount(){let{register:e}=this.node.presenceContext||{};e&&(this.unmount=e(this.id))}unmount(){}}function r1(e,t,n,r={passive:!0}){return e.addEventListener(t,n,r),()=>e.removeEventListener(t,n)}function r2(e){return{point:{x:e.pageX,y:e.pageY}}}let r4=e=>t=>tc(t)&&e(t,r2(t));function r3(e,t,n,r){return r1(e,t,r4(n),r)}let r5=(e,t)=>Math.abs(e-t);class r6{constructor(e,t,{transformPagePoint:n,contextWindow:r,dragSnapToOrigin:i=!1}={}){if(this.startEvent=null,this.lastMoveEvent=null,this.lastMoveEventInfo=null,this.handlers={},this.contextWindow=window,this.updatePoint=()=>{if(!(this.lastMoveEvent&&this.lastMoveEventInfo))return;let e=r7(this.lastMoveEventInfo,this.history),t=null!==this.startEvent,n=function(e,t){return Math.sqrt(r5(e.x,t.x)**2+r5(e.y,t.y)**2)}(e.offset,{x:0,y:0})>=3;if(!t&&!n)return;let{point:r}=e,{timestamp:i}=tT;this.history.push({...r,timestamp:i});let{onStart:s,onMove:o}=this.handlers;t||(s&&s(this.lastMoveEvent,e),this.startEvent=this.lastMoveEvent),o&&o(this.lastMoveEvent,e)},this.handlePointerMove=(e,t)=>{this.lastMoveEvent=e,this.lastMoveEventInfo=r8(t,this.transformPagePoint),tM.update(this.updatePoint,!0)},this.handlePointerUp=(e,t)=>{this.end();let{onEnd:n,onSessionEnd:r,resumeAnimation:i}=this.handlers;if(this.dragSnapToOrigin&&i&&i(),!(this.lastMoveEvent&&this.lastMoveEventInfo))return;let s=r7("pointercancel"===e.type?this.lastMoveEventInfo:r8(t,this.transformPagePoint),this.history);this.startEvent&&n&&n(e,s),r&&r(e,s)},!tc(e))return;this.dragSnapToOrigin=i,this.handlers=t,this.transformPagePoint=n,this.contextWindow=r||window;let s=r8(r2(e),this.transformPagePoint),{point:o}=s,{timestamp:a}=tT;this.history=[{...o,timestamp:a}];let{onSessionStart:l}=t;l&&l(e,r7(s,this.history)),this.removeListeners=ro(r3(this.contextWindow,"pointermove",this.handlePointerMove),r3(this.contextWindow,"pointerup",this.handlePointerUp),r3(this.contextWindow,"pointercancel",this.handlePointerUp))}updateHandlers(e){this.handlers=e}end(){this.removeListeners&&this.removeListeners(),tE(this.updatePoint)}}function r8(e,t){return t?{point:t(e.point)}:e}function r9(e,t){return{x:e.x-t.x,y:e.y-t.y}}function r7({point:e},t){return{point:e,delta:r9(e,ie(t)),offset:r9(e,t[0]),velocity:function(e,t){if(e.length<2)return{x:0,y:0};let n=e.length-1,r=null,i=ie(e);for(;n>=0&&(r=e[n],!(i.timestamp-r.timestamp>tg(.1)));)n--;if(!r)return{x:0,y:0};let s=ty(i.timestamp-r.timestamp);if(0===s)return{x:0,y:0};let o={x:(i.x-r.x)/s,y:(i.y-r.y)/s};return o.x===1/0&&(o.x=0),o.y===1/0&&(o.y=0),o}(t,.1)}}function ie(e){return e[e.length-1]}function it(e){return e&&"object"==typeof e&&Object.prototype.hasOwnProperty.call(e,"current")}function ir(e){return e.max-e.min}function ii(e,t,n,r=.5){e.origin=r,e.originPoint=n8(t.min,t.max,e.origin),e.scale=ir(n)/ir(t),e.translate=n8(n.min,n.max,e.origin)-e.originPoint,(e.scale>=.9999&&e.scale<=1.0001||isNaN(e.scale))&&(e.scale=1),(e.translate>=-.01&&e.translate<=.01||isNaN(e.translate))&&(e.translate=0)}function is(e,t,n,r){ii(e.x,t.x,n.x,r?r.originX:void 0),ii(e.y,t.y,n.y,r?r.originY:void 0)}function io(e,t,n){e.min=n.min+t.min,e.max=e.min+ir(t)}function ia(e,t,n){e.min=t.min-n.min,e.max=e.min+ir(t)}function il(e,t,n){ia(e.x,t.x,n.x),ia(e.y,t.y,n.y)}function ic(e,t,n){return{min:void 0!==t?e.min+t:void 0,max:void 0!==n?e.max+n-(e.max-e.min):void 0}}function id(e,t){let n=t.min-e.min,r=t.max-e.max;return t.max-t.min<e.max-e.min&&([n,r]=[r,n]),{min:n,max:r}}function iu(e,t,n){return{min:ih(e,t),max:ih(e,n)}}function ih(e,t){return"number"==typeof e?e:e[t]||0}let ip=()=>({translate:0,scale:1,origin:0,originPoint:0}),im=()=>({x:ip(),y:ip()}),ig=()=>({min:0,max:0}),iy=()=>({x:ig(),y:ig()});function ix(e){return[e("x"),e("y")]}function iv({top:e,left:t,right:n,bottom:r}){return{x:{min:t,max:n},y:{min:e,max:r}}}function ib(e){return void 0===e||1===e}function iw({scale:e,scaleX:t,scaleY:n}){return!ib(e)||!ib(t)||!ib(n)}function ik(e){return iw(e)||ij(e)||e.z||e.rotate||e.rotateX||e.rotateY||e.skewX||e.skewY}function ij(e){var t,n;return(t=e.x)&&"0%"!==t||(n=e.y)&&"0%"!==n}function iN(e,t,n,r,i){return void 0!==i&&(e=r+i*(e-r)),r+n*(e-r)+t}function iS(e,t=0,n=1,r,i){e.min=iN(e.min,t,n,r,i),e.max=iN(e.max,t,n,r,i)}function iC(e,{x:t,y:n}){iS(e.x,t.translate,t.scale,t.originPoint),iS(e.y,n.translate,n.scale,n.originPoint)}function iM(e,t){e.min=e.min+t,e.max=e.max+t}function iE(e,t,n,r,i=.5){let s=n8(e.min,e.max,i);iS(e,t,n,s,r)}function iT(e,t){iE(e.x,t.x,t.scaleX,t.scale,t.originX),iE(e.y,t.y,t.scaleY,t.scale,t.originY)}function iA(e,t){return iv(function(e,t){if(!t)return e;let n=t({x:e.left,y:e.top}),r=t({x:e.right,y:e.bottom});return{top:n.y,left:n.x,bottom:r.y,right:r.x}}(e.getBoundingClientRect(),t))}let iD=({current:e})=>e?e.ownerDocument.defaultView:null,iO=new WeakMap;class iR{constructor(e){this.openDragLock=null,this.isDragging=!1,this.currentDirection=null,this.originPoint={x:0,y:0},this.constraints=!1,this.hasMutatedConstraints=!1,this.elastic=iy(),this.visualElement=e}start(e,{snapToCursor:t=!1}={}){let{presenceContext:n}=this.visualElement;if(n&&!1===n.isPresent)return;let{dragSnapToOrigin:r}=this.getProps();this.panSession=new r6(e,{onSessionStart:e=>{let{dragSnapToOrigin:n}=this.getProps();n?this.pauseAnimation():this.stopAnimation(),t&&this.snapToCursor(r2(e).point)},onStart:(e,t)=>{let{drag:n,dragPropagation:r,onDragStart:i}=this.getProps();if(n&&!r&&(this.openDragLock&&this.openDragLock(),this.openDragLock=function(e){if("x"===e||"y"===e)if(ts[e])return null;else return ts[e]=!0,()=>{ts[e]=!1};return ts.x||ts.y?null:(ts.x=ts.y=!0,()=>{ts.x=ts.y=!1})}(n),!this.openDragLock))return;this.isDragging=!0,this.currentDirection=null,this.resolveConstraints(),this.visualElement.projection&&(this.visualElement.projection.isAnimationBlocked=!0,this.visualElement.projection.target=void 0),ix(e=>{let t=this.getAxisMotionValue(e).get()||0;if(nl.test(t)){let{projection:n}=this.visualElement;if(n&&n.layout){let r=n.layout.layoutBox[e];r&&(t=ir(r)*(parseFloat(t)/100))}}this.originPoint[e]=t}),i&&tM.postRender(()=>i(e,t)),tF(this.visualElement,"transform");let{animationState:s}=this.visualElement;s&&s.setActive("whileDrag",!0)},onMove:(e,t)=>{let{dragPropagation:n,dragDirectionLock:r,onDirectionLock:i,onDrag:s}=this.getProps();if(!n&&!this.openDragLock)return;let{offset:o}=t;if(r&&null===this.currentDirection){this.currentDirection=function(e,t=10){let n=null;return Math.abs(e.y)>t?n="y":Math.abs(e.x)>t&&(n="x"),n}(o),null!==this.currentDirection&&i&&i(this.currentDirection);return}this.updateAxis("x",t.point,o),this.updateAxis("y",t.point,o),this.visualElement.render(),s&&s(e,t)},onSessionEnd:(e,t)=>this.stop(e,t),resumeAnimation:()=>ix(e=>{var t;return"paused"===this.getAnimationState(e)&&(null==(t=this.getAxisMotionValue(e).animation)?void 0:t.play())})},{transformPagePoint:this.visualElement.getTransformPagePoint(),dragSnapToOrigin:r,contextWindow:iD(this.visualElement)})}stop(e,t){let n=this.isDragging;if(this.cancel(),!n)return;let{velocity:r}=t;this.startAnimation(r);let{onDragEnd:i}=this.getProps();i&&tM.postRender(()=>i(e,t))}cancel(){this.isDragging=!1;let{projection:e,animationState:t}=this.visualElement;e&&(e.isAnimationBlocked=!1),this.panSession&&this.panSession.end(),this.panSession=void 0;let{dragPropagation:n}=this.getProps();!n&&this.openDragLock&&(this.openDragLock(),this.openDragLock=null),t&&t.setActive("whileDrag",!1)}updateAxis(e,t,n){let{drag:r}=this.getProps();if(!n||!iP(e,r,this.currentDirection))return;let i=this.getAxisMotionValue(e),s=this.originPoint[e]+n[e];this.constraints&&this.constraints[e]&&(s=function(e,{min:t,max:n},r){return void 0!==t&&e<t?e=r?n8(t,e,r.min):Math.max(e,t):void 0!==n&&e>n&&(e=r?n8(n,e,r.max):Math.min(e,n)),e}(s,this.constraints[e],this.elastic[e])),i.set(s)}resolveConstraints(){var e;let{dragConstraints:t,dragElastic:n}=this.getProps(),r=this.visualElement.projection&&!this.visualElement.projection.layout?this.visualElement.projection.measure(!1):null==(e=this.visualElement.projection)?void 0:e.layout,i=this.constraints;t&&it(t)?this.constraints||(this.constraints=this.resolveRefConstraints()):t&&r?this.constraints=function(e,{top:t,left:n,bottom:r,right:i}){return{x:ic(e.x,n,i),y:ic(e.y,t,r)}}(r.layoutBox,t):this.constraints=!1,this.elastic=function(e=.35){return!1===e?e=0:!0===e&&(e=.35),{x:iu(e,"left","right"),y:iu(e,"top","bottom")}}(n),i!==this.constraints&&r&&this.constraints&&!this.hasMutatedConstraints&&ix(e=>{!1!==this.constraints&&this.getAxisMotionValue(e)&&(this.constraints[e]=function(e,t){let n={};return void 0!==t.min&&(n.min=t.min-e.min),void 0!==t.max&&(n.max=t.max-e.min),n}(r.layoutBox[e],this.constraints[e]))})}resolveRefConstraints(){var e;let{dragConstraints:t,onMeasureDragConstraints:n}=this.getProps();if(!t||!it(t))return!1;let r=t.current;tx(null!==r,"If `dragConstraints` is set as a React ref, that ref must be passed to another component's `ref` prop.");let{projection:i}=this.visualElement;if(!i||!i.layout)return!1;let s=function(e,t,n){let r=iA(e,n),{scroll:i}=t;return i&&(iM(r.x,i.offset.x),iM(r.y,i.offset.y)),r}(r,i.root,this.visualElement.getTransformPagePoint()),o=(e=i.layout.layoutBox,{x:id(e.x,s.x),y:id(e.y,s.y)});if(n){let e=n(function({x:e,y:t}){return{top:t.min,right:e.max,bottom:t.max,left:e.min}}(o));this.hasMutatedConstraints=!!e,e&&(o=iv(e))}return o}startAnimation(e){let{drag:t,dragMomentum:n,dragElastic:r,dragTransition:i,dragSnapToOrigin:s,onDragTransitionEnd:o}=this.getProps(),a=this.constraints||{};return Promise.all(ix(o=>{if(!iP(o,t,this.currentDirection))return;let l=a&&a[o]||{};s&&(l={min:0,max:0});let c={type:"inertia",velocity:n?e[o]:0,bounceStiffness:r?200:1e6,bounceDamping:r?40:1e7,timeConstant:750,restDelta:1,restSpeed:10,...i,...l};return this.startAxisValueAnimation(o,c)})).then(o)}startAxisValueAnimation(e,t){let n=this.getAxisMotionValue(e);return tF(this.visualElement,e),n.start(rB(e,n,0,t,this.visualElement,!1))}stopAnimation(){ix(e=>this.getAxisMotionValue(e).stop())}pauseAnimation(){ix(e=>{var t;return null==(t=this.getAxisMotionValue(e).animation)?void 0:t.pause()})}getAnimationState(e){var t;return null==(t=this.getAxisMotionValue(e).animation)?void 0:t.state}getAxisMotionValue(e){let t=`_drag${e.toUpperCase()}`,n=this.visualElement.getProps();return n[t]||this.visualElement.getValue(e,(n.initial?n.initial[e]:void 0)||0)}snapToCursor(e){ix(t=>{let{drag:n}=this.getProps();if(!iP(t,n,this.currentDirection))return;let{projection:r}=this.visualElement,i=this.getAxisMotionValue(t);if(r&&r.layout){let{min:n,max:s}=r.layout.layoutBox[t];i.set(e[t]-n8(n,s,.5))}})}scalePositionWithinConstraints(){if(!this.visualElement.current)return;let{drag:e,dragConstraints:t}=this.getProps(),{projection:n}=this.visualElement;if(!it(t)||!n||!this.constraints)return;this.stopAnimation();let r={x:0,y:0};ix(e=>{let t=this.getAxisMotionValue(e);if(t&&!1!==this.constraints){let n=t.get();r[e]=function(e,t){let n=.5,r=ir(e),i=ir(t);return i>r?n=tt(t.min,t.max-r,e.min):r>i&&(n=tt(e.min,e.max-i,t.min)),t4(0,1,n)}({min:n,max:n},this.constraints[e])}});let{transformTemplate:i}=this.visualElement.getProps();this.visualElement.current.style.transform=i?i({},""):"none",n.root&&n.root.updateScroll(),n.updateLayout(),this.resolveConstraints(),ix(t=>{if(!iP(t,e,null))return;let n=this.getAxisMotionValue(t),{min:i,max:s}=this.constraints[t];n.set(n8(i,s,r[t]))})}addListeners(){if(!this.visualElement.current)return;iO.set(this.visualElement,this);let e=r3(this.visualElement.current,"pointerdown",e=>{let{drag:t,dragListener:n=!0}=this.getProps();t&&n&&this.start(e)}),t=()=>{let{dragConstraints:e}=this.getProps();it(e)&&e.current&&(this.constraints=this.resolveRefConstraints())},{projection:n}=this.visualElement,r=n.addEventListener("measure",t);n&&!n.layout&&(n.root&&n.root.updateScroll(),n.updateLayout()),tM.read(t);let i=r1(window,"resize",()=>this.scalePositionWithinConstraints()),s=n.addEventListener("didUpdate",({delta:e,hasLayoutChanged:t})=>{this.isDragging&&t&&(ix(t=>{let n=this.getAxisMotionValue(t);n&&(this.originPoint[t]+=e[t].translate,n.set(n.get()+e[t].translate))}),this.visualElement.render())});return()=>{i(),e(),r(),s&&s()}}getProps(){let e=this.visualElement.getProps(),{drag:t=!1,dragDirectionLock:n=!1,dragPropagation:r=!1,dragConstraints:i=!1,dragElastic:s=.35,dragMomentum:o=!0}=e;return{...e,drag:t,dragDirectionLock:n,dragPropagation:r,dragConstraints:i,dragElastic:s,dragMomentum:o}}}function iP(e,t,n){return(!0===t||t===e)&&(null===n||n===e)}class iI extends rX{constructor(e){super(e),this.removeGroupControls=tx,this.removeListeners=tx,this.controls=new iR(e)}mount(){let{dragControls:e}=this.node.getProps();e&&(this.removeGroupControls=e.subscribe(this.controls)),this.removeListeners=this.controls.addListeners()||tx}unmount(){this.removeGroupControls(),this.removeListeners()}}let iL=e=>(t,n)=>{e&&tM.postRender(()=>e(t,n))};class iz extends rX{constructor(){super(...arguments),this.removePointerDownListener=tx}onPointerDown(e){this.session=new r6(e,this.createPanHandlers(),{transformPagePoint:this.node.getTransformPagePoint(),contextWindow:iD(this.node)})}createPanHandlers(){let{onPanSessionStart:e,onPanStart:t,onPan:n,onPanEnd:r}=this.node.getProps();return{onSessionStart:iL(e),onStart:iL(t),onMove:n,onEnd:(e,t)=>{delete this.session,r&&tM.postRender(()=>r(e,t))}}}mount(){this.removePointerDownListener=r3(this.node.current,"pointerdown",e=>this.onPointerDown(e))}update(){this.session&&this.session.updateHandlers(this.createPanHandlers())}unmount(){this.removePointerDownListener(),this.session&&this.session.end()}}let iV=(0,h.createContext)({}),i$={hasAnimatedSinceResize:!0,hasEverUpdated:!1};function i_(e,t){return t.max===t.min?0:e/(t.max-t.min)*100}let iF={correct:(e,t)=>{if(!t.target)return e;if("string"==typeof e)if(!nc.test(e))return e;else e=parseFloat(e);let n=i_(e,t.target.x),r=i_(e,t.target.y);return`${n}% ${r}%`}},iB={},{schedule:iW,cancel:iq}=tC(queueMicrotask,!1);class iH extends h.Component{componentDidMount(){let{visualElement:e,layoutGroup:t,switchLayoutGroup:n,layoutId:r}=this.props,{projection:i}=e;Object.assign(iB,iK),i&&(t.group&&t.group.add(i),n&&n.register&&r&&n.register(i),i.root.didUpdate(),i.addEventListener("animationComplete",()=>{this.safeToRemove()}),i.setOptions({...i.options,onExitComplete:()=>this.safeToRemove()})),i$.hasEverUpdated=!0}getSnapshotBeforeUpdate(e){let{layoutDependency:t,visualElement:n,drag:r,isPresent:i}=this.props,s=n.projection;return s&&(s.isPresent=i,r||e.layoutDependency!==t||void 0===t?s.willUpdate():this.safeToRemove(),e.isPresent!==i&&(i?s.promote():s.relegate()||tM.postRender(()=>{let e=s.getStack();e&&e.members.length||this.safeToRemove()}))),null}componentDidUpdate(){let{projection:e}=this.props.visualElement;e&&(e.root.didUpdate(),iW.postRender(()=>{!e.currentAnimation&&e.isLead()&&this.safeToRemove()}))}componentWillUnmount(){let{visualElement:e,layoutGroup:t,switchLayoutGroup:n}=this.props,{projection:r}=e;r&&(r.scheduleCheckAfterUnmount(),t&&t.group&&t.group.remove(r),n&&n.deregister&&n.deregister(r))}safeToRemove(){let{safeToRemove:e}=this.props;e&&e()}render(){return null}}function iU(e){let[t,n]=e$(),r=(0,h.useContext)(eD);return(0,u.jsx)(iH,{...e,layoutGroup:r,switchLayoutGroup:(0,h.useContext)(iV),isPresent:t,safeToRemove:n})}let iK={borderRadius:{...iF,applyTo:["borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius"]},borderTopLeftRadius:iF,borderTopRightRadius:iF,borderBottomLeftRadius:iF,borderBottomRightRadius:iF,boxShadow:{correct:(e,{treeScale:t,projectionDelta:n})=>{let r=nj.parse(e);if(r.length>5)return e;let i=nj.createTransformer(e),s=+("number"!=typeof r[0]),o=n.x.scale*t.x,a=n.y.scale*t.y;r[0+s]/=o,r[1+s]/=a;let l=n8(o,a,.5);return"number"==typeof r[2+s]&&(r[2+s]/=l),"number"==typeof r[3+s]&&(r[3+s]/=l),i(r)}}},iJ=(e,t)=>e.depth-t.depth;class iG{constructor(){this.children=[],this.isDirty=!1}add(e){tR(this.children,e),this.isDirty=!0}remove(e){tP(this.children,e),this.isDirty=!0}forEach(e){this.isDirty&&this.children.sort(iJ),this.isDirty=!1,this.children.forEach(e)}}function iY(e){let t=t_(e)?e.get():e;return tk(t)?t.toValue():t}let iX=["TopLeft","TopRight","BottomLeft","BottomRight"],iZ=iX.length,iQ=e=>"string"==typeof e?parseFloat(e):e,i0=e=>"number"==typeof e||nc.test(e);function i1(e,t){return void 0!==e[t]?e[t]:e.borderRadius}let i2=i3(0,.5,t0),i4=i3(.5,.95,tx);function i3(e,t,n){return r=>r<e?0:r>t?1:n(tt(e,t,r))}function i5(e,t){e.min=t.min,e.max=t.max}function i6(e,t){i5(e.x,t.x),i5(e.y,t.y)}function i8(e,t){e.translate=t.translate,e.scale=t.scale,e.originPoint=t.originPoint,e.origin=t.origin}function i9(e,t,n,r,i){return e-=t,e=r+1/n*(e-r),void 0!==i&&(e=r+1/i*(e-r)),e}function i7(e,t,[n,r,i],s,o){!function(e,t=0,n=1,r=.5,i,s=e,o=e){if(nl.test(t)&&(t=parseFloat(t),t=n8(o.min,o.max,t/100)-o.min),"number"!=typeof t)return;let a=n8(s.min,s.max,r);e===s&&(a-=t),e.min=i9(e.min,t,n,a,i),e.max=i9(e.max,t,n,a,i)}(e,t[n],t[r],t[i],t.scale,s,o)}let se=["x","scaleX","originX"],st=["y","scaleY","originY"];function sn(e,t,n,r){i7(e.x,t,se,n?n.x:void 0,r?r.x:void 0),i7(e.y,t,st,n?n.y:void 0,r?r.y:void 0)}function sr(e){return 0===e.translate&&1===e.scale}function si(e){return sr(e.x)&&sr(e.y)}function ss(e,t){return e.min===t.min&&e.max===t.max}function so(e,t){return Math.round(e.min)===Math.round(t.min)&&Math.round(e.max)===Math.round(t.max)}function sa(e,t){return so(e.x,t.x)&&so(e.y,t.y)}function sl(e){return ir(e.x)/ir(e.y)}function sc(e,t){return e.translate===t.translate&&e.scale===t.scale&&e.originPoint===t.originPoint}class sd{constructor(){this.members=[]}add(e){tR(this.members,e),e.scheduleRender()}remove(e){if(tP(this.members,e),e===this.prevLead&&(this.prevLead=void 0),e===this.lead){let e=this.members[this.members.length-1];e&&this.promote(e)}}relegate(e){let t,n=this.members.findIndex(t=>e===t);if(0===n)return!1;for(let e=n;e>=0;e--){let n=this.members[e];if(!1!==n.isPresent){t=n;break}}return!!t&&(this.promote(t),!0)}promote(e,t){let n=this.lead;if(e!==n&&(this.prevLead=n,this.lead=e,e.show(),n)){n.instance&&n.scheduleRender(),e.scheduleRender(),e.resumeFrom=n,t&&(e.resumeFrom.preserveOpacity=!0),n.snapshot&&(e.snapshot=n.snapshot,e.snapshot.latestValues=n.animationValues||n.latestValues),e.root&&e.root.isUpdating&&(e.isLayoutDirty=!0);let{crossfade:r}=e.options;!1===r&&n.hide()}}exitAnimationComplete(){this.members.forEach(e=>{let{options:t,resumingFrom:n}=e;t.onExitComplete&&t.onExitComplete(),n&&n.options.onExitComplete&&n.options.onExitComplete()})}scheduleRender(){this.members.forEach(e=>{e.instance&&e.scheduleRender(!1)})}removeLeadSnapshot(){this.lead&&this.lead.snapshot&&(this.lead.snapshot=void 0)}}let su={type:"projectionFrame",totalNodes:0,resolvedTargetDeltas:0,recalculatedProjection:0},sh="undefined"!=typeof window&&void 0!==window.MotionDebug,sp=["","X","Y","Z"],sf={visibility:"hidden"},sm=0;function sg(e,t,n,r){let{latestValues:i}=t;i[e]&&(n[e]=i[e],t.setStaticValue(e,0),r&&(r[e]=0))}function sy({attachResizeListener:e,defaultParent:t,measureScroll:n,checkIsScrollRoot:r,resetTransform:i}){return class{constructor(e={},n=null==t?void 0:t()){this.id=sm++,this.animationId=0,this.children=new Set,this.options={},this.isTreeAnimating=!1,this.isAnimationBlocked=!1,this.isLayoutDirty=!1,this.isProjectionDirty=!1,this.isSharedProjectionDirty=!1,this.isTransformDirty=!1,this.updateManuallyBlocked=!1,this.updateBlockedByResize=!1,this.isUpdating=!1,this.isSVG=!1,this.needsReset=!1,this.shouldResetTransform=!1,this.hasCheckedOptimisedAppear=!1,this.treeScale={x:1,y:1},this.eventHandlers=new Map,this.hasTreeAnimated=!1,this.updateScheduled=!1,this.scheduleUpdate=()=>this.update(),this.projectionUpdateScheduled=!1,this.checkUpdateFailed=()=>{this.isUpdating&&(this.isUpdating=!1,this.clearAllSnapshots())},this.updateProjection=()=>{this.projectionUpdateScheduled=!1,sh&&(su.totalNodes=su.resolvedTargetDeltas=su.recalculatedProjection=0),this.nodes.forEach(sb),this.nodes.forEach(sM),this.nodes.forEach(sE),this.nodes.forEach(sw),sh&&window.MotionDebug.record(su)},this.resolvedRelativeTargetAt=0,this.hasProjected=!1,this.isVisible=!0,this.animationProgress=0,this.sharedNodes=new Map,this.latestValues=e,this.root=n?n.root||n:this,this.path=n?[...n.path,n]:[],this.parent=n,this.depth=n?n.depth+1:0;for(let e=0;e<this.path.length;e++)this.path[e].shouldResetTransform=!0;this.root===this&&(this.nodes=new iG)}addEventListener(e,t){return this.eventHandlers.has(e)||this.eventHandlers.set(e,new tI),this.eventHandlers.get(e).add(t)}notifyListeners(e,...t){let n=this.eventHandlers.get(e);n&&n.notify(...t)}hasListeners(e){return this.eventHandlers.has(e)}mount(t,n=this.root.hasTreeAnimated){if(this.instance)return;this.isSVG=t instanceof SVGElement&&"svg"!==t.tagName,this.instance=t;let{layoutId:r,layout:i,visualElement:s}=this.options;if(s&&!s.current&&s.mount(t),this.root.nodes.add(this),this.parent&&this.parent.children.add(this),n&&(i||r)&&(this.isLayoutDirty=!0),e){let n,r=()=>this.root.updateBlockedByResize=!1;e(t,()=>{this.root.updateBlockedByResize=!0,n&&n(),n=function(e,t){let n=tO.now(),r=({timestamp:i})=>{let s=i-n;s>=250&&(tE(r),e(s-t))};return tM.read(r,!0),()=>tE(r)}(r,250),i$.hasAnimatedSinceResize&&(i$.hasAnimatedSinceResize=!1,this.nodes.forEach(sC))})}r&&this.root.registerSharedNode(r,this),!1!==this.options.animate&&s&&(r||i)&&this.addEventListener("didUpdate",({delta:e,hasLayoutChanged:t,hasRelativeTargetChanged:n,layout:r})=>{if(this.isTreeAnimationBlocked()){this.target=void 0,this.relativeTarget=void 0;return}let i=this.options.transition||s.getDefaultTransition()||sP,{onLayoutAnimationStart:o,onLayoutAnimationComplete:a}=s.getProps(),l=!this.targetLayout||!sa(this.targetLayout,r)||n,c=!t&&n;if(this.options.layoutRoot||this.resumeFrom&&this.resumeFrom.instance||c||t&&(l||!this.currentAnimation)){this.resumeFrom&&(this.resumingFrom=this.resumeFrom,this.resumingFrom.resumingFrom=void 0),this.setAnimationOrigin(e,c);let t={...e3(i,"layout"),onPlay:o,onComplete:a};(s.shouldReduceMotion||this.options.layoutRoot)&&(t.delay=0,t.type=!1),this.startAnimation(t)}else t||sC(this),this.isLead()&&this.options.onExitComplete&&this.options.onExitComplete();this.targetLayout=r})}unmount(){this.options.layoutId&&this.willUpdate(),this.root.nodes.remove(this);let e=this.getStack();e&&e.remove(this),this.parent&&this.parent.children.delete(this),this.instance=void 0,tE(this.updateProjection)}blockUpdate(){this.updateManuallyBlocked=!0}unblockUpdate(){this.updateManuallyBlocked=!1}isUpdateBlocked(){return this.updateManuallyBlocked||this.updateBlockedByResize}isTreeAnimationBlocked(){return this.isAnimationBlocked||this.parent&&this.parent.isTreeAnimationBlocked()||!1}startUpdate(){!this.isUpdateBlocked()&&(this.isUpdating=!0,this.nodes&&this.nodes.forEach(sT),this.animationId++)}getTransformTemplate(){let{visualElement:e}=this.options;return e&&e.getProps().transformTemplate}willUpdate(e=!0){if(this.root.hasTreeAnimated=!0,this.root.isUpdateBlocked()){this.options.onExitComplete&&this.options.onExitComplete();return}if(window.MotionCancelOptimisedAnimation&&!this.hasCheckedOptimisedAppear&&function e(t){if(t.hasCheckedOptimisedAppear=!0,t.root===t)return;let{visualElement:n}=t.options;if(!n)return;let r=n.props[tW];if(window.MotionHasOptimisedAnimation(r,"transform")){let{layout:e,layoutId:n}=t.options;window.MotionCancelOptimisedAnimation(r,"transform",tM,!(e||n))}let{parent:i}=t;i&&!i.hasCheckedOptimisedAppear&&e(i)}(this),this.root.isUpdating||this.root.startUpdate(),this.isLayoutDirty)return;this.isLayoutDirty=!0;for(let e=0;e<this.path.length;e++){let t=this.path[e];t.shouldResetTransform=!0,t.updateScroll("snapshot"),t.options.layoutRoot&&t.willUpdate(!1)}let{layoutId:t,layout:n}=this.options;if(void 0===t&&!n)return;let r=this.getTransformTemplate();this.prevTransformTemplateValue=r?r(this.latestValues,""):void 0,this.updateSnapshot(),e&&this.notifyListeners("willUpdate")}update(){if(this.updateScheduled=!1,this.isUpdateBlocked()){this.unblockUpdate(),this.clearAllSnapshots(),this.nodes.forEach(sj);return}this.isUpdating||this.nodes.forEach(sN),this.isUpdating=!1,this.nodes.forEach(sS),this.nodes.forEach(sx),this.nodes.forEach(sv),this.clearAllSnapshots();let e=tO.now();tT.delta=t4(0,1e3/60,e-tT.timestamp),tT.timestamp=e,tT.isProcessing=!0,tA.update.process(tT),tA.preRender.process(tT),tA.render.process(tT),tT.isProcessing=!1}didUpdate(){this.updateScheduled||(this.updateScheduled=!0,iW.read(this.scheduleUpdate))}clearAllSnapshots(){this.nodes.forEach(sk),this.sharedNodes.forEach(sA)}scheduleUpdateProjection(){this.projectionUpdateScheduled||(this.projectionUpdateScheduled=!0,tM.preRender(this.updateProjection,!1,!0))}scheduleCheckAfterUnmount(){tM.postRender(()=>{this.isLayoutDirty?this.root.didUpdate():this.root.checkUpdateFailed()})}updateSnapshot(){!this.snapshot&&this.instance&&(this.snapshot=this.measure())}updateLayout(){if(!this.instance||(this.updateScroll(),!(this.options.alwaysMeasureLayout&&this.isLead())&&!this.isLayoutDirty))return;if(this.resumeFrom&&!this.resumeFrom.instance)for(let e=0;e<this.path.length;e++)this.path[e].updateScroll();let e=this.layout;this.layout=this.measure(!1),this.layoutCorrected=iy(),this.isLayoutDirty=!1,this.projectionDelta=void 0,this.notifyListeners("measure",this.layout.layoutBox);let{visualElement:t}=this.options;t&&t.notify("LayoutMeasure",this.layout.layoutBox,e?e.layoutBox:void 0)}updateScroll(e="measure"){let t=!!(this.options.layoutScroll&&this.instance);if(this.scroll&&this.scroll.animationId===this.root.animationId&&this.scroll.phase===e&&(t=!1),t){let t=r(this.instance);this.scroll={animationId:this.root.animationId,phase:e,isRoot:t,offset:n(this.instance),wasRoot:this.scroll?this.scroll.isRoot:t}}}resetTransform(){if(!i)return;let e=this.isLayoutDirty||this.shouldResetTransform||this.options.alwaysMeasureLayout,t=this.projectionDelta&&!si(this.projectionDelta),n=this.getTransformTemplate(),r=n?n(this.latestValues,""):void 0,s=r!==this.prevTransformTemplateValue;e&&(t||ik(this.latestValues)||s)&&(i(this.instance,r),this.shouldResetTransform=!1,this.scheduleRender())}measure(e=!0){var t;let n=this.measurePageBox(),r=this.removeElementScroll(n);return e&&(r=this.removeTransform(r)),sz((t=r).x),sz(t.y),{animationId:this.root.animationId,measuredBox:n,layoutBox:r,latestValues:{},source:this.id}}measurePageBox(){var e;let{visualElement:t}=this.options;if(!t)return iy();let n=t.measureViewportBox();if(!((null==(e=this.scroll)?void 0:e.wasRoot)||this.path.some(s$))){let{scroll:e}=this.root;e&&(iM(n.x,e.offset.x),iM(n.y,e.offset.y))}return n}removeElementScroll(e){var t;let n=iy();if(i6(n,e),null==(t=this.scroll)?void 0:t.wasRoot)return n;for(let t=0;t<this.path.length;t++){let r=this.path[t],{scroll:i,options:s}=r;r!==this.root&&i&&s.layoutScroll&&(i.wasRoot&&i6(n,e),iM(n.x,i.offset.x),iM(n.y,i.offset.y))}return n}applyTransform(e,t=!1){let n=iy();i6(n,e);for(let e=0;e<this.path.length;e++){let r=this.path[e];!t&&r.options.layoutScroll&&r.scroll&&r!==r.root&&iT(n,{x:-r.scroll.offset.x,y:-r.scroll.offset.y}),ik(r.latestValues)&&iT(n,r.latestValues)}return ik(this.latestValues)&&iT(n,this.latestValues),n}removeTransform(e){let t=iy();i6(t,e);for(let e=0;e<this.path.length;e++){let n=this.path[e];if(!n.instance||!ik(n.latestValues))continue;iw(n.latestValues)&&n.updateSnapshot();let r=iy();i6(r,n.measurePageBox()),sn(t,n.latestValues,n.snapshot?n.snapshot.layoutBox:void 0,r)}return ik(this.latestValues)&&sn(t,this.latestValues),t}setTargetDelta(e){this.targetDelta=e,this.root.scheduleUpdateProjection(),this.isProjectionDirty=!0}setOptions(e){this.options={...this.options,...e,crossfade:void 0===e.crossfade||e.crossfade}}clearMeasurements(){this.scroll=void 0,this.layout=void 0,this.snapshot=void 0,this.prevTransformTemplateValue=void 0,this.targetDelta=void 0,this.target=void 0,this.isLayoutDirty=!1}forceRelativeParentToResolveTarget(){this.relativeParent&&this.relativeParent.resolvedRelativeTargetAt!==tT.timestamp&&this.relativeParent.resolveTargetDelta(!0)}resolveTargetDelta(e=!1){var t,n,r,i;let s=this.getLead();this.isProjectionDirty||(this.isProjectionDirty=s.isProjectionDirty),this.isTransformDirty||(this.isTransformDirty=s.isTransformDirty),this.isSharedProjectionDirty||(this.isSharedProjectionDirty=s.isSharedProjectionDirty);let o=!!this.resumingFrom||this!==s;if(!(e||o&&this.isSharedProjectionDirty||this.isProjectionDirty||(null==(t=this.parent)?void 0:t.isProjectionDirty)||this.attemptToResolveRelativeTarget||this.root.updateBlockedByResize))return;let{layout:a,layoutId:l}=this.options;if(this.layout&&(a||l)){if(this.resolvedRelativeTargetAt=tT.timestamp,!this.targetDelta&&!this.relativeTarget){let e=this.getClosestProjectingParent();e&&e.layout&&1!==this.animationProgress?(this.relativeParent=e,this.forceRelativeParentToResolveTarget(),this.relativeTarget=iy(),this.relativeTargetOrigin=iy(),il(this.relativeTargetOrigin,this.layout.layoutBox,e.layout.layoutBox),i6(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}if(this.relativeTarget||this.targetDelta){if((this.target||(this.target=iy(),this.targetWithTransforms=iy()),this.relativeTarget&&this.relativeTargetOrigin&&this.relativeParent&&this.relativeParent.target)?(this.forceRelativeParentToResolveTarget(),n=this.target,r=this.relativeTarget,i=this.relativeParent.target,io(n.x,r.x,i.x),io(n.y,r.y,i.y)):this.targetDelta?(this.resumingFrom?this.target=this.applyTransform(this.layout.layoutBox):i6(this.target,this.layout.layoutBox),iC(this.target,this.targetDelta)):i6(this.target,this.layout.layoutBox),this.attemptToResolveRelativeTarget){this.attemptToResolveRelativeTarget=!1;let e=this.getClosestProjectingParent();e&&!!e.resumingFrom==!!this.resumingFrom&&!e.options.layoutScroll&&e.target&&1!==this.animationProgress?(this.relativeParent=e,this.forceRelativeParentToResolveTarget(),this.relativeTarget=iy(),this.relativeTargetOrigin=iy(),il(this.relativeTargetOrigin,this.target,e.target),i6(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}sh&&su.resolvedTargetDeltas++}}}getClosestProjectingParent(){if(!(!this.parent||iw(this.parent.latestValues)||ij(this.parent.latestValues)))if(this.parent.isProjecting())return this.parent;else return this.parent.getClosestProjectingParent()}isProjecting(){return!!((this.relativeTarget||this.targetDelta||this.options.layoutRoot)&&this.layout)}calcProjection(){var e;let t=this.getLead(),n=!!this.resumingFrom||this!==t,r=!0;if((this.isProjectionDirty||(null==(e=this.parent)?void 0:e.isProjectionDirty))&&(r=!1),n&&(this.isSharedProjectionDirty||this.isTransformDirty)&&(r=!1),this.resolvedRelativeTargetAt===tT.timestamp&&(r=!1),r)return;let{layout:i,layoutId:s}=this.options;if(this.isTreeAnimating=!!(this.parent&&this.parent.isTreeAnimating||this.currentAnimation||this.pendingAnimation),this.isTreeAnimating||(this.targetDelta=this.relativeTarget=void 0),!this.layout||!(i||s))return;i6(this.layoutCorrected,this.layout.layoutBox);let o=this.treeScale.x,a=this.treeScale.y;!function(e,t,n,r=!1){let i,s,o=n.length;if(o){t.x=t.y=1;for(let a=0;a<o;a++){s=(i=n[a]).projectionDelta;let{visualElement:o}=i.options;(!o||!o.props.style||"contents"!==o.props.style.display)&&(r&&i.options.layoutScroll&&i.scroll&&i!==i.root&&iT(e,{x:-i.scroll.offset.x,y:-i.scroll.offset.y}),s&&(t.x*=s.x.scale,t.y*=s.y.scale,iC(e,s)),r&&ik(i.latestValues)&&iT(e,i.latestValues))}t.x<1.0000000000001&&t.x>.999999999999&&(t.x=1),t.y<1.0000000000001&&t.y>.999999999999&&(t.y=1)}}(this.layoutCorrected,this.treeScale,this.path,n),t.layout&&!t.target&&(1!==this.treeScale.x||1!==this.treeScale.y)&&(t.target=t.layout.layoutBox,t.targetWithTransforms=iy());let{target:l}=t;if(!l){this.prevProjectionDelta&&(this.createProjectionDeltas(),this.scheduleRender());return}this.projectionDelta&&this.prevProjectionDelta?(i8(this.prevProjectionDelta.x,this.projectionDelta.x),i8(this.prevProjectionDelta.y,this.projectionDelta.y)):this.createProjectionDeltas(),is(this.projectionDelta,this.layoutCorrected,l,this.latestValues),this.treeScale.x===o&&this.treeScale.y===a&&sc(this.projectionDelta.x,this.prevProjectionDelta.x)&&sc(this.projectionDelta.y,this.prevProjectionDelta.y)||(this.hasProjected=!0,this.scheduleRender(),this.notifyListeners("projectionUpdate",l)),sh&&su.recalculatedProjection++}hide(){this.isVisible=!1}show(){this.isVisible=!0}scheduleRender(e=!0){var t;if(null==(t=this.options.visualElement)||t.scheduleRender(),e){let e=this.getStack();e&&e.scheduleRender()}this.resumingFrom&&!this.resumingFrom.instance&&(this.resumingFrom=void 0)}createProjectionDeltas(){this.prevProjectionDelta=im(),this.projectionDelta=im(),this.projectionDeltaWithTransform=im()}setAnimationOrigin(e,t=!1){let n,r=this.snapshot,i=r?r.latestValues:{},s={...this.latestValues},o=im();this.relativeParent&&this.relativeParent.options.layoutRoot||(this.relativeTarget=this.relativeTargetOrigin=void 0),this.attemptToResolveRelativeTarget=!t;let a=iy(),l=(r?r.source:void 0)!==(this.layout?this.layout.source:void 0),c=this.getStack(),d=!c||c.members.length<=1,u=!!(l&&!d&&!0===this.options.crossfade&&!this.path.some(sR));this.animationProgress=0,this.mixTargetDelta=t=>{let r=t/1e3;if(sD(o.x,e.x,r),sD(o.y,e.y,r),this.setTargetDelta(o),this.relativeTarget&&this.relativeTargetOrigin&&this.layout&&this.relativeParent&&this.relativeParent.layout){var c,h,p,f,m,g;il(a,this.layout.layoutBox,this.relativeParent.layout.layoutBox),p=this.relativeTarget,f=this.relativeTargetOrigin,m=a,g=r,sO(p.x,f.x,m.x,g),sO(p.y,f.y,m.y,g),n&&(c=this.relativeTarget,h=n,ss(c.x,h.x)&&ss(c.y,h.y))&&(this.isProjectionDirty=!1),n||(n=iy()),i6(n,this.relativeTarget)}l&&(this.animationValues=s,function(e,t,n,r,i,s){i?(e.opacity=n8(0,void 0!==n.opacity?n.opacity:1,i2(r)),e.opacityExit=n8(void 0!==t.opacity?t.opacity:1,0,i4(r))):s&&(e.opacity=n8(void 0!==t.opacity?t.opacity:1,void 0!==n.opacity?n.opacity:1,r));for(let i=0;i<iZ;i++){let s=`border${iX[i]}Radius`,o=i1(t,s),a=i1(n,s);(void 0!==o||void 0!==a)&&(o||(o=0),a||(a=0),0===o||0===a||i0(o)===i0(a)?(e[s]=Math.max(n8(iQ(o),iQ(a),r),0),(nl.test(a)||nl.test(o))&&(e[s]+="%")):e[s]=a)}(t.rotate||n.rotate)&&(e.rotate=n8(t.rotate||0,n.rotate||0,r))}(s,i,this.latestValues,r,u,d)),this.root.scheduleUpdateProjection(),this.scheduleRender(),this.animationProgress=r},this.mixTargetDelta(1e3*!!this.options.layoutRoot)}startAnimation(e){this.notifyListeners("animationStart"),this.currentAnimation&&this.currentAnimation.stop(),this.resumingFrom&&this.resumingFrom.currentAnimation&&this.resumingFrom.currentAnimation.stop(),this.pendingAnimation&&(tE(this.pendingAnimation),this.pendingAnimation=void 0),this.pendingAnimation=tM.update(()=>{i$.hasAnimatedSinceResize=!0,this.currentAnimation=function(e,t,n){let r=t_(0)?0:t$(e);return r.start(rB("",r,1e3,n)),r.animation}(0,0,{...e,onUpdate:t=>{this.mixTargetDelta(t),e.onUpdate&&e.onUpdate(t)},onComplete:()=>{e.onComplete&&e.onComplete(),this.completeAnimation()}}),this.resumingFrom&&(this.resumingFrom.currentAnimation=this.currentAnimation),this.pendingAnimation=void 0})}completeAnimation(){this.resumingFrom&&(this.resumingFrom.currentAnimation=void 0,this.resumingFrom.preserveOpacity=void 0);let e=this.getStack();e&&e.exitAnimationComplete(),this.resumingFrom=this.currentAnimation=this.animationValues=void 0,this.notifyListeners("animationComplete")}finishAnimation(){this.currentAnimation&&(this.mixTargetDelta&&this.mixTargetDelta(1e3),this.currentAnimation.stop()),this.completeAnimation()}applyTransformsToTarget(){let e=this.getLead(),{targetWithTransforms:t,target:n,layout:r,latestValues:i}=e;if(t&&n&&r){if(this!==e&&this.layout&&r&&sV(this.options.animationType,this.layout.layoutBox,r.layoutBox)){n=this.target||iy();let t=ir(this.layout.layoutBox.x);n.x.min=e.target.x.min,n.x.max=n.x.min+t;let r=ir(this.layout.layoutBox.y);n.y.min=e.target.y.min,n.y.max=n.y.min+r}i6(t,n),iT(t,i),is(this.projectionDeltaWithTransform,this.layoutCorrected,t,i)}}registerSharedNode(e,t){this.sharedNodes.has(e)||this.sharedNodes.set(e,new sd),this.sharedNodes.get(e).add(t);let n=t.options.initialPromotionConfig;t.promote({transition:n?n.transition:void 0,preserveFollowOpacity:n&&n.shouldPreserveFollowOpacity?n.shouldPreserveFollowOpacity(t):void 0})}isLead(){let e=this.getStack();return!e||e.lead===this}getLead(){var e;let{layoutId:t}=this.options;return t&&(null==(e=this.getStack())?void 0:e.lead)||this}getPrevLead(){var e;let{layoutId:t}=this.options;return t?null==(e=this.getStack())?void 0:e.prevLead:void 0}getStack(){let{layoutId:e}=this.options;if(e)return this.root.sharedNodes.get(e)}promote({needsReset:e,transition:t,preserveFollowOpacity:n}={}){let r=this.getStack();r&&r.promote(this,n),e&&(this.projectionDelta=void 0,this.needsReset=!0),t&&this.setOptions({transition:t})}relegate(){let e=this.getStack();return!!e&&e.relegate(this)}resetSkewAndRotation(){let{visualElement:e}=this.options;if(!e)return;let t=!1,{latestValues:n}=e;if((n.z||n.rotate||n.rotateX||n.rotateY||n.rotateZ||n.skewX||n.skewY)&&(t=!0),!t)return;let r={};n.z&&sg("z",e,r,this.animationValues);for(let t=0;t<sp.length;t++)sg(`rotate${sp[t]}`,e,r,this.animationValues),sg(`skew${sp[t]}`,e,r,this.animationValues);for(let t in e.render(),r)e.setStaticValue(t,r[t]),this.animationValues&&(this.animationValues[t]=r[t]);e.scheduleRender()}getProjectionStyles(e){var t,n;if(!this.instance||this.isSVG)return;if(!this.isVisible)return sf;let r={visibility:""},i=this.getTransformTemplate();if(this.needsReset)return this.needsReset=!1,r.opacity="",r.pointerEvents=iY(null==e?void 0:e.pointerEvents)||"",r.transform=i?i(this.latestValues,""):"none",r;let s=this.getLead();if(!this.projectionDelta||!this.layout||!s.target){let t={};return this.options.layoutId&&(t.opacity=void 0!==this.latestValues.opacity?this.latestValues.opacity:1,t.pointerEvents=iY(null==e?void 0:e.pointerEvents)||""),this.hasProjected&&!ik(this.latestValues)&&(t.transform=i?i({},""):"none",this.hasProjected=!1),t}let o=s.animationValues||s.latestValues;this.applyTransformsToTarget(),r.transform=function(e,t,n){let r="",i=e.x.translate/t.x,s=e.y.translate/t.y,o=(null==n?void 0:n.z)||0;if((i||s||o)&&(r=`translate3d(${i}px, ${s}px, ${o}px) `),(1!==t.x||1!==t.y)&&(r+=`scale(${1/t.x}, ${1/t.y}) `),n){let{transformPerspective:e,rotate:t,rotateX:i,rotateY:s,skewX:o,skewY:a}=n;e&&(r=`perspective(${e}px) ${r}`),t&&(r+=`rotate(${t}deg) `),i&&(r+=`rotateX(${i}deg) `),s&&(r+=`rotateY(${s}deg) `),o&&(r+=`skewX(${o}deg) `),a&&(r+=`skewY(${a}deg) `)}let a=e.x.scale*t.x,l=e.y.scale*t.y;return(1!==a||1!==l)&&(r+=`scale(${a}, ${l})`),r||"none"}(this.projectionDeltaWithTransform,this.treeScale,o),i&&(r.transform=i(o,r.transform));let{x:a,y:l}=this.projectionDelta;for(let e in r.transformOrigin=`${100*a.origin}% ${100*l.origin}% 0`,s.animationValues?r.opacity=s===this?null!=(n=null!=(t=o.opacity)?t:this.latestValues.opacity)?n:1:this.preserveOpacity?this.latestValues.opacity:o.opacityExit:r.opacity=s===this?void 0!==o.opacity?o.opacity:"":void 0!==o.opacityExit?o.opacityExit:0,iB){if(void 0===o[e])continue;let{correct:t,applyTo:n}=iB[e],i="none"===r.transform?o[e]:t(o[e],s);if(n){let e=n.length;for(let t=0;t<e;t++)r[n[t]]=i}else r[e]=i}return this.options.layoutId&&(r.pointerEvents=s===this?iY(null==e?void 0:e.pointerEvents)||"":"none"),r}clearSnapshot(){this.resumeFrom=this.snapshot=void 0}resetTree(){this.root.nodes.forEach(e=>{var t;return null==(t=e.currentAnimation)?void 0:t.stop()}),this.root.nodes.forEach(sj),this.root.sharedNodes.clear()}}}function sx(e){e.updateLayout()}function sv(e){var t;let n=(null==(t=e.resumeFrom)?void 0:t.snapshot)||e.snapshot;if(e.isLead()&&e.layout&&n&&e.hasListeners("didUpdate")){let{layoutBox:t,measuredBox:r}=e.layout,{animationType:i}=e.options,s=n.source!==e.layout.source;"size"===i?ix(e=>{let r=s?n.measuredBox[e]:n.layoutBox[e],i=ir(r);r.min=t[e].min,r.max=r.min+i}):sV(i,n.layoutBox,t)&&ix(r=>{let i=s?n.measuredBox[r]:n.layoutBox[r],o=ir(t[r]);i.max=i.min+o,e.relativeTarget&&!e.currentAnimation&&(e.isProjectionDirty=!0,e.relativeTarget[r].max=e.relativeTarget[r].min+o)});let o=im();is(o,t,n.layoutBox);let a=im();s?is(a,e.applyTransform(r,!0),n.measuredBox):is(a,t,n.layoutBox);let l=!si(o),c=!1;if(!e.resumeFrom){let r=e.getClosestProjectingParent();if(r&&!r.resumeFrom){let{snapshot:i,layout:s}=r;if(i&&s){let o=iy();il(o,n.layoutBox,i.layoutBox);let a=iy();il(a,t,s.layoutBox),sa(o,a)||(c=!0),r.options.layoutRoot&&(e.relativeTarget=a,e.relativeTargetOrigin=o,e.relativeParent=r)}}}e.notifyListeners("didUpdate",{layout:t,snapshot:n,delta:a,layoutDelta:o,hasLayoutChanged:l,hasRelativeTargetChanged:c})}else if(e.isLead()){let{onExitComplete:t}=e.options;t&&t()}e.options.transition=void 0}function sb(e){sh&&su.totalNodes++,e.parent&&(e.isProjecting()||(e.isProjectionDirty=e.parent.isProjectionDirty),e.isSharedProjectionDirty||(e.isSharedProjectionDirty=!!(e.isProjectionDirty||e.parent.isProjectionDirty||e.parent.isSharedProjectionDirty)),e.isTransformDirty||(e.isTransformDirty=e.parent.isTransformDirty))}function sw(e){e.isProjectionDirty=e.isSharedProjectionDirty=e.isTransformDirty=!1}function sk(e){e.clearSnapshot()}function sj(e){e.clearMeasurements()}function sN(e){e.isLayoutDirty=!1}function sS(e){let{visualElement:t}=e.options;t&&t.getProps().onBeforeLayoutMeasure&&t.notify("BeforeLayoutMeasure"),e.resetTransform()}function sC(e){e.finishAnimation(),e.targetDelta=e.relativeTarget=e.target=void 0,e.isProjectionDirty=!0}function sM(e){e.resolveTargetDelta()}function sE(e){e.calcProjection()}function sT(e){e.resetSkewAndRotation()}function sA(e){e.removeLeadSnapshot()}function sD(e,t,n){e.translate=n8(t.translate,0,n),e.scale=n8(t.scale,1,n),e.origin=t.origin,e.originPoint=t.originPoint}function sO(e,t,n,r){e.min=n8(t.min,n.min,r),e.max=n8(t.max,n.max,r)}function sR(e){return e.animationValues&&void 0!==e.animationValues.opacityExit}let sP={duration:.45,ease:[.4,0,.1,1]},sI=e=>"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().includes(e),sL=sI("applewebkit/")&&!sI("chrome/")?Math.round:tx;function sz(e){e.min=sL(e.min),e.max=sL(e.max)}function sV(e,t,n){return"position"===e||"preserve-aspect"===e&&!(.2>=Math.abs(sl(t)-sl(n)))}function s$(e){var t;return e!==e.root&&(null==(t=e.scroll)?void 0:t.wasRoot)}let s_=sy({attachResizeListener:(e,t)=>r1(e,"resize",t),measureScroll:()=>({x:document.documentElement.scrollLeft||document.body.scrollLeft,y:document.documentElement.scrollTop||document.body.scrollTop}),checkIsScrollRoot:()=>!0}),sF={current:void 0},sB=sy({measureScroll:e=>({x:e.scrollLeft,y:e.scrollTop}),defaultParent:()=>{if(!sF.current){let e=new s_({});e.mount(window),e.setOptions({layoutScroll:!0}),sF.current=e}return sF.current},resetTransform:(e,t)=>{e.style.transform=void 0!==t?t:"none"},checkIsScrollRoot:e=>"fixed"===window.getComputedStyle(e).position});function sW(e,t,n){let{props:r}=e;e.animationState&&r.whileHover&&e.animationState.setActive("whileHover","Start"===n);let i=r["onHover"+n];i&&tM.postRender(()=>i(t,r2(t)))}class sq extends rX{mount(){let{current:e}=this.node;e&&(this.unmount=function(e,t,n={}){let[r,i,s]=to(e,n),o=ta(e=>{let{target:n}=e,r=t(e);if("function"!=typeof r||!n)return;let s=ta(e=>{r(e),n.removeEventListener("pointerleave",s)});n.addEventListener("pointerleave",s,i)});return r.forEach(e=>{e.addEventListener("pointerenter",o,i)}),s}(e,e=>(sW(this.node,e,"Start"),e=>sW(this.node,e,"End"))))}unmount(){}}class sH extends rX{constructor(){super(...arguments),this.isActive=!1}onFocus(){let e=!1;try{e=this.node.current.matches(":focus-visible")}catch(t){e=!0}e&&this.node.animationState&&(this.node.animationState.setActive("whileFocus",!0),this.isActive=!0)}onBlur(){this.isActive&&this.node.animationState&&(this.node.animationState.setActive("whileFocus",!1),this.isActive=!1)}mount(){this.unmount=ro(r1(this.node.current,"focus",()=>this.onFocus()),r1(this.node.current,"blur",()=>this.onBlur()))}unmount(){}}function sU(e,t,n){let{props:r}=e;e.animationState&&r.whileTap&&e.animationState.setActive("whileTap","Start"===n);let i=r["onTap"+("End"===n?"":n)];i&&tM.postRender(()=>i(t,r2(t)))}class sK extends rX{mount(){let{current:e}=this.node;e&&(this.unmount=function(e,t,n={}){let[r,i,s]=to(e,n),o=e=>{let r=e.currentTarget;if(!tm(e)||tu.has(r))return;tu.add(r);let s=t(e),o=(e,t)=>{window.removeEventListener("pointerup",a),window.removeEventListener("pointercancel",l),tm(e)&&tu.has(r)&&(tu.delete(r),"function"==typeof s&&s(e,{success:t}))},a=e=>{o(e,n.useGlobalTarget||tl(r,e.target))},l=e=>{o(e,!1)};window.addEventListener("pointerup",a,i),window.addEventListener("pointercancel",l,i)};return r.forEach(e=>{td.has(e.tagName)||-1!==e.tabIndex||null!==e.getAttribute("tabindex")||(e.tabIndex=0),(n.useGlobalTarget?window:e).addEventListener("pointerdown",o,i),e.addEventListener("focus",e=>tf(e,i),i)}),s}(e,e=>(sU(this.node,e,"Start"),(e,{success:t})=>sU(this.node,e,t?"End":"Cancel")),{useGlobalTarget:this.node.props.globalTapTarget}))}unmount(){}}let sJ=new WeakMap,sG=new WeakMap,sY=e=>{let t=sJ.get(e.target);t&&t(e)},sX=e=>{e.forEach(sY)},sZ={some:0,all:1};class sQ extends rX{constructor(){super(...arguments),this.hasEnteredView=!1,this.isInView=!1}startObserver(){this.unmount();let{viewport:e={}}=this.node.getProps(),{root:t,margin:n,amount:r="some",once:i}=e,s={root:t?t.current:void 0,rootMargin:n,threshold:"number"==typeof r?r:sZ[r]};return function(e,t,n){let r=function({root:e,...t}){let n=e||document;sG.has(n)||sG.set(n,{});let r=sG.get(n),i=JSON.stringify(t);return r[i]||(r[i]=new IntersectionObserver(sX,{root:e,...t})),r[i]}(t);return sJ.set(e,n),r.observe(e),()=>{sJ.delete(e),r.unobserve(e)}}(this.node.current,s,e=>{let{isIntersecting:t}=e;if(this.isInView===t||(this.isInView=t,i&&!t&&this.hasEnteredView))return;t&&(this.hasEnteredView=!0),this.node.animationState&&this.node.animationState.setActive("whileInView",t);let{onViewportEnter:n,onViewportLeave:r}=this.node.getProps(),s=t?n:r;s&&s(e)})}mount(){this.startObserver()}update(){if("undefined"==typeof IntersectionObserver)return;let{props:e,prevProps:t}=this.node;["amount","margin","root"].some(function({viewport:e={}},{viewport:t={}}={}){return n=>e[n]!==t[n]}(e,t))&&this.startObserver()}unmount(){}}let s0=(0,h.createContext)({strict:!1}),s1=(0,h.createContext)({});function s2(e){return eH(e.animate)||eQ.some(t=>eJ(e[t]))}function s4(e){return!!(s2(e)||e.variants)}function s3(e){return Array.isArray(e)?e.join(" "):e}let s5={animation:["animate","variants","whileHover","whileTap","exit","whileInView","whileFocus","whileDrag"],exit:["exit"],drag:["drag","dragControls"],focus:["whileFocus"],hover:["whileHover","onHoverStart","onHoverEnd"],tap:["whileTap","onTap","onTapStart","onTapCancel"],pan:["onPan","onPanStart","onPanSessionStart","onPanEnd"],inView:["whileInView","onViewportEnter","onViewportLeave"],layout:["layout","layoutId"]},s6={};for(let e in s5)s6[e]={isEnabled:t=>s5[e].some(e=>!!t[e])};let s8=Symbol.for("motionComponentSymbol"),s9=["animate","circle","defs","desc","ellipse","g","image","line","filter","marker","mask","metadata","path","pattern","polygon","polyline","rect","stop","switch","symbol","svg","text","tspan","use","view"];function s7(e){if("string"!=typeof e||e.includes("-"));else if(s9.indexOf(e)>-1||/[A-Z]/u.test(e))return!0;return!1}let oe=e=>(t,n)=>{let r=(0,h.useContext)(s1),i=(0,h.useContext)(eR),s=()=>(function({scrapeMotionValuesFromProps:e,createRenderState:t,onUpdate:n},r,i,s){let o={latestValues:function(e,t,n,r){let i={},s=r(e,{});for(let e in s)i[e]=iY(s[e]);let{initial:o,animate:a}=e,l=s2(e),c=s4(e);t&&c&&!l&&!1!==e.inherit&&(void 0===o&&(o=t.initial),void 0===a&&(a=t.animate));let d=!!n&&!1===n.initial,u=(d=d||!1===o)?a:o;if(u&&"boolean"!=typeof u&&!eH(u)){let t=Array.isArray(u)?u:[u];for(let n=0;n<t.length;n++){let r=eY(e,t[n]);if(r){let{transitionEnd:e,transition:t,...n}=r;for(let e in n){let t=n[e];if(Array.isArray(t)){let e=d?t.length-1:0;t=t[e]}null!==t&&(i[e]=t)}for(let t in e)i[t]=e[t]}}}return i}(r,i,s,e),renderState:t()};return n&&(o.onMount=e=>n({props:r,current:e,...o}),o.onUpdate=e=>n(e)),o})(e,t,r,i);return n?s():eO(s)},ot=(e,t)=>t&&"number"==typeof e?t.transform(e):e,on={x:"translateX",y:"translateY",z:"translateZ",transformPerspective:"perspective"},or=tv.length;function oi(e,t,n){let{style:r,vars:i,transformOrigin:s}=e,o=!1,a=!1;for(let e in t){let n=t[e];if(tb.has(e)){o=!0;continue}if(nJ(e)){i[e]=n;continue}{let t=ot(n,nT[e]);e.startsWith("origin")?(a=!0,s[e]=t):r[e]=t}}if(!t.transform&&(o||n?r.transform=function(e,t,n){let r="",i=!0;for(let s=0;s<or;s++){let o=tv[s],a=e[o];if(void 0===a)continue;let l=!0;if(!(l="number"==typeof a?a===+!!o.startsWith("scale"):0===parseFloat(a))||n){let e=ot(a,nT[o]);if(!l){i=!1;let t=on[o]||o;r+=`${t}(${e}) `}n&&(t[o]=e)}}return r=r.trim(),n?r=n(t,i?"":r):i&&(r="none"),r}(t,e.transform,n):r.transform&&(r.transform="none")),a){let{originX:e="50%",originY:t="50%",originZ:n=0}=s;r.transformOrigin=`${e} ${t} ${n}`}}let oo={offset:"stroke-dashoffset",array:"stroke-dasharray"},oa={offset:"strokeDashoffset",array:"strokeDasharray"};function ol(e,t,n){return"string"==typeof e?e:nc.transform(t+n*e)}function oc(e,{attrX:t,attrY:n,attrScale:r,originX:i,originY:s,pathLength:o,pathSpacing:a=1,pathOffset:l=0,...c},d,u){if(oi(e,c,u),d){e.style.viewBox&&(e.attrs.viewBox=e.style.viewBox);return}e.attrs=e.style,e.style={};let{attrs:h,style:p,dimensions:f}=e;h.transform&&(f&&(p.transform=h.transform),delete h.transform),f&&(void 0!==i||void 0!==s||p.transform)&&(p.transformOrigin=function(e,t,n){let r=ol(t,e.x,e.width),i=ol(n,e.y,e.height);return`${r} ${i}`}(f,void 0!==i?i:.5,void 0!==s?s:.5)),void 0!==t&&(h.x=t),void 0!==n&&(h.y=n),void 0!==r&&(h.scale=r),void 0!==o&&function(e,t,n=1,r=0,i=!0){e.pathLength=1;let s=i?oo:oa;e[s.offset]=nc.transform(-r);let o=nc.transform(t),a=nc.transform(n);e[s.array]=`${o} ${a}`}(h,o,a,l,!1)}let od=()=>({style:{},transform:{},transformOrigin:{},vars:{}}),ou=()=>({...od(),attrs:{}}),oh=e=>"string"==typeof e&&"svg"===e.toLowerCase();function op(e,{style:t,vars:n},r,i){for(let s in Object.assign(e.style,t,i&&i.getProjectionStyles(r)),n)e.style.setProperty(s,n[s])}let of=new Set(["baseFrequency","diffuseConstant","kernelMatrix","kernelUnitLength","keySplines","keyTimes","limitingConeAngle","markerHeight","markerWidth","numOctaves","targetX","targetY","surfaceScale","specularConstant","specularExponent","stdDeviation","tableValues","viewBox","gradientTransform","pathLength","startOffset","textLength","lengthAdjust"]);function om(e,t,n,r){for(let n in op(e,t,void 0,r),t.attrs)e.setAttribute(of.has(n)?n:tB(n),t.attrs[n])}function og(e,{layout:t,layoutId:n}){return tb.has(e)||e.startsWith("origin")||(t||void 0!==n)&&(!!iB[e]||"opacity"===e)}function oy(e,t,n){var r;let{style:i}=e,s={};for(let o in i)(t_(i[o])||t.style&&t_(t.style[o])||og(o,e)||(null==(r=null==n?void 0:n.getValue(o))?void 0:r.liveStyle)!==void 0)&&(s[o]=i[o]);return s}function ox(e,t,n){let r=oy(e,t,n);for(let n in e)(t_(e[n])||t_(t[n]))&&(r[-1!==tv.indexOf(n)?"attr"+n.charAt(0).toUpperCase()+n.substring(1):n]=e[n]);return r}let ov=["x","y","width","height","cx","cy","r"],ob={useVisualState:oe({scrapeMotionValuesFromProps:ox,createRenderState:ou,onUpdate:({props:e,prevProps:t,current:n,renderState:r,latestValues:i})=>{if(!n)return;let s=!!e.drag;if(!s){for(let e in i)if(tb.has(e)){s=!0;break}}if(!s)return;let o=!t;if(t)for(let n=0;n<ov.length;n++){let r=ov[n];e[r]!==t[r]&&(o=!0)}o&&tM.read(()=>{!function(e,t){try{t.dimensions="function"==typeof e.getBBox?e.getBBox():e.getBoundingClientRect()}catch(e){t.dimensions={x:0,y:0,width:0,height:0}}}(n,r),tM.render(()=>{oc(r,i,oh(n.tagName),e.transformTemplate),om(n,r)})})}})},ow={useVisualState:oe({scrapeMotionValuesFromProps:oy,createRenderState:od})};function ok(e,t,n){for(let r in t)t_(t[r])||og(r,n)||(e[r]=t[r])}let oj=new Set(["animate","exit","variants","initial","style","values","variants","transition","transformTemplate","custom","inherit","onBeforeLayoutMeasure","onAnimationStart","onAnimationComplete","onUpdate","onDragStart","onDrag","onDragEnd","onMeasureDragConstraints","onDirectionLock","onDragTransitionEnd","_dragX","_dragY","onHoverStart","onHoverEnd","onViewportEnter","onViewportLeave","globalTapTarget","ignoreStrict","viewport"]);function oN(e){return e.startsWith("while")||e.startsWith("drag")&&"draggable"!==e||e.startsWith("layout")||e.startsWith("onTap")||e.startsWith("onPan")||e.startsWith("onLayout")||oj.has(e)}let oS=e=>!oN(e);try{!function(e){e&&(oS=t=>t.startsWith("on")?!oN(t):e(t))}(require("@emotion/is-prop-valid").default)}catch(e){}let oC={current:null},oM={current:!1},oE=[...n0,nf,nj],oT=e=>oE.find(nQ(e)),oA=new WeakMap,oD=["AnimationStart","AnimationComplete","Update","BeforeLayoutMeasure","LayoutMeasure","LayoutAnimationStart","LayoutAnimationComplete"];class oO{scrapeMotionValuesFromProps(e,t,n){return{}}constructor({parent:e,props:t,presenceContext:n,reducedMotionConfig:r,blockInitialAnimation:i,visualState:s},o={}){this.current=null,this.children=new Set,this.isVariantNode=!1,this.isControllingVariants=!1,this.shouldReduceMotion=null,this.values=new Map,this.KeyframeResolver=nH,this.features={},this.valueSubscriptions=new Map,this.prevMotionValues={},this.events={},this.propEventSubscriptions={},this.notifyUpdate=()=>this.notify("Update",this.latestValues),this.render=()=>{this.current&&(this.triggerBuild(),this.renderInstance(this.current,this.renderState,this.props.style,this.projection))},this.renderScheduledAt=0,this.scheduleRender=()=>{let e=tO.now();this.renderScheduledAt<e&&(this.renderScheduledAt=e,tM.render(this.render,!1,!0))};let{latestValues:a,renderState:l,onUpdate:c}=s;this.onUpdate=c,this.latestValues=a,this.baseTarget={...a},this.initialValues=t.initial?{...a}:{},this.renderState=l,this.parent=e,this.props=t,this.presenceContext=n,this.depth=e?e.depth+1:0,this.reducedMotionConfig=r,this.options=o,this.blockInitialAnimation=!!i,this.isControllingVariants=s2(t),this.isVariantNode=s4(t),this.isVariantNode&&(this.variantChildren=new Set),this.manuallyAnimateOnMount=!!(e&&e.current);let{willChange:d,...u}=this.scrapeMotionValuesFromProps(t,{},this);for(let e in u){let t=u[e];void 0!==a[e]&&t_(t)&&t.set(a[e],!1)}}mount(e){this.current=e,oA.set(e,this),this.projection&&!this.projection.instance&&this.projection.mount(e),this.parent&&this.isVariantNode&&!this.isControllingVariants&&(this.removeFromVariantTree=this.parent.addVariantChild(this)),this.values.forEach((e,t)=>this.bindToMotionValue(t,e)),oM.current||function(){if(oM.current=!0,eB)if(window.matchMedia){let e=window.matchMedia("(prefers-reduced-motion)"),t=()=>oC.current=e.matches;e.addListener(t),t()}else oC.current=!1}(),this.shouldReduceMotion="never"!==this.reducedMotionConfig&&("always"===this.reducedMotionConfig||oC.current),this.parent&&this.parent.children.add(this),this.update(this.props,this.presenceContext)}unmount(){for(let e in oA.delete(this.current),this.projection&&this.projection.unmount(),tE(this.notifyUpdate),tE(this.render),this.valueSubscriptions.forEach(e=>e()),this.valueSubscriptions.clear(),this.removeFromVariantTree&&this.removeFromVariantTree(),this.parent&&this.parent.children.delete(this),this.events)this.events[e].clear();for(let e in this.features){let t=this.features[e];t&&(t.unmount(),t.isMounted=!1)}this.current=null}bindToMotionValue(e,t){let n;this.valueSubscriptions.has(e)&&this.valueSubscriptions.get(e)();let r=tb.has(e),i=t.on("change",t=>{this.latestValues[e]=t,this.props.onUpdate&&tM.preRender(this.notifyUpdate),r&&this.projection&&(this.projection.isTransformDirty=!0)}),s=t.on("renderRequest",this.scheduleRender);window.MotionCheckAppearSync&&(n=window.MotionCheckAppearSync(this,e,t)),this.valueSubscriptions.set(e,()=>{i(),s(),n&&n(),t.owner&&t.stop()})}sortNodePosition(e){return this.current&&this.sortInstanceNodePosition&&this.type===e.type?this.sortInstanceNodePosition(this.current,e.current):0}updateFeatures(){let e="animation";for(e in s6){let t=s6[e];if(!t)continue;let{isEnabled:n,Feature:r}=t;if(!this.features[e]&&r&&n(this.props)&&(this.features[e]=new r(this)),this.features[e]){let t=this.features[e];t.isMounted?t.update():(t.mount(),t.isMounted=!0)}}}triggerBuild(){this.build(this.renderState,this.latestValues,this.props)}measureViewportBox(){return this.current?this.measureInstanceViewportBox(this.current,this.props):iy()}getStaticValue(e){return this.latestValues[e]}setStaticValue(e,t){this.latestValues[e]=t}update(e,t){(e.transformTemplate||this.props.transformTemplate)&&this.scheduleRender(),this.prevProps=this.props,this.props=e,this.prevPresenceContext=this.presenceContext,this.presenceContext=t;for(let t=0;t<oD.length;t++){let n=oD[t];this.propEventSubscriptions[n]&&(this.propEventSubscriptions[n](),delete this.propEventSubscriptions[n]);let r=e["on"+n];r&&(this.propEventSubscriptions[n]=this.on(n,r))}this.prevMotionValues=function(e,t,n){for(let r in t){let i=t[r],s=n[r];if(t_(i))e.addValue(r,i);else if(t_(s))e.addValue(r,t$(i,{owner:e}));else if(s!==i)if(e.hasValue(r)){let t=e.getValue(r);!0===t.liveStyle?t.jump(i):t.hasAnimated||t.set(i)}else{let t=e.getStaticValue(r);e.addValue(r,t$(void 0!==t?t:i,{owner:e}))}}for(let r in n)void 0===t[r]&&e.removeValue(r);return t}(this,this.scrapeMotionValuesFromProps(e,this.prevProps,this),this.prevMotionValues),this.handleChildMotionValue&&this.handleChildMotionValue(),this.onUpdate&&this.onUpdate(this)}getProps(){return this.props}getVariant(e){return this.props.variants?this.props.variants[e]:void 0}getDefaultTransition(){return this.props.transition}getTransformPagePoint(){return this.props.transformPagePoint}getClosestVariantNode(){return this.isVariantNode?this:this.parent?this.parent.getClosestVariantNode():void 0}addVariantChild(e){let t=this.getClosestVariantNode();if(t)return t.variantChildren&&t.variantChildren.add(e),()=>t.variantChildren.delete(e)}addValue(e,t){let n=this.values.get(e);t!==n&&(n&&this.removeValue(e),this.bindToMotionValue(e,t),this.values.set(e,t),this.latestValues[e]=t.get())}removeValue(e){this.values.delete(e);let t=this.valueSubscriptions.get(e);t&&(t(),this.valueSubscriptions.delete(e)),delete this.latestValues[e],this.removeValueFromRenderState(e,this.renderState)}hasValue(e){return this.values.has(e)}getValue(e,t){if(this.props.values&&this.props.values[e])return this.props.values[e];let n=this.values.get(e);return void 0===n&&void 0!==t&&(n=t$(null===t?void 0:t,{owner:this}),this.addValue(e,n)),n}readValue(e,t){var n;let r=void 0===this.latestValues[e]&&this.current?null!=(n=this.getBaseTargetFromProps(this.props,e))?n:this.readValueFromInstance(this.current,e,this.options):this.latestValues[e];return null!=r&&("string"==typeof r&&(nU(r)||t2(r))?r=parseFloat(r):!oT(r)&&nj.test(t)&&(r=nO(e,t)),this.setBaseTarget(e,t_(r)?r.get():r)),t_(r)?r.get():r}setBaseTarget(e,t){this.baseTarget[e]=t}getBaseTarget(e){var t;let n,{initial:r}=this.props;if("string"==typeof r||"object"==typeof r){let i=eY(this.props,r,null==(t=this.presenceContext)?void 0:t.custom);i&&(n=i[e])}if(r&&void 0!==n)return n;let i=this.getBaseTargetFromProps(this.props,e);return void 0===i||t_(i)?void 0!==this.initialValues[e]&&void 0===n?void 0:this.baseTarget[e]:i}on(e,t){return this.events[e]||(this.events[e]=new tI),this.events[e].add(t)}notify(e,...t){this.events[e]&&this.events[e].notify(...t)}}class oR extends oO{constructor(){super(...arguments),this.KeyframeResolver=n2}sortInstanceNodePosition(e,t){return 2&e.compareDocumentPosition(t)?1:-1}getBaseTargetFromProps(e,t){return e.style?e.style[t]:void 0}removeValueFromRenderState(e,{vars:t,style:n}){delete t[e],delete n[e]}handleChildMotionValue(){this.childSubscription&&(this.childSubscription(),delete this.childSubscription);let{children:e}=this.props;t_(e)&&(this.childSubscription=e.on("change",e=>{this.current&&(this.current.textContent=`${e}`)}))}}class oP extends oR{constructor(){super(...arguments),this.type="html",this.renderInstance=op}readValueFromInstance(e,t){if(tb.has(t)){let e=nD(t);return e&&e.default||0}{let n=window.getComputedStyle(e),r=(nJ(t)?n.getPropertyValue(t):n[t])||0;return"string"==typeof r?r.trim():r}}measureInstanceViewportBox(e,{transformPagePoint:t}){return iA(e,t)}build(e,t,n){oi(e,t,n.transformTemplate)}scrapeMotionValuesFromProps(e,t,n){return oy(e,t,n)}}class oI extends oR{constructor(){super(...arguments),this.type="svg",this.isSVGTag=!1,this.measureInstanceViewportBox=iy}getBaseTargetFromProps(e,t){return e[t]}readValueFromInstance(e,t){if(tb.has(t)){let e=nD(t);return e&&e.default||0}return t=of.has(t)?t:tB(t),e.getAttribute(t)}scrapeMotionValuesFromProps(e,t,n){return ox(e,t,n)}build(e,t,n){oc(e,t,this.isSVGTag,n.transformTemplate)}renderInstance(e,t,n,r){om(e,t,n,r)}mount(e){this.isSVGTag=oh(e.tagName),super.mount(e)}}let oL=function(e){if("undefined"==typeof Proxy)return e;let t=new Map;return new Proxy((...t)=>e(...t),{get:(n,r)=>"create"===r?e:(t.has(r)||t.set(r,e(r)),t.get(r))})}((s={animation:{Feature:rZ},exit:{Feature:r0},inView:{Feature:sQ},tap:{Feature:sK},focus:{Feature:sH},hover:{Feature:sq},pan:{Feature:iz},drag:{Feature:iI,ProjectionNode:sB,MeasureLayout:iU},layout:{ProjectionNode:sB,MeasureLayout:iU}},o=(e,t)=>s7(e)?new oI(t):new oP(t,{allowProjection:e!==h.Fragment}),function(e,{forwardMotionProps:t}={forwardMotionProps:!1}){return function({preloadedFeatures:e,createVisualElement:t,useRender:n,useVisualState:r,Component:i}){var s,o;function a(e,s){var o,a,l;let c,d={...(0,h.useContext)(eP),...e,layoutId:function({layoutId:e}){let t=(0,h.useContext)(eD).id;return t&&void 0!==e?t+"-"+e:e}(e)},{isStatic:p}=d,f=function(e){let{initial:t,animate:n}=function(e,t){if(s2(e)){let{initial:t,animate:n}=e;return{initial:!1===t||eJ(t)?t:void 0,animate:eJ(n)?n:void 0}}return!1!==e.inherit?t:{}}(e,(0,h.useContext)(s1));return(0,h.useMemo)(()=>({initial:t,animate:n}),[s3(t),s3(n)])}(e),m=r(e,p);if(!p&&eB){a=0,l=0,(0,h.useContext)(s0).strict;let e=function(e){let{drag:t,layout:n}=s6;if(!t&&!n)return{};let r={...t,...n};return{MeasureLayout:(null==t?void 0:t.isEnabled(e))||(null==n?void 0:n.isEnabled(e))?r.MeasureLayout:void 0,ProjectionNode:r.ProjectionNode}}(d);c=e.MeasureLayout,f.visualElement=function(e,t,n,r,i){var s,o;let{visualElement:a}=(0,h.useContext)(s1),l=(0,h.useContext)(s0),c=(0,h.useContext)(eR),d=(0,h.useContext)(eP).reducedMotion,u=(0,h.useRef)(null);r=r||l.renderer,!u.current&&r&&(u.current=r(e,{visualState:t,parent:a,props:n,presenceContext:c,blockInitialAnimation:!!c&&!1===c.initial,reducedMotionConfig:d}));let p=u.current,f=(0,h.useContext)(iV);p&&!p.projection&&i&&("html"===p.type||"svg"===p.type)&&function(e,t,n,r){let{layoutId:i,layout:s,drag:o,dragConstraints:a,layoutScroll:l,layoutRoot:c}=t;e.projection=new n(e.latestValues,t["data-framer-portal-id"]?void 0:function e(t){if(t)return!1!==t.options.allowProjection?t.projection:e(t.parent)}(e.parent)),e.projection.setOptions({layoutId:i,layout:s,alwaysMeasureLayout:!!o||a&&it(a),visualElement:e,animationType:"string"==typeof s?s:"both",initialPromotionConfig:r,layoutScroll:l,layoutRoot:c})}(u.current,n,i,f);let m=(0,h.useRef)(!1);(0,h.useInsertionEffect)(()=>{p&&m.current&&p.update(n,c)});let g=n[tW],y=(0,h.useRef)(!!g&&!(null==(s=window.MotionHandoffIsComplete)?void 0:s.call(window,g))&&(null==(o=window.MotionHasOptimisedAnimation)?void 0:o.call(window,g)));return eW(()=>{p&&(m.current=!0,window.MotionIsMounted=!0,p.updateFeatures(),iW.render(p.render),y.current&&p.animationState&&p.animationState.animateChanges())}),(0,h.useEffect)(()=>{p&&(!y.current&&p.animationState&&p.animationState.animateChanges(),y.current&&(queueMicrotask(()=>{var e;null==(e=window.MotionHandoffMarkAsComplete)||e.call(window,g)}),y.current=!1))}),p}(i,m,d,t,e.ProjectionNode)}return(0,u.jsxs)(s1.Provider,{value:f,children:[c&&f.visualElement?(0,u.jsx)(c,{visualElement:f.visualElement,...d}):null,n(i,e,(o=f.visualElement,(0,h.useCallback)(e=>{e&&m.onMount&&m.onMount(e),o&&(e?o.mount(e):o.unmount()),s&&("function"==typeof s?s(e):it(s)&&(s.current=e))},[o])),m,p,f.visualElement)]})}e&&function(e){for(let t in e)s6[t]={...s6[t],...e[t]}}(e),a.displayName=`motion.${"string"==typeof i?i:`create(${null!=(o=null!=(s=i.displayName)?s:i.name)?o:""})`}`;let l=(0,h.forwardRef)(a);return l[s8]=i,l}({...s7(e)?ob:ow,preloadedFeatures:s,useRender:function(e=!1){return(t,n,r,{latestValues:i},s)=>{let o=(s7(t)?function(e,t,n,r){let i=(0,h.useMemo)(()=>{let n=ou();return oc(n,t,oh(r),e.transformTemplate),{...n.attrs,style:{...n.style}}},[t]);if(e.style){let t={};ok(t,e.style,e),i.style={...t,...i.style}}return i}:function(e,t){let n={},r=function(e,t){let n=e.style||{},r={};return ok(r,n,e),Object.assign(r,function({transformTemplate:e},t){return(0,h.useMemo)(()=>{let n=od();return oi(n,t,e),Object.assign({},n.vars,n.style)},[t])}(e,t)),r}(e,t);return e.drag&&!1!==e.dragListener&&(n.draggable=!1,r.userSelect=r.WebkitUserSelect=r.WebkitTouchCallout="none",r.touchAction=!0===e.drag?"none":`pan-${"x"===e.drag?"y":"x"}`),void 0===e.tabIndex&&(e.onTap||e.onTapStart||e.whileTap)&&(n.tabIndex=0),n.style=r,n})(n,i,s,t),a=function(e,t,n){let r={};for(let i in e)("values"!==i||"object"!=typeof e.values)&&(oS(i)||!0===n&&oN(i)||!t&&!oN(i)||e.draggable&&i.startsWith("onDrag"))&&(r[i]=e[i]);return r}(n,"string"==typeof t,e),l=t!==h.Fragment?{...a,...o,ref:r}:{},{children:c}=n,d=(0,h.useMemo)(()=>t_(c)?c.get():c,[c]);return(0,h.createElement)(t,{...l,children:d})}}(t),createVisualElement:o,Component:e})})),oz=h.forwardRef(({className:e,type:t,...n},r)=>(0,u.jsx)("input",{type:t,className:(0,X.cn)("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",e),ref:r,...n}));oz.displayName="Input";var oV=n(9867);let o$=({profileData:e,onUpdateProfile:t,onNavigate:n,className:r=""})=>{let[i,s]=(0,h.useState)(0),[o,a]=(0,h.useState)(""),[l,c]=(0,h.useState)(!1),{toast:d}=(0,oV.dj)(),p=e?.favoriteAffirmations||[];(0,h.useEffect)(()=>{c(!0)},[]),(0,h.useEffect)(()=>{if(p.length>1){let e=setInterval(()=>{s(e=>(e+1)%p.length)},7e3);return()=>clearInterval(e)}},[p.length]);let f=()=>{if(!o.trim())return;let n=[...p,o.trim()];t({...e,favoriteAffirmations:n}),a(""),d({title:"Custom affirmation added!"})};if(!l)return(0,u.jsx)(eE,{className:`bg-surface-container-low p-8 rounded-xl h-[230px] ${r}`});let m=p&&p.length>0;return(0,u.jsxs)("div",{className:`bg-surface-container-low p-8 rounded-xl shadow-md hover:shadow-lg transition-shadow duration-300 flex flex-col justify-between h-full ${r}`,children:[(0,u.jsxs)("div",{children:[(0,u.jsxs)("div",{className:"flex items-center space-x-2 mb-3",children:[(0,u.jsx)(el,{className:"w-7 h-7 text-yellow-500"}),(0,u.jsx)("h3",{className:"font-serif text-headline-sm text-surface-on",children:"My Affirmations"})]}),(0,u.jsx)("div",{className:"mb-4 p-4 bg-surface rounded-lg min-h-[80px] flex items-center justify-center text-center",children:m?(0,u.jsx)(eq,{mode:"wait",children:(0,u.jsxs)(oL.p,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},transition:{duration:.5},className:"text-body-lg font-medium text-surface-on",children:['"',p[i],'"']},i)}):(0,u.jsx)("p",{className:"text-body-md text-surface-on-variant",children:"Add or favorite some affirmations to see them here."})})]}),(0,u.jsxs)("div",{className:"mt-auto space-y-3",children:[(0,u.jsxs)("div",{className:"flex gap-2",children:[(0,u.jsx)(oz,{type:"text",placeholder:"Write your own affirmation...",value:o,onChange:e=>a(e.target.value),onKeyPress:e=>"Enter"===e.key&&f(),className:"h-10 bg-surface border-outline-variant"}),(0,u.jsx)(Q,{variant:"tonal",size:"md",isIconOnly:!0,onClick:f,disabled:!o.trim(),title:"Add Custom Affirmation",children:(0,u.jsx)(eA,{})})]}),(0,u.jsx)(Q,{variant:"tonal",size:"md",leadingIcon:(0,u.jsx)(eM,{}),onClick:()=>n("affirmations"),"aria-label":"Find more affirmations to favorite",className:"w-full",children:m?"Manage & Find More":"Find Affirmations"})]})]})},o_=e=>e.toISOString().split("T")[0],oF=({dailyPlans:e,medications:t,medicationGroups:n,profileData:r,onUpdateProfile:i,onNavigateToView:s})=>{let[o,a]=(0,h.useState)(null);if((0,h.useEffect)(()=>{a(new Date)},[]),!o)return(0,u.jsxs)("div",{className:"space-y-8 lg:space-y-10 animate-in fade-in-0 duration-750",children:[(0,u.jsx)(eE,{className:"h-[168px] w-full rounded-2xl"}),(0,u.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8 lg:gap-10",children:[(0,u.jsx)(eE,{className:"h-[230px] w-full rounded-xl"}),(0,u.jsx)(eE,{className:"h-[230px] w-full rounded-xl"}),(0,u.jsx)(eE,{className:"h-[180px] w-full rounded-xl"}),(0,u.jsx)(eE,{className:"h-[180px] w-full rounded-xl"})]})]});let{dashboardWidgets:l}=r,c=e[o_(o)],d=c?.goals?.filter(e=>!e.completed).slice(0,3)||[],p=c?.goals?.length||0,f=c?.goals?.filter(e=>e.completed).length||0;return(0,u.jsxs)("div",{className:"space-y-8 lg:space-y-10 animate-in fade-in-0 duration-750",children:[(0,u.jsx)(ex,{}),(0,u.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8 lg:gap-10",children:[l?.planner&&(0,u.jsx)(ek,{todaysGoals:d,selectedDate:o,onNavigate:s,totalGoalsToday:p,completedGoalsToday:f}),l?.affirmations&&(0,u.jsx)(o$,{profileData:r,onUpdateProfile:i,onNavigate:s}),l?.medication&&(0,u.jsx)(eN,{medicationsCount:t.length,medicationGroupsCount:n.length,onNavigate:s}),l?.copingMechanisms&&(0,u.jsx)(eT,{copingMechanisms:r.copingMechanisms,onNavigate:s})]})]})},oB=(0,K.A)("File",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}]]),oW=(0,K.A)("Mic",[["path",{d:"M12 2a3 3 0 0 0-3 3v7a3 3 0 0 0 6 0V5a3 3 0 0 0-3-3Z",key:"131961"}],["path",{d:"M19 10v2a7 7 0 0 1-14 0v-2",key:"1vc78b"}],["line",{x1:"12",x2:"12",y1:"19",y2:"22",key:"x3vr5v"}]]),oq=(0,K.A)("Save",[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]]),oH=void 0,oU=({onTranscriptUpdate:e,onAudioRecorded:t,lang:n="en-US"})=>{let[r,i]=(0,h.useState)(!1),[s,o]=(0,h.useState)(null),a=(0,h.useRef)(null),l=(0,h.useRef)(null),c=(0,h.useRef)([]),d=(0,h.useRef)(null),u=(0,h.useRef)(null),p=!!oH&&!!navigator.mediaDevices&&!!navigator.mediaDevices.getUserMedia,f=(0,h.useCallback)(()=>{if(d.current&&(d.current.getTracks().forEach(e=>e.stop()),d.current=null),l.current&&"inactive"!==l.current.state)try{l.current.stop()}catch(e){}if(l.current=null,a.current)try{a.current.stop()}catch(e){}a.current=null,c.current=[],u.current&&(u.current.abort(),u.current=null)},[]);(0,h.useEffect)(()=>()=>{f()},[f]);let m=()=>{oH&&(a.current=new oH,a.current.continuous=!0,a.current.interimResults=!0,a.current.lang=n,a.current.onresult=t=>{let n="",r="";for(let e=t.resultIndex;e<t.results.length;++e)t.results[e].isFinal?r+=t.results[e][0].transcript:n+=t.results[e][0].transcript;r&&e(r,!0),n&&e(n,!1)},a.current.onerror=e=>{console.error("Speech recognition error:",e.error,e.message),o(`Speech error: ${e.error}. ${e.message||"Check console."}`)})},g=e=>{let n={mimeType:"audio/webm"};!MediaRecorder.isTypeSupported(n.mimeType)&&(n={mimeType:"audio/ogg; codecs=opus"},MediaRecorder.isTypeSupported(n.mimeType)||(n={mimeType:""})),l.current=new MediaRecorder(e,n.mimeType?n:void 0),c.current=[],l.current.ondataavailable=e=>{e.data.size>0&&c.current.push(e.data)},l.current.onstop=()=>{if(c.current.length>0&&t){let e=new Blob(c.current,{type:l.current?.mimeType||"audio/webm"}),n=new FileReader;u.current=n,n.onloadend=()=>{u.current===n&&(t&&t(n.result),u.current=null)},n.onerror=e=>{console.error("FileReader error:",e),o("Failed to process recorded audio."),u.current=null},n.onabort=()=>{console.log("Audio processing cancelled."),o(null),u.current=null},n.readAsDataURL(e)}c.current=[]},l.current.onerror=e=>{console.error("MediaRecorder error:",e),o("Audio recording error. Check console.")}},y=(0,h.useCallback)(async()=>{if(f(),!p)return void o("Speech or media recording is not supported.");if(!r){o(null);try{d.current=await navigator.mediaDevices.getUserMedia({audio:!0}),m(),t&&g(d.current),a.current&&a.current.start(),l.current&&l.current.start(),i(!0)}catch(e){console.error("Error starting recording:",e),"NotAllowedError"===e.name||"PermissionDeniedError"===e.name?o("Microphone access denied. Please allow permissions."):"NotFoundError"===e.name||"DevicesNotFoundError"===e.name?o("No microphone found. Please connect a microphone."):o(`Mic/Setup error: ${e.message||"Unknown error"}`),f(),i(!1)}}},[r,p,n,e,t,f]),x=(0,h.useCallback)(()=>{r&&(f(),i(!1))},[r,f]);return{isRecording:r,startRecording:y,stopRecording:x,cancelProcessing:(0,h.useCallback)(()=>{u.current&&u.current.abort()},[]),speechError:s,isSpeechSupported:p}},oK=({onSave:e,onClose:t,initialEntry:n})=>{let[r,i]=(0,h.useState)(""),[s,o]=(0,h.useState)(void 0),[a,l]=(0,h.useState)("Ready to record"),[c,d]=(0,h.useState)(!1),p=(0,h.useRef)(null),{isRecording:f,startRecording:m,stopRecording:g,cancelProcessing:y,speechError:x,isSpeechSupported:v}=oU({onTranscriptUpdate:(0,h.useCallback)((e,t)=>{p.current&&t&&(p.current.classList.contains("placeholder-active")&&(p.current.textContent="",p.current.classList.remove("placeholder-active")),p.current.textContent&&!p.current.textContent.endsWith(" ")&&(p.current.textContent+=" "),p.current.textContent+=e.trim()+" ")},[]),onAudioRecorded:e=>{o(e),d(!1)}});(0,h.useEffect)(()=>{n?(i(n.title||""),o(n.audioBase64DataUrl),p.current&&(p.current.innerHTML=n.text||"",p.current.textContent?.trim()&&p.current.classList.remove("placeholder-active"))):(i(""),o(void 0),p.current&&(p.current.innerHTML="",p.current.classList.add("placeholder-active")))},[n]);let b=()=>{f?(d(!0),g()):m()},w=()=>{y(),d(!1)};return(0,h.useEffect)(()=>{v?x?(l(x),d(!1)):f?(l("Recording... Speak now."),d(!1)):c?l("Processing..."):l("Ready to record"):l("Speech recognition not supported by your browser.")},[f,c,x,v]),(0,u.jsxs)("div",{className:"flex flex-col h-full bg-surface",children:[(0,u.jsxs)("div",{className:"flex-shrink-0 flex items-center justify-between p-4 border-b border-outline-variant md:max-w-3xl md:mx-auto md:w-full",children:[(0,u.jsx)("input",{type:"text",value:r,onChange:e=>i(e.target.value),placeholder:"Untitled Note",className:"flex-grow bg-transparent text-headline-sm font-serif text-surface-on focus:outline-none"}),(0,u.jsx)(Q,{onClick:t,variant:"text",size:"sm",isIconOnly:!0,"aria-label":"Close",children:(0,u.jsx)(eu.A,{className:"h-6 w-6"})})]}),(0,u.jsxs)("div",{className:"flex-grow flex flex-col min-h-0 md:max-w-3xl md:mx-auto md:w-full",children:[(0,u.jsx)("div",{className:"flex-grow p-4 md:p-6 overflow-y-auto min-h-0",children:(0,u.jsx)("div",{ref:p,contentEditable:!0,className:"prose prose-sm sm:prose-base dark:prose-invert max-w-none focus:outline-none h-full placeholder-active:text-surface-on-variant/80","data-placeholder":"Start typing or use the microphone to dictate your thoughts...",onInput:e=>{let t=e.currentTarget;t.textContent?.trim()?t.classList.remove("placeholder-active"):t.classList.add("placeholder-active")}})}),(0,u.jsxs)("div",{className:"flex-shrink-0 flex flex-col items-center justify-center p-4 border-t border-outline-variant space-y-3",children:[(0,u.jsx)("div",{className:"text-label-md text-surface-on-variant h-4",children:a}),(0,u.jsxs)("div",{className:"flex items-center justify-center gap-6",children:[(0,u.jsx)(Q,{onClick:()=>{i(""),p.current&&(p.current.innerHTML="",p.current.classList.add("placeholder-active")),o(void 0),f&&g(),d(!1),l("Ready to record")},variant:"tonal",size:"md",isIconOnly:!0,title:"New Note / Clear",children:(0,u.jsx)(oB,{className:"w-5 h-5"})}),(0,u.jsxs)("button",{onClick:()=>{c?w():b()},disabled:!v,className:(0,X.cn)("relative w-20 h-20 rounded-full flex items-center justify-center transition-all duration-300","bg-surface-container border border-outline-variant shadow-lg hover:scale-105",(f||c)&&"bg-destructive border-transparent",!v&&"opacity-50 cursor-not-allowed"),"aria-label":c?"Cancel Processing":f?"Stop Recording":"Start Recording",children:[(0,u.jsxs)("div",{className:(0,X.cn)(f||c?"text-white":"text-surface-on"),children:[(0,u.jsx)(oW,{className:(0,X.cn)("w-8 h-8 transition-opacity duration-300",f||c?"opacity-0":"opacity-100")}),(0,u.jsx)("div",{className:(0,X.cn)("absolute inset-0 flex items-center justify-center transition-opacity duration-300",f?"opacity-100":"opacity-0"),children:(0,u.jsx)("div",{className:"w-6 h-6 bg-white rounded-sm"})}),(0,u.jsx)("div",{className:(0,X.cn)("absolute inset-0 flex items-center justify-center transition-opacity duration-300",c?"opacity-100":"opacity-0"),children:(0,u.jsx)(eu.A,{className:"w-8 h-8"})})]}),f&&(0,u.jsx)("div",{className:"absolute inset-0 flex items-center justify-center pointer-events-none",children:(0,u.jsxs)("svg",{className:"w-48 h-48",viewBox:"0 0 200 200",children:[(0,u.jsx)("circle",{className:"wave animate-wave",cx:"100",cy:"100",r:"40"}),(0,u.jsx)("circle",{className:"wave animate-wave [animation-delay:0.4s]",cx:"100",cy:"100",r:"70"}),(0,u.jsx)("circle",{className:"wave animate-wave [animation-delay:0.8s]",cx:"100",cy:"100",r:"100"})]})})]}),(0,u.jsx)(Q,{onClick:()=>{e({title:r.trim()||`Journal Entry - ${new Date().toLocaleDateString()}`,text:p.current?.innerHTML||"",audioBase64DataUrl:s})},variant:"filled",size:"md",isIconOnly:!0,title:"Save Note",children:(0,u.jsx)(oq,{className:"w-5 h-5"})})]})]})]})]})},oJ=(0,K.A)("CirclePlay",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polygon",{points:"10 8 16 12 10 16 10 8",key:"1cimsy"}]]),oG=(0,K.A)("Pen",[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]]),oY=(0,K.A)("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]),oX=({entry:e,onView:t,onEdit:n,onDelete:r,isPlaceholder:i=!1})=>{let s=i?"Just now":new Date(e.timestamp).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"}),o=e.text.replace(/<[^>]+>/g,""),a=o.length>200?o.substring(0,200)+"...":o;return(0,u.jsxs)("div",{className:"bg-surface-container-low shadow-lg rounded-xl transition-all duration-300 hover:shadow-xl flex items-stretch w-full",children:[(0,u.jsxs)("div",{onClick:()=>!i&&t(e),className:"flex-grow p-5 sm:p-6 cursor-pointer","aria-label":`View entry: ${e.title||"Journal Entry"}`,children:[(0,u.jsx)("h3",{className:"font-serif text-title-lg text-surface-on mb-0.5 break-words",children:e.title}),(0,u.jsx)("p",{className:"text-label-md text-surface-on-variant",children:s}),e.audioBase64DataUrl&&(0,u.jsxs)("div",{className:"flex items-center gap-2 mt-3 text-primary",children:[(0,u.jsx)(oJ,{className:"w-4 h-4"}),(0,u.jsx)("span",{className:"text-label-md",children:"Audio entry attached"})]}),o.trim()&&(0,u.jsx)("div",{className:"text-body-md text-surface-on max-w-none mt-2 break-words",children:a}),!o.trim()&&e.audioBase64DataUrl&&(0,u.jsx)("p",{className:"text-label-md text-surface-on-variant italic mt-2",children:"This entry primarily contains audio."})]}),!i&&(0,u.jsxs)("div",{className:"flex flex-col items-center justify-center space-y-2 p-2 border-l border-outline-variant/30",children:[(0,u.jsx)(Q,{onClick:t=>{t.stopPropagation(),n(e)},variant:"text",size:"sm",isIconOnly:!0,title:"Edit Entry",className:"text-surface-on-variant hover:bg-surface-on-variant/10","aria-label":"Edit this journal entry",children:(0,u.jsx)(oG,{className:"w-5 h-5"})}),(0,u.jsx)(Q,{onClick:t=>{t.stopPropagation(),r(e.id)},variant:"text",size:"sm",isIconOnly:!0,title:"Delete Entry",className:"text-error hover:bg-error-container/20","aria-label":"Delete this journal entry",children:(0,u.jsx)(oY,{className:"w-5 h-5"})})]})]})},oZ=({entries:e,onViewEntry:t,onEdit:n,onDelete:r})=>{if(0===e.length){let e={id:"placeholder",timestamp:Date.now(),title:"Your First Entry Awaits",text:"This is where your journal entries will appear. Click the '+' button below to capture your thoughts, reflections, and daily moments."};return(0,u.jsx)("div",{className:"flex flex-col items-center justify-center text-center py-8 animate-in fade-in-0 duration-1000",children:(0,u.jsx)("div",{className:"max-w-2xl w-full",children:(0,u.jsx)(oX,{entry:e,onView:()=>{},onEdit:()=>{},onDelete:()=>{},isPlaceholder:!0})})})}return(0,u.jsx)("div",{className:"space-y-6 max-w-2xl w-full",children:e.map(e=>(0,u.jsx)(oX,{entry:e,onView:t,onEdit:n,onDelete:r},e.id))})};var oQ=n(569),o0=n(8599),o1=n(1273),o2=n(6156),o4=p["useId".toString()]||(()=>void 0),o3=0;function o5(e){let[t,n]=h.useState(o4());return(0,o2.N)(()=>{e||n(e=>e??String(o3++))},[e]),e||(t?`radix-${t}`:"")}var o6=n(5551),o8=n(1355),o9=n(3416),o7=n(3495),ae="focusScope.autoFocusOnMount",at="focusScope.autoFocusOnUnmount",an={bubbles:!1,cancelable:!0},ar=h.forwardRef((e,t)=>{let{loop:n=!1,trapped:r=!1,onMountAutoFocus:i,onUnmountAutoFocus:s,...o}=e,[a,l]=h.useState(null),c=(0,o7.c)(i),d=(0,o7.c)(s),p=h.useRef(null),f=(0,o0.s)(t,e=>l(e)),m=h.useRef({paused:!1,pause(){this.paused=!0},resume(){this.paused=!1}}).current;h.useEffect(()=>{if(r){let e=function(e){if(m.paused||!a)return;let t=e.target;a.contains(t)?p.current=t:ao(p.current,{select:!0})},t=function(e){if(m.paused||!a)return;let t=e.relatedTarget;null!==t&&(a.contains(t)||ao(p.current,{select:!0}))};document.addEventListener("focusin",e),document.addEventListener("focusout",t);let n=new MutationObserver(function(e){if(document.activeElement===document.body)for(let t of e)t.removedNodes.length>0&&ao(a)});return a&&n.observe(a,{childList:!0,subtree:!0}),()=>{document.removeEventListener("focusin",e),document.removeEventListener("focusout",t),n.disconnect()}}},[r,a,m.paused]),h.useEffect(()=>{if(a){aa.add(m);let e=document.activeElement;if(!a.contains(e)){let t=new CustomEvent(ae,an);a.addEventListener(ae,c),a.dispatchEvent(t),t.defaultPrevented||(function(e,{select:t=!1}={}){let n=document.activeElement;for(let r of e)if(ao(r,{select:t}),document.activeElement!==n)return}(ai(a).filter(e=>"A"!==e.tagName),{select:!0}),document.activeElement===e&&ao(a))}return()=>{a.removeEventListener(ae,c),setTimeout(()=>{let t=new CustomEvent(at,an);a.addEventListener(at,d),a.dispatchEvent(t),t.defaultPrevented||ao(e??document.body,{select:!0}),a.removeEventListener(at,d),aa.remove(m)},0)}}},[a,c,d,m]);let g=h.useCallback(e=>{if(!n&&!r||m.paused)return;let t="Tab"===e.key&&!e.altKey&&!e.ctrlKey&&!e.metaKey,i=document.activeElement;if(t&&i){let t=e.currentTarget,[r,s]=function(e){let t=ai(e);return[as(t,e),as(t.reverse(),e)]}(t);r&&s?e.shiftKey||i!==s?e.shiftKey&&i===r&&(e.preventDefault(),n&&ao(s,{select:!0})):(e.preventDefault(),n&&ao(r,{select:!0})):i===t&&e.preventDefault()}},[n,r,m.paused]);return(0,u.jsx)(o9.sG.div,{tabIndex:-1,...o,ref:f,onKeyDown:g})});function ai(e){let t=[],n=document.createTreeWalker(e,NodeFilter.SHOW_ELEMENT,{acceptNode:e=>{let t="INPUT"===e.tagName&&"hidden"===e.type;return e.disabled||e.hidden||t?NodeFilter.FILTER_SKIP:e.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;n.nextNode();)t.push(n.currentNode);return t}function as(e,t){for(let n of e)if(!function(e,{upTo:t}){if("hidden"===getComputedStyle(e).visibility)return!0;for(;e&&(void 0===t||e!==t);){if("none"===getComputedStyle(e).display)return!0;e=e.parentElement}return!1}(n,{upTo:t}))return n}function ao(e,{select:t=!1}={}){if(e&&e.focus){var n;let r=document.activeElement;e.focus({preventScroll:!0}),e!==r&&(n=e)instanceof HTMLInputElement&&"select"in n&&t&&e.select()}}ar.displayName="FocusScope";var aa=function(){let e=[];return{add(t){let n=e[0];t!==n&&n?.pause(),(e=al(e,t)).unshift(t)},remove(t){e=al(e,t),e[0]?.resume()}}}();function al(e,t){let n=[...e],r=n.indexOf(t);return -1!==r&&n.splice(r,1),n}var ac=n(5028),ad=n(6059),au=0;function ah(){let e=document.createElement("span");return e.setAttribute("data-radix-focus-guard",""),e.tabIndex=0,e.style.outline="none",e.style.opacity="0",e.style.position="fixed",e.style.pointerEvents="none",e}var ap=function(){return(ap=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};function af(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&0>t.indexOf(r)&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols)for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)0>t.indexOf(r[i])&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n}Object.create;Object.create;var am=("function"==typeof SuppressedError&&SuppressedError,"right-scroll-bar-position"),ag="width-before-scroll-bar";function ay(e,t){return"function"==typeof e?e(t):e&&(e.current=t),e}var ax="undefined"!=typeof window?h.useLayoutEffect:h.useEffect,av=new WeakMap;function ab(e){return e}var aw=function(e){void 0===e&&(e={});var t,n,r,i,s=(t=null,void 0===n&&(n=ab),r=[],i=!1,{read:function(){if(i)throw Error("Sidecar: could not `read` from an `assigned` medium. `read` could be used only with `useMedium`.");return r.length?r[r.length-1]:null},useMedium:function(e){var t=n(e,i);return r.push(t),function(){r=r.filter(function(e){return e!==t})}},assignSyncMedium:function(e){for(i=!0;r.length;){var t=r;r=[],t.forEach(e)}r={push:function(t){return e(t)},filter:function(){return r}}},assignMedium:function(e){i=!0;var t=[];if(r.length){var n=r;r=[],n.forEach(e),t=r}var s=function(){var n=t;t=[],n.forEach(e)},o=function(){return Promise.resolve().then(s)};o(),r={push:function(e){t.push(e),o()},filter:function(e){return t=t.filter(e),r}}}});return s.options=ap({async:!0,ssr:!1},e),s}(),ak=function(){},aj=h.forwardRef(function(e,t){var n,r,i,s,o=h.useRef(null),a=h.useState({onScrollCapture:ak,onWheelCapture:ak,onTouchMoveCapture:ak}),l=a[0],c=a[1],d=e.forwardProps,u=e.children,p=e.className,f=e.removeScrollBar,m=e.enabled,g=e.shards,y=e.sideCar,x=e.noIsolation,v=e.inert,b=e.allowPinchZoom,w=e.as,k=e.gapMode,j=af(e,["forwardProps","children","className","removeScrollBar","enabled","shards","sideCar","noIsolation","inert","allowPinchZoom","as","gapMode"]),N=(n=[o,t],r=function(e){return n.forEach(function(t){return ay(t,e)})},(i=(0,h.useState)(function(){return{value:null,callback:r,facade:{get current(){return i.value},set current(value){var e=i.value;e!==value&&(i.value=value,i.callback(value,e))}}}})[0]).callback=r,s=i.facade,ax(function(){var e=av.get(s);if(e){var t=new Set(e),r=new Set(n),i=s.current;t.forEach(function(e){r.has(e)||ay(e,null)}),r.forEach(function(e){t.has(e)||ay(e,i)})}av.set(s,n)},[n]),s),S=ap(ap({},j),l);return h.createElement(h.Fragment,null,m&&h.createElement(y,{sideCar:aw,removeScrollBar:f,shards:g,noIsolation:x,inert:v,setCallbacks:c,allowPinchZoom:!!b,lockRef:o,gapMode:k}),d?h.cloneElement(h.Children.only(u),ap(ap({},S),{ref:N})):h.createElement(void 0===w?"div":w,ap({},S,{className:p,ref:N}),u))});aj.defaultProps={enabled:!0,removeScrollBar:!0,inert:!1},aj.classNames={fullWidth:ag,zeroRight:am};var aN=function(e){var t=e.sideCar,n=af(e,["sideCar"]);if(!t)throw Error("Sidecar: please provide `sideCar` property to import the right car");var r=t.read();if(!r)throw Error("Sidecar medium not found");return h.createElement(r,ap({},n))};aN.isSideCarExport=!0;var aS=function(){var e=0,t=null;return{add:function(r){if(0==e&&(t=function(){if(!document)return null;var e=document.createElement("style");e.type="text/css";var t=l||n.nc;return t&&e.setAttribute("nonce",t),e}())){var i,s;(i=t).styleSheet?i.styleSheet.cssText=r:i.appendChild(document.createTextNode(r)),s=t,(document.head||document.getElementsByTagName("head")[0]).appendChild(s)}e++},remove:function(){--e||!t||(t.parentNode&&t.parentNode.removeChild(t),t=null)}}},aC=function(){var e=aS();return function(t,n){h.useEffect(function(){return e.add(t),function(){e.remove()}},[t&&n])}},aM=function(){var e=aC();return function(t){return e(t.styles,t.dynamic),null}},aE={left:0,top:0,right:0,gap:0},aT=function(e){return parseInt(e||"",10)||0},aA=function(e){var t=window.getComputedStyle(document.body),n=t["padding"===e?"paddingLeft":"marginLeft"],r=t["padding"===e?"paddingTop":"marginTop"],i=t["padding"===e?"paddingRight":"marginRight"];return[aT(n),aT(r),aT(i)]},aD=function(e){if(void 0===e&&(e="margin"),"undefined"==typeof window)return aE;var t=aA(e),n=document.documentElement.clientWidth,r=window.innerWidth;return{left:t[0],top:t[1],right:t[2],gap:Math.max(0,r-n+t[2]-t[0])}},aO=aM(),aR="data-scroll-locked",aP=function(e,t,n,r){var i=e.left,s=e.top,o=e.right,a=e.gap;return void 0===n&&(n="margin"),"\n  .".concat("with-scroll-bars-hidden"," {\n   overflow: hidden ").concat(r,";\n   padding-right: ").concat(a,"px ").concat(r,";\n  }\n  body[").concat(aR,"] {\n    overflow: hidden ").concat(r,";\n    overscroll-behavior: contain;\n    ").concat([t&&"position: relative ".concat(r,";"),"margin"===n&&"\n    padding-left: ".concat(i,"px;\n    padding-top: ").concat(s,"px;\n    padding-right: ").concat(o,"px;\n    margin-left:0;\n    margin-top:0;\n    margin-right: ").concat(a,"px ").concat(r,";\n    "),"padding"===n&&"padding-right: ".concat(a,"px ").concat(r,";")].filter(Boolean).join(""),"\n  }\n  \n  .").concat(am," {\n    right: ").concat(a,"px ").concat(r,";\n  }\n  \n  .").concat(ag," {\n    margin-right: ").concat(a,"px ").concat(r,";\n  }\n  \n  .").concat(am," .").concat(am," {\n    right: 0 ").concat(r,";\n  }\n  \n  .").concat(ag," .").concat(ag," {\n    margin-right: 0 ").concat(r,";\n  }\n  \n  body[").concat(aR,"] {\n    ").concat("--removed-body-scroll-bar-size",": ").concat(a,"px;\n  }\n")},aI=function(){var e=parseInt(document.body.getAttribute(aR)||"0",10);return isFinite(e)?e:0},aL=function(){h.useEffect(function(){return document.body.setAttribute(aR,(aI()+1).toString()),function(){var e=aI()-1;e<=0?document.body.removeAttribute(aR):document.body.setAttribute(aR,e.toString())}},[])},az=function(e){var t=e.noRelative,n=e.noImportant,r=e.gapMode,i=void 0===r?"margin":r;aL();var s=h.useMemo(function(){return aD(i)},[i]);return h.createElement(aO,{styles:aP(s,!t,i,n?"":"!important")})},aV=!1;if("undefined"!=typeof window)try{var a$=Object.defineProperty({},"passive",{get:function(){return aV=!0,!0}});window.addEventListener("test",a$,a$),window.removeEventListener("test",a$,a$)}catch(e){aV=!1}var a_=!!aV&&{passive:!1},aF=function(e,t){if(!(e instanceof Element))return!1;var n=window.getComputedStyle(e);return"hidden"!==n[t]&&(n.overflowY!==n.overflowX||"TEXTAREA"===e.tagName||"visible"!==n[t])},aB=function(e,t){var n=t.ownerDocument,r=t;do{if("undefined"!=typeof ShadowRoot&&r instanceof ShadowRoot&&(r=r.host),aW(e,r)){var i=aq(e,r);if(i[1]>i[2])return!0}r=r.parentNode}while(r&&r!==n.body);return!1},aW=function(e,t){return"v"===e?aF(t,"overflowY"):aF(t,"overflowX")},aq=function(e,t){return"v"===e?[t.scrollTop,t.scrollHeight,t.clientHeight]:[t.scrollLeft,t.scrollWidth,t.clientWidth]},aH=function(e,t,n,r,i){var s,o=(s=window.getComputedStyle(t).direction,"h"===e&&"rtl"===s?-1:1),a=o*r,l=n.target,c=t.contains(l),d=!1,u=a>0,h=0,p=0;do{var f=aq(e,l),m=f[0],g=f[1]-f[2]-o*m;(m||g)&&aW(e,l)&&(h+=g,p+=m),l=l instanceof ShadowRoot?l.host:l.parentNode}while(!c&&l!==document.body||c&&(t.contains(l)||t===l));return u&&(i&&1>Math.abs(h)||!i&&a>h)?d=!0:!u&&(i&&1>Math.abs(p)||!i&&-a>p)&&(d=!0),d},aU=function(e){return"changedTouches"in e?[e.changedTouches[0].clientX,e.changedTouches[0].clientY]:[0,0]},aK=function(e){return[e.deltaX,e.deltaY]},aJ=function(e){return e&&"current"in e?e.current:e},aG=0,aY=[];let aX=(a=function(e){var t=h.useRef([]),n=h.useRef([0,0]),r=h.useRef(),i=h.useState(aG++)[0],s=h.useState(aM)[0],o=h.useRef(e);h.useEffect(function(){o.current=e},[e]),h.useEffect(function(){if(e.inert){document.body.classList.add("block-interactivity-".concat(i));var t=(function(e,t,n){if(n||2==arguments.length)for(var r,i=0,s=t.length;i<s;i++)!r&&i in t||(r||(r=Array.prototype.slice.call(t,0,i)),r[i]=t[i]);return e.concat(r||Array.prototype.slice.call(t))})([e.lockRef.current],(e.shards||[]).map(aJ),!0).filter(Boolean);return t.forEach(function(e){return e.classList.add("allow-interactivity-".concat(i))}),function(){document.body.classList.remove("block-interactivity-".concat(i)),t.forEach(function(e){return e.classList.remove("allow-interactivity-".concat(i))})}}},[e.inert,e.lockRef.current,e.shards]);var a=h.useCallback(function(e,t){if("touches"in e&&2===e.touches.length||"wheel"===e.type&&e.ctrlKey)return!o.current.allowPinchZoom;var i,s=aU(e),a=n.current,l="deltaX"in e?e.deltaX:a[0]-s[0],c="deltaY"in e?e.deltaY:a[1]-s[1],d=e.target,u=Math.abs(l)>Math.abs(c)?"h":"v";if("touches"in e&&"h"===u&&"range"===d.type)return!1;var h=aB(u,d);if(!h)return!0;if(h?i=u:(i="v"===u?"h":"v",h=aB(u,d)),!h)return!1;if(!r.current&&"changedTouches"in e&&(l||c)&&(r.current=i),!i)return!0;var p=r.current||i;return aH(p,t,e,"h"===p?l:c,!0)},[]),l=h.useCallback(function(e){if(aY.length&&aY[aY.length-1]===s){var n="deltaY"in e?aK(e):aU(e),r=t.current.filter(function(t){var r;return t.name===e.type&&(t.target===e.target||e.target===t.shadowParent)&&(r=t.delta,r[0]===n[0]&&r[1]===n[1])})[0];if(r&&r.should){e.cancelable&&e.preventDefault();return}if(!r){var i=(o.current.shards||[]).map(aJ).filter(Boolean).filter(function(t){return t.contains(e.target)});(i.length>0?a(e,i[0]):!o.current.noIsolation)&&e.cancelable&&e.preventDefault()}}},[]),c=h.useCallback(function(e,n,r,i){var s={name:e,delta:n,target:r,should:i,shadowParent:function(e){for(var t=null;null!==e;)e instanceof ShadowRoot&&(t=e.host,e=e.host),e=e.parentNode;return t}(r)};t.current.push(s),setTimeout(function(){t.current=t.current.filter(function(e){return e!==s})},1)},[]),d=h.useCallback(function(e){n.current=aU(e),r.current=void 0},[]),u=h.useCallback(function(t){c(t.type,aK(t),t.target,a(t,e.lockRef.current))},[]),p=h.useCallback(function(t){c(t.type,aU(t),t.target,a(t,e.lockRef.current))},[]);h.useEffect(function(){return aY.push(s),e.setCallbacks({onScrollCapture:u,onWheelCapture:u,onTouchMoveCapture:p}),document.addEventListener("wheel",l,a_),document.addEventListener("touchmove",l,a_),document.addEventListener("touchstart",d,a_),function(){aY=aY.filter(function(e){return e!==s}),document.removeEventListener("wheel",l,a_),document.removeEventListener("touchmove",l,a_),document.removeEventListener("touchstart",d,a_)}},[]);var f=e.removeScrollBar,m=e.inert;return h.createElement(h.Fragment,null,m?h.createElement(s,{styles:"\n  .block-interactivity-".concat(i," {pointer-events: none;}\n  .allow-interactivity-").concat(i," {pointer-events: all;}\n")}):null,f?h.createElement(az,{gapMode:e.gapMode}):null)},aw.useMedium(a),aN);var aZ=h.forwardRef(function(e,t){return h.createElement(aj,ap({},e,{ref:t,sideCar:aX}))});aZ.classNames=aj.classNames;var aQ=function(e){return"undefined"==typeof document?null:(Array.isArray(e)?e[0]:e).ownerDocument.body},a0=new WeakMap,a1=new WeakMap,a2={},a4=0,a3=function(e){return e&&(e.host||a3(e.parentNode))},a5=function(e,t,n,r){var i=(Array.isArray(e)?e:[e]).map(function(e){if(t.contains(e))return e;var n=a3(e);return n&&t.contains(n)?n:(console.error("aria-hidden",e,"in not contained inside",t,". Doing nothing"),null)}).filter(function(e){return!!e});a2[n]||(a2[n]=new WeakMap);var s=a2[n],o=[],a=new Set,l=new Set(i),c=function(e){!e||a.has(e)||(a.add(e),c(e.parentNode))};i.forEach(c);var d=function(e){!e||l.has(e)||Array.prototype.forEach.call(e.children,function(e){if(a.has(e))d(e);else try{var t=e.getAttribute(r),i=null!==t&&"false"!==t,l=(a0.get(e)||0)+1,c=(s.get(e)||0)+1;a0.set(e,l),s.set(e,c),o.push(e),1===l&&i&&a1.set(e,!0),1===c&&e.setAttribute(n,"true"),i||e.setAttribute(r,"true")}catch(t){console.error("aria-hidden: cannot operate on ",e,t)}})};return d(t),a.clear(),a4++,function(){o.forEach(function(e){var t=a0.get(e)-1,i=s.get(e)-1;a0.set(e,t),s.set(e,i),t||(a1.has(e)||e.removeAttribute(r),a1.delete(e)),i||e.removeAttribute(n)}),--a4||(a0=new WeakMap,a0=new WeakMap,a1=new WeakMap,a2={})}},a6=function(e,t,n){void 0===n&&(n="data-aria-hidden");var r=Array.from(Array.isArray(e)?e:[e]),i=t||aQ(e);return i?(r.push.apply(r,Array.from(i.querySelectorAll("[aria-live]"))),a5(r,i,n,"aria-hidden")):function(){return null}},a8=h.forwardRef((e,t)=>{let{children:n,...r}=e,i=h.Children.toArray(n),s=i.find(le);if(s){let e=s.props.children,n=i.map(t=>t!==s?t:h.Children.count(e)>1?h.Children.only(null):h.isValidElement(e)?e.props.children:null);return(0,u.jsx)(a9,{...r,ref:t,children:h.isValidElement(e)?h.cloneElement(e,void 0,n):null})}return(0,u.jsx)(a9,{...r,ref:t,children:n})});a8.displayName="Slot";var a9=h.forwardRef((e,t)=>{let{children:n,...r}=e;if(h.isValidElement(n)){let e=function(e){let t=Object.getOwnPropertyDescriptor(e.props,"ref")?.get,n=t&&"isReactWarning"in t&&t.isReactWarning;return n?e.ref:(n=(t=Object.getOwnPropertyDescriptor(e,"ref")?.get)&&"isReactWarning"in t&&t.isReactWarning)?e.props.ref:e.props.ref||e.ref}(n),i=function(e,t){let n={...t};for(let r in t){let i=e[r],s=t[r];/^on[A-Z]/.test(r)?i&&s?n[r]=(...e)=>{s(...e),i(...e)}:i&&(n[r]=i):"style"===r?n[r]={...i,...s}:"className"===r&&(n[r]=[i,s].filter(Boolean).join(" "))}return{...e,...n}}(r,n.props);return n.type!==h.Fragment&&(i.ref=t?(0,o0.t)(t,e):e),h.cloneElement(n,i)}return h.Children.count(n)>1?h.Children.only(null):null});a9.displayName="SlotClone";var a7=({children:e})=>(0,u.jsx)(u.Fragment,{children:e});function le(e){return h.isValidElement(e)&&e.type===a7}var lt="Dialog",[ln,lr]=(0,o1.A)(lt),[li,ls]=ln(lt),lo=e=>{let{__scopeDialog:t,children:n,open:r,defaultOpen:i,onOpenChange:s,modal:o=!0}=e,a=h.useRef(null),l=h.useRef(null),[c=!1,d]=(0,o6.i)({prop:r,defaultProp:i,onChange:s});return(0,u.jsx)(li,{scope:t,triggerRef:a,contentRef:l,contentId:o5(),titleId:o5(),descriptionId:o5(),open:c,onOpenChange:d,onOpenToggle:h.useCallback(()=>d(e=>!e),[d]),modal:o,children:n})};lo.displayName=lt;var la="DialogTrigger";h.forwardRef((e,t)=>{let{__scopeDialog:n,...r}=e,i=ls(la,n),s=(0,o0.s)(t,i.triggerRef);return(0,u.jsx)(o9.sG.button,{type:"button","aria-haspopup":"dialog","aria-expanded":i.open,"aria-controls":i.contentId,"data-state":lC(i.open),...r,ref:s,onClick:(0,oQ.m)(e.onClick,i.onOpenToggle)})}).displayName=la;var ll="DialogPortal",[lc,ld]=ln(ll,{forceMount:void 0}),lu=e=>{let{__scopeDialog:t,forceMount:n,children:r,container:i}=e,s=ls(ll,t);return(0,u.jsx)(lc,{scope:t,forceMount:n,children:h.Children.map(r,e=>(0,u.jsx)(ad.C,{present:n||s.open,children:(0,u.jsx)(ac.Z,{asChild:!0,container:i,children:e})}))})};lu.displayName=ll;var lh="DialogOverlay",lp=h.forwardRef((e,t)=>{let n=ld(lh,e.__scopeDialog),{forceMount:r=n.forceMount,...i}=e,s=ls(lh,e.__scopeDialog);return s.modal?(0,u.jsx)(ad.C,{present:r||s.open,children:(0,u.jsx)(lf,{...i,ref:t})}):null});lp.displayName=lh;var lf=h.forwardRef((e,t)=>{let{__scopeDialog:n,...r}=e,i=ls(lh,n);return(0,u.jsx)(aZ,{as:a8,allowPinchZoom:!0,shards:[i.contentRef],children:(0,u.jsx)(o9.sG.div,{"data-state":lC(i.open),...r,ref:t,style:{pointerEvents:"auto",...r.style}})})}),lm="DialogContent",lg=h.forwardRef((e,t)=>{let n=ld(lm,e.__scopeDialog),{forceMount:r=n.forceMount,...i}=e,s=ls(lm,e.__scopeDialog);return(0,u.jsx)(ad.C,{present:r||s.open,children:s.modal?(0,u.jsx)(ly,{...i,ref:t}):(0,u.jsx)(lx,{...i,ref:t})})});lg.displayName=lm;var ly=h.forwardRef((e,t)=>{let n=ls(lm,e.__scopeDialog),r=h.useRef(null),i=(0,o0.s)(t,n.contentRef,r);return h.useEffect(()=>{let e=r.current;if(e)return a6(e)},[]),(0,u.jsx)(lv,{...e,ref:i,trapFocus:n.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:(0,oQ.m)(e.onCloseAutoFocus,e=>{e.preventDefault(),n.triggerRef.current?.focus()}),onPointerDownOutside:(0,oQ.m)(e.onPointerDownOutside,e=>{let t=e.detail.originalEvent,n=0===t.button&&!0===t.ctrlKey;(2===t.button||n)&&e.preventDefault()}),onFocusOutside:(0,oQ.m)(e.onFocusOutside,e=>e.preventDefault())})}),lx=h.forwardRef((e,t)=>{let n=ls(lm,e.__scopeDialog),r=h.useRef(!1),i=h.useRef(!1);return(0,u.jsx)(lv,{...e,ref:t,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:t=>{e.onCloseAutoFocus?.(t),t.defaultPrevented||(r.current||n.triggerRef.current?.focus(),t.preventDefault()),r.current=!1,i.current=!1},onInteractOutside:t=>{e.onInteractOutside?.(t),t.defaultPrevented||(r.current=!0,"pointerdown"===t.detail.originalEvent.type&&(i.current=!0));let s=t.target;n.triggerRef.current?.contains(s)&&t.preventDefault(),"focusin"===t.detail.originalEvent.type&&i.current&&t.preventDefault()}})}),lv=h.forwardRef((e,t)=>{let{__scopeDialog:n,trapFocus:r,onOpenAutoFocus:i,onCloseAutoFocus:s,...o}=e,a=ls(lm,n),l=h.useRef(null),c=(0,o0.s)(t,l);return h.useEffect(()=>{let e=document.querySelectorAll("[data-radix-focus-guard]");return document.body.insertAdjacentElement("afterbegin",e[0]??ah()),document.body.insertAdjacentElement("beforeend",e[1]??ah()),au++,()=>{1===au&&document.querySelectorAll("[data-radix-focus-guard]").forEach(e=>e.remove()),au--}},[]),(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)(ar,{asChild:!0,loop:!0,trapped:r,onMountAutoFocus:i,onUnmountAutoFocus:s,children:(0,u.jsx)(o8.qW,{role:"dialog",id:a.contentId,"aria-describedby":a.descriptionId,"aria-labelledby":a.titleId,"data-state":lC(a.open),...o,ref:c,onDismiss:()=>a.onOpenChange(!1)})}),(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)(lA,{titleId:a.titleId}),(0,u.jsx)(lD,{contentRef:l,descriptionId:a.descriptionId})]})]})}),lb="DialogTitle",lw=h.forwardRef((e,t)=>{let{__scopeDialog:n,...r}=e,i=ls(lb,n);return(0,u.jsx)(o9.sG.h2,{id:i.titleId,...r,ref:t})});lw.displayName=lb;var lk="DialogDescription",lj=h.forwardRef((e,t)=>{let{__scopeDialog:n,...r}=e,i=ls(lk,n);return(0,u.jsx)(o9.sG.p,{id:i.descriptionId,...r,ref:t})});lj.displayName=lk;var lN="DialogClose",lS=h.forwardRef((e,t)=>{let{__scopeDialog:n,...r}=e,i=ls(lN,n);return(0,u.jsx)(o9.sG.button,{type:"button",...r,ref:t,onClick:(0,oQ.m)(e.onClick,()=>i.onOpenChange(!1))})});function lC(e){return e?"open":"closed"}lS.displayName=lN;var lM="DialogTitleWarning",[lE,lT]=(0,o1.q)(lM,{contentName:lm,titleName:lb,docsSlug:"dialog"}),lA=({titleId:e})=>{let t=lT(lM),n=`\`${t.contentName}\` requires a \`${t.titleName}\` for the component to be accessible for screen reader users.

If you want to hide the \`${t.titleName}\`, you can wrap it with our VisuallyHidden component.

For more information, see https://radix-ui.com/primitives/docs/components/${t.docsSlug}`;return h.useEffect(()=>{e&&(document.getElementById(e)||console.error(n))},[n,e]),null},lD=({contentRef:e,descriptionId:t})=>{let n=lT("DialogDescriptionWarning"),r=`Warning: Missing \`Description\` or \`aria-describedby={undefined}\` for {${n.contentName}}.`;return h.useEffect(()=>{let n=e.current?.getAttribute("aria-describedby");t&&n&&(document.getElementById(t)||console.warn(r))},[r,e,t]),null};let lO=h.forwardRef(({className:e,...t},n)=>(0,u.jsx)(lp,{ref:n,className:(0,X.cn)("fixed inset-0 z-50 bg-black/80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",e),...t}));lO.displayName=lp.displayName;let lR=h.forwardRef(({className:e,children:t,...n},r)=>(0,u.jsxs)(lu,{children:[(0,u.jsx)(lO,{}),(0,u.jsxs)(lg,{ref:r,className:(0,X.cn)("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",e),...n,children:[t,(0,u.jsxs)(lS,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[(0,u.jsx)(eu.A,{className:"h-4 w-4"}),(0,u.jsx)("span",{className:"sr-only",children:"Close"})]})]})]}));lR.displayName=lg.displayName;let lP=({className:e,...t})=>(0,u.jsx)("div",{className:(0,X.cn)("flex flex-col space-y-1.5 text-center sm:text-left",e),...t});lP.displayName="DialogHeader";let lI=h.forwardRef(({className:e,...t},n)=>(0,u.jsx)(lw,{ref:n,className:(0,X.cn)("text-lg font-semibold leading-none tracking-tight",e),...t}));lI.displayName=lw.displayName,h.forwardRef(({className:e,...t},n)=>(0,u.jsx)(lj,{ref:n,className:(0,X.cn)("text-sm text-muted-foreground",e),...t})).displayName=lj.displayName;let lL=({isOpen:e,onClose:t,title:n,children:r,contentClassName:i,containerClassName:s})=>(0,u.jsx)(lo,{open:e,onOpenChange:e=>{e||t()},children:(0,u.jsxs)(lR,{className:(0,X.cn)("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-surface-container shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",s),children:[n?(0,u.jsx)(lP,{className:"px-6 pt-6 text-left -mb-4",children:(0,u.jsx)(lI,{className:"font-serif text-headline-sm text-surface-on",children:n})}):(0,u.jsx)(lP,{className:"sr-only",children:(0,u.jsx)(lI,{children:"Dialog"})}),(0,u.jsx)("div",{className:(0,X.cn)("text-body-md text-surface-on-variant",{"-mt-12":!n},i),children:r})]})}),lz=({isOpen:e,onClose:t,entry:n,onEdit:r})=>{if(!n)return null;let i=new Date(n.timestamp).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit",hour12:!0});return(0,u.jsxs)(lL,{isOpen:e,onClose:t,title:n.title||"Journal Entry",children:[(0,u.jsxs)("div",{className:"p-6 max-h-[70vh] overflow-y-auto",children:[(0,u.jsx)("p",{className:"text-sm text-surface-on-variant mb-4",children:i}),n.audioBase64DataUrl&&(0,u.jsxs)("div",{className:"my-4 p-4 bg-surface-container rounded-lg",children:[(0,u.jsxs)("div",{className:"flex items-center mb-2",children:[(0,u.jsx)(oJ,{className:"w-5 h-5 text-primary mr-2 flex-shrink-0"}),(0,u.jsx)("p",{className:"text-label-md text-surface-on font-medium",children:"Play Dictated Audio"})]}),(0,u.jsx)("audio",{controls:!0,src:n.audioBase64DataUrl,className:"w-full h-10 rounded-md",children:"Your browser does not support the audio element."})]}),n.text.trim()&&(0,u.jsx)("div",{className:"prose prose-sm sm:prose-base dark:prose-invert max-w-none break-words",dangerouslySetInnerHTML:{__html:n.text}}),!n.text.trim()&&n.audioBase64DataUrl&&(0,u.jsx)("p",{className:"text-label-md text-surface-on-variant italic mt-2",children:"This entry primarily contains audio."})]}),(0,u.jsxs)("div",{className:"flex justify-end space-x-3 p-6 border-t border-outline-variant",children:[(0,u.jsx)(Q,{type:"button",variant:"text",onClick:t,children:"Close"}),(0,u.jsx)(Q,{type:"button",variant:"filled",leadingIcon:(0,u.jsx)(oG,{}),onClick:()=>{r(n),t()},children:"Edit Entry"})]})]})},lV=({record:e,onView:t,onEdit:n,onDelete:r})=>{let i=new Date(e.timestamp).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"}),s=e.data.situation.length>150?e.data.situation.substring(0,150)+"...":e.data.situation;return(0,u.jsxs)("div",{className:"bg-surface-container-low shadow-lg rounded-xl transition-all duration-300 hover:shadow-xl flex items-stretch w-full",children:[(0,u.jsxs)("div",{onClick:()=>t(e),className:"flex-grow p-5 sm:p-6 cursor-pointer","aria-label":`View record: ${e.title}`,children:[(0,u.jsx)("h3",{className:"font-serif text-title-lg text-surface-on mb-0.5 break-words",children:e.title}),(0,u.jsx)("p",{className:"text-label-md text-surface-on-variant",children:i}),(0,u.jsx)("div",{className:"text-body-md text-surface-on max-w-none mt-2 break-words",children:(0,u.jsxs)("p",{className:"italic text-surface-on-variant",children:['Situation: "',s,'"']})})]}),(0,u.jsxs)("div",{className:"flex flex-col items-center justify-center space-y-2 p-2 border-l border-outline-variant/30",children:[(0,u.jsx)(Q,{onClick:t=>{t.stopPropagation(),n(e)},variant:"text",size:"sm",isIconOnly:!0,title:"Edit Record",className:"text-surface-on-variant hover:bg-surface-on-variant/10","aria-label":"Edit this thought record",children:(0,u.jsx)(oG,{className:"w-5 h-5"})}),(0,u.jsx)(Q,{onClick:t=>{t.stopPropagation(),r(e.id)},variant:"text",size:"sm",isIconOnly:!0,title:"Delete Record",className:"text-error hover:bg-error-container/20","aria-label":"Delete this thought record",children:(0,u.jsx)(oY,{className:"w-5 h-5"})})]})]})},l$=({thoughtRecords:e,onNew:t,onView:n,onEdit:r,onDelete:i})=>(0,u.jsxs)("div",{className:"space-y-10 animate-in fade-in-0 duration-750 max-w-3xl w-full",children:[(0,u.jsxs)("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4",children:[(0,u.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,u.jsx)(ea,{className:"w-8 h-8 text-primary"}),(0,u.jsx)("h2",{className:"font-serif text-headline-lg text-surface-on",children:"My Thought Records"})]}),(0,u.jsx)(Q,{variant:"filled",size:"md",leadingIcon:(0,u.jsx)(eM,{}),onClick:t,className:"w-full sm:w-auto","aria-label":"Create new thought record",children:"New Thought Record"})]}),(0,u.jsx)("p",{className:"text-body-lg text-surface-on-variant -mt-6",children:"Use this structured exercise to examine and challenge unhelpful thoughts. Track your progress by reviewing past records."}),e.length>0?(0,u.jsx)("div",{className:"space-y-6",children:e.map(e=>(0,u.jsx)(lV,{record:e,onView:n,onEdit:r,onDelete:i},e.id))}):(0,u.jsxs)("div",{className:"text-center py-12 bg-surface-container-low rounded-xl",children:[(0,u.jsx)("h3",{className:"font-serif text-headline-sm text-surface-on",children:"No Records Yet"}),(0,u.jsx)("p",{className:"mt-2 text-body-md text-surface-on-variant",children:'Click "New Thought Record" to get started.'})]})]}),l_=(0,K.A)("CircleStop",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["rect",{x:"9",y:"9",width:"6",height:"6",rx:"1",key:"1ssd4o"}]]),lF=(0,K.A)("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]),lB=(0,K.A)("ArrowRight",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]);function lW(e,[t,n]){return Math.min(n,Math.max(t,e))}var lq=h.createContext(void 0);function lH(e){let t=h.useContext(lq);return e||t||"ltr"}function lU(e){let t=h.useRef({value:e,previous:e});return h.useMemo(()=>(t.current.value!==e&&(t.current.previous=t.current.value,t.current.value=e),t.current.previous),[e])}function lK(e){let[t,n]=h.useState(void 0);return(0,o2.N)(()=>{if(e){n({width:e.offsetWidth,height:e.offsetHeight});let t=new ResizeObserver(t=>{let r,i;if(!Array.isArray(t)||!t.length)return;let s=t[0];if("borderBoxSize"in s){let e=s.borderBoxSize,t=Array.isArray(e)?e[0]:e;r=t.inlineSize,i=t.blockSize}else r=e.offsetWidth,i=e.offsetHeight;n({width:r,height:i})});return t.observe(e,{box:"border-box"}),()=>t.unobserve(e)}n(void 0)},[e]),t}var lJ=n(2031),lG=["PageUp","PageDown"],lY=["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"],lX={"from-left":["Home","PageDown","ArrowDown","ArrowLeft"],"from-right":["Home","PageDown","ArrowDown","ArrowRight"],"from-bottom":["Home","PageDown","ArrowDown","ArrowLeft"],"from-top":["Home","PageDown","ArrowUp","ArrowLeft"]},lZ="Slider",[lQ,l0,l1]=(0,lJ.N)(lZ),[l2,l4]=(0,o1.A)(lZ,[l1]),[l3,l5]=l2(lZ),l6=h.forwardRef((e,t)=>{let{name:n,min:r=0,max:i=100,step:s=1,orientation:o="horizontal",disabled:a=!1,minStepsBetweenThumbs:l=0,defaultValue:c=[r],value:d,onValueChange:p=()=>{},onValueCommit:f=()=>{},inverted:m=!1,form:g,...y}=e,x=h.useRef(new Set),v=h.useRef(0),b="horizontal"===o,[w=[],k]=(0,o6.i)({prop:d,defaultProp:c,onChange:e=>{let t=[...x.current];t[v.current]?.focus(),p(e)}}),j=h.useRef(w);function N(e,t,{commit:n}={commit:!1}){let o=(String(s).split(".")[1]||"").length,a=lW(function(e,t){let n=Math.pow(10,t);return Math.round(e*n)/n}(Math.round((e-r)/s)*s+r,o),[r,i]);k((e=[])=>{let r=function(e=[],t,n){let r=[...e];return r[n]=t,r.sort((e,t)=>e-t)}(e,a,t);if(!function(e,t){if(t>0)return Math.min(...e.slice(0,-1).map((t,n)=>e[n+1]-t))>=t;return!0}(r,l*s))return e;{v.current=r.indexOf(a);let t=String(r)!==String(e);return t&&n&&f(r),t?r:e}})}return(0,u.jsx)(l3,{scope:e.__scopeSlider,name:n,disabled:a,min:r,max:i,valueIndexToChangeRef:v,thumbs:x.current,values:w,orientation:o,form:g,children:(0,u.jsx)(lQ.Provider,{scope:e.__scopeSlider,children:(0,u.jsx)(lQ.Slot,{scope:e.__scopeSlider,children:(0,u.jsx)(b?l7:ce,{"aria-disabled":a,"data-disabled":a?"":void 0,...y,ref:t,onPointerDown:(0,oQ.m)(y.onPointerDown,()=>{a||(j.current=w)}),min:r,max:i,inverted:m,onSlideStart:a?void 0:function(e){let t=function(e,t){if(1===e.length)return 0;let n=e.map(e=>Math.abs(e-t)),r=Math.min(...n);return n.indexOf(r)}(w,e);N(e,t)},onSlideMove:a?void 0:function(e){N(e,v.current)},onSlideEnd:a?void 0:function(){let e=j.current[v.current];w[v.current]!==e&&f(w)},onHomeKeyDown:()=>!a&&N(r,0,{commit:!0}),onEndKeyDown:()=>!a&&N(i,w.length-1,{commit:!0}),onStepKeyDown:({event:e,direction:t})=>{if(!a){let n=lG.includes(e.key)||e.shiftKey&&lY.includes(e.key),r=v.current;N(w[r]+s*(n?10:1)*t,r,{commit:!0})}}})})})})});l6.displayName=lZ;var[l8,l9]=l2(lZ,{startEdge:"left",endEdge:"right",size:"width",direction:1}),l7=h.forwardRef((e,t)=>{let{min:n,max:r,dir:i,inverted:s,onSlideStart:o,onSlideMove:a,onSlideEnd:l,onStepKeyDown:c,...d}=e,[p,f]=h.useState(null),m=(0,o0.s)(t,e=>f(e)),g=h.useRef(void 0),y=lH(i),x="ltr"===y,v=x&&!s||!x&&s;function b(e){let t=g.current||p.getBoundingClientRect(),i=cu([0,t.width],v?[n,r]:[r,n]);return g.current=t,i(e-t.left)}return(0,u.jsx)(l8,{scope:e.__scopeSlider,startEdge:v?"left":"right",endEdge:v?"right":"left",direction:v?1:-1,size:"width",children:(0,u.jsx)(ct,{dir:y,"data-orientation":"horizontal",...d,ref:m,style:{...d.style,"--radix-slider-thumb-transform":"translateX(-50%)"},onSlideStart:e=>{let t=b(e.clientX);o?.(t)},onSlideMove:e=>{let t=b(e.clientX);a?.(t)},onSlideEnd:()=>{g.current=void 0,l?.()},onStepKeyDown:e=>{let t=lX[v?"from-left":"from-right"].includes(e.key);c?.({event:e,direction:t?-1:1})}})})}),ce=h.forwardRef((e,t)=>{let{min:n,max:r,inverted:i,onSlideStart:s,onSlideMove:o,onSlideEnd:a,onStepKeyDown:l,...c}=e,d=h.useRef(null),p=(0,o0.s)(t,d),f=h.useRef(void 0),m=!i;function g(e){let t=f.current||d.current.getBoundingClientRect(),i=cu([0,t.height],m?[r,n]:[n,r]);return f.current=t,i(e-t.top)}return(0,u.jsx)(l8,{scope:e.__scopeSlider,startEdge:m?"bottom":"top",endEdge:m?"top":"bottom",size:"height",direction:m?1:-1,children:(0,u.jsx)(ct,{"data-orientation":"vertical",...c,ref:p,style:{...c.style,"--radix-slider-thumb-transform":"translateY(50%)"},onSlideStart:e=>{let t=g(e.clientY);s?.(t)},onSlideMove:e=>{let t=g(e.clientY);o?.(t)},onSlideEnd:()=>{f.current=void 0,a?.()},onStepKeyDown:e=>{let t=lX[m?"from-bottom":"from-top"].includes(e.key);l?.({event:e,direction:t?-1:1})}})})}),ct=h.forwardRef((e,t)=>{let{__scopeSlider:n,onSlideStart:r,onSlideMove:i,onSlideEnd:s,onHomeKeyDown:o,onEndKeyDown:a,onStepKeyDown:l,...c}=e,d=l5(lZ,n);return(0,u.jsx)(o9.sG.span,{...c,ref:t,onKeyDown:(0,oQ.m)(e.onKeyDown,e=>{"Home"===e.key?(o(e),e.preventDefault()):"End"===e.key?(a(e),e.preventDefault()):lG.concat(lY).includes(e.key)&&(l(e),e.preventDefault())}),onPointerDown:(0,oQ.m)(e.onPointerDown,e=>{let t=e.target;t.setPointerCapture(e.pointerId),e.preventDefault(),d.thumbs.has(t)?t.focus():r(e)}),onPointerMove:(0,oQ.m)(e.onPointerMove,e=>{e.target.hasPointerCapture(e.pointerId)&&i(e)}),onPointerUp:(0,oQ.m)(e.onPointerUp,e=>{let t=e.target;t.hasPointerCapture(e.pointerId)&&(t.releasePointerCapture(e.pointerId),s(e))})})}),cn="SliderTrack",cr=h.forwardRef((e,t)=>{let{__scopeSlider:n,...r}=e,i=l5(cn,n);return(0,u.jsx)(o9.sG.span,{"data-disabled":i.disabled?"":void 0,"data-orientation":i.orientation,...r,ref:t})});cr.displayName=cn;var ci="SliderRange",cs=h.forwardRef((e,t)=>{let{__scopeSlider:n,...r}=e,i=l5(ci,n),s=l9(ci,n),o=h.useRef(null),a=(0,o0.s)(t,o),l=i.values.length,c=i.values.map(e=>cd(e,i.min,i.max)),d=l>1?Math.min(...c):0,p=100-Math.max(...c);return(0,u.jsx)(o9.sG.span,{"data-orientation":i.orientation,"data-disabled":i.disabled?"":void 0,...r,ref:a,style:{...e.style,[s.startEdge]:d+"%",[s.endEdge]:p+"%"}})});cs.displayName=ci;var co="SliderThumb",ca=h.forwardRef((e,t)=>{let n=l0(e.__scopeSlider),[r,i]=h.useState(null),s=(0,o0.s)(t,e=>i(e)),o=h.useMemo(()=>r?n().findIndex(e=>e.ref.current===r):-1,[n,r]);return(0,u.jsx)(cl,{...e,ref:s,index:o})}),cl=h.forwardRef((e,t)=>{let{__scopeSlider:n,index:r,name:i,...s}=e,o=l5(co,n),a=l9(co,n),[l,c]=h.useState(null),d=(0,o0.s)(t,e=>c(e)),p=!l||o.form||!!l.closest("form"),f=lK(l),m=o.values[r],g=void 0===m?0:cd(m,o.min,o.max),y=function(e,t){return t>2?`Value ${e+1} of ${t}`:2===t?["Minimum","Maximum"][e]:void 0}(r,o.values.length),x=f?.[a.size],v=x?function(e,t,n){let r=e/2,i=cu([0,50],[0,r]);return(r-i(t)*n)*n}(x,g,a.direction):0;return h.useEffect(()=>{if(l)return o.thumbs.add(l),()=>{o.thumbs.delete(l)}},[l,o.thumbs]),(0,u.jsxs)("span",{style:{transform:"var(--radix-slider-thumb-transform)",position:"absolute",[a.startEdge]:`calc(${g}% + ${v}px)`},children:[(0,u.jsx)(lQ.ItemSlot,{scope:e.__scopeSlider,children:(0,u.jsx)(o9.sG.span,{role:"slider","aria-label":e["aria-label"]||y,"aria-valuemin":o.min,"aria-valuenow":m,"aria-valuemax":o.max,"aria-orientation":o.orientation,"data-orientation":o.orientation,"data-disabled":o.disabled?"":void 0,tabIndex:o.disabled?void 0:0,...s,ref:d,style:void 0===m?{display:"none"}:e.style,onFocus:(0,oQ.m)(e.onFocus,()=>{o.valueIndexToChangeRef.current=r})})}),p&&(0,u.jsx)(cc,{name:i??(o.name?o.name+(o.values.length>1?"[]":""):void 0),form:o.form,value:m},r)]})});ca.displayName=co;var cc=e=>{let{value:t,...n}=e,r=h.useRef(null),i=lU(t);return h.useEffect(()=>{let e=r.current,n=Object.getOwnPropertyDescriptor(window.HTMLInputElement.prototype,"value").set;if(i!==t&&n){let r=new Event("input",{bubbles:!0});n.call(e,t),e.dispatchEvent(r)}},[i,t]),(0,u.jsx)("input",{style:{display:"none"},...n,ref:r,defaultValue:t})};function cd(e,t,n){return lW(100/(n-t)*(e-t),[0,100])}function cu(e,t){return n=>{if(e[0]===e[1]||t[0]===t[1])return t[0];let r=(t[1]-t[0])/(e[1]-e[0]);return t[0]+r*(n-e[0])}}let ch=h.forwardRef(({className:e,...t},n)=>(0,u.jsxs)(l6,{ref:n,className:(0,X.cn)("relative flex w-full touch-none select-none items-center group py-2",e),...t,children:[(0,u.jsx)(cr,{className:"relative h-2 w-full grow overflow-hidden rounded-full bg-secondary-container",children:(0,u.jsx)(cs,{className:"absolute h-full bg-primary"})}),(0,u.jsx)(ca,{className:"block h-5 w-5 rounded-full border-2 border-primary bg-background ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50"})]}));ch.displayName=l6.displayName;var cp=n(1215);function cf(e){this.content=e}cf.prototype={constructor:cf,find:function(e){for(var t=0;t<this.content.length;t+=2)if(this.content[t]===e)return t;return -1},get:function(e){var t=this.find(e);return -1==t?void 0:this.content[t+1]},update:function(e,t,n){var r=n&&n!=e?this.remove(n):this,i=r.find(e),s=r.content.slice();return -1==i?s.push(n||e,t):(s[i+1]=t,n&&(s[i]=n)),new cf(s)},remove:function(e){var t=this.find(e);if(-1==t)return this;var n=this.content.slice();return n.splice(t,2),new cf(n)},addToStart:function(e,t){return new cf([e,t].concat(this.remove(e).content))},addToEnd:function(e,t){var n=this.remove(e).content.slice();return n.push(e,t),new cf(n)},addBefore:function(e,t,n){var r=this.remove(t),i=r.content.slice(),s=r.find(e);return i.splice(-1==s?i.length:s,0,t,n),new cf(i)},forEach:function(e){for(var t=0;t<this.content.length;t+=2)e(this.content[t],this.content[t+1])},prepend:function(e){return(e=cf.from(e)).size?new cf(e.content.concat(this.subtract(e).content)):this},append:function(e){return(e=cf.from(e)).size?new cf(this.subtract(e).content.concat(e.content)):this},subtract:function(e){var t=this;e=cf.from(e);for(var n=0;n<e.content.length;n+=2)t=t.remove(e.content[n]);return t},toObject:function(){var e={};return this.forEach(function(t,n){e[t]=n}),e},get size(){return this.content.length>>1}},cf.from=function(e){if(e instanceof cf)return e;var t=[];if(e)for(var n in e)t.push(n,e[n]);return new cf(t)};class cm{constructor(e,t){if(this.content=e,this.size=t||0,null==t)for(let t=0;t<e.length;t++)this.size+=e[t].nodeSize}nodesBetween(e,t,n,r=0,i){for(let s=0,o=0;o<t;s++){let a=this.content[s],l=o+a.nodeSize;if(l>e&&!1!==n(a,r+o,i||null,s)&&a.content.size){let i=o+1;a.nodesBetween(Math.max(0,e-i),Math.min(a.content.size,t-i),n,r+i)}o=l}}descendants(e){this.nodesBetween(0,this.size,e)}textBetween(e,t,n,r){let i="",s=!0;return this.nodesBetween(e,t,(o,a)=>{let l=o.isText?o.text.slice(Math.max(e,a)-a,t-a):o.isLeaf?r?"function"==typeof r?r(o):r:o.type.spec.leafText?o.type.spec.leafText(o):"":"";o.isBlock&&(o.isLeaf&&l||o.isTextblock)&&n&&(s?s=!1:i+=n),i+=l},0),i}append(e){if(!e.size)return this;if(!this.size)return e;let t=this.lastChild,n=e.firstChild,r=this.content.slice(),i=0;for(t.isText&&t.sameMarkup(n)&&(r[r.length-1]=t.withText(t.text+n.text),i=1);i<e.content.length;i++)r.push(e.content[i]);return new cm(r,this.size+e.size)}cut(e,t=this.size){if(0==e&&t==this.size)return this;let n=[],r=0;if(t>e)for(let i=0,s=0;s<t;i++){let o=this.content[i],a=s+o.nodeSize;a>e&&((s<e||a>t)&&(o=o.isText?o.cut(Math.max(0,e-s),Math.min(o.text.length,t-s)):o.cut(Math.max(0,e-s-1),Math.min(o.content.size,t-s-1))),n.push(o),r+=o.nodeSize),s=a}return new cm(n,r)}cutByIndex(e,t){return e==t?cm.empty:0==e&&t==this.content.length?this:new cm(this.content.slice(e,t))}replaceChild(e,t){let n=this.content[e];if(n==t)return this;let r=this.content.slice(),i=this.size+t.nodeSize-n.nodeSize;return r[e]=t,new cm(r,i)}addToStart(e){return new cm([e].concat(this.content),this.size+e.nodeSize)}addToEnd(e){return new cm(this.content.concat(e),this.size+e.nodeSize)}eq(e){if(this.content.length!=e.content.length)return!1;for(let t=0;t<this.content.length;t++)if(!this.content[t].eq(e.content[t]))return!1;return!0}get firstChild(){return this.content.length?this.content[0]:null}get lastChild(){return this.content.length?this.content[this.content.length-1]:null}get childCount(){return this.content.length}child(e){let t=this.content[e];if(!t)throw RangeError("Index "+e+" out of range for "+this);return t}maybeChild(e){return this.content[e]||null}forEach(e){for(let t=0,n=0;t<this.content.length;t++){let r=this.content[t];e(r,n,t),n+=r.nodeSize}}findDiffStart(e,t=0){return function e(t,n,r){for(let i=0;;i++){if(i==t.childCount||i==n.childCount)return t.childCount==n.childCount?null:r;let s=t.child(i),o=n.child(i);if(s==o){r+=s.nodeSize;continue}if(!s.sameMarkup(o))return r;if(s.isText&&s.text!=o.text){for(let e=0;s.text[e]==o.text[e];e++)r++;return r}if(s.content.size||o.content.size){let t=e(s.content,o.content,r+1);if(null!=t)return t}r+=s.nodeSize}}(this,e,t)}findDiffEnd(e,t=this.size,n=e.size){return function e(t,n,r,i){for(let s=t.childCount,o=n.childCount;;){if(0==s||0==o)return s==o?null:{a:r,b:i};let a=t.child(--s),l=n.child(--o),c=a.nodeSize;if(a==l){r-=c,i-=c;continue}if(!a.sameMarkup(l))return{a:r,b:i};if(a.isText&&a.text!=l.text){let e=0,t=Math.min(a.text.length,l.text.length);for(;e<t&&a.text[a.text.length-e-1]==l.text[l.text.length-e-1];)e++,r--,i--;return{a:r,b:i}}if(a.content.size||l.content.size){let t=e(a.content,l.content,r-1,i-1);if(t)return t}r-=c,i-=c}}(this,e,t,n)}findIndex(e,t=-1){if(0==e)return cy(0,e);if(e==this.size)return cy(this.content.length,e);if(e>this.size||e<0)throw RangeError(`Position ${e} outside of fragment (${this})`);for(let n=0,r=0;;n++){let i=r+this.child(n).nodeSize;if(i>=e){if(i==e||t>0)return cy(n+1,i);return cy(n,r)}r=i}}toString(){return"<"+this.toStringInner()+">"}toStringInner(){return this.content.join(", ")}toJSON(){return this.content.length?this.content.map(e=>e.toJSON()):null}static fromJSON(e,t){if(!t)return cm.empty;if(!Array.isArray(t))throw RangeError("Invalid input for Fragment.fromJSON");return new cm(t.map(e.nodeFromJSON))}static fromArray(e){if(!e.length)return cm.empty;let t,n=0;for(let r=0;r<e.length;r++){let i=e[r];n+=i.nodeSize,r&&i.isText&&e[r-1].sameMarkup(i)?(t||(t=e.slice(0,r)),t[t.length-1]=i.withText(t[t.length-1].text+i.text)):t&&t.push(i)}return new cm(t||e,n)}static from(e){if(!e)return cm.empty;if(e instanceof cm)return e;if(Array.isArray(e))return this.fromArray(e);if(e.attrs)return new cm([e],e.nodeSize);throw RangeError("Can not convert "+e+" to a Fragment"+(e.nodesBetween?" (looks like multiple versions of prosemirror-model were loaded)":""))}}cm.empty=new cm([],0);let cg={index:0,offset:0};function cy(e,t){return cg.index=e,cg.offset=t,cg}function cx(e,t){if(e===t)return!0;if(!(e&&"object"==typeof e)||!(t&&"object"==typeof t))return!1;let n=Array.isArray(e);if(Array.isArray(t)!=n)return!1;if(n){if(e.length!=t.length)return!1;for(let n=0;n<e.length;n++)if(!cx(e[n],t[n]))return!1}else{for(let n in e)if(!(n in t)||!cx(e[n],t[n]))return!1;for(let n in t)if(!(n in e))return!1}return!0}class cv{constructor(e,t){this.type=e,this.attrs=t}addToSet(e){let t,n=!1;for(let r=0;r<e.length;r++){let i=e[r];if(this.eq(i))return e;if(this.type.excludes(i.type))t||(t=e.slice(0,r));else{if(i.type.excludes(this.type))return e;!n&&i.type.rank>this.type.rank&&(t||(t=e.slice(0,r)),t.push(this),n=!0),t&&t.push(i)}}return t||(t=e.slice()),n||t.push(this),t}removeFromSet(e){for(let t=0;t<e.length;t++)if(this.eq(e[t]))return e.slice(0,t).concat(e.slice(t+1));return e}isInSet(e){for(let t=0;t<e.length;t++)if(this.eq(e[t]))return!0;return!1}eq(e){return this==e||this.type==e.type&&cx(this.attrs,e.attrs)}toJSON(){let e={type:this.type.name};for(let t in this.attrs){e.attrs=this.attrs;break}return e}static fromJSON(e,t){if(!t)throw RangeError("Invalid input for Mark.fromJSON");let n=e.marks[t.type];if(!n)throw RangeError(`There is no mark type ${t.type} in this schema`);let r=n.create(t.attrs);return n.checkAttrs(r.attrs),r}static sameSet(e,t){if(e==t)return!0;if(e.length!=t.length)return!1;for(let n=0;n<e.length;n++)if(!e[n].eq(t[n]))return!1;return!0}static setFrom(e){if(!e||Array.isArray(e)&&0==e.length)return cv.none;if(e instanceof cv)return[e];let t=e.slice();return t.sort((e,t)=>e.type.rank-t.type.rank),t}}cv.none=[];class cb extends Error{}class cw{constructor(e,t,n){this.content=e,this.openStart=t,this.openEnd=n}get size(){return this.content.size-this.openStart-this.openEnd}insertAt(e,t){let n=function e(t,n,r,i){let{index:s,offset:o}=t.findIndex(n),a=t.maybeChild(s);if(o==n||a.isText)return i&&!i.canReplace(s,s,r)?null:t.cut(0,n).append(r).append(t.cut(n));let l=e(a.content,n-o-1,r);return l&&t.replaceChild(s,a.copy(l))}(this.content,e+this.openStart,t);return n&&new cw(n,this.openStart,this.openEnd)}removeBetween(e,t){return new cw(function e(t,n,r){let{index:i,offset:s}=t.findIndex(n),o=t.maybeChild(i),{index:a,offset:l}=t.findIndex(r);if(s==n||o.isText){if(l!=r&&!t.child(a).isText)throw RangeError("Removing non-flat range");return t.cut(0,n).append(t.cut(r))}if(i!=a)throw RangeError("Removing non-flat range");return t.replaceChild(i,o.copy(e(o.content,n-s-1,r-s-1)))}(this.content,e+this.openStart,t+this.openStart),this.openStart,this.openEnd)}eq(e){return this.content.eq(e.content)&&this.openStart==e.openStart&&this.openEnd==e.openEnd}toString(){return this.content+"("+this.openStart+","+this.openEnd+")"}toJSON(){if(!this.content.size)return null;let e={content:this.content.toJSON()};return this.openStart>0&&(e.openStart=this.openStart),this.openEnd>0&&(e.openEnd=this.openEnd),e}static fromJSON(e,t){if(!t)return cw.empty;let n=t.openStart||0,r=t.openEnd||0;if("number"!=typeof n||"number"!=typeof r)throw RangeError("Invalid input for Slice.fromJSON");return new cw(cm.fromJSON(e,t.content),n,r)}static maxOpen(e,t=!0){let n=0,r=0;for(let r=e.firstChild;r&&!r.isLeaf&&(t||!r.type.spec.isolating);r=r.firstChild)n++;for(let n=e.lastChild;n&&!n.isLeaf&&(t||!n.type.spec.isolating);n=n.lastChild)r++;return new cw(e,n,r)}}function ck(e,t){if(!t.type.compatibleContent(e.type))throw new cb("Cannot join "+t.type.name+" onto "+e.type.name)}function cj(e,t,n){let r=e.node(n);return ck(r,t.node(n)),r}function cN(e,t){let n=t.length-1;n>=0&&e.isText&&e.sameMarkup(t[n])?t[n]=e.withText(t[n].text+e.text):t.push(e)}function cS(e,t,n,r){let i=(t||e).node(n),s=0,o=t?t.index(n):i.childCount;e&&(s=e.index(n),e.depth>n?s++:e.textOffset&&(cN(e.nodeAfter,r),s++));for(let e=s;e<o;e++)cN(i.child(e),r);t&&t.depth==n&&t.textOffset&&cN(t.nodeBefore,r)}function cC(e,t){return e.type.checkContent(t),e.copy(t)}function cM(e,t,n){let r=[];return cS(null,e,n,r),e.depth>n&&cN(cC(cj(e,t,n+1),cM(e,t,n+1)),r),cS(t,null,n,r),new cm(r)}cw.empty=new cw(cm.empty,0,0);class cE{constructor(e,t,n){this.pos=e,this.path=t,this.parentOffset=n,this.depth=t.length/3-1}resolveDepth(e){return null==e?this.depth:e<0?this.depth+e:e}get parent(){return this.node(this.depth)}get doc(){return this.node(0)}node(e){return this.path[3*this.resolveDepth(e)]}index(e){return this.path[3*this.resolveDepth(e)+1]}indexAfter(e){return e=this.resolveDepth(e),this.index(e)+(e!=this.depth||this.textOffset?1:0)}start(e){return 0==(e=this.resolveDepth(e))?0:this.path[3*e-1]+1}end(e){return e=this.resolveDepth(e),this.start(e)+this.node(e).content.size}before(e){if(!(e=this.resolveDepth(e)))throw RangeError("There is no position before the top-level node");return e==this.depth+1?this.pos:this.path[3*e-1]}after(e){if(!(e=this.resolveDepth(e)))throw RangeError("There is no position after the top-level node");return e==this.depth+1?this.pos:this.path[3*e-1]+this.path[3*e].nodeSize}get textOffset(){return this.pos-this.path[this.path.length-1]}get nodeAfter(){let e=this.parent,t=this.index(this.depth);if(t==e.childCount)return null;let n=this.pos-this.path[this.path.length-1],r=e.child(t);return n?e.child(t).cut(n):r}get nodeBefore(){let e=this.index(this.depth),t=this.pos-this.path[this.path.length-1];return t?this.parent.child(e).cut(0,t):0==e?null:this.parent.child(e-1)}posAtIndex(e,t){t=this.resolveDepth(t);let n=this.path[3*t],r=0==t?0:this.path[3*t-1]+1;for(let t=0;t<e;t++)r+=n.child(t).nodeSize;return r}marks(){let e=this.parent,t=this.index();if(0==e.content.size)return cv.none;if(this.textOffset)return e.child(t).marks;let n=e.maybeChild(t-1),r=e.maybeChild(t);if(!n){let e=n;n=r,r=e}let i=n.marks;for(var s=0;s<i.length;s++)!1!==i[s].type.spec.inclusive||r&&i[s].isInSet(r.marks)||(i=i[s--].removeFromSet(i));return i}marksAcross(e){let t=this.parent.maybeChild(this.index());if(!t||!t.isInline)return null;let n=t.marks,r=e.parent.maybeChild(e.index());for(var i=0;i<n.length;i++)!1!==n[i].type.spec.inclusive||r&&n[i].isInSet(r.marks)||(n=n[i--].removeFromSet(n));return n}sharedDepth(e){for(let t=this.depth;t>0;t--)if(this.start(t)<=e&&this.end(t)>=e)return t;return 0}blockRange(e=this,t){if(e.pos<this.pos)return e.blockRange(this);for(let n=this.depth-(this.parent.inlineContent||this.pos==e.pos?1:0);n>=0;n--)if(e.pos<=this.end(n)&&(!t||t(this.node(n))))return new cO(this,e,n);return null}sameParent(e){return this.pos-this.parentOffset==e.pos-e.parentOffset}max(e){return e.pos>this.pos?e:this}min(e){return e.pos<this.pos?e:this}toString(){let e="";for(let t=1;t<=this.depth;t++)e+=(e?"/":"")+this.node(t).type.name+"_"+this.index(t-1);return e+":"+this.parentOffset}static resolve(e,t){if(!(t>=0&&t<=e.content.size))throw RangeError("Position "+t+" out of range");let n=[],r=0,i=t;for(let t=e;;){let{index:e,offset:s}=t.content.findIndex(i),o=i-s;if(n.push(t,e,r+s),!o||(t=t.child(e)).isText)break;i=o-1,r+=s+1}return new cE(t,n,i)}static resolveCached(e,t){let n=cD.get(e);if(n)for(let e=0;e<n.elts.length;e++){let r=n.elts[e];if(r.pos==t)return r}else cD.set(e,n=new cT);let r=n.elts[n.i]=cE.resolve(e,t);return n.i=(n.i+1)%cA,r}}class cT{constructor(){this.elts=[],this.i=0}}let cA=12,cD=new WeakMap;class cO{constructor(e,t,n){this.$from=e,this.$to=t,this.depth=n}get start(){return this.$from.before(this.depth+1)}get end(){return this.$to.after(this.depth+1)}get parent(){return this.$from.node(this.depth)}get startIndex(){return this.$from.index(this.depth)}get endIndex(){return this.$to.indexAfter(this.depth)}}let cR=Object.create(null);class cP{constructor(e,t,n,r=cv.none){this.type=e,this.attrs=t,this.marks=r,this.content=n||cm.empty}get children(){return this.content.content}get nodeSize(){return this.isLeaf?1:2+this.content.size}get childCount(){return this.content.childCount}child(e){return this.content.child(e)}maybeChild(e){return this.content.maybeChild(e)}forEach(e){this.content.forEach(e)}nodesBetween(e,t,n,r=0){this.content.nodesBetween(e,t,n,r,this)}descendants(e){this.nodesBetween(0,this.content.size,e)}get textContent(){return this.isLeaf&&this.type.spec.leafText?this.type.spec.leafText(this):this.textBetween(0,this.content.size,"")}textBetween(e,t,n,r){return this.content.textBetween(e,t,n,r)}get firstChild(){return this.content.firstChild}get lastChild(){return this.content.lastChild}eq(e){return this==e||this.sameMarkup(e)&&this.content.eq(e.content)}sameMarkup(e){return this.hasMarkup(e.type,e.attrs,e.marks)}hasMarkup(e,t,n){return this.type==e&&cx(this.attrs,t||e.defaultAttrs||cR)&&cv.sameSet(this.marks,n||cv.none)}copy(e=null){return e==this.content?this:new cP(this.type,this.attrs,e,this.marks)}mark(e){return e==this.marks?this:new cP(this.type,this.attrs,this.content,e)}cut(e,t=this.content.size){return 0==e&&t==this.content.size?this:this.copy(this.content.cut(e,t))}slice(e,t=this.content.size,n=!1){if(e==t)return cw.empty;let r=this.resolve(e),i=this.resolve(t),s=n?0:r.sharedDepth(t),o=r.start(s);return new cw(r.node(s).content.cut(r.pos-o,i.pos-o),r.depth-s,i.depth-s)}replace(e,t,n){var r=this.resolve(e),i=this.resolve(t);if(n.openStart>r.depth)throw new cb("Inserted content deeper than insertion position");if(r.depth-n.openStart!=i.depth-n.openEnd)throw new cb("Inconsistent open depths");return function e(t,n,r,i){let s=t.index(i),o=t.node(i);if(s==n.index(i)&&i<t.depth-r.openStart){let a=e(t,n,r,i+1);return o.copy(o.content.replaceChild(s,a))}if(!r.content.size)return cC(o,cM(t,n,i));if(r.openStart||r.openEnd||t.depth!=i||n.depth!=i){let{start:e,end:s}=function(e,t){let n=t.depth-e.openStart,r=t.node(n).copy(e.content);for(let e=n-1;e>=0;e--)r=t.node(e).copy(cm.from(r));return{start:r.resolveNoCache(e.openStart+n),end:r.resolveNoCache(r.content.size-e.openEnd-n)}}(r,t);return cC(o,function e(t,n,r,i,s){let o=t.depth>s&&cj(t,n,s+1),a=i.depth>s&&cj(r,i,s+1),l=[];return cS(null,t,s,l),o&&a&&n.index(s)==r.index(s)?(ck(o,a),cN(cC(o,e(t,n,r,i,s+1)),l)):(o&&cN(cC(o,cM(t,n,s+1)),l),cS(n,r,s,l),a&&cN(cC(a,cM(r,i,s+1)),l)),cS(i,null,s,l),new cm(l)}(t,e,s,n,i))}{let e=t.parent,i=e.content;return cC(e,i.cut(0,t.parentOffset).append(r.content).append(i.cut(n.parentOffset)))}}(r,i,n,0)}nodeAt(e){for(let t=this;;){let{index:n,offset:r}=t.content.findIndex(e);if(!(t=t.maybeChild(n)))return null;if(r==e||t.isText)return t;e-=r+1}}childAfter(e){let{index:t,offset:n}=this.content.findIndex(e);return{node:this.content.maybeChild(t),index:t,offset:n}}childBefore(e){if(0==e)return{node:null,index:0,offset:0};let{index:t,offset:n}=this.content.findIndex(e);if(n<e)return{node:this.content.child(t),index:t,offset:n};let r=this.content.child(t-1);return{node:r,index:t-1,offset:n-r.nodeSize}}resolve(e){return cE.resolveCached(this,e)}resolveNoCache(e){return cE.resolve(this,e)}rangeHasMark(e,t,n){let r=!1;return t>e&&this.nodesBetween(e,t,e=>(n.isInSet(e.marks)&&(r=!0),!r)),r}get isBlock(){return this.type.isBlock}get isTextblock(){return this.type.isTextblock}get inlineContent(){return this.type.inlineContent}get isInline(){return this.type.isInline}get isText(){return this.type.isText}get isLeaf(){return this.type.isLeaf}get isAtom(){return this.type.isAtom}toString(){if(this.type.spec.toDebugString)return this.type.spec.toDebugString(this);let e=this.type.name;return this.content.size&&(e+="("+this.content.toStringInner()+")"),cL(this.marks,e)}contentMatchAt(e){let t=this.type.contentMatch.matchFragment(this.content,0,e);if(!t)throw Error("Called contentMatchAt on a node with invalid content");return t}canReplace(e,t,n=cm.empty,r=0,i=n.childCount){let s=this.contentMatchAt(e).matchFragment(n,r,i),o=s&&s.matchFragment(this.content,t);if(!o||!o.validEnd)return!1;for(let e=r;e<i;e++)if(!this.type.allowsMarks(n.child(e).marks))return!1;return!0}canReplaceWith(e,t,n,r){if(r&&!this.type.allowsMarks(r))return!1;let i=this.contentMatchAt(e).matchType(n),s=i&&i.matchFragment(this.content,t);return!!s&&s.validEnd}canAppend(e){return e.content.size?this.canReplace(this.childCount,this.childCount,e.content):this.type.compatibleContent(e.type)}check(){this.type.checkContent(this.content),this.type.checkAttrs(this.attrs);let e=cv.none;for(let t=0;t<this.marks.length;t++){let n=this.marks[t];n.type.checkAttrs(n.attrs),e=n.addToSet(e)}if(!cv.sameSet(e,this.marks))throw RangeError(`Invalid collection of marks for node ${this.type.name}: ${this.marks.map(e=>e.type.name)}`);this.content.forEach(e=>e.check())}toJSON(){let e={type:this.type.name};for(let t in this.attrs){e.attrs=this.attrs;break}return this.content.size&&(e.content=this.content.toJSON()),this.marks.length&&(e.marks=this.marks.map(e=>e.toJSON())),e}static fromJSON(e,t){let n;if(!t)throw RangeError("Invalid input for Node.fromJSON");if(t.marks){if(!Array.isArray(t.marks))throw RangeError("Invalid mark data for Node.fromJSON");n=t.marks.map(e.markFromJSON)}if("text"==t.type){if("string"!=typeof t.text)throw RangeError("Invalid text node in JSON");return e.text(t.text,n)}let r=cm.fromJSON(e,t.content),i=e.nodeType(t.type).create(t.attrs,r,n);return i.type.checkAttrs(i.attrs),i}}cP.prototype.text=void 0;class cI extends cP{constructor(e,t,n,r){if(super(e,t,null,r),!n)throw RangeError("Empty text nodes are not allowed");this.text=n}toString(){return this.type.spec.toDebugString?this.type.spec.toDebugString(this):cL(this.marks,JSON.stringify(this.text))}get textContent(){return this.text}textBetween(e,t){return this.text.slice(e,t)}get nodeSize(){return this.text.length}mark(e){return e==this.marks?this:new cI(this.type,this.attrs,this.text,e)}withText(e){return e==this.text?this:new cI(this.type,this.attrs,e,this.marks)}cut(e=0,t=this.text.length){return 0==e&&t==this.text.length?this:this.withText(this.text.slice(e,t))}eq(e){return this.sameMarkup(e)&&this.text==e.text}toJSON(){let e=super.toJSON();return e.text=this.text,e}}function cL(e,t){for(let n=e.length-1;n>=0;n--)t=e[n].type.name+"("+t+")";return t}class cz{constructor(e){this.validEnd=e,this.next=[],this.wrapCache=[]}static parse(e,t){var n;let r,i=new cV(e,t);if(null==i.next)return cz.empty;let s=function e(t){let n=[];do n.push(function(t){let n=[];do n.push(function(t){let n=function(t){if(t.eat("(")){let n=e(t);return t.eat(")")||t.err("Missing closing paren"),n}if(/\W/.test(t.next))t.err("Unexpected token '"+t.next+"'");else{let e=(function(e,t){let n=e.nodeTypes,r=n[t];if(r)return[r];let i=[];for(let e in n){let r=n[e];r.isInGroup(t)&&i.push(r)}return 0==i.length&&e.err("No node type or group '"+t+"' found"),i})(t,t.next).map(e=>(null==t.inline?t.inline=e.isInline:t.inline!=e.isInline&&t.err("Mixing inline and block content"),{type:"name",value:e}));return t.pos++,1==e.length?e[0]:{type:"choice",exprs:e}}}(t);for(;;)if(t.eat("+"))n={type:"plus",expr:n};else if(t.eat("*"))n={type:"star",expr:n};else if(t.eat("?"))n={type:"opt",expr:n};else if(t.eat("{"))n=function(e,t){let n=c$(e),r=n;return e.eat(",")&&(r="}"!=e.next?c$(e):-1),e.eat("}")||e.err("Unclosed braced range"),{type:"range",min:n,max:r,expr:t}}(t,n);else break;return n}(t));while(t.next&&")"!=t.next&&"|"!=t.next);return 1==n.length?n[0]:{type:"seq",exprs:n}}(t));while(t.eat("|"));return 1==n.length?n[0]:{type:"choice",exprs:n}}(i);i.next&&i.err("Unexpected trailing text");let o=(n=function(e){let t=[[]];return i(function e(t,s){if("choice"==t.type)return t.exprs.reduce((t,n)=>t.concat(e(n,s)),[]);if("seq"==t.type)for(let r=0;;r++){let o=e(t.exprs[r],s);if(r==t.exprs.length-1)return o;i(o,s=n())}else if("star"==t.type){let o=n();return r(s,o),i(e(t.expr,o),o),[r(o)]}else if("plus"==t.type){let o=n();return i(e(t.expr,s),o),i(e(t.expr,o),o),[r(o)]}else if("opt"==t.type)return[r(s)].concat(e(t.expr,s));else if("range"==t.type){let o=s;for(let r=0;r<t.min;r++){let r=n();i(e(t.expr,o),r),o=r}if(-1==t.max)i(e(t.expr,o),o);else for(let s=t.min;s<t.max;s++){let s=n();r(o,s),i(e(t.expr,o),s),o=s}return[r(o)]}else if("name"==t.type)return[r(s,void 0,t.value)];else throw Error("Unknown expr type")}(e,0),n()),t;function n(){return t.push([])-1}function r(e,n,r){let i={term:r,to:n};return t[e].push(i),i}function i(e,t){e.forEach(e=>e.to=t)}}(s),r=Object.create(null),function e(t){let i=[];t.forEach(e=>{n[e].forEach(({term:e,to:t})=>{let r;if(e){for(let t=0;t<i.length;t++)i[t][0]==e&&(r=i[t][1]);cF(n,t).forEach(t=>{r||i.push([e,r=[]]),-1==r.indexOf(t)&&r.push(t)})}})});let s=r[t.join(",")]=new cz(t.indexOf(n.length-1)>-1);for(let t=0;t<i.length;t++){let n=i[t][1].sort(c_);s.next.push({type:i[t][0],next:r[n.join(",")]||e(n)})}return s}(cF(n,0)));return function(e,t){for(let n=0,r=[e];n<r.length;n++){let e=r[n],i=!e.validEnd,s=[];for(let t=0;t<e.next.length;t++){let{type:n,next:o}=e.next[t];s.push(n.name),i&&!(n.isText||n.hasRequiredAttrs())&&(i=!1),-1==r.indexOf(o)&&r.push(o)}i&&t.err("Only non-generatable nodes ("+s.join(", ")+") in a required position (see https://prosemirror.net/docs/guide/#generatable)")}}(o,i),o}matchType(e){for(let t=0;t<this.next.length;t++)if(this.next[t].type==e)return this.next[t].next;return null}matchFragment(e,t=0,n=e.childCount){let r=this;for(let i=t;r&&i<n;i++)r=r.matchType(e.child(i).type);return r}get inlineContent(){return 0!=this.next.length&&this.next[0].type.isInline}get defaultType(){for(let e=0;e<this.next.length;e++){let{type:t}=this.next[e];if(!(t.isText||t.hasRequiredAttrs()))return t}return null}compatible(e){for(let t=0;t<this.next.length;t++)for(let n=0;n<e.next.length;n++)if(this.next[t].type==e.next[n].type)return!0;return!1}fillBefore(e,t=!1,n=0){let r=[this];return function i(s,o){let a=s.matchFragment(e,n);if(a&&(!t||a.validEnd))return cm.from(o.map(e=>e.createAndFill()));for(let e=0;e<s.next.length;e++){let{type:t,next:n}=s.next[e];if(!(t.isText||t.hasRequiredAttrs())&&-1==r.indexOf(n)){r.push(n);let e=i(n,o.concat(t));if(e)return e}}return null}(this,[])}findWrapping(e){for(let t=0;t<this.wrapCache.length;t+=2)if(this.wrapCache[t]==e)return this.wrapCache[t+1];let t=this.computeWrapping(e);return this.wrapCache.push(e,t),t}computeWrapping(e){let t=Object.create(null),n=[{match:this,type:null,via:null}];for(;n.length;){let r=n.shift(),i=r.match;if(i.matchType(e)){let e=[];for(let t=r;t.type;t=t.via)e.push(t.type);return e.reverse()}for(let e=0;e<i.next.length;e++){let{type:s,next:o}=i.next[e];s.isLeaf||s.hasRequiredAttrs()||s.name in t||r.type&&!o.validEnd||(n.push({match:s.contentMatch,type:s,via:r}),t[s.name]=!0)}}return null}get edgeCount(){return this.next.length}edge(e){if(e>=this.next.length)throw RangeError(`There's no ${e}th edge in this content match`);return this.next[e]}toString(){let e=[];return!function t(n){e.push(n);for(let r=0;r<n.next.length;r++)-1==e.indexOf(n.next[r].next)&&t(n.next[r].next)}(this),e.map((t,n)=>{let r=n+(t.validEnd?"*":" ")+" ";for(let n=0;n<t.next.length;n++)r+=(n?", ":"")+t.next[n].type.name+"->"+e.indexOf(t.next[n].next);return r}).join("\n")}}cz.empty=new cz(!0);class cV{constructor(e,t){this.string=e,this.nodeTypes=t,this.inline=null,this.pos=0,this.tokens=e.split(/\s*(?=\b|\W|$)/),""==this.tokens[this.tokens.length-1]&&this.tokens.pop(),""==this.tokens[0]&&this.tokens.shift()}get next(){return this.tokens[this.pos]}eat(e){return this.next==e&&(this.pos++||!0)}err(e){throw SyntaxError(e+" (in content expression '"+this.string+"')")}}function c$(e){/\D/.test(e.next)&&e.err("Expected number, got '"+e.next+"'");let t=Number(e.next);return e.pos++,t}function c_(e,t){return t-e}function cF(e,t){let n=[];return function t(r){let i=e[r];if(1==i.length&&!i[0].term)return t(i[0].to);n.push(r);for(let e=0;e<i.length;e++){let{term:r,to:s}=i[e];r||-1!=n.indexOf(s)||t(s)}}(t),n.sort(c_)}function cB(e){let t=Object.create(null);for(let n in e){let r=e[n];if(!r.hasDefault)return null;t[n]=r.default}return t}function cW(e,t){let n=Object.create(null);for(let r in e){let i=t&&t[r];if(void 0===i){let t=e[r];if(t.hasDefault)i=t.default;else throw RangeError("No value supplied for attribute "+r)}n[r]=i}return n}function cq(e,t,n,r){for(let r in t)if(!(r in e))throw RangeError(`Unsupported attribute ${r} for ${n} of type ${r}`);for(let n in e){let r=e[n];r.validate&&r.validate(t[n])}}function cH(e,t){let n=Object.create(null);if(t)for(let r in t)n[r]=new cK(e,r,t[r]);return n}class cU{constructor(e,t,n){this.name=e,this.schema=t,this.spec=n,this.markSet=null,this.groups=n.group?n.group.split(" "):[],this.attrs=cH(e,n.attrs),this.defaultAttrs=cB(this.attrs),this.contentMatch=null,this.inlineContent=null,this.isBlock=!(n.inline||"text"==e),this.isText="text"==e}get isInline(){return!this.isBlock}get isTextblock(){return this.isBlock&&this.inlineContent}get isLeaf(){return this.contentMatch==cz.empty}get isAtom(){return this.isLeaf||!!this.spec.atom}isInGroup(e){return this.groups.indexOf(e)>-1}get whitespace(){return this.spec.whitespace||(this.spec.code?"pre":"normal")}hasRequiredAttrs(){for(let e in this.attrs)if(this.attrs[e].isRequired)return!0;return!1}compatibleContent(e){return this==e||this.contentMatch.compatible(e.contentMatch)}computeAttrs(e){return!e&&this.defaultAttrs?this.defaultAttrs:cW(this.attrs,e)}create(e=null,t,n){if(this.isText)throw Error("NodeType.create can't construct text nodes");return new cP(this,this.computeAttrs(e),cm.from(t),cv.setFrom(n))}createChecked(e=null,t,n){return t=cm.from(t),this.checkContent(t),new cP(this,this.computeAttrs(e),t,cv.setFrom(n))}createAndFill(e=null,t,n){if(e=this.computeAttrs(e),(t=cm.from(t)).size){let e=this.contentMatch.fillBefore(t);if(!e)return null;t=e.append(t)}let r=this.contentMatch.matchFragment(t),i=r&&r.fillBefore(cm.empty,!0);return i?new cP(this,e,t.append(i),cv.setFrom(n)):null}validContent(e){let t=this.contentMatch.matchFragment(e);if(!t||!t.validEnd)return!1;for(let t=0;t<e.childCount;t++)if(!this.allowsMarks(e.child(t).marks))return!1;return!0}checkContent(e){if(!this.validContent(e))throw RangeError(`Invalid content for node ${this.name}: ${e.toString().slice(0,50)}`)}checkAttrs(e){cq(this.attrs,e,"node",this.name)}allowsMarkType(e){return null==this.markSet||this.markSet.indexOf(e)>-1}allowsMarks(e){if(null==this.markSet)return!0;for(let t=0;t<e.length;t++)if(!this.allowsMarkType(e[t].type))return!1;return!0}allowedMarks(e){let t;if(null==this.markSet)return e;for(let n=0;n<e.length;n++)this.allowsMarkType(e[n].type)?t&&t.push(e[n]):t||(t=e.slice(0,n));return t?t.length?t:cv.none:e}static compile(e,t){let n=Object.create(null);e.forEach((e,r)=>n[e]=new cU(e,t,r));let r=t.spec.topNode||"doc";if(!n[r])throw RangeError("Schema is missing its top node type ('"+r+"')");if(!n.text)throw RangeError("Every schema needs a 'text' type");for(let e in n.text.attrs)throw RangeError("The text node type should not have attributes");return n}}class cK{constructor(e,t,n){this.hasDefault=Object.prototype.hasOwnProperty.call(n,"default"),this.default=n.default,this.validate="string"==typeof n.validate?function(e,t,n){let r=n.split("|");return n=>{let i=null===n?"null":typeof n;if(0>r.indexOf(i))throw RangeError(`Expected value of type ${r} for attribute ${t} on type ${e}, got ${i}`)}}(e,t,n.validate):n.validate}get isRequired(){return!this.hasDefault}}class cJ{constructor(e,t,n,r){this.name=e,this.rank=t,this.schema=n,this.spec=r,this.attrs=cH(e,r.attrs),this.excluded=null;let i=cB(this.attrs);this.instance=i?new cv(this,i):null}create(e=null){return!e&&this.instance?this.instance:new cv(this,cW(this.attrs,e))}static compile(e,t){let n=Object.create(null),r=0;return e.forEach((e,i)=>n[e]=new cJ(e,r++,t,i)),n}removeFromSet(e){for(var t=0;t<e.length;t++)e[t].type==this&&(e=e.slice(0,t).concat(e.slice(t+1)),t--);return e}isInSet(e){for(let t=0;t<e.length;t++)if(e[t].type==this)return e[t]}checkAttrs(e){cq(this.attrs,e,"mark",this.name)}excludes(e){return this.excluded.indexOf(e)>-1}}class cG{constructor(e){this.linebreakReplacement=null,this.cached=Object.create(null);let t=this.spec={};for(let n in e)t[n]=e[n];t.nodes=cf.from(e.nodes),t.marks=cf.from(e.marks||{}),this.nodes=cU.compile(this.spec.nodes,this),this.marks=cJ.compile(this.spec.marks,this);let n=Object.create(null);for(let e in this.nodes){if(e in this.marks)throw RangeError(e+" can not be both a node and a mark");let t=this.nodes[e],r=t.spec.content||"",i=t.spec.marks;if(t.contentMatch=n[r]||(n[r]=cz.parse(r,this.nodes)),t.inlineContent=t.contentMatch.inlineContent,t.spec.linebreakReplacement){if(this.linebreakReplacement)throw RangeError("Multiple linebreak nodes defined");if(!t.isInline||!t.isLeaf)throw RangeError("Linebreak replacement nodes must be inline leaf nodes");this.linebreakReplacement=t}t.markSet="_"==i?null:i?cY(this,i.split(" ")):""!=i&&t.inlineContent?null:[]}for(let e in this.marks){let t=this.marks[e],n=t.spec.excludes;t.excluded=null==n?[t]:""==n?[]:cY(this,n.split(" "))}this.nodeFromJSON=this.nodeFromJSON.bind(this),this.markFromJSON=this.markFromJSON.bind(this),this.topNodeType=this.nodes[this.spec.topNode||"doc"],this.cached.wrappings=Object.create(null)}node(e,t=null,n,r){if("string"==typeof e)e=this.nodeType(e);else if(e instanceof cU){if(e.schema!=this)throw RangeError("Node type from different schema used ("+e.name+")")}else throw RangeError("Invalid node type: "+e);return e.createChecked(t,n,r)}text(e,t){let n=this.nodes.text;return new cI(n,n.defaultAttrs,e,cv.setFrom(t))}mark(e,t){return"string"==typeof e&&(e=this.marks[e]),e.create(t)}nodeFromJSON(e){return cP.fromJSON(this,e)}markFromJSON(e){return cv.fromJSON(this,e)}nodeType(e){let t=this.nodes[e];if(!t)throw RangeError("Unknown node type: "+e);return t}}function cY(e,t){let n=[];for(let r=0;r<t.length;r++){let i=t[r],s=e.marks[i],o=s;if(s)n.push(s);else for(let t in e.marks){let r=e.marks[t];("_"==i||r.spec.group&&r.spec.group.split(" ").indexOf(i)>-1)&&n.push(o=r)}if(!o)throw SyntaxError("Unknown mark type: '"+t[r]+"'")}return n}class cX{constructor(e,t){this.schema=e,this.rules=t,this.tags=[],this.styles=[];let n=this.matchedStyles=[];t.forEach(e=>{if(null!=e.tag)this.tags.push(e);else if(null!=e.style){let t=/[^=]*/.exec(e.style)[0];0>n.indexOf(t)&&n.push(t),this.styles.push(e)}}),this.normalizeLists=!this.tags.some(t=>{if(!/^(ul|ol)\b/.test(t.tag)||!t.node)return!1;let n=e.nodes[t.node];return n.contentMatch.matchType(n)})}parse(e,t={}){let n=new c4(this,t,!1);return n.addAll(e,cv.none,t.from,t.to),n.finish()}parseSlice(e,t={}){let n=new c4(this,t,!0);return n.addAll(e,cv.none,t.from,t.to),cw.maxOpen(n.finish())}matchTag(e,t,n){for(let s=n?this.tags.indexOf(n)+1:0;s<this.tags.length;s++){var r,i;let n=this.tags[s];if(r=e,i=n.tag,(r.matches||r.msMatchesSelector||r.webkitMatchesSelector||r.mozMatchesSelector).call(r,i)&&(void 0===n.namespace||e.namespaceURI==n.namespace)&&(!n.context||t.matchesContext(n.context))){if(n.getAttrs){let t=n.getAttrs(e);if(!1===t)continue;n.attrs=t||void 0}return n}}}matchStyle(e,t,n,r){for(let i=r?this.styles.indexOf(r)+1:0;i<this.styles.length;i++){let r=this.styles[i],s=r.style;if(0==s.indexOf(e)&&(!r.context||n.matchesContext(r.context))&&(!(s.length>e.length)||61==s.charCodeAt(e.length)&&s.slice(e.length+1)==t)){if(r.getAttrs){let e=r.getAttrs(t);if(!1===e)continue;r.attrs=e||void 0}return r}}}static schemaRules(e){let t=[];function n(e){let n=null==e.priority?50:e.priority,r=0;for(;r<t.length;r++){let e=t[r];if((null==e.priority?50:e.priority)<n)break}t.splice(r,0,e)}for(let t in e.marks){let r=e.marks[t].spec.parseDOM;r&&r.forEach(e=>{n(e=c3(e)),e.mark||e.ignore||e.clearMark||(e.mark=t)})}for(let t in e.nodes){let r=e.nodes[t].spec.parseDOM;r&&r.forEach(e=>{n(e=c3(e)),e.node||e.ignore||e.mark||(e.node=t)})}return t}static fromSchema(e){return e.cached.domParser||(e.cached.domParser=new cX(e,cX.schemaRules(e)))}}let cZ={address:!0,article:!0,aside:!0,blockquote:!0,canvas:!0,dd:!0,div:!0,dl:!0,fieldset:!0,figcaption:!0,figure:!0,footer:!0,form:!0,h1:!0,h2:!0,h3:!0,h4:!0,h5:!0,h6:!0,header:!0,hgroup:!0,hr:!0,li:!0,noscript:!0,ol:!0,output:!0,p:!0,pre:!0,section:!0,table:!0,tfoot:!0,ul:!0},cQ={head:!0,noscript:!0,object:!0,script:!0,style:!0,title:!0},c0={ol:!0,ul:!0};function c1(e,t,n){return null!=t?!!t|2*("full"===t):e&&"pre"==e.whitespace?3:-5&n}class c2{constructor(e,t,n,r,i,s){this.type=e,this.attrs=t,this.marks=n,this.solid=r,this.options=s,this.content=[],this.activeMarks=cv.none,this.match=i||(4&s?null:e.contentMatch)}findWrapping(e){if(!this.match){if(!this.type)return[];let t=this.type.contentMatch.fillBefore(cm.from(e));if(t)this.match=this.type.contentMatch.matchFragment(t);else{let t=this.type.contentMatch,n;return(n=t.findWrapping(e.type))?(this.match=t,n):null}}return this.match.findWrapping(e.type)}finish(e){if(!(1&this.options)){let e=this.content[this.content.length-1],t;e&&e.isText&&(t=/[ \t\r\n\u000c]+$/.exec(e.text))&&(e.text.length==t[0].length?this.content.pop():this.content[this.content.length-1]=e.withText(e.text.slice(0,e.text.length-t[0].length)))}let t=cm.from(this.content);return!e&&this.match&&(t=t.append(this.match.fillBefore(cm.empty,!0))),this.type?this.type.create(this.attrs,t,this.marks):t}inlineContext(e){return this.type?this.type.inlineContent:this.content.length?this.content[0].isInline:e.parentNode&&!cZ.hasOwnProperty(e.parentNode.nodeName.toLowerCase())}}class c4{constructor(e,t,n){this.parser=e,this.options=t,this.isOpen=n,this.open=0,this.localPreserveWS=!1;let r=t.topNode,i,s=c1(null,t.preserveWhitespace,0)|4*!!n;i=r?new c2(r.type,r.attrs,cv.none,!0,t.topMatch||r.type.contentMatch,s):n?new c2(null,null,cv.none,!0,null,s):new c2(e.schema.topNodeType,null,cv.none,!0,null,s),this.nodes=[i],this.find=t.findPositions,this.needsBlock=!1}get top(){return this.nodes[this.open]}addDOM(e,t){3==e.nodeType?this.addTextNode(e,t):1==e.nodeType&&this.addElement(e,t)}addTextNode(e,t){let n=e.nodeValue,r=this.top,i=2&r.options?"full":this.localPreserveWS||(1&r.options)>0;if("full"===i||r.inlineContext(e)||/[^ \t\r\n\u000c]/.test(n)){if(i)n="full"!==i?n.replace(/\r?\n|\r/g," "):n.replace(/\r\n?/g,"\n");else if(n=n.replace(/[ \t\r\n\u000c]+/g," "),/^[ \t\r\n\u000c]/.test(n)&&this.open==this.nodes.length-1){let t=r.content[r.content.length-1],i=e.previousSibling;(!t||i&&"BR"==i.nodeName||t.isText&&/[ \t\r\n\u000c]$/.test(t.text))&&(n=n.slice(1))}n&&this.insertNode(this.parser.schema.text(n),t,!/\S/.test(n)),this.findInText(e)}else this.findInside(e)}addElement(e,t,n){let r=this.localPreserveWS,i=this.top;("PRE"==e.tagName||/pre/.test(e.style&&e.style.whiteSpace))&&(this.localPreserveWS=!0);let s=e.nodeName.toLowerCase(),o;c0.hasOwnProperty(s)&&this.parser.normalizeLists&&function(e){for(let t=e.firstChild,n=null;t;t=t.nextSibling){let e=1==t.nodeType?t.nodeName.toLowerCase():null;e&&c0.hasOwnProperty(e)&&n?(n.appendChild(t),t=n):"li"==e?n=t:e&&(n=null)}}(e);let a=this.options.ruleFromNode&&this.options.ruleFromNode(e)||(o=this.parser.matchTag(e,this,n));e:if(a?a.ignore:cQ.hasOwnProperty(s))this.findInside(e),this.ignoreFallback(e,t);else if(!a||a.skip||a.closeParent){a&&a.closeParent?this.open=Math.max(0,this.open-1):a&&a.skip.nodeType&&(e=a.skip);let n,r=this.needsBlock;if(cZ.hasOwnProperty(s))i.content.length&&i.content[0].isInline&&this.open&&(this.open--,i=this.top),n=!0,i.type||(this.needsBlock=!0);else if(!e.firstChild){this.leafFallback(e,t);break e}let o=a&&a.skip?t:this.readStyles(e,t);o&&this.addAll(e,o),n&&this.sync(i),this.needsBlock=r}else{let n=this.readStyles(e,t);n&&this.addElementByRule(e,a,n,!1===a.consuming?o:void 0)}this.localPreserveWS=r}leafFallback(e,t){"BR"==e.nodeName&&this.top.type&&this.top.type.inlineContent&&this.addTextNode(e.ownerDocument.createTextNode("\n"),t)}ignoreFallback(e,t){"BR"!=e.nodeName||this.top.type&&this.top.type.inlineContent||this.findPlace(this.parser.schema.text("-"),t,!0)}readStyles(e,t){let n=e.style;if(n&&n.length)for(let e=0;e<this.parser.matchedStyles.length;e++){let r=this.parser.matchedStyles[e],i=n.getPropertyValue(r);if(i)for(let e;;){let n=this.parser.matchStyle(r,i,this,e);if(!n)break;if(n.ignore)return null;if(t=n.clearMark?t.filter(e=>!n.clearMark(e)):t.concat(this.parser.schema.marks[n.mark].create(n.attrs)),!1===n.consuming)e=n;else break}}return t}addElementByRule(e,t,n,r){let i,s;if(t.node)if((s=this.parser.schema.nodes[t.node]).isLeaf)this.insertNode(s.create(t.attrs),n,"BR"==e.nodeName)||this.leafFallback(e,n);else{let e=this.enter(s,t.attrs||null,n,t.preserveWhitespace);e&&(i=!0,n=e)}else{let e=this.parser.schema.marks[t.mark];n=n.concat(e.create(t.attrs))}let o=this.top;if(s&&s.isLeaf)this.findInside(e);else if(r)this.addElement(e,n,r);else if(t.getContent)this.findInside(e),t.getContent(e,this.parser.schema).forEach(e=>this.insertNode(e,n,!1));else{let r=e;"string"==typeof t.contentElement?r=e.querySelector(t.contentElement):"function"==typeof t.contentElement?r=t.contentElement(e):t.contentElement&&(r=t.contentElement),this.findAround(e,r,!0),this.addAll(r,n),this.findAround(e,r,!1)}i&&this.sync(o)&&this.open--}addAll(e,t,n,r){let i=n||0;for(let s=n?e.childNodes[n]:e.firstChild,o=null==r?null:e.childNodes[r];s!=o;s=s.nextSibling,++i)this.findAtPoint(e,i),this.addDOM(s,t);this.findAtPoint(e,i)}findPlace(e,t,n){let r,i;for(let t=this.open,s=0;t>=0;t--){let o=this.nodes[t],a=o.findWrapping(e);if(a&&(!r||r.length>a.length+s)&&(r=a,i=o,!a.length))break;if(o.solid){if(n)break;s+=2}}if(!r)return null;this.sync(i);for(let e=0;e<r.length;e++)t=this.enterInner(r[e],null,t,!1);return t}insertNode(e,t,n){if(e.isInline&&this.needsBlock&&!this.top.type){let e=this.textblockFromContext();e&&(t=this.enterInner(e,null,t))}let r=this.findPlace(e,t,n);if(r){this.closeExtra();let t=this.top;t.match&&(t.match=t.match.matchType(e.type));let n=cv.none;for(let i of r.concat(e.marks))(t.type?t.type.allowsMarkType(i.type):c5(i.type,e.type))&&(n=i.addToSet(n));return t.content.push(e.mark(n)),!0}return!1}enter(e,t,n,r){let i=this.findPlace(e.create(t),n,!1);return i&&(i=this.enterInner(e,t,n,!0,r)),i}enterInner(e,t,n,r=!1,i){this.closeExtra();let s=this.top;s.match=s.match&&s.match.matchType(e);let o=c1(e,i,s.options);4&s.options&&0==s.content.length&&(o|=4);let a=cv.none;return n=n.filter(t=>(s.type?!s.type.allowsMarkType(t.type):!c5(t.type,e))||(a=t.addToSet(a),!1)),this.nodes.push(new c2(e,t,a,r,null,o)),this.open++,n}closeExtra(e=!1){let t=this.nodes.length-1;if(t>this.open){for(;t>this.open;t--)this.nodes[t-1].content.push(this.nodes[t].finish(e));this.nodes.length=this.open+1}}finish(){return this.open=0,this.closeExtra(this.isOpen),this.nodes[0].finish(!!(this.isOpen||this.options.topOpen))}sync(e){for(let t=this.open;t>=0;t--)if(this.nodes[t]==e)return this.open=t,!0;else this.localPreserveWS&&(this.nodes[t].options|=1);return!1}get currentPos(){this.closeExtra();let e=0;for(let t=this.open;t>=0;t--){let n=this.nodes[t].content;for(let t=n.length-1;t>=0;t--)e+=n[t].nodeSize;t&&e++}return e}findAtPoint(e,t){if(this.find)for(let n=0;n<this.find.length;n++)this.find[n].node==e&&this.find[n].offset==t&&(this.find[n].pos=this.currentPos)}findInside(e){if(this.find)for(let t=0;t<this.find.length;t++)null==this.find[t].pos&&1==e.nodeType&&e.contains(this.find[t].node)&&(this.find[t].pos=this.currentPos)}findAround(e,t,n){if(e!=t&&this.find)for(let r=0;r<this.find.length;r++)null==this.find[r].pos&&1==e.nodeType&&e.contains(this.find[r].node)&&t.compareDocumentPosition(this.find[r].node)&(n?2:4)&&(this.find[r].pos=this.currentPos)}findInText(e){if(this.find)for(let t=0;t<this.find.length;t++)this.find[t].node==e&&(this.find[t].pos=this.currentPos-(e.nodeValue.length-this.find[t].offset))}matchesContext(e){if(e.indexOf("|")>-1)return e.split(/\s*\|\s*/).some(this.matchesContext,this);let t=e.split("/"),n=this.options.context,r=!this.isOpen&&(!n||n.parent.type==this.nodes[0].type),i=-(n?n.depth+1:0)+ +!r,s=(e,o)=>{for(;e>=0;e--){let a=t[e];if(""==a){if(e==t.length-1||0==e)continue;for(;o>=i;o--)if(s(e-1,o))return!0;return!1}{let e=o>0||0==o&&r?this.nodes[o].type:n&&o>=i?n.node(o-i).type:null;if(!e||e.name!=a&&!e.isInGroup(a))return!1;o--}}return!0};return s(t.length-1,this.open)}textblockFromContext(){let e=this.options.context;if(e)for(let t=e.depth;t>=0;t--){let n=e.node(t).contentMatchAt(e.indexAfter(t)).defaultType;if(n&&n.isTextblock&&n.defaultAttrs)return n}for(let e in this.parser.schema.nodes){let t=this.parser.schema.nodes[e];if(t.isTextblock&&t.defaultAttrs)return t}}}function c3(e){let t={};for(let n in e)t[n]=e[n];return t}function c5(e,t){let n=t.schema.nodes;for(let r in n){let i=n[r];if(!i.allowsMarkType(e))continue;let s=[],o=e=>{s.push(e);for(let n=0;n<e.edgeCount;n++){let{type:r,next:i}=e.edge(n);if(r==t||0>s.indexOf(i)&&o(i))return!0}};if(o(i.contentMatch))return!0}}class c6{constructor(e,t){this.nodes=e,this.marks=t}serializeFragment(e,t={},n){n||(n=c9(t).createDocumentFragment());let r=n,i=[];return e.forEach(e=>{if(i.length||e.marks.length){let n=0,s=0;for(;n<i.length&&s<e.marks.length;){let t=e.marks[s];if(!this.marks[t.type.name]){s++;continue}if(!t.eq(i[n][0])||!1===t.type.spec.spanning)break;n++,s++}for(;n<i.length;)r=i.pop()[1];for(;s<e.marks.length;){let n=e.marks[s++],o=this.serializeMark(n,e.isInline,t);o&&(i.push([n,r]),r.appendChild(o.dom),r=o.contentDOM||o.dom)}}r.appendChild(this.serializeNodeInner(e,t))}),n}serializeNodeInner(e,t){let{dom:n,contentDOM:r}=de(c9(t),this.nodes[e.type.name](e),null,e.attrs);if(r){if(e.isLeaf)throw RangeError("Content hole not allowed in a leaf node spec");this.serializeFragment(e.content,t,r)}return n}serializeNode(e,t={}){let n=this.serializeNodeInner(e,t);for(let r=e.marks.length-1;r>=0;r--){let i=this.serializeMark(e.marks[r],e.isInline,t);i&&((i.contentDOM||i.dom).appendChild(n),n=i.dom)}return n}serializeMark(e,t,n={}){let r=this.marks[e.type.name];return r&&de(c9(n),r(e,t),null,e.attrs)}static renderSpec(e,t,n=null,r){return de(e,t,n,r)}static fromSchema(e){return e.cached.domSerializer||(e.cached.domSerializer=new c6(this.nodesFromSchema(e),this.marksFromSchema(e)))}static nodesFromSchema(e){let t=c8(e.nodes);return t.text||(t.text=e=>e.text),t}static marksFromSchema(e){return c8(e.marks)}}function c8(e){let t={};for(let n in e){let r=e[n].spec.toDOM;r&&(t[n]=r)}return t}function c9(e){return e.document||window.document}let c7=new WeakMap;function de(e,t,n,r){let i,s,o;if("string"==typeof t)return{dom:e.createTextNode(t)};if(null!=t.nodeType)return{dom:t};if(t.dom&&null!=t.dom.nodeType)return t;let a=t[0],l;if("string"!=typeof a)throw RangeError("Invalid array passed to renderSpec");if(r&&(void 0===(s=c7.get(r))&&c7.set(r,(o=null,!function e(t){if(t&&"object"==typeof t)if(Array.isArray(t))if("string"==typeof t[0])o||(o=[]),o.push(t);else for(let n=0;n<t.length;n++)e(t[n]);else for(let n in t)e(t[n])}(r),s=o)),l=s)&&l.indexOf(t)>-1)throw RangeError("Using an array from an attribute object as a DOM spec. This may be an attempted cross site scripting attack.");let c=a.indexOf(" ");c>0&&(n=a.slice(0,c),a=a.slice(c+1));let d=n?e.createElementNS(n,a):e.createElement(a),u=t[1],h=1;if(u&&"object"==typeof u&&null==u.nodeType&&!Array.isArray(u)){for(let e in h=2,u)if(null!=u[e]){let t=e.indexOf(" ");t>0?d.setAttributeNS(e.slice(0,t),e.slice(t+1),u[e]):d.setAttribute(e,u[e])}}for(let s=h;s<t.length;s++){let o=t[s];if(0===o){if(s<t.length-1||s>h)throw RangeError("Content hole must be the only child of its parent node");return{dom:d,contentDOM:d}}{let{dom:t,contentDOM:s}=de(e,o,n,r);if(d.appendChild(t),s){if(i)throw RangeError("Multiple content holes");i=s}}}return{dom:d,contentDOM:i}}class dt{constructor(e,t,n){this.pos=e,this.delInfo=t,this.recover=n}get deleted(){return(8&this.delInfo)>0}get deletedBefore(){return(5&this.delInfo)>0}get deletedAfter(){return(6&this.delInfo)>0}get deletedAcross(){return(4&this.delInfo)>0}}class dn{constructor(e,t=!1){if(this.ranges=e,this.inverted=t,!e.length&&dn.empty)return dn.empty}recover(e){let t=0,n=65535&e;if(!this.inverted)for(let e=0;e<n;e++)t+=this.ranges[3*e+2]-this.ranges[3*e+1];return this.ranges[3*n]+t+(e-(65535&e))/65536}mapResult(e,t=1){return this._map(e,t,!1)}map(e,t=1){return this._map(e,t,!0)}_map(e,t,n){let r=0,i=this.inverted?2:1,s=this.inverted?1:2;for(let o=0;o<this.ranges.length;o+=3){let a=this.ranges[o]-(this.inverted?r:0);if(a>e)break;let l=this.ranges[o+i],c=this.ranges[o+s],d=a+l;if(e<=d){let i=l?e==a?-1:e==d?1:t:t,s=a+r+(i<0?0:c);if(n)return s;let u=e==(t<0?a:d)?null:o/3+(e-a)*65536,h=e==a?2:e==d?1:4;return(t<0?e!=a:e!=d)&&(h|=8),new dt(s,h,u)}r+=c-l}return n?e+r:new dt(e+r,0,null)}touches(e,t){let n=0,r=65535&t,i=this.inverted?2:1,s=this.inverted?1:2;for(let t=0;t<this.ranges.length;t+=3){let o=this.ranges[t]-(this.inverted?n:0);if(o>e)break;let a=this.ranges[t+i];if(e<=o+a&&t==3*r)return!0;n+=this.ranges[t+s]-a}return!1}forEach(e){let t=this.inverted?2:1,n=this.inverted?1:2;for(let r=0,i=0;r<this.ranges.length;r+=3){let s=this.ranges[r],o=s-(this.inverted?i:0),a=s+(this.inverted?0:i),l=this.ranges[r+t],c=this.ranges[r+n];e(o,o+l,a,a+c),i+=c-l}}invert(){return new dn(this.ranges,!this.inverted)}toString(){return(this.inverted?"-":"")+JSON.stringify(this.ranges)}static offset(e){return 0==e?dn.empty:new dn(e<0?[0,-e,0]:[0,0,e])}}dn.empty=new dn([]);class dr{constructor(e,t,n=0,r=e?e.length:0){this.mirror=t,this.from=n,this.to=r,this._maps=e||[],this.ownData=!(e||t)}get maps(){return this._maps}slice(e=0,t=this.maps.length){return new dr(this._maps,this.mirror,e,t)}appendMap(e,t){this.ownData||(this._maps=this._maps.slice(),this.mirror=this.mirror&&this.mirror.slice(),this.ownData=!0),this.to=this._maps.push(e),null!=t&&this.setMirror(this._maps.length-1,t)}appendMapping(e){for(let t=0,n=this._maps.length;t<e._maps.length;t++){let r=e.getMirror(t);this.appendMap(e._maps[t],null!=r&&r<t?n+r:void 0)}}getMirror(e){if(this.mirror){for(let t=0;t<this.mirror.length;t++)if(this.mirror[t]==e)return this.mirror[t+(t%2?-1:1)]}}setMirror(e,t){this.mirror||(this.mirror=[]),this.mirror.push(e,t)}appendMappingInverted(e){for(let t=e.maps.length-1,n=this._maps.length+e._maps.length;t>=0;t--){let r=e.getMirror(t);this.appendMap(e._maps[t].invert(),null!=r&&r>t?n-r-1:void 0)}}invert(){let e=new dr;return e.appendMappingInverted(this),e}map(e,t=1){if(this.mirror)return this._map(e,t,!0);for(let n=this.from;n<this.to;n++)e=this._maps[n].map(e,t);return e}mapResult(e,t=1){return this._map(e,t,!1)}_map(e,t,n){let r=0;for(let n=this.from;n<this.to;n++){let i=this._maps[n].mapResult(e,t);if(null!=i.recover){let t=this.getMirror(n);if(null!=t&&t>n&&t<this.to){n=t,e=this._maps[t].recover(i.recover);continue}}r|=i.delInfo,e=i.pos}return n?e:new dt(e,r,null)}}let di=Object.create(null);class ds{getMap(){return dn.empty}merge(e){return null}static fromJSON(e,t){if(!t||!t.stepType)throw RangeError("Invalid input for Step.fromJSON");let n=di[t.stepType];if(!n)throw RangeError(`No step type ${t.stepType} defined`);return n.fromJSON(e,t)}static jsonID(e,t){if(e in di)throw RangeError("Duplicate use of step JSON ID "+e);return di[e]=t,t.prototype.jsonID=e,t}}class da{constructor(e,t){this.doc=e,this.failed=t}static ok(e){return new da(e,null)}static fail(e){return new da(null,e)}static fromReplace(e,t,n,r){try{return da.ok(e.replace(t,n,r))}catch(e){if(e instanceof cb)return da.fail(e.message);throw e}}}function dl(e,t,n){let r=[];for(let i=0;i<e.childCount;i++){let s=e.child(i);s.content.size&&(s=s.copy(dl(s.content,t,s))),s.isInline&&(s=t(s,n,i)),r.push(s)}return cm.fromArray(r)}class dc extends ds{constructor(e,t,n){super(),this.from=e,this.to=t,this.mark=n}apply(e){let t=e.slice(this.from,this.to),n=e.resolve(this.from),r=n.node(n.sharedDepth(this.to)),i=new cw(dl(t.content,(e,t)=>e.isAtom&&t.type.allowsMarkType(this.mark.type)?e.mark(this.mark.addToSet(e.marks)):e,r),t.openStart,t.openEnd);return da.fromReplace(e,this.from,this.to,i)}invert(){return new dd(this.from,this.to,this.mark)}map(e){let t=e.mapResult(this.from,1),n=e.mapResult(this.to,-1);return t.deleted&&n.deleted||t.pos>=n.pos?null:new dc(t.pos,n.pos,this.mark)}merge(e){return e instanceof dc&&e.mark.eq(this.mark)&&this.from<=e.to&&this.to>=e.from?new dc(Math.min(this.from,e.from),Math.max(this.to,e.to),this.mark):null}toJSON(){return{stepType:"addMark",mark:this.mark.toJSON(),from:this.from,to:this.to}}static fromJSON(e,t){if("number"!=typeof t.from||"number"!=typeof t.to)throw RangeError("Invalid input for AddMarkStep.fromJSON");return new dc(t.from,t.to,e.markFromJSON(t.mark))}}ds.jsonID("addMark",dc);class dd extends ds{constructor(e,t,n){super(),this.from=e,this.to=t,this.mark=n}apply(e){let t=e.slice(this.from,this.to),n=new cw(dl(t.content,e=>e.mark(this.mark.removeFromSet(e.marks)),e),t.openStart,t.openEnd);return da.fromReplace(e,this.from,this.to,n)}invert(){return new dc(this.from,this.to,this.mark)}map(e){let t=e.mapResult(this.from,1),n=e.mapResult(this.to,-1);return t.deleted&&n.deleted||t.pos>=n.pos?null:new dd(t.pos,n.pos,this.mark)}merge(e){return e instanceof dd&&e.mark.eq(this.mark)&&this.from<=e.to&&this.to>=e.from?new dd(Math.min(this.from,e.from),Math.max(this.to,e.to),this.mark):null}toJSON(){return{stepType:"removeMark",mark:this.mark.toJSON(),from:this.from,to:this.to}}static fromJSON(e,t){if("number"!=typeof t.from||"number"!=typeof t.to)throw RangeError("Invalid input for RemoveMarkStep.fromJSON");return new dd(t.from,t.to,e.markFromJSON(t.mark))}}ds.jsonID("removeMark",dd);class du extends ds{constructor(e,t){super(),this.pos=e,this.mark=t}apply(e){let t=e.nodeAt(this.pos);if(!t)return da.fail("No node at mark step's position");let n=t.type.create(t.attrs,null,this.mark.addToSet(t.marks));return da.fromReplace(e,this.pos,this.pos+1,new cw(cm.from(n),0,+!t.isLeaf))}invert(e){let t=e.nodeAt(this.pos);if(t){let e=this.mark.addToSet(t.marks);if(e.length==t.marks.length){for(let n=0;n<t.marks.length;n++)if(!t.marks[n].isInSet(e))return new du(this.pos,t.marks[n]);return new du(this.pos,this.mark)}}return new dh(this.pos,this.mark)}map(e){let t=e.mapResult(this.pos,1);return t.deletedAfter?null:new du(t.pos,this.mark)}toJSON(){return{stepType:"addNodeMark",pos:this.pos,mark:this.mark.toJSON()}}static fromJSON(e,t){if("number"!=typeof t.pos)throw RangeError("Invalid input for AddNodeMarkStep.fromJSON");return new du(t.pos,e.markFromJSON(t.mark))}}ds.jsonID("addNodeMark",du);class dh extends ds{constructor(e,t){super(),this.pos=e,this.mark=t}apply(e){let t=e.nodeAt(this.pos);if(!t)return da.fail("No node at mark step's position");let n=t.type.create(t.attrs,null,this.mark.removeFromSet(t.marks));return da.fromReplace(e,this.pos,this.pos+1,new cw(cm.from(n),0,+!t.isLeaf))}invert(e){let t=e.nodeAt(this.pos);return t&&this.mark.isInSet(t.marks)?new du(this.pos,this.mark):this}map(e){let t=e.mapResult(this.pos,1);return t.deletedAfter?null:new dh(t.pos,this.mark)}toJSON(){return{stepType:"removeNodeMark",pos:this.pos,mark:this.mark.toJSON()}}static fromJSON(e,t){if("number"!=typeof t.pos)throw RangeError("Invalid input for RemoveNodeMarkStep.fromJSON");return new dh(t.pos,e.markFromJSON(t.mark))}}ds.jsonID("removeNodeMark",dh);class dp extends ds{constructor(e,t,n,r=!1){super(),this.from=e,this.to=t,this.slice=n,this.structure=r}apply(e){return this.structure&&dm(e,this.from,this.to)?da.fail("Structure replace would overwrite content"):da.fromReplace(e,this.from,this.to,this.slice)}getMap(){return new dn([this.from,this.to-this.from,this.slice.size])}invert(e){return new dp(this.from,this.from+this.slice.size,e.slice(this.from,this.to))}map(e){let t=e.mapResult(this.from,1),n=e.mapResult(this.to,-1);return t.deletedAcross&&n.deletedAcross?null:new dp(t.pos,Math.max(t.pos,n.pos),this.slice,this.structure)}merge(e){if(!(e instanceof dp)||e.structure||this.structure)return null;if(this.from+this.slice.size!=e.from||this.slice.openEnd||e.slice.openStart)if(e.to!=this.from||this.slice.openStart||e.slice.openEnd)return null;else{let t=this.slice.size+e.slice.size==0?cw.empty:new cw(e.slice.content.append(this.slice.content),e.slice.openStart,this.slice.openEnd);return new dp(e.from,this.to,t,this.structure)}{let t=this.slice.size+e.slice.size==0?cw.empty:new cw(this.slice.content.append(e.slice.content),this.slice.openStart,e.slice.openEnd);return new dp(this.from,this.to+(e.to-e.from),t,this.structure)}}toJSON(){let e={stepType:"replace",from:this.from,to:this.to};return this.slice.size&&(e.slice=this.slice.toJSON()),this.structure&&(e.structure=!0),e}static fromJSON(e,t){if("number"!=typeof t.from||"number"!=typeof t.to)throw RangeError("Invalid input for ReplaceStep.fromJSON");return new dp(t.from,t.to,cw.fromJSON(e,t.slice),!!t.structure)}}ds.jsonID("replace",dp);class df extends ds{constructor(e,t,n,r,i,s,o=!1){super(),this.from=e,this.to=t,this.gapFrom=n,this.gapTo=r,this.slice=i,this.insert=s,this.structure=o}apply(e){if(this.structure&&(dm(e,this.from,this.gapFrom)||dm(e,this.gapTo,this.to)))return da.fail("Structure gap-replace would overwrite content");let t=e.slice(this.gapFrom,this.gapTo);if(t.openStart||t.openEnd)return da.fail("Gap is not a flat range");let n=this.slice.insertAt(this.insert,t.content);return n?da.fromReplace(e,this.from,this.to,n):da.fail("Content does not fit in gap")}getMap(){return new dn([this.from,this.gapFrom-this.from,this.insert,this.gapTo,this.to-this.gapTo,this.slice.size-this.insert])}invert(e){let t=this.gapTo-this.gapFrom;return new df(this.from,this.from+this.slice.size+t,this.from+this.insert,this.from+this.insert+t,e.slice(this.from,this.to).removeBetween(this.gapFrom-this.from,this.gapTo-this.from),this.gapFrom-this.from,this.structure)}map(e){let t=e.mapResult(this.from,1),n=e.mapResult(this.to,-1),r=this.from==this.gapFrom?t.pos:e.map(this.gapFrom,-1),i=this.to==this.gapTo?n.pos:e.map(this.gapTo,1);return t.deletedAcross&&n.deletedAcross||r<t.pos||i>n.pos?null:new df(t.pos,n.pos,r,i,this.slice,this.insert,this.structure)}toJSON(){let e={stepType:"replaceAround",from:this.from,to:this.to,gapFrom:this.gapFrom,gapTo:this.gapTo,insert:this.insert};return this.slice.size&&(e.slice=this.slice.toJSON()),this.structure&&(e.structure=!0),e}static fromJSON(e,t){if("number"!=typeof t.from||"number"!=typeof t.to||"number"!=typeof t.gapFrom||"number"!=typeof t.gapTo||"number"!=typeof t.insert)throw RangeError("Invalid input for ReplaceAroundStep.fromJSON");return new df(t.from,t.to,t.gapFrom,t.gapTo,cw.fromJSON(e,t.slice),t.insert,!!t.structure)}}function dm(e,t,n){let r=e.resolve(t),i=n-t,s=r.depth;for(;i>0&&s>0&&r.indexAfter(s)==r.node(s).childCount;)s--,i--;if(i>0){let e=r.node(s).maybeChild(r.indexAfter(s));for(;i>0;){if(!e||e.isLeaf)return!0;e=e.firstChild,i--}}return!1}function dg(e,t,n,r=n.contentMatch,i=!0){let s=e.doc.nodeAt(t),o=[],a=t+1;for(let t=0;t<s.childCount;t++){let l=s.child(t),c=a+l.nodeSize,d=r.matchType(l.type);if(d){r=d;for(let t=0;t<l.marks.length;t++)n.allowsMarkType(l.marks[t].type)||e.step(new dd(a,c,l.marks[t]));if(i&&l.isText&&"pre"!=n.whitespace){let e,t=/\r?\n|\r/g,r;for(;e=t.exec(l.text);)r||(r=new cw(cm.from(n.schema.text(" ",n.allowedMarks(l.marks))),0,0)),o.push(new dp(a+e.index,a+e.index+e[0].length,r))}}else o.push(new dp(a,c,cw.empty));a=c}if(!r.validEnd){let t=r.fillBefore(cm.empty,!0);e.replace(a,a,new cw(t,0,0))}for(let t=o.length-1;t>=0;t--)e.step(o[t])}function dy(e){let t=e.parent.content.cutByIndex(e.startIndex,e.endIndex);for(let n=e.depth;;--n){let r=e.$from.node(n),i=e.$from.index(n),s=e.$to.indexAfter(n);if(n<e.depth&&r.canReplace(i,s,t))return n;if(0==n||r.type.spec.isolating||!((0==i||r.canReplace(i,r.childCount))&&(s==r.childCount||r.canReplace(0,s))))break}return null}function dx(e,t,n=null,r=e){let i=function(e,t){let{parent:n,startIndex:r,endIndex:i}=e,s=n.contentMatchAt(r).findWrapping(t);if(!s)return null;let o=s.length?s[0]:t;return n.canReplaceWith(r,i,o)?s:null}(e,t),s=i&&function(e,t){let{parent:n,startIndex:r,endIndex:i}=e,s=n.child(r),o=t.contentMatch.findWrapping(s.type);if(!o)return null;let a=(o.length?o[o.length-1]:t).contentMatch;for(let e=r;a&&e<i;e++)a=a.matchType(n.child(e).type);return a&&a.validEnd?o:null}(r,t);return s?i.map(dv).concat({type:t,attrs:n}).concat(s.map(dv)):null}function dv(e){return{type:e,attrs:null}}function db(e,t,n,r){t.forEach((i,s)=>{if(i.isText){let o,a=/\r?\n|\r/g;for(;o=a.exec(i.text);){let i=e.mapping.slice(r).map(n+1+s+o.index);e.replaceWith(i,i+1,t.type.schema.linebreakReplacement.create())}}})}function dw(e,t,n,r){t.forEach((i,s)=>{if(i.type==i.type.schema.linebreakReplacement){let i=e.mapping.slice(r).map(n+1+s);e.replaceWith(i,i+1,t.type.schema.text("\n"))}})}function dk(e,t,n=1,r){let i=e.resolve(t),s=i.depth-n,o=r&&r[r.length-1]||i.parent;if(s<0||i.parent.type.spec.isolating||!i.parent.canReplace(i.index(),i.parent.childCount)||!o.type.validContent(i.parent.content.cutByIndex(i.index(),i.parent.childCount)))return!1;for(let e=i.depth-1,t=n-2;e>s;e--,t--){let n=i.node(e),s=i.index(e);if(n.type.spec.isolating)return!1;let o=n.content.cutByIndex(s,n.childCount),a=r&&r[t+1];a&&(o=o.replaceChild(0,a.type.create(a.attrs)));let l=r&&r[t]||n;if(!n.canReplace(s+1,n.childCount)||!l.type.validContent(o))return!1}let a=i.indexAfter(s),l=r&&r[0];return i.node(s).canReplaceWith(a,a,l?l.type:i.node(s+1).type)}function dj(e,t){let n=e.resolve(t),r=n.index();return dN(n.nodeBefore,n.nodeAfter)&&n.parent.canReplace(r,r+1)}function dN(e,t){return!!(e&&t&&!e.isLeaf&&function(e,t){t.content.size||e.type.compatibleContent(t.type);let n=e.contentMatchAt(e.childCount),{linebreakReplacement:r}=e.type.schema;for(let i=0;i<t.childCount;i++){let s=t.child(i),o=s.type==r?e.type.schema.nodes.text:s.type;if(!(n=n.matchType(o))||!e.type.allowsMarks(s.marks))return!1}return n.validEnd}(e,t))}function dS(e,t,n=-1){let r=e.resolve(t);for(let e=r.depth;;e--){let i,s,o=r.index(e);if(e==r.depth?(i=r.nodeBefore,s=r.nodeAfter):n>0?(i=r.node(e+1),o++,s=r.node(e).maybeChild(o)):(i=r.node(e).maybeChild(o-1),s=r.node(e+1)),i&&!i.isTextblock&&dN(i,s)&&r.node(e).canReplace(o,o+1))return t;if(0==e)break;t=n<0?r.before(e):r.after(e)}}function dC(e,t,n){let r=e.resolve(t);if(!n.content.size)return t;let i=n.content;for(let e=0;e<n.openStart;e++)i=i.firstChild.content;for(let e=1;e<=(0==n.openStart&&n.size?2:1);e++)for(let t=r.depth;t>=0;t--){let n=t==r.depth?0:r.pos<=(r.start(t+1)+r.end(t+1))/2?-1:1,s=r.index(t)+ +(n>0),o=r.node(t),a=!1;if(1==e)a=o.canReplace(s,s,i);else{let e=o.contentMatchAt(s).findWrapping(i.firstChild.type);a=e&&o.canReplaceWith(s,s,e[0])}if(a)return 0==n?r.pos:n<0?r.before(t+1):r.after(t+1)}return null}function dM(e,t,n=t,r=cw.empty){if(t==n&&!r.size)return null;let i=e.resolve(t),s=e.resolve(n);return dE(i,s,r)?new dp(t,n,r):new dT(i,s,r).fit()}function dE(e,t,n){return!n.openStart&&!n.openEnd&&e.start()==t.start()&&e.parent.canReplace(e.index(),t.index(),n.content)}ds.jsonID("replaceAround",df);class dT{constructor(e,t,n){this.$from=e,this.$to=t,this.unplaced=n,this.frontier=[],this.placed=cm.empty;for(let t=0;t<=e.depth;t++){let n=e.node(t);this.frontier.push({type:n.type,match:n.contentMatchAt(e.indexAfter(t))})}for(let t=e.depth;t>0;t--)this.placed=cm.from(e.node(t).copy(this.placed))}get depth(){return this.frontier.length-1}fit(){for(;this.unplaced.size;){let e=this.findFittable();e?this.placeNodes(e):this.openMore()||this.dropNode()}let e=this.mustMoveInline(),t=this.placed.size-this.depth-this.$from.depth,n=this.$from,r=this.close(e<0?this.$to:n.doc.resolve(e));if(!r)return null;let i=this.placed,s=n.depth,o=r.depth;for(;s&&o&&1==i.childCount;)i=i.firstChild.content,s--,o--;let a=new cw(i,s,o);return e>-1?new df(n.pos,e,this.$to.pos,this.$to.end(),a,t):a.size||n.pos!=this.$to.pos?new dp(n.pos,r.pos,a):null}findFittable(){let e=this.unplaced.openStart;for(let t=this.unplaced.content,n=0,r=this.unplaced.openEnd;n<e;n++){let i=t.firstChild;if(t.childCount>1&&(r=0),i.type.spec.isolating&&r<=n){e=n;break}t=i.content}for(let t=1;t<=2;t++)for(let n=1==t?e:this.unplaced.openStart;n>=0;n--){let e,r=null,i=(n?(r=dO(this.unplaced.content,n-1).firstChild).content:this.unplaced.content).firstChild;for(let e=this.depth;e>=0;e--){let{type:s,match:o}=this.frontier[e],a,l=null;if(1==t&&(i?o.matchType(i.type)||(l=o.fillBefore(cm.from(i),!1)):r&&s.compatibleContent(r.type)))return{sliceDepth:n,frontierDepth:e,parent:r,inject:l};if(2==t&&i&&(a=o.findWrapping(i.type)))return{sliceDepth:n,frontierDepth:e,parent:r,wrap:a};if(r&&o.matchType(r.type))break}}}openMore(){let{content:e,openStart:t,openEnd:n}=this.unplaced,r=dO(e,t);return!!r.childCount&&!r.firstChild.isLeaf&&(this.unplaced=new cw(e,t+1,Math.max(n,r.size+t>=e.size-n?t+1:0)),!0)}dropNode(){let{content:e,openStart:t,openEnd:n}=this.unplaced,r=dO(e,t);if(r.childCount<=1&&t>0){let i=e.size-t<=t+r.size;this.unplaced=new cw(dA(e,t-1,1),t-1,i?t-1:n)}else this.unplaced=new cw(dA(e,t,1),t,n)}placeNodes({sliceDepth:e,frontierDepth:t,parent:n,inject:r,wrap:i}){for(;this.depth>t;)this.closeFrontierNode();if(i)for(let e=0;e<i.length;e++)this.openFrontierNode(i[e]);let s=this.unplaced,o=n?n.content:s.content,a=s.openStart-e,l=0,c=[],{match:d,type:u}=this.frontier[t];if(r){for(let e=0;e<r.childCount;e++)c.push(r.child(e));d=d.matchFragment(r)}let h=o.size+e-(s.content.size-s.openEnd);for(;l<o.childCount;){let e=o.child(l),t=d.matchType(e.type);if(!t)break;(++l>1||0==a||e.content.size)&&(d=t,c.push(function e(t,n,r){if(n<=0)return t;let i=t.content;return n>1&&(i=i.replaceChild(0,e(i.firstChild,n-1,1==i.childCount?r-1:0))),n>0&&(i=t.type.contentMatch.fillBefore(i).append(i),r<=0&&(i=i.append(t.type.contentMatch.matchFragment(i).fillBefore(cm.empty,!0)))),t.copy(i)}(e.mark(u.allowedMarks(e.marks)),1==l?a:0,l==o.childCount?h:-1)))}let p=l==o.childCount;p||(h=-1),this.placed=dD(this.placed,t,cm.from(c)),this.frontier[t].match=d,p&&h<0&&n&&n.type==this.frontier[this.depth].type&&this.frontier.length>1&&this.closeFrontierNode();for(let e=0,t=o;e<h;e++){let e=t.lastChild;this.frontier.push({type:e.type,match:e.contentMatchAt(e.childCount)}),t=e.content}this.unplaced=p?0==e?cw.empty:new cw(dA(s.content,e-1,1),e-1,h<0?s.openEnd:e-1):new cw(dA(s.content,e,l),s.openStart,s.openEnd)}mustMoveInline(){if(!this.$to.parent.isTextblock)return -1;let e=this.frontier[this.depth],t;if(!e.type.isTextblock||!dR(this.$to,this.$to.depth,e.type,e.match,!1)||this.$to.depth==this.depth&&(t=this.findCloseLevel(this.$to))&&t.depth==this.depth)return -1;let{depth:n}=this.$to,r=this.$to.after(n);for(;n>1&&r==this.$to.end(--n);)++r;return r}findCloseLevel(e){t:for(let t=Math.min(this.depth,e.depth);t>=0;t--){let{match:n,type:r}=this.frontier[t],i=t<e.depth&&e.end(t+1)==e.pos+(e.depth-(t+1)),s=dR(e,t,r,n,i);if(s){for(let n=t-1;n>=0;n--){let{match:t,type:r}=this.frontier[n],i=dR(e,n,r,t,!0);if(!i||i.childCount)continue t}return{depth:t,fit:s,move:i?e.doc.resolve(e.after(t+1)):e}}}}close(e){let t=this.findCloseLevel(e);if(!t)return null;for(;this.depth>t.depth;)this.closeFrontierNode();t.fit.childCount&&(this.placed=dD(this.placed,t.depth,t.fit)),e=t.move;for(let n=t.depth+1;n<=e.depth;n++){let t=e.node(n),r=t.type.contentMatch.fillBefore(t.content,!0,e.index(n));this.openFrontierNode(t.type,t.attrs,r)}return e}openFrontierNode(e,t=null,n){let r=this.frontier[this.depth];r.match=r.match.matchType(e),this.placed=dD(this.placed,this.depth,cm.from(e.create(t,n))),this.frontier.push({type:e,match:e.contentMatch})}closeFrontierNode(){let e=this.frontier.pop().match.fillBefore(cm.empty,!0);e.childCount&&(this.placed=dD(this.placed,this.frontier.length,e))}}function dA(e,t,n){return 0==t?e.cutByIndex(n,e.childCount):e.replaceChild(0,e.firstChild.copy(dA(e.firstChild.content,t-1,n)))}function dD(e,t,n){return 0==t?e.append(n):e.replaceChild(e.childCount-1,e.lastChild.copy(dD(e.lastChild.content,t-1,n)))}function dO(e,t){for(let n=0;n<t;n++)e=e.firstChild.content;return e}function dR(e,t,n,r,i){let s=e.node(t),o=i?e.indexAfter(t):e.index(t);if(o==s.childCount&&!n.compatibleContent(s.type))return null;let a=r.fillBefore(s.content,!0,o);return a&&!function(e,t,n){for(let r=n;r<t.childCount;r++)if(!e.allowsMarks(t.child(r).marks))return!0;return!1}(n,s.content,o)?a:null}function dP(e,t){let n=[],r=Math.min(e.depth,t.depth);for(let i=r;i>=0;i--){let r=e.start(i);if(r<e.pos-(e.depth-i)||t.end(i)>t.pos+(t.depth-i)||e.node(i).type.spec.isolating||t.node(i).type.spec.isolating)break;(r==t.start(i)||i==e.depth&&i==t.depth&&e.parent.inlineContent&&t.parent.inlineContent&&i&&t.start(i-1)==r-1)&&n.push(i)}return n}class dI extends ds{constructor(e,t,n){super(),this.pos=e,this.attr=t,this.value=n}apply(e){let t=e.nodeAt(this.pos);if(!t)return da.fail("No node at attribute step's position");let n=Object.create(null);for(let e in t.attrs)n[e]=t.attrs[e];n[this.attr]=this.value;let r=t.type.create(n,null,t.marks);return da.fromReplace(e,this.pos,this.pos+1,new cw(cm.from(r),0,+!t.isLeaf))}getMap(){return dn.empty}invert(e){return new dI(this.pos,this.attr,e.nodeAt(this.pos).attrs[this.attr])}map(e){let t=e.mapResult(this.pos,1);return t.deletedAfter?null:new dI(t.pos,this.attr,this.value)}toJSON(){return{stepType:"attr",pos:this.pos,attr:this.attr,value:this.value}}static fromJSON(e,t){if("number"!=typeof t.pos||"string"!=typeof t.attr)throw RangeError("Invalid input for AttrStep.fromJSON");return new dI(t.pos,t.attr,t.value)}}ds.jsonID("attr",dI);class dL extends ds{constructor(e,t){super(),this.attr=e,this.value=t}apply(e){let t=Object.create(null);for(let n in e.attrs)t[n]=e.attrs[n];t[this.attr]=this.value;let n=e.type.create(t,e.content,e.marks);return da.ok(n)}getMap(){return dn.empty}invert(e){return new dL(this.attr,e.attrs[this.attr])}map(e){return this}toJSON(){return{stepType:"docAttr",attr:this.attr,value:this.value}}static fromJSON(e,t){if("string"!=typeof t.attr)throw RangeError("Invalid input for DocAttrStep.fromJSON");return new dL(t.attr,t.value)}}ds.jsonID("docAttr",dL);let dz=class extends Error{};(dz=function e(t){let n=Error.call(this,t);return n.__proto__=e.prototype,n}).prototype=Object.create(Error.prototype),dz.prototype.constructor=dz,dz.prototype.name="TransformError";class dV{constructor(e){this.doc=e,this.steps=[],this.docs=[],this.mapping=new dr}get before(){return this.docs.length?this.docs[0]:this.doc}step(e){let t=this.maybeStep(e);if(t.failed)throw new dz(t.failed);return this}maybeStep(e){let t=e.apply(this.doc);return t.failed||this.addStep(e,t.doc),t}get docChanged(){return this.steps.length>0}addStep(e,t){this.docs.push(this.doc),this.steps.push(e),this.mapping.appendMap(e.getMap()),this.doc=t}replace(e,t=e,n=cw.empty){let r=dM(this.doc,e,t,n);return r&&this.step(r),this}replaceWith(e,t,n){return this.replace(e,t,new cw(cm.from(n),0,0))}delete(e,t){return this.replace(e,t,cw.empty)}insert(e,t){return this.replaceWith(e,e,t)}replaceRange(e,t,n){return!function(e,t,n,r){if(!r.size)return e.deleteRange(t,n);let i=e.doc.resolve(t),s=e.doc.resolve(n);if(dE(i,s,r))return e.step(new dp(t,n,r));let o=dP(i,e.doc.resolve(n));0==o[o.length-1]&&o.pop();let a=-(i.depth+1);o.unshift(a);for(let e=i.depth,t=i.pos-1;e>0;e--,t--){let n=i.node(e).type.spec;if(n.defining||n.definingAsContext||n.isolating)break;o.indexOf(e)>-1?a=e:i.before(e)==t&&o.splice(1,0,-e)}let l=o.indexOf(a),c=[],d=r.openStart;for(let e=r.content,t=0;;t++){let n=e.firstChild;if(c.push(n),t==r.openStart)break;e=n.content}for(let e=d-1;e>=0;e--){var u;let t=c[e],n=(u=t.type).spec.defining||u.spec.definingForContent;if(n&&!t.sameMarkup(i.node(Math.abs(a)-1)))d=e;else if(n||!t.type.isTextblock)break}for(let t=r.openStart;t>=0;t--){let a=(t+d+1)%(r.openStart+1),u=c[a];if(u)for(let t=0;t<o.length;t++){let c=o[(t+l)%o.length],d=!0;c<0&&(d=!1,c=-c);let h=i.node(c-1),p=i.index(c-1);if(h.canReplaceWith(p,p,u.type,u.marks))return e.replace(i.before(c),d?s.after(c):n,new cw(function e(t,n,r,i,s){if(n<r){let s=t.firstChild;t=t.replaceChild(0,s.copy(e(s.content,n+1,r,i,s)))}if(n>i){let e=s.contentMatchAt(0),n=e.fillBefore(t).append(t);t=n.append(e.matchFragment(n).fillBefore(cm.empty,!0))}return t}(r.content,0,r.openStart,a),a,r.openEnd))}}let h=e.steps.length;for(let a=o.length-1;a>=0&&(e.replace(t,n,r),!(e.steps.length>h));a--){let e=o[a];e<0||(t=i.before(e),n=s.after(e))}}(this,e,t,n),this}replaceRangeWith(e,t,n){var r=e,i=t;if(!n.isInline&&r==i&&this.doc.resolve(r).parent.content.size){let e=function(e,t,n){let r=e.resolve(t);if(r.parent.canReplaceWith(r.index(),r.index(),n))return t;if(0==r.parentOffset)for(let e=r.depth-1;e>=0;e--){let t=r.index(e);if(r.node(e).canReplaceWith(t,t,n))return r.before(e+1);if(t>0)return null}if(r.parentOffset==r.parent.content.size)for(let e=r.depth-1;e>=0;e--){let t=r.indexAfter(e);if(r.node(e).canReplaceWith(t,t,n))return r.after(e+1);if(t<r.node(e).childCount)break}return null}(this.doc,r,n.type);null!=e&&(r=i=e)}return this.replaceRange(r,i,new cw(cm.from(n),0,0)),this}deleteRange(e,t){return!function(e,t,n){let r=e.doc.resolve(t),i=e.doc.resolve(n),s=dP(r,i);for(let t=0;t<s.length;t++){let n=s[t],o=t==s.length-1;if(o&&0==n||r.node(n).type.contentMatch.validEnd)return e.delete(r.start(n),i.end(n));if(n>0&&(o||r.node(n-1).canReplace(r.index(n-1),i.indexAfter(n-1))))return e.delete(r.before(n),i.after(n))}for(let s=1;s<=r.depth&&s<=i.depth;s++)if(t-r.start(s)==r.depth-s&&n>r.end(s)&&i.end(s)-n!=i.depth-s&&r.start(s-1)==i.start(s-1)&&r.node(s-1).canReplace(r.index(s-1),i.index(s-1)))return e.delete(r.before(s),n);e.delete(t,n)}(this,e,t),this}lift(e,t){return!function(e,t,n){let{$from:r,$to:i,depth:s}=t,o=r.before(s+1),a=i.after(s+1),l=o,c=a,d=cm.empty,u=0;for(let e=s,t=!1;e>n;e--)t||r.index(e)>0?(t=!0,d=cm.from(r.node(e).copy(d)),u++):l--;let h=cm.empty,p=0;for(let e=s,t=!1;e>n;e--)t||i.after(e+1)<i.end(e)?(t=!0,h=cm.from(i.node(e).copy(h)),p++):c++;e.step(new df(l,c,o,a,new cw(d.append(h),u,p),d.size-u,!0))}(this,e,t),this}join(e,t=1){return!function(e,t,n){let r=null,{linebreakReplacement:i}=e.doc.type.schema,s=e.doc.resolve(t-n),o=s.node().type;if(i&&o.inlineContent){let e="pre"==o.whitespace,t=!!o.contentMatch.matchType(i);e&&!t?r=!1:!e&&t&&(r=!0)}let a=e.steps.length;if(!1===r){let r=e.doc.resolve(t+n);dw(e,r.node(),r.before(),a)}o.inlineContent&&dg(e,t+n-1,o,s.node().contentMatchAt(s.index()),null==r);let l=e.mapping.slice(a),c=l.map(t-n);if(e.step(new dp(c,l.map(t+n,-1),cw.empty,!0)),!0===r){let t=e.doc.resolve(c);db(e,t.node(),t.before(),e.steps.length)}}(this,e,t),this}wrap(e,t){return!function(e,t,n){let r=cm.empty;for(let e=n.length-1;e>=0;e--){if(r.size){let t=n[e].type.contentMatch.matchFragment(r);if(!t||!t.validEnd)throw RangeError("Wrapper type given to Transform.wrap does not form valid content of its parent wrapper")}r=cm.from(n[e].type.create(n[e].attrs,r))}let i=t.start,s=t.end;e.step(new df(i,s,i,s,new cw(r,0,0),n.length,!0))}(this,e,t),this}setBlockType(e,t=e,n,r=null){var i=this;if(!n.isTextblock)throw RangeError("Type given to setBlockType should be a textblock");let s=i.steps.length;return i.doc.nodesBetween(e,t,(e,t)=>{var o,a,l;let c,d,u="function"==typeof r?r(e):r;if(e.isTextblock&&!e.hasMarkup(n,u)&&(o=i.doc,a=i.mapping.slice(s).map(t),l=n,d=(c=o.resolve(a)).index(),c.parent.canReplaceWith(d,d+1,l))){let r=null;if(n.schema.linebreakReplacement){let e="pre"==n.whitespace,t=!!n.contentMatch.matchType(n.schema.linebreakReplacement);e&&!t?r=!1:!e&&t&&(r=!0)}!1===r&&dw(i,e,t,s),dg(i,i.mapping.slice(s).map(t,1),n,void 0,null===r);let o=i.mapping.slice(s),a=o.map(t,1),l=o.map(t+e.nodeSize,1);return i.step(new df(a,l,a+1,l-1,new cw(cm.from(n.create(u,null,e.marks)),0,0),1,!0)),!0===r&&db(i,e,t,s),!1}}),this}setNodeMarkup(e,t,n=null,r){return!function(e,t,n,r,i){let s=e.doc.nodeAt(t);if(!s)throw RangeError("No node at given position");n||(n=s.type);let o=n.create(r,null,i||s.marks);if(s.isLeaf)return e.replaceWith(t,t+s.nodeSize,o);if(!n.validContent(s.content))throw RangeError("Invalid content for node type "+n.name);e.step(new df(t,t+s.nodeSize,t+1,t+s.nodeSize-1,new cw(cm.from(o),0,0),1,!0))}(this,e,t,n,r),this}setNodeAttribute(e,t,n){return this.step(new dI(e,t,n)),this}setDocAttribute(e,t){return this.step(new dL(e,t)),this}addNodeMark(e,t){return this.step(new du(e,t)),this}removeNodeMark(e,t){let n=this.doc.nodeAt(e);if(!n)throw RangeError("No node at position "+e);if(t instanceof cv)t.isInSet(n.marks)&&this.step(new dh(e,t));else{let r=n.marks,i,s=[];for(;i=t.isInSet(r);)s.push(new dh(e,i)),r=i.removeFromSet(r);for(let e=s.length-1;e>=0;e--)this.step(s[e])}return this}split(e,t=1,n){return!function(e,t,n=1,r){let i=e.doc.resolve(t),s=cm.empty,o=cm.empty;for(let e=i.depth,t=i.depth-n,a=n-1;e>t;e--,a--){s=cm.from(i.node(e).copy(s));let t=r&&r[a];o=cm.from(t?t.type.create(t.attrs,o):i.node(e).copy(o))}e.step(new dp(t,t,new cw(s.append(o),n,n),!0))}(this,e,t,n),this}addMark(e,t,n){var r;let i,s,o,a;return r=this,o=[],a=[],r.doc.nodesBetween(e,t,(r,l,c)=>{if(!r.isInline)return;let d=r.marks;if(!n.isInSet(d)&&c.type.allowsMarkType(n.type)){let c=Math.max(l,e),u=Math.min(l+r.nodeSize,t),h=n.addToSet(d);for(let e=0;e<d.length;e++)d[e].isInSet(h)||(i&&i.to==c&&i.mark.eq(d[e])?i.to=u:o.push(i=new dd(c,u,d[e])));s&&s.to==c?s.to=u:a.push(s=new dc(c,u,n))}}),o.forEach(e=>r.step(e)),a.forEach(e=>r.step(e)),this}removeMark(e,t,n){var r;let i,s;return r=this,i=[],s=0,r.doc.nodesBetween(e,t,(r,o)=>{if(!r.isInline)return;s++;let a=null;if(n instanceof cJ){let e=r.marks,t;for(;t=n.isInSet(e);)(a||(a=[])).push(t),e=t.removeFromSet(e)}else n?n.isInSet(r.marks)&&(a=[n]):a=r.marks;if(a&&a.length){let n=Math.min(o+r.nodeSize,t);for(let t=0;t<a.length;t++){let r=a[t],l;for(let e=0;e<i.length;e++){let t=i[e];t.step==s-1&&r.eq(i[e].style)&&(l=t)}l?(l.to=n,l.step=s):i.push({style:r,from:Math.max(o,e),to:n,step:s})}}}),i.forEach(e=>r.step(new dd(e.from,e.to,e.style))),this}clearIncompatible(e,t,n){return dg(this,e,t,n),this}}let d$=Object.create(null);class d_{constructor(e,t,n){this.$anchor=e,this.$head=t,this.ranges=n||[new dF(e.min(t),e.max(t))]}get anchor(){return this.$anchor.pos}get head(){return this.$head.pos}get from(){return this.$from.pos}get to(){return this.$to.pos}get $from(){return this.ranges[0].$from}get $to(){return this.ranges[0].$to}get empty(){let e=this.ranges;for(let t=0;t<e.length;t++)if(e[t].$from.pos!=e[t].$to.pos)return!1;return!0}content(){return this.$from.doc.slice(this.from,this.to,!0)}replace(e,t=cw.empty){let n=t.content.lastChild,r=null;for(let e=0;e<t.openEnd;e++)r=n,n=n.lastChild;let i=e.steps.length,s=this.ranges;for(let o=0;o<s.length;o++){let{$from:a,$to:l}=s[o],c=e.mapping.slice(i);e.replaceRange(c.map(a.pos),c.map(l.pos),o?cw.empty:t),0==o&&dX(e,i,(n?n.isInline:r&&r.isTextblock)?-1:1)}}replaceWith(e,t){let n=e.steps.length,r=this.ranges;for(let i=0;i<r.length;i++){let{$from:s,$to:o}=r[i],a=e.mapping.slice(n),l=a.map(s.pos),c=a.map(o.pos);i?e.deleteRange(l,c):(e.replaceRangeWith(l,c,t),dX(e,n,t.isInline?-1:1))}}static findFrom(e,t,n=!1){let r=e.parent.inlineContent?new dq(e):dY(e.node(0),e.parent,e.pos,e.index(),t,n);if(r)return r;for(let r=e.depth-1;r>=0;r--){let i=t<0?dY(e.node(0),e.node(r),e.before(r+1),e.index(r),t,n):dY(e.node(0),e.node(r),e.after(r+1),e.index(r)+1,t,n);if(i)return i}return null}static near(e,t=1){return this.findFrom(e,t)||this.findFrom(e,-t)||new dJ(e.node(0))}static atStart(e){return dY(e,e,0,0,1)||new dJ(e)}static atEnd(e){return dY(e,e,e.content.size,e.childCount,-1)||new dJ(e)}static fromJSON(e,t){if(!t||!t.type)throw RangeError("Invalid input for Selection.fromJSON");let n=d$[t.type];if(!n)throw RangeError(`No selection type ${t.type} defined`);return n.fromJSON(e,t)}static jsonID(e,t){if(e in d$)throw RangeError("Duplicate use of selection JSON ID "+e);return d$[e]=t,t.prototype.jsonID=e,t}getBookmark(){return dq.between(this.$anchor,this.$head).getBookmark()}}d_.prototype.visible=!0;class dF{constructor(e,t){this.$from=e,this.$to=t}}let dB=!1;function dW(e){dB||e.parent.inlineContent||(dB=!0,console.warn("TextSelection endpoint not pointing into a node with inline content ("+e.parent.type.name+")"))}class dq extends d_{constructor(e,t=e){dW(e),dW(t),super(e,t)}get $cursor(){return this.$anchor.pos==this.$head.pos?this.$head:null}map(e,t){let n=e.resolve(t.map(this.head));if(!n.parent.inlineContent)return d_.near(n);let r=e.resolve(t.map(this.anchor));return new dq(r.parent.inlineContent?r:n,n)}replace(e,t=cw.empty){if(super.replace(e,t),t==cw.empty){let t=this.$from.marksAcross(this.$to);t&&e.ensureMarks(t)}}eq(e){return e instanceof dq&&e.anchor==this.anchor&&e.head==this.head}getBookmark(){return new dH(this.anchor,this.head)}toJSON(){return{type:"text",anchor:this.anchor,head:this.head}}static fromJSON(e,t){if("number"!=typeof t.anchor||"number"!=typeof t.head)throw RangeError("Invalid input for TextSelection.fromJSON");return new dq(e.resolve(t.anchor),e.resolve(t.head))}static create(e,t,n=t){let r=e.resolve(t);return new this(r,n==t?r:e.resolve(n))}static between(e,t,n){let r=e.pos-t.pos;if((!n||r)&&(n=r>=0?1:-1),!t.parent.inlineContent){let e=d_.findFrom(t,n,!0)||d_.findFrom(t,-n,!0);if(!e)return d_.near(t,n);t=e.$head}return e.parent.inlineContent||(0==r?e=t:(e=(d_.findFrom(e,-n,!0)||d_.findFrom(e,n,!0)).$anchor).pos<t.pos!=r<0&&(e=t)),new dq(e,t)}}d_.jsonID("text",dq);class dH{constructor(e,t){this.anchor=e,this.head=t}map(e){return new dH(e.map(this.anchor),e.map(this.head))}resolve(e){return dq.between(e.resolve(this.anchor),e.resolve(this.head))}}class dU extends d_{constructor(e){let t=e.nodeAfter;super(e,e.node(0).resolve(e.pos+t.nodeSize)),this.node=t}map(e,t){let{deleted:n,pos:r}=t.mapResult(this.anchor),i=e.resolve(r);return n?d_.near(i):new dU(i)}content(){return new cw(cm.from(this.node),0,0)}eq(e){return e instanceof dU&&e.anchor==this.anchor}toJSON(){return{type:"node",anchor:this.anchor}}getBookmark(){return new dK(this.anchor)}static fromJSON(e,t){if("number"!=typeof t.anchor)throw RangeError("Invalid input for NodeSelection.fromJSON");return new dU(e.resolve(t.anchor))}static create(e,t){return new dU(e.resolve(t))}static isSelectable(e){return!e.isText&&!1!==e.type.spec.selectable}}dU.prototype.visible=!1,d_.jsonID("node",dU);class dK{constructor(e){this.anchor=e}map(e){let{deleted:t,pos:n}=e.mapResult(this.anchor);return t?new dH(n,n):new dK(n)}resolve(e){let t=e.resolve(this.anchor),n=t.nodeAfter;return n&&dU.isSelectable(n)?new dU(t):d_.near(t)}}class dJ extends d_{constructor(e){super(e.resolve(0),e.resolve(e.content.size))}replace(e,t=cw.empty){if(t==cw.empty){e.delete(0,e.doc.content.size);let t=d_.atStart(e.doc);t.eq(e.selection)||e.setSelection(t)}else super.replace(e,t)}toJSON(){return{type:"all"}}static fromJSON(e){return new dJ(e)}map(e){return new dJ(e)}eq(e){return e instanceof dJ}getBookmark(){return dG}}d_.jsonID("all",dJ);let dG={map(){return this},resolve:e=>new dJ(e)};function dY(e,t,n,r,i,s=!1){if(t.inlineContent)return dq.create(e,n);for(let o=r-(i>0?0:1);i>0?o<t.childCount:o>=0;o+=i){let r=t.child(o);if(r.isAtom){if(!s&&dU.isSelectable(r))return dU.create(e,n-(i<0?r.nodeSize:0))}else{let t=dY(e,r,n+i,i<0?r.childCount:0,i,s);if(t)return t}n+=r.nodeSize*i}return null}function dX(e,t,n){let r,i=e.steps.length-1;if(i<t)return;let s=e.steps[i];(s instanceof dp||s instanceof df)&&(e.mapping.maps[i].forEach((e,t,n,i)=>{null==r&&(r=i)}),e.setSelection(d_.near(e.doc.resolve(r),n)))}class dZ extends dV{constructor(e){super(e.doc),this.curSelectionFor=0,this.updated=0,this.meta=Object.create(null),this.time=Date.now(),this.curSelection=e.selection,this.storedMarks=e.storedMarks}get selection(){return this.curSelectionFor<this.steps.length&&(this.curSelection=this.curSelection.map(this.doc,this.mapping.slice(this.curSelectionFor)),this.curSelectionFor=this.steps.length),this.curSelection}setSelection(e){if(e.$from.doc!=this.doc)throw RangeError("Selection passed to setSelection must point at the current document");return this.curSelection=e,this.curSelectionFor=this.steps.length,this.updated=(1|this.updated)&-3,this.storedMarks=null,this}get selectionSet(){return(1&this.updated)>0}setStoredMarks(e){return this.storedMarks=e,this.updated|=2,this}ensureMarks(e){return cv.sameSet(this.storedMarks||this.selection.$from.marks(),e)||this.setStoredMarks(e),this}addStoredMark(e){return this.ensureMarks(e.addToSet(this.storedMarks||this.selection.$head.marks()))}removeStoredMark(e){return this.ensureMarks(e.removeFromSet(this.storedMarks||this.selection.$head.marks()))}get storedMarksSet(){return(2&this.updated)>0}addStep(e,t){super.addStep(e,t),this.updated=-3&this.updated,this.storedMarks=null}setTime(e){return this.time=e,this}replaceSelection(e){return this.selection.replace(this,e),this}replaceSelectionWith(e,t=!0){let n=this.selection;return t&&(e=e.mark(this.storedMarks||(n.empty?n.$from.marks():n.$from.marksAcross(n.$to)||cv.none))),n.replaceWith(this,e),this}deleteSelection(){return this.selection.replace(this),this}insertText(e,t,n){let r=this.doc.type.schema;if(null==t)return e?this.replaceSelectionWith(r.text(e),!0):this.deleteSelection();{if(null==n&&(n=t),n=null==n?t:n,!e)return this.deleteRange(t,n);let i=this.storedMarks;if(!i){let e=this.doc.resolve(t);i=n==t?e.marks():e.marksAcross(this.doc.resolve(n))}return this.replaceRangeWith(t,n,r.text(e,i)),this.selection.empty||this.setSelection(d_.near(this.selection.$to)),this}}setMeta(e,t){return this.meta["string"==typeof e?e:e.key]=t,this}getMeta(e){return this.meta["string"==typeof e?e:e.key]}get isGeneric(){for(let e in this.meta)return!1;return!0}scrollIntoView(){return this.updated|=4,this}get scrolledIntoView(){return(4&this.updated)>0}}function dQ(e,t){return t&&e?e.bind(t):e}class d0{constructor(e,t,n){this.name=e,this.init=dQ(t.init,n),this.apply=dQ(t.apply,n)}}let d1=[new d0("doc",{init:e=>e.doc||e.schema.topNodeType.createAndFill(),apply:e=>e.doc}),new d0("selection",{init:(e,t)=>e.selection||d_.atStart(t.doc),apply:e=>e.selection}),new d0("storedMarks",{init:e=>e.storedMarks||null,apply:(e,t,n,r)=>r.selection.$cursor?e.storedMarks:null}),new d0("scrollToSelection",{init:()=>0,apply:(e,t)=>e.scrolledIntoView?t+1:t})];class d2{constructor(e,t){this.schema=e,this.plugins=[],this.pluginsByKey=Object.create(null),this.fields=d1.slice(),t&&t.forEach(e=>{if(this.pluginsByKey[e.key])throw RangeError("Adding different instances of a keyed plugin ("+e.key+")");this.plugins.push(e),this.pluginsByKey[e.key]=e,e.spec.state&&this.fields.push(new d0(e.key,e.spec.state,e))})}}class d4{constructor(e){this.config=e}get schema(){return this.config.schema}get plugins(){return this.config.plugins}apply(e){return this.applyTransaction(e).state}filterTransaction(e,t=-1){for(let n=0;n<this.config.plugins.length;n++)if(n!=t){let t=this.config.plugins[n];if(t.spec.filterTransaction&&!t.spec.filterTransaction.call(t,e,this))return!1}return!0}applyTransaction(e){if(!this.filterTransaction(e))return{state:this,transactions:[]};let t=[e],n=this.applyInner(e),r=null;for(;;){let i=!1;for(let s=0;s<this.config.plugins.length;s++){let o=this.config.plugins[s];if(o.spec.appendTransaction){let a=r?r[s].n:0,l=r?r[s].state:this,c=a<t.length&&o.spec.appendTransaction.call(o,a?t.slice(a):t,l,n);if(c&&n.filterTransaction(c,s)){if(c.setMeta("appendedTransaction",e),!r){r=[];for(let e=0;e<this.config.plugins.length;e++)r.push(e<s?{state:n,n:t.length}:{state:this,n:0})}t.push(c),n=n.applyInner(c),i=!0}r&&(r[s]={state:n,n:t.length})}}if(!i)return{state:n,transactions:t}}}applyInner(e){if(!e.before.eq(this.doc))throw RangeError("Applying a mismatched transaction");let t=new d4(this.config),n=this.config.fields;for(let r=0;r<n.length;r++){let i=n[r];t[i.name]=i.apply(e,this[i.name],this,t)}return t}get tr(){return new dZ(this)}static create(e){let t=new d2(e.doc?e.doc.type.schema:e.schema,e.plugins),n=new d4(t);for(let r=0;r<t.fields.length;r++)n[t.fields[r].name]=t.fields[r].init(e,n);return n}reconfigure(e){let t=new d2(this.schema,e.plugins),n=t.fields,r=new d4(t);for(let t=0;t<n.length;t++){let i=n[t].name;r[i]=this.hasOwnProperty(i)?this[i]:n[t].init(e,r)}return r}toJSON(e){let t={doc:this.doc.toJSON(),selection:this.selection.toJSON()};if(this.storedMarks&&(t.storedMarks=this.storedMarks.map(e=>e.toJSON())),e&&"object"==typeof e)for(let n in e){if("doc"==n||"selection"==n)throw RangeError("The JSON fields `doc` and `selection` are reserved");let r=e[n],i=r.spec.state;i&&i.toJSON&&(t[n]=i.toJSON.call(r,this[r.key]))}return t}static fromJSON(e,t,n){if(!t)throw RangeError("Invalid input for EditorState.fromJSON");if(!e.schema)throw RangeError("Required config field 'schema' missing");let r=new d2(e.schema,e.plugins),i=new d4(r);return r.fields.forEach(r=>{if("doc"==r.name)i.doc=cP.fromJSON(e.schema,t.doc);else if("selection"==r.name)i.selection=d_.fromJSON(i.doc,t.selection);else if("storedMarks"==r.name)t.storedMarks&&(i.storedMarks=t.storedMarks.map(e.schema.markFromJSON));else{if(n)for(let s in n){let o=n[s],a=o.spec.state;if(o.key==r.name&&a&&a.fromJSON&&Object.prototype.hasOwnProperty.call(t,s)){i[r.name]=a.fromJSON.call(o,e,t[s],i);return}}i[r.name]=r.init(e,i)}}),i}}class d3{constructor(e){this.spec=e,this.props={},e.props&&function e(t,n,r){for(let i in t){let s=t[i];s instanceof Function?s=s.bind(n):"handleDOMEvents"==i&&(s=e(s,n,{})),r[i]=s}return r}(e.props,this,this.props),this.key=e.key?e.key.key:d6("plugin")}getState(e){return e[this.key]}}let d5=Object.create(null);function d6(e){return e in d5?e+"$"+ ++d5[e]:(d5[e]=0,e+"$")}class d8{constructor(e="key"){this.key=d6(e)}get(e){return e.config.pluginsByKey[this.key]}getState(e){return e[this.key]}}let d9=function(e){for(var t=0;;t++)if(!(e=e.previousSibling))return t},d7=function(e){let t=e.assignedSlot||e.parentNode;return t&&11==t.nodeType?t.host:t},ue=null,ut=function(e,t,n){let r=ue||(ue=document.createRange());return r.setEnd(e,null==n?e.nodeValue.length:n),r.setStart(e,t||0),r},un=function(){ue=null},ur=function(e,t,n,r){return n&&(us(e,t,n,r,-1)||us(e,t,n,r,1))},ui=/^(img|br|input|textarea|hr)$/i;function us(e,t,n,r,i){for(var s;;){if(e==n&&t==r)return!0;if(t==(i<0?0:uo(e))){let n=e.parentNode;if(!n||1!=n.nodeType||ua(e)||ui.test(e.nodeName)||"false"==e.contentEditable)return!1;t=d9(e)+(i<0?0:1),e=n}else{if(1!=e.nodeType)return!1;let n=e.childNodes[t+(i<0?-1:0)];if(1==n.nodeType&&"false"==n.contentEditable)if(null==(s=n.pmViewDesc)||!s.ignoreForSelection)return!1;else t+=i;else e=n,t=i<0?uo(e):0}}}function uo(e){return 3==e.nodeType?e.nodeValue.length:e.childNodes.length}function ua(e){let t;for(let n=e;n&&!(t=n.pmViewDesc);n=n.parentNode);return t&&t.node&&t.node.isBlock&&(t.dom==e||t.contentDOM==e)}let ul=function(e){return e.focusNode&&ur(e.focusNode,e.focusOffset,e.anchorNode,e.anchorOffset)};function uc(e,t){let n=document.createEvent("Event");return n.initEvent("keydown",!0,!0),n.keyCode=e,n.key=n.code=t,n}let ud="undefined"!=typeof navigator?navigator:null,uu="undefined"!=typeof document?document:null,uh=ud&&ud.userAgent||"",up=/Edge\/(\d+)/.exec(uh),uf=/MSIE \d/.exec(uh),um=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(uh),ug=!!(uf||um||up),uy=uf?document.documentMode:um?+um[1]:up?+up[1]:0,ux=!ug&&/gecko\/(\d+)/i.test(uh);ux&&(/Firefox\/(\d+)/.exec(uh)||[0,0])[1];let uv=!ug&&/Chrome\/(\d+)/.exec(uh),ub=!!uv,uw=uv?+uv[1]:0,uk=!ug&&!!ud&&/Apple Computer/.test(ud.vendor),uj=uk&&(/Mobile\/\w+/.test(uh)||!!ud&&ud.maxTouchPoints>2),uN=uj||!!ud&&/Mac/.test(ud.platform),uS=!!ud&&/Win/.test(ud.platform),uC=/Android \d/.test(uh),uM=!!uu&&"webkitFontSmoothing"in uu.documentElement.style,uE=uM?+(/\bAppleWebKit\/(\d+)/.exec(navigator.userAgent)||[0,0])[1]:0;function uT(e,t){return"number"==typeof e?e:e[t]}function uA(e,t,n){let r=e.someProp("scrollThreshold")||0,i=e.someProp("scrollMargin")||5,s=e.dom.ownerDocument;for(let o=n||e.dom;o;){if(1!=o.nodeType){o=d7(o);continue}let e=o,n=e==s.body,a=n?function(e){let t=e.defaultView&&e.defaultView.visualViewport;return t?{left:0,right:t.width,top:0,bottom:t.height}:{left:0,right:e.documentElement.clientWidth,top:0,bottom:e.documentElement.clientHeight}}(s):function(e){let t=e.getBoundingClientRect(),n=t.width/e.offsetWidth||1,r=t.height/e.offsetHeight||1;return{left:t.left,right:t.left+e.clientWidth*n,top:t.top,bottom:t.top+e.clientHeight*r}}(e),l=0,c=0;if(t.top<a.top+uT(r,"top")?c=-(a.top-t.top+uT(i,"top")):t.bottom>a.bottom-uT(r,"bottom")&&(c=t.bottom-t.top>a.bottom-a.top?t.top+uT(i,"top")-a.top:t.bottom-a.bottom+uT(i,"bottom")),t.left<a.left+uT(r,"left")?l=-(a.left-t.left+uT(i,"left")):t.right>a.right-uT(r,"right")&&(l=t.right-a.right+uT(i,"right")),l||c)if(n)s.defaultView.scrollBy(l,c);else{let n=e.scrollLeft,r=e.scrollTop;c&&(e.scrollTop+=c),l&&(e.scrollLeft+=l);let i=e.scrollLeft-n,s=e.scrollTop-r;t={left:t.left-i,top:t.top-s,right:t.right-i,bottom:t.bottom-s}}let d=n?"fixed":getComputedStyle(o).position;if(/^(fixed|sticky)$/.test(d))break;o="absolute"==d?o.offsetParent:d7(o)}}function uD(e){let t=[],n=e.ownerDocument;for(let r=e;r&&(t.push({dom:r,top:r.scrollTop,left:r.scrollLeft}),e!=n);r=d7(r));return t}function uO(e,t){for(let n=0;n<e.length;n++){let{dom:r,top:i,left:s}=e[n];r.scrollTop!=i+t&&(r.scrollTop=i+t),r.scrollLeft!=s&&(r.scrollLeft=s)}}let uR=null;function uP(e,t){return e.left>=t.left-1&&e.left<=t.right+1&&e.top>=t.top-1&&e.top<=t.bottom+1}function uI(e){return e.top<e.bottom||e.left<e.right}function uL(e,t){let n=e.getClientRects();if(n.length){let e=n[t<0?0:n.length-1];if(uI(e))return e}return Array.prototype.find.call(n,uI)||e.getBoundingClientRect()}let uz=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac]/;function uV(e,t,n){let{node:r,offset:i,atom:s}=e.docView.domFromPos(t,n<0?-1:1),o=uM||ux;if(3==r.nodeType)if(o&&(uz.test(r.nodeValue)||(n<0?!i:i==r.nodeValue.length))){let e=uL(ut(r,i,i),n);if(ux&&i&&/\s/.test(r.nodeValue[i-1])&&i<r.nodeValue.length){let t=uL(ut(r,i-1,i-1),-1);if(t.top==e.top){let n=uL(ut(r,i,i+1),-1);if(n.top!=e.top)return u$(n,n.left<t.left)}}return e}else{let e=i,t=i,s=n<0?1:-1;return n<0&&!i?(t++,s=-1):n>=0&&i==r.nodeValue.length?(e--,s=1):n<0?e--:t++,u$(uL(ut(r,e,t),s),s<0)}if(!e.state.doc.resolve(t-(s||0)).parent.inlineContent){if(null==s&&i&&(n<0||i==uo(r))){let e=r.childNodes[i-1];if(1==e.nodeType)return u_(e.getBoundingClientRect(),!1)}if(null==s&&i<uo(r)){let e=r.childNodes[i];if(1==e.nodeType)return u_(e.getBoundingClientRect(),!0)}return u_(r.getBoundingClientRect(),n>=0)}if(null==s&&i&&(n<0||i==uo(r))){let e=r.childNodes[i-1],t=3==e.nodeType?ut(e,uo(e)-!o):1!=e.nodeType||"BR"==e.nodeName&&e.nextSibling?null:e;if(t)return u$(uL(t,1),!1)}if(null==s&&i<uo(r)){let e=r.childNodes[i];for(;e.pmViewDesc&&e.pmViewDesc.ignoreForCoords;)e=e.nextSibling;let t=e?3==e.nodeType?ut(e,0,+!o):1==e.nodeType?e:null:null;if(t)return u$(uL(t,-1),!0)}return u$(uL(3==r.nodeType?ut(r):r,-n),n>=0)}function u$(e,t){if(0==e.width)return e;let n=t?e.left:e.right;return{top:e.top,bottom:e.bottom,left:n,right:n}}function u_(e,t){if(0==e.height)return e;let n=t?e.top:e.bottom;return{top:n,bottom:n,left:e.left,right:e.right}}function uF(e,t,n){let r=e.state,i=e.root.activeElement;r!=t&&e.updateState(t),i!=e.dom&&e.focus();try{return n()}finally{r!=t&&e.updateState(r),i!=e.dom&&i&&i.focus()}}let uB=/[\u0590-\u08ac]/,uW=null,uq=null,uH=!1;class uU{constructor(e,t,n,r){this.parent=e,this.children=t,this.dom=n,this.contentDOM=r,this.dirty=0,n.pmViewDesc=this}matchesWidget(e){return!1}matchesMark(e){return!1}matchesNode(e,t,n){return!1}matchesHack(e){return!1}parseRule(){return null}stopEvent(e){return!1}get size(){let e=0;for(let t=0;t<this.children.length;t++)e+=this.children[t].size;return e}get border(){return 0}destroy(){this.parent=void 0,this.dom.pmViewDesc==this&&(this.dom.pmViewDesc=void 0);for(let e=0;e<this.children.length;e++)this.children[e].destroy()}posBeforeChild(e){for(let t=0,n=this.posAtStart;;t++){let r=this.children[t];if(r==e)return n;n+=r.size}}get posBefore(){return this.parent.posBeforeChild(this)}get posAtStart(){return this.parent?this.parent.posBeforeChild(this)+this.border:0}get posAfter(){return this.posBefore+this.size}get posAtEnd(){return this.posAtStart+this.size-2*this.border}localPosFromDOM(e,t,n){let r;if(this.contentDOM&&this.contentDOM.contains(1==e.nodeType?e:e.parentNode))if(n<0){let n,r;if(e==this.contentDOM)n=e.childNodes[t-1];else{for(;e.parentNode!=this.contentDOM;)e=e.parentNode;n=e.previousSibling}for(;n&&!((r=n.pmViewDesc)&&r.parent==this);)n=n.previousSibling;return n?this.posBeforeChild(r)+r.size:this.posAtStart}else{let n,r;if(e==this.contentDOM)n=e.childNodes[t];else{for(;e.parentNode!=this.contentDOM;)e=e.parentNode;n=e.nextSibling}for(;n&&!((r=n.pmViewDesc)&&r.parent==this);)n=n.nextSibling;return n?this.posBeforeChild(r):this.posAtEnd}if(e==this.dom&&this.contentDOM)r=t>d9(this.contentDOM);else if(this.contentDOM&&this.contentDOM!=this.dom&&this.dom.contains(this.contentDOM))r=2&e.compareDocumentPosition(this.contentDOM);else if(this.dom.firstChild){if(0==t)for(let t=e;;t=t.parentNode){if(t==this.dom){r=!1;break}if(t.previousSibling)break}if(null==r&&t==e.childNodes.length)for(let t=e;;t=t.parentNode){if(t==this.dom){r=!0;break}if(t.nextSibling)break}}return(null==r?n>0:r)?this.posAtEnd:this.posAtStart}nearestDesc(e,t=!1){for(let n=!0,r=e;r;r=r.parentNode){let i=this.getDesc(r),s;if(i&&(!t||i.node))if(!n||!(s=i.nodeDOM)||(1==s.nodeType?s.contains(1==e.nodeType?e:e.parentNode):s==e))return i;else n=!1}}getDesc(e){let t=e.pmViewDesc;for(let e=t;e;e=e.parent)if(e==this)return t}posFromDOM(e,t,n){for(let r=e;r;r=r.parentNode){let i=this.getDesc(r);if(i)return i.localPosFromDOM(e,t,n)}return -1}descAt(e){for(let t=0,n=0;t<this.children.length;t++){let r=this.children[t],i=n+r.size;if(n==e&&i!=n){for(;!r.border&&r.children.length;)for(let e=0;e<r.children.length;e++){let t=r.children[e];if(t.size){r=t;break}}return r}if(e<i)return r.descAt(e-n-r.border);n=i}}domFromPos(e,t){if(!this.contentDOM)return{node:this.dom,offset:0,atom:e+1};let n=0,r=0;for(let t=0;n<this.children.length;n++){let i=this.children[n],s=t+i.size;if(s>e||i instanceof uQ){r=e-t;break}t=s}if(r)return this.children[n].domFromPos(r-this.children[n].border,t);for(let e;n&&!(e=this.children[n-1]).size&&e instanceof uK&&e.side>=0;n--);if(t<=0){let e,r=!0;for(;(e=n?this.children[n-1]:null)&&e.dom.parentNode!=this.contentDOM;n--,r=!1);return e&&t&&r&&!e.border&&!e.domAtom?e.domFromPos(e.size,t):{node:this.contentDOM,offset:e?d9(e.dom)+1:0}}{let e,r=!0;for(;(e=n<this.children.length?this.children[n]:null)&&e.dom.parentNode!=this.contentDOM;n++,r=!1);return e&&r&&!e.border&&!e.domAtom?e.domFromPos(0,t):{node:this.contentDOM,offset:e?d9(e.dom):this.contentDOM.childNodes.length}}}parseRange(e,t,n=0){if(0==this.children.length)return{node:this.contentDOM,from:e,to:t,fromOffset:0,toOffset:this.contentDOM.childNodes.length};let r=-1,i=-1;for(let s=n,o=0;;o++){let n=this.children[o],a=s+n.size;if(-1==r&&e<=a){let i=s+n.border;if(e>=i&&t<=a-n.border&&n.node&&n.contentDOM&&this.contentDOM.contains(n.contentDOM))return n.parseRange(e,t,i);e=s;for(let t=o;t>0;t--){let n=this.children[t-1];if(n.size&&n.dom.parentNode==this.contentDOM&&!n.emptyChildAt(1)){r=d9(n.dom)+1;break}e-=n.size}-1==r&&(r=0)}if(r>-1&&(a>t||o==this.children.length-1)){t=a;for(let e=o+1;e<this.children.length;e++){let n=this.children[e];if(n.size&&n.dom.parentNode==this.contentDOM&&!n.emptyChildAt(-1)){i=d9(n.dom);break}t+=n.size}-1==i&&(i=this.contentDOM.childNodes.length);break}s=a}return{node:this.contentDOM,from:e,to:t,fromOffset:r,toOffset:i}}emptyChildAt(e){if(this.border||!this.contentDOM||!this.children.length)return!1;let t=this.children[e<0?0:this.children.length-1];return 0==t.size||t.emptyChildAt(e)}domAfterPos(e){let{node:t,offset:n}=this.domFromPos(e,0);if(1!=t.nodeType||n==t.childNodes.length)throw RangeError("No node after pos "+e);return t.childNodes[n]}setSelection(e,t,n,r=!1){let i=Math.min(e,t),s=Math.max(e,t);for(let o=0,a=0;o<this.children.length;o++){let l=this.children[o],c=a+l.size;if(i>a&&s<c)return l.setSelection(e-a-l.border,t-a-l.border,n,r);a=c}let o=this.domFromPos(e,e?-1:1),a=t==e?o:this.domFromPos(t,t?-1:1),l=n.root.getSelection(),c=n.domSelectionRange(),d=!1;if((ux||uk)&&e==t){let{node:e,offset:t}=o;if(3==e.nodeType){if((d=!!(t&&"\n"==e.nodeValue[t-1]))&&t==e.nodeValue.length)for(let t=e,n;t;t=t.parentNode){if(n=t.nextSibling){"BR"==n.nodeName&&(o=a={node:n.parentNode,offset:d9(n)+1});break}let e=t.pmViewDesc;if(e&&e.node&&e.node.isBlock)break}}else{let n=e.childNodes[t-1];d=n&&("BR"==n.nodeName||"false"==n.contentEditable)}}if(ux&&c.focusNode&&c.focusNode!=a.node&&1==c.focusNode.nodeType){let e=c.focusNode.childNodes[c.focusOffset];e&&"false"==e.contentEditable&&(r=!0)}if(!(r||d&&uk)&&ur(o.node,o.offset,c.anchorNode,c.anchorOffset)&&ur(a.node,a.offset,c.focusNode,c.focusOffset))return;let u=!1;if((l.extend||e==t)&&!d){l.collapse(o.node,o.offset);try{e!=t&&l.extend(a.node,a.offset),u=!0}catch(e){}}if(!u){if(e>t){let e=o;o=a,a=e}let n=document.createRange();n.setEnd(a.node,a.offset),n.setStart(o.node,o.offset),l.removeAllRanges(),l.addRange(n)}}ignoreMutation(e){return!this.contentDOM&&"selection"!=e.type}get contentLost(){return this.contentDOM&&this.contentDOM!=this.dom&&!this.dom.contains(this.contentDOM)}markDirty(e,t){for(let n=0,r=0;r<this.children.length;r++){let i=this.children[r],s=n+i.size;if(n==s?e<=s&&t>=n:e<s&&t>n){let r=n+i.border,o=s-i.border;if(e>=r&&t<=o){this.dirty=e==n||t==s?2:1,e==r&&t==o&&(i.contentLost||i.dom.parentNode!=this.contentDOM)?i.dirty=3:i.markDirty(e-r,t-r);return}i.dirty=i.dom!=i.contentDOM||i.dom.parentNode!=this.contentDOM||i.children.length?3:2}n=s}this.dirty=2}markParentsDirty(){let e=1;for(let t=this.parent;t;t=t.parent,e++){let n=1==e?2:1;t.dirty<n&&(t.dirty=n)}}get domAtom(){return!1}get ignoreForCoords(){return!1}get ignoreForSelection(){return!1}isText(e){return!1}}class uK extends uU{constructor(e,t,n,r){let i,s=t.type.toDOM;if("function"==typeof s&&(s=s(n,()=>i?i.parent?i.parent.posBeforeChild(i):void 0:r)),!t.type.spec.raw){if(1!=s.nodeType){let e=document.createElement("span");e.appendChild(s),s=e}s.contentEditable="false",s.classList.add("ProseMirror-widget")}super(e,[],s,null),this.widget=t,this.widget=t,i=this}matchesWidget(e){return 0==this.dirty&&e.type.eq(this.widget.type)}parseRule(){return{ignore:!0}}stopEvent(e){let t=this.widget.spec.stopEvent;return!!t&&t(e)}ignoreMutation(e){return"selection"!=e.type||this.widget.spec.ignoreSelection}destroy(){this.widget.type.destroy(this.dom),super.destroy()}get domAtom(){return!0}get ignoreForSelection(){return!!this.widget.type.spec.relaxedSide}get side(){return this.widget.type.side}}class uJ extends uU{constructor(e,t,n,r){super(e,[],t,null),this.textDOM=n,this.text=r}get size(){return this.text.length}localPosFromDOM(e,t){return e!=this.textDOM?this.posAtStart+(t?this.size:0):this.posAtStart+t}domFromPos(e){return{node:this.textDOM,offset:e}}ignoreMutation(e){return"characterData"===e.type&&e.target.nodeValue==e.oldValue}}class uG extends uU{constructor(e,t,n,r,i){super(e,[],n,r),this.mark=t,this.spec=i}static create(e,t,n,r){let i=r.nodeViews[t.type.name],s=i&&i(t,r,n);return s&&s.dom||(s=c6.renderSpec(document,t.type.spec.toDOM(t,n),null,t.attrs)),new uG(e,t,s.dom,s.contentDOM||s.dom,s)}parseRule(){return 3&this.dirty||this.mark.type.spec.reparseInView?null:{mark:this.mark.type.name,attrs:this.mark.attrs,contentElement:this.contentDOM}}matchesMark(e){return 3!=this.dirty&&this.mark.eq(e)}markDirty(e,t){if(super.markDirty(e,t),0!=this.dirty){let e=this.parent;for(;!e.node;)e=e.parent;e.dirty<this.dirty&&(e.dirty=this.dirty),this.dirty=0}}slice(e,t,n){let r=uG.create(this.parent,this.mark,!0,n),i=this.children,s=this.size;t<s&&(i=he(i,t,s,n)),e>0&&(i=he(i,0,e,n));for(let e=0;e<i.length;e++)i[e].parent=r;return r.children=i,r}ignoreMutation(e){return this.spec.ignoreMutation?this.spec.ignoreMutation(e):super.ignoreMutation(e)}destroy(){this.spec.destroy&&this.spec.destroy(),super.destroy()}}class uY extends uU{constructor(e,t,n,r,i,s,o,a,l){super(e,[],i,s),this.node=t,this.outerDeco=n,this.innerDeco=r,this.nodeDOM=o}static create(e,t,n,r,i,s){let o=i.nodeViews[t.type.name],a,l=o&&o(t,i,()=>a?a.parent?a.parent.posBeforeChild(a):void 0:s,n,r),c=l&&l.dom,d=l&&l.contentDOM;if(t.isText)if(c){if(3!=c.nodeType)throw RangeError("Text must be rendered as a DOM text node")}else c=document.createTextNode(t.text);else if(!c){let e=c6.renderSpec(document,t.type.spec.toDOM(t),null,t.attrs);({dom:c,contentDOM:d}=e)}d||t.isText||"BR"==c.nodeName||(c.hasAttribute("contenteditable")||(c.contentEditable="false"),t.type.spec.draggable&&(c.draggable=!0));let u=c;return(c=u5(c,n,t),l)?a=new u0(e,t,n,r,c,d||null,u,l,i,s+1):t.isText?new uZ(e,t,n,r,c,u,i):new uY(e,t,n,r,c,d||null,u,i,s+1)}parseRule(){if(this.node.type.spec.reparseInView)return null;let e={node:this.node.type.name,attrs:this.node.attrs};if("pre"==this.node.type.whitespace&&(e.preserveWhitespace="full"),this.contentDOM)if(this.contentLost){for(let t=this.children.length-1;t>=0;t--){let n=this.children[t];if(this.dom.contains(n.dom.parentNode)){e.contentElement=n.dom.parentNode;break}}e.contentElement||(e.getContent=()=>cm.empty)}else e.contentElement=this.contentDOM;else e.getContent=()=>this.node.content;return e}matchesNode(e,t,n){return 0==this.dirty&&e.eq(this.node)&&u6(t,this.outerDeco)&&n.eq(this.innerDeco)}get size(){return this.node.nodeSize}get border(){return+!this.node.isLeaf}updateChildren(e,t){let n=this.node.inlineContent,r=t,i=e.composing?this.localCompositionInfo(e,t):null,s=i&&i.pos>-1?i:null,o=i&&i.pos<0,a=new u9(this,s&&s.node,e);(function(e,t,n,r){let i=t.locals(e),s=0;if(0==i.length){for(let n=0;n<e.childCount;n++){let o=e.child(n);r(o,i,t.forChild(s,o),n),s+=o.nodeSize}return}let o=0,a=[],l=null;for(let c=0;;){let d,u,h,p;for(;o<i.length&&i[o].to==s;){let e=i[o++];e.widget&&(d?(u||(u=[d])).push(e):d=e)}if(d)if(u){u.sort(u7);for(let e=0;e<u.length;e++)n(u[e],c,!!l)}else n(d,c,!!l);if(l)p=-1,h=l,l=null;else if(c<e.childCount)p=c,h=e.child(c++);else break;for(let e=0;e<a.length;e++)a[e].to<=s&&a.splice(e--,1);for(;o<i.length&&i[o].from<=s&&i[o].to>s;)a.push(i[o++]);let f=s+h.nodeSize;if(h.isText){let e=f;o<i.length&&i[o].from<e&&(e=i[o].from);for(let t=0;t<a.length;t++)a[t].to<e&&(e=a[t].to);e<f&&(l=h.cut(e-s),h=h.cut(0,e-s),f=e,p=-1)}else for(;o<i.length&&i[o].to<f;)o++;let m=h.isInline&&!h.isLeaf?a.filter(e=>!e.inline):a.slice();r(h,m,t.forChild(s,h),p),s=f}})(this.node,this.innerDeco,(t,i,s)=>{t.spec.marks?a.syncToMarks(t.spec.marks,n,e):t.type.side>=0&&!s&&a.syncToMarks(i==this.node.childCount?cv.none:this.node.child(i).marks,n,e),a.placeWidget(t,e,r)},(t,s,l,c)=>{let d;a.syncToMarks(t.marks,n,e),a.findNodeMatch(t,s,l,c)||o&&e.state.selection.from>r&&e.state.selection.to<r+t.nodeSize&&(d=a.findIndexWithChild(i.node))>-1&&a.updateNodeAt(t,s,l,d,e)||a.updateNextNode(t,s,l,e,c,r)||a.addNode(t,s,l,e,r),r+=t.nodeSize}),a.syncToMarks([],n,e),this.node.isTextblock&&a.addTextblockHacks(),a.destroyRest(),(a.changed||2==this.dirty)&&(s&&this.protectLocalComposition(e,s),function e(t,n,r){let i=t.firstChild,s=!1;for(let o=0;o<n.length;o++){let a=n[o],l=a.dom;if(l.parentNode==t){for(;l!=i;)i=u8(i),s=!0;i=i.nextSibling}else s=!0,t.insertBefore(l,i);if(a instanceof uG){let n=i?i.previousSibling:t.lastChild;e(a.contentDOM,a.children,r),i=n?n.nextSibling:t.firstChild}}for(;i;)i=u8(i),s=!0;s&&r.trackWrites==t&&(r.trackWrites=null)}(this.contentDOM,this.children,e),uj&&function(e){if("UL"==e.nodeName||"OL"==e.nodeName){let t=e.style.cssText;e.style.cssText=t+"; list-style: square !important",window.getComputedStyle(e).listStyle,e.style.cssText=t}}(this.dom))}localCompositionInfo(e,t){let{from:n,to:r}=e.state.selection;if(!(e.state.selection instanceof dq)||n<t||r>t+this.node.content.size)return null;let i=e.input.compositionNode;if(!i||!this.dom.contains(i.parentNode))return null;if(!this.node.inlineContent)return{node:i,pos:-1,text:""};{let e=i.nodeValue,s=function(e,t,n,r){for(let i=0,s=0;i<e.childCount&&s<=r;){let o=e.child(i++),a=s;if(s+=o.nodeSize,!o.isText)continue;let l=o.text;for(;i<e.childCount;){let t=e.child(i++);if(s+=t.nodeSize,!t.isText)break;l+=t.text}if(s>=n){if(s>=r&&l.slice(r-t.length-a,r-a)==t)return r-t.length;let e=a<r?l.lastIndexOf(t,r-a-1):-1;if(e>=0&&e+t.length+a>=n)return a+e;if(n==r&&l.length>=r+t.length-a&&l.slice(r-a,r-a+t.length)==t)return r}}return -1}(this.node.content,e,n-t,r-t);return s<0?null:{node:i,pos:s,text:e}}}protectLocalComposition(e,{node:t,pos:n,text:r}){if(this.getDesc(t))return;let i=t;for(;i.parentNode!=this.contentDOM;i=i.parentNode){for(;i.previousSibling;)i.parentNode.removeChild(i.previousSibling);for(;i.nextSibling;)i.parentNode.removeChild(i.nextSibling);i.pmViewDesc&&(i.pmViewDesc=void 0)}let s=new uJ(this,i,t,r);e.input.compositionNodes.push(s),this.children=he(this.children,n,n+r.length,e,s)}update(e,t,n,r){return 3!=this.dirty&&!!e.sameMarkup(this.node)&&(this.updateInner(e,t,n,r),!0)}updateInner(e,t,n,r){this.updateOuterDeco(t),this.node=e,this.innerDeco=n,this.contentDOM&&this.updateChildren(r,this.posAtStart),this.dirty=0}updateOuterDeco(e){if(u6(e,this.outerDeco))return;let t=1!=this.nodeDOM.nodeType,n=this.dom;this.dom=u3(this.dom,this.nodeDOM,u4(this.outerDeco,this.node,t),u4(e,this.node,t)),this.dom!=n&&(n.pmViewDesc=void 0,this.dom.pmViewDesc=this),this.outerDeco=e}selectNode(){1==this.nodeDOM.nodeType&&this.nodeDOM.classList.add("ProseMirror-selectednode"),(this.contentDOM||!this.node.type.spec.draggable)&&(this.dom.draggable=!0)}deselectNode(){1==this.nodeDOM.nodeType&&(this.nodeDOM.classList.remove("ProseMirror-selectednode"),(this.contentDOM||!this.node.type.spec.draggable)&&this.dom.removeAttribute("draggable"))}get domAtom(){return this.node.isAtom}}function uX(e,t,n,r,i){u5(r,t,e);let s=new uY(void 0,e,t,n,r,r,r,i,0);return s.contentDOM&&s.updateChildren(i,0),s}class uZ extends uY{constructor(e,t,n,r,i,s,o){super(e,t,n,r,i,null,s,o,0)}parseRule(){let e=this.nodeDOM.parentNode;for(;e&&e!=this.dom&&!e.pmIsDeco;)e=e.parentNode;return{skip:e||!0}}update(e,t,n,r){return 3!=this.dirty&&(0==this.dirty||!!this.inParent())&&!!e.sameMarkup(this.node)&&(this.updateOuterDeco(t),(0!=this.dirty||e.text!=this.node.text)&&e.text!=this.nodeDOM.nodeValue&&(this.nodeDOM.nodeValue=e.text,r.trackWrites==this.nodeDOM&&(r.trackWrites=null)),this.node=e,this.dirty=0,!0)}inParent(){let e=this.parent.contentDOM;for(let t=this.nodeDOM;t;t=t.parentNode)if(t==e)return!0;return!1}domFromPos(e){return{node:this.nodeDOM,offset:e}}localPosFromDOM(e,t,n){return e==this.nodeDOM?this.posAtStart+Math.min(t,this.node.text.length):super.localPosFromDOM(e,t,n)}ignoreMutation(e){return"characterData"!=e.type&&"selection"!=e.type}slice(e,t,n){let r=this.node.cut(e,t),i=document.createTextNode(r.text);return new uZ(this.parent,r,this.outerDeco,this.innerDeco,i,i,n)}markDirty(e,t){super.markDirty(e,t),this.dom!=this.nodeDOM&&(0==e||t==this.nodeDOM.nodeValue.length)&&(this.dirty=3)}get domAtom(){return!1}isText(e){return this.node.text==e}}class uQ extends uU{parseRule(){return{ignore:!0}}matchesHack(e){return 0==this.dirty&&this.dom.nodeName==e}get domAtom(){return!0}get ignoreForCoords(){return"IMG"==this.dom.nodeName}}class u0 extends uY{constructor(e,t,n,r,i,s,o,a,l,c){super(e,t,n,r,i,s,o,l,c),this.spec=a}update(e,t,n,r){if(3==this.dirty)return!1;if(this.spec.update&&(this.node.type==e.type||this.spec.multiType)){let i=this.spec.update(e,t,n);return i&&this.updateInner(e,t,n,r),i}return(!!this.contentDOM||!!e.isLeaf)&&super.update(e,t,n,r)}selectNode(){this.spec.selectNode?this.spec.selectNode():super.selectNode()}deselectNode(){this.spec.deselectNode?this.spec.deselectNode():super.deselectNode()}setSelection(e,t,n,r){this.spec.setSelection?this.spec.setSelection(e,t,n.root):super.setSelection(e,t,n,r)}destroy(){this.spec.destroy&&this.spec.destroy(),super.destroy()}stopEvent(e){return!!this.spec.stopEvent&&this.spec.stopEvent(e)}ignoreMutation(e){return this.spec.ignoreMutation?this.spec.ignoreMutation(e):super.ignoreMutation(e)}}let u1=function(e){e&&(this.nodeName=e)};u1.prototype=Object.create(null);let u2=[new u1];function u4(e,t,n){if(0==e.length)return u2;let r=n?u2[0]:new u1,i=[r];for(let s=0;s<e.length;s++){let o=e[s].type.attrs;if(o)for(let e in o.nodeName&&i.push(r=new u1(o.nodeName)),o){let s=o[e];null!=s&&(n&&1==i.length&&i.push(r=new u1(t.isInline?"span":"div")),"class"==e?r.class=(r.class?r.class+" ":"")+s:"style"==e?r.style=(r.style?r.style+";":"")+s:"nodeName"!=e&&(r[e]=s))}}return i}function u3(e,t,n,r){if(n==u2&&r==u2)return t;let i=t;for(let t=0;t<r.length;t++){let s=r[t],o=n[t];if(t){let t;o&&o.nodeName==s.nodeName&&i!=e&&(t=i.parentNode)&&t.nodeName.toLowerCase()==s.nodeName||((t=document.createElement(s.nodeName)).pmIsDeco=!0,t.appendChild(i),o=u2[0]),i=t}!function(e,t,n){for(let r in t)"class"==r||"style"==r||"nodeName"==r||r in n||e.removeAttribute(r);for(let r in n)"class"!=r&&"style"!=r&&"nodeName"!=r&&n[r]!=t[r]&&e.setAttribute(r,n[r]);if(t.class!=n.class){let r=t.class?t.class.split(" ").filter(Boolean):[],i=n.class?n.class.split(" ").filter(Boolean):[];for(let t=0;t<r.length;t++)-1==i.indexOf(r[t])&&e.classList.remove(r[t]);for(let t=0;t<i.length;t++)-1==r.indexOf(i[t])&&e.classList.add(i[t]);0==e.classList.length&&e.removeAttribute("class")}if(t.style!=n.style){if(t.style){let n=/\s*([\w\-\xa1-\uffff]+)\s*:(?:"(?:\\.|[^"])*"|'(?:\\.|[^'])*'|\(.*?\)|[^;])*/g,r;for(;r=n.exec(t.style);)e.style.removeProperty(r[1])}n.style&&(e.style.cssText+=n.style)}}(i,o||u2[0],s)}return i}function u5(e,t,n){return u3(e,e,u2,u4(t,n,1!=e.nodeType))}function u6(e,t){if(e.length!=t.length)return!1;for(let n=0;n<e.length;n++)if(!e[n].type.eq(t[n].type))return!1;return!0}function u8(e){let t=e.nextSibling;return e.parentNode.removeChild(e),t}class u9{constructor(e,t,n){this.lock=t,this.view=n,this.index=0,this.stack=[],this.changed=!1,this.top=e,this.preMatch=function(e,t){let n=t,r=n.children.length,i=e.childCount,s=new Map,o=[];n:for(;i>0;){let a;for(;;)if(r){let e=n.children[r-1];if(e instanceof uG)n=e,r=e.children.length;else{a=e,r--;break}}else if(n==t)break n;else r=n.parent.children.indexOf(n),n=n.parent;let l=a.node;if(l){if(l!=e.child(i-1))break;--i,s.set(a,i),o.push(a)}}return{index:i,matched:s,matches:o.reverse()}}(e.node.content,e)}destroyBetween(e,t){if(e!=t){for(let n=e;n<t;n++)this.top.children[n].destroy();this.top.children.splice(e,t-e),this.changed=!0}}destroyRest(){this.destroyBetween(this.index,this.top.children.length)}syncToMarks(e,t,n){let r=0,i=this.stack.length>>1,s=Math.min(i,e.length);for(;r<s&&(r==i-1?this.top:this.stack[r+1<<1]).matchesMark(e[r])&&!1!==e[r].type.spec.spanning;)r++;for(;r<i;)this.destroyRest(),this.top.dirty=0,this.index=this.stack.pop(),this.top=this.stack.pop(),i--;for(;i<e.length;){this.stack.push(this.top,this.index+1);let r=-1;for(let t=this.index;t<Math.min(this.index+3,this.top.children.length);t++){let n=this.top.children[t];if(n.matchesMark(e[i])&&!this.isLocked(n.dom)){r=t;break}}if(r>-1)r>this.index&&(this.changed=!0,this.destroyBetween(this.index,r)),this.top=this.top.children[this.index];else{let r=uG.create(this.top,e[i],t,n);this.top.children.splice(this.index,0,r),this.top=r,this.changed=!0}this.index=0,i++}}findNodeMatch(e,t,n,r){let i=-1,s;if(r>=this.preMatch.index&&(s=this.preMatch.matches[r-this.preMatch.index]).parent==this.top&&s.matchesNode(e,t,n))i=this.top.children.indexOf(s,this.index);else for(let r=this.index,s=Math.min(this.top.children.length,r+5);r<s;r++){let s=this.top.children[r];if(s.matchesNode(e,t,n)&&!this.preMatch.matched.has(s)){i=r;break}}return!(i<0)&&(this.destroyBetween(this.index,i),this.index++,!0)}updateNodeAt(e,t,n,r,i){let s=this.top.children[r];return 3==s.dirty&&s.dom==s.contentDOM&&(s.dirty=2),!!s.update(e,t,n,i)&&(this.destroyBetween(this.index,r),this.index++,!0)}findIndexWithChild(e){for(;;){let t=e.parentNode;if(!t)return -1;if(t==this.top.contentDOM){let t=e.pmViewDesc;if(t){for(let e=this.index;e<this.top.children.length;e++)if(this.top.children[e]==t)return e}return -1}e=t}}updateNextNode(e,t,n,r,i,s){for(let o=this.index;o<this.top.children.length;o++){let a=this.top.children[o];if(a instanceof uY){let l=this.preMatch.matched.get(a);if(null!=l&&l!=i)return!1;let c=a.dom,d,u=this.isLocked(c)&&!(e.isText&&a.node&&a.node.isText&&a.nodeDOM.nodeValue==e.text&&3!=a.dirty&&u6(t,a.outerDeco));if(!u&&a.update(e,t,n,r))return this.destroyBetween(this.index,o),a.dom!=c&&(this.changed=!0),this.index++,!0;if(!u&&(d=this.recreateWrapper(a,e,t,n,r,s)))return this.destroyBetween(this.index,o),this.top.children[this.index]=d,d.contentDOM&&(d.dirty=2,d.updateChildren(r,s+1),d.dirty=0),this.changed=!0,this.index++,!0;break}}return!1}recreateWrapper(e,t,n,r,i,s){if(e.dirty||t.isAtom||!e.children.length||!e.node.content.eq(t.content)||!u6(n,e.outerDeco)||!r.eq(e.innerDeco))return null;let o=uY.create(this.top,t,n,r,i,s);if(o.contentDOM)for(let t of(o.children=e.children,e.children=[],o.children))t.parent=o;return e.destroy(),o}addNode(e,t,n,r,i){let s=uY.create(this.top,e,t,n,r,i);s.contentDOM&&s.updateChildren(r,i+1),this.top.children.splice(this.index++,0,s),this.changed=!0}placeWidget(e,t,n){let r=this.index<this.top.children.length?this.top.children[this.index]:null;if(r&&r.matchesWidget(e)&&(e==r.widget||!r.widget.type.toDOM.parentNode))this.index++;else{let r=new uK(this.top,e,t,n);this.top.children.splice(this.index++,0,r),this.changed=!0}}addTextblockHacks(){let e=this.top.children[this.index-1],t=this.top;for(;e instanceof uG;)e=(t=e).children[t.children.length-1];(!e||!(e instanceof uZ)||/\n$/.test(e.node.text)||this.view.requiresGeckoHackNode&&/\s$/.test(e.node.text))&&((uk||ub)&&e&&"false"==e.dom.contentEditable&&this.addHackNode("IMG",t),this.addHackNode("BR",this.top))}addHackNode(e,t){if(t==this.top&&this.index<t.children.length&&t.children[this.index].matchesHack(e))this.index++;else{let n=document.createElement(e);"IMG"==e&&(n.className="ProseMirror-separator",n.alt=""),"BR"==e&&(n.className="ProseMirror-trailingBreak");let r=new uQ(this.top,[],n,null);t!=this.top?t.children.push(r):t.children.splice(this.index++,0,r),this.changed=!0}}isLocked(e){return this.lock&&(e==this.lock||1==e.nodeType&&e.contains(this.lock.parentNode))}}function u7(e,t){return e.type.side-t.type.side}function he(e,t,n,r,i){let s=[];for(let o=0,a=0;o<e.length;o++){let l=e[o],c=a,d=a+=l.size;c>=n||d<=t?s.push(l):(c<t&&s.push(l.slice(0,t-c,r)),i&&(s.push(i),i=void 0),d>n&&s.push(l.slice(n-c,l.size,r)))}return s}function ht(e,t=null){let n=e.domSelectionRange(),r=e.state.doc;if(!n.focusNode)return null;let i=e.docView.nearestDesc(n.focusNode),s=i&&0==i.size,o=e.docView.posFromDOM(n.focusNode,n.focusOffset,1);if(o<0)return null;let a=r.resolve(o),l,c;if(ul(n)){for(l=o;i&&!i.node;)i=i.parent;let e=i.node;if(i&&e.isAtom&&dU.isSelectable(e)&&i.parent&&!(e.isInline&&function(e,t,n){for(let r=0==t,i=t==uo(e);r||i;){if(e==n)return!0;let t=d9(e);if(!(e=e.parentNode))return!1;r=r&&0==t,i=i&&t==uo(e)}}(n.focusNode,n.focusOffset,i.dom))){let e=i.posBefore;c=new dU(o==e?a:r.resolve(e))}}else{if(n instanceof e.dom.ownerDocument.defaultView.Selection&&n.rangeCount>1){let t=o,i=o;for(let r=0;r<n.rangeCount;r++){let s=n.getRangeAt(r);t=Math.min(t,e.docView.posFromDOM(s.startContainer,s.startOffset,1)),i=Math.max(i,e.docView.posFromDOM(s.endContainer,s.endOffset,-1))}if(t<0)return null;[l,o]=i==e.state.selection.anchor?[i,t]:[t,i],a=r.resolve(o)}else l=e.docView.posFromDOM(n.anchorNode,n.anchorOffset,1);if(l<0)return null}let d=r.resolve(l);if(!c){let n="pointer"==t||e.state.selection.head<a.pos&&!s?1:-1;c=hd(e,d,a,n)}return c}function hn(e){return e.editable?e.hasFocus():hh(e)&&document.activeElement&&document.activeElement.contains(e.dom)}function hr(e,t=!1){let n=e.state.selection;if(hl(e,n),hn(e)){if(!t&&e.input.mouseDown&&e.input.mouseDown.allowDefault&&ub){let t=e.domSelectionRange(),n=e.domObserver.currentSelection;if(t.anchorNode&&n.anchorNode&&ur(t.anchorNode,t.anchorOffset,n.anchorNode,n.anchorOffset)){e.input.mouseDown.delayedSelectionSync=!0,e.domObserver.setCurSelection();return}}if(e.domObserver.disconnectSelection(),e.cursorWrapper)!function(e){let t=e.domSelection(),n=document.createRange();if(!t)return;let r=e.cursorWrapper.dom,i="IMG"==r.nodeName;i?n.setStart(r.parentNode,d9(r)+1):n.setStart(r,0),n.collapse(!0),t.removeAllRanges(),t.addRange(n),!i&&!e.state.selection.visible&&ug&&uy<=11&&(r.disabled=!0,r.disabled=!1)}(e);else{var r;let i,s,o,a,{anchor:l,head:c}=n,d,u;hi&&!(n instanceof dq)&&(n.$from.parent.inlineContent||(d=hs(e,n.from)),n.empty||n.$from.parent.inlineContent||(u=hs(e,n.to))),e.docView.setSelection(l,c,e,t),hi&&(d&&ha(d),u&&ha(u)),n.visible?e.dom.classList.remove("ProseMirror-hideselection"):(e.dom.classList.add("ProseMirror-hideselection"),"onselectionchange"in document&&((i=(r=e).dom.ownerDocument).removeEventListener("selectionchange",r.input.hideSelectionGuard),o=(s=r.domSelectionRange()).anchorNode,a=s.anchorOffset,i.addEventListener("selectionchange",r.input.hideSelectionGuard=()=>{(s.anchorNode!=o||s.anchorOffset!=a)&&(i.removeEventListener("selectionchange",r.input.hideSelectionGuard),setTimeout(()=>{(!hn(r)||r.state.selection.visible)&&r.dom.classList.remove("ProseMirror-hideselection")},20))})))}e.domObserver.setCurSelection(),e.domObserver.connectSelection()}}let hi=uk||ub&&uw<63;function hs(e,t){let{node:n,offset:r}=e.docView.domFromPos(t,0),i=r<n.childNodes.length?n.childNodes[r]:null,s=r?n.childNodes[r-1]:null;if(uk&&i&&"false"==i.contentEditable)return ho(i);if((!i||"false"==i.contentEditable)&&(!s||"false"==s.contentEditable)){if(i)return ho(i);else if(s)return ho(s)}}function ho(e){return e.contentEditable="true",uk&&e.draggable&&(e.draggable=!1,e.wasDraggable=!0),e}function ha(e){e.contentEditable="false",e.wasDraggable&&(e.draggable=!0,e.wasDraggable=null)}function hl(e,t){if(t instanceof dU){let n=e.docView.descAt(t.from);n!=e.lastSelectedViewDesc&&(hc(e),n&&n.selectNode(),e.lastSelectedViewDesc=n)}else hc(e)}function hc(e){e.lastSelectedViewDesc&&(e.lastSelectedViewDesc.parent&&e.lastSelectedViewDesc.deselectNode(),e.lastSelectedViewDesc=void 0)}function hd(e,t,n,r){return e.someProp("createSelectionBetween",r=>r(e,t,n))||dq.between(t,n,r)}function hu(e){return(!e.editable||!!e.hasFocus())&&hh(e)}function hh(e){let t=e.domSelectionRange();if(!t.anchorNode)return!1;try{return e.dom.contains(3==t.anchorNode.nodeType?t.anchorNode.parentNode:t.anchorNode)&&(e.editable||e.dom.contains(3==t.focusNode.nodeType?t.focusNode.parentNode:t.focusNode))}catch(e){return!1}}function hp(e,t){let{$anchor:n,$head:r}=e.selection,i=t>0?n.max(r):n.min(r),s=i.parent.inlineContent?i.depth?e.doc.resolve(t>0?i.after():i.before()):null:i;return s&&d_.findFrom(s,t)}function hf(e,t){return e.dispatch(e.state.tr.setSelection(t).scrollIntoView()),!0}function hm(e,t,n){let r=e.state.selection;if(r instanceof dq){if(n.indexOf("s")>-1){let{$head:n}=r,i=n.textOffset?null:t<0?n.nodeBefore:n.nodeAfter;if(!i||i.isText||!i.isLeaf)return!1;let s=e.state.doc.resolve(n.pos+i.nodeSize*(t<0?-1:1));return hf(e,new dq(r.$anchor,s))}else if(!r.empty)return!1;else if(e.endOfTextblock(t>0?"forward":"backward")){let n=hp(e.state,t);return!!n&&n instanceof dU&&hf(e,n)}else if(!(uN&&n.indexOf("m")>-1)){let n=r.$head,i=n.textOffset?null:t<0?n.nodeBefore:n.nodeAfter,s;if(!i||i.isText)return!1;let o=t<0?n.pos-i.nodeSize:n.pos;return!!(i.isAtom||(s=e.docView.descAt(o))&&!s.contentDOM)&&(dU.isSelectable(i)?hf(e,new dU(t<0?e.state.doc.resolve(n.pos-i.nodeSize):n)):!!uM&&hf(e,new dq(e.state.doc.resolve(t<0?o:o+i.nodeSize))))}}else{if(r instanceof dU&&r.node.isInline)return hf(e,new dq(t>0?r.$to:r.$from));let n=hp(e.state,t);return!!n&&hf(e,n)}}function hg(e){return 3==e.nodeType?e.nodeValue.length:e.childNodes.length}function hy(e,t){let n=e.pmViewDesc;return n&&0==n.size&&(t<0||e.nextSibling||"BR"!=e.nodeName)}function hx(e,t){return t<0?function(e){let t=e.domSelectionRange(),n=t.focusNode,r=t.focusOffset;if(!n)return;let i,s,o=!1;for(ux&&1==n.nodeType&&r<hg(n)&&hy(n.childNodes[r],-1)&&(o=!0);;)if(r>0)if(1!=n.nodeType)break;else{let e=n.childNodes[r-1];if(hy(e,-1))i=n,s=--r;else if(3==e.nodeType)r=(n=e).nodeValue.length;else break}else if(hv(n))break;else{let t=n.previousSibling;for(;t&&hy(t,-1);)i=n.parentNode,s=d9(t),t=t.previousSibling;if(t)r=hg(n=t);else{if((n=n.parentNode)==e.dom)break;r=0}}o?hb(e,n,r):i&&hb(e,i,s)}(e):function(e){let t,n,r=e.domSelectionRange(),i=r.focusNode,s=r.focusOffset;if(!i)return;let o=hg(i);for(;;)if(s<o){if(1!=i.nodeType)break;if(hy(i.childNodes[s],1))t=i,n=++s;else break}else if(hv(i))break;else{let r=i.nextSibling;for(;r&&hy(r,1);)t=r.parentNode,n=d9(r)+1,r=r.nextSibling;if(r)s=0,o=hg(i=r);else{if((i=i.parentNode)==e.dom)break;s=o=0}}t&&hb(e,t,n)}(e)}function hv(e){let t=e.pmViewDesc;return t&&t.node&&t.node.isBlock}function hb(e,t,n){if(3!=t.nodeType){let e,r;(r=function(e,t){for(;e&&t==e.childNodes.length&&!ua(e);)t=d9(e)+1,e=e.parentNode;for(;e&&t<e.childNodes.length;){let n=e.childNodes[t];if(3==n.nodeType)return n;if(1==n.nodeType&&"false"==n.contentEditable)break;e=n,t=0}}(t,n))?(t=r,n=0):(e=function(e,t){for(;e&&!t&&!ua(e);)t=d9(e),e=e.parentNode;for(;e&&t;){let n=e.childNodes[t-1];if(3==n.nodeType)return n;if(1==n.nodeType&&"false"==n.contentEditable)break;t=(e=n).childNodes.length}}(t,n))&&(t=e,n=e.nodeValue.length)}let r=e.domSelection();if(!r)return;if(ul(r)){let e=document.createRange();e.setEnd(t,n),e.setStart(t,n),r.removeAllRanges(),r.addRange(e)}else r.extend&&r.extend(t,n);e.domObserver.setCurSelection();let{state:i}=e;setTimeout(()=>{e.state==i&&hr(e)},50)}function hw(e,t){let n=e.state.doc.resolve(t);if(!(ub||uS)&&n.parent.inlineContent){let r=e.coordsAtPos(t);if(t>n.start()){let n=e.coordsAtPos(t-1),i=(n.top+n.bottom)/2;if(i>r.top&&i<r.bottom&&Math.abs(n.left-r.left)>1)return n.left<r.left?"ltr":"rtl"}if(t<n.end()){let n=e.coordsAtPos(t+1),i=(n.top+n.bottom)/2;if(i>r.top&&i<r.bottom&&Math.abs(n.left-r.left)>1)return n.left>r.left?"ltr":"rtl"}}return"rtl"==getComputedStyle(e.dom).direction?"rtl":"ltr"}function hk(e,t,n){let r=e.state.selection;if(r instanceof dq&&!r.empty||n.indexOf("s")>-1||uN&&n.indexOf("m")>-1)return!1;let{$from:i,$to:s}=r;if(!i.parent.inlineContent||e.endOfTextblock(t<0?"up":"down")){let n=hp(e.state,t);if(n&&n instanceof dU)return hf(e,n)}if(!i.parent.inlineContent){let n=t<0?i:s,o=r instanceof dJ?d_.near(n,t):d_.findFrom(n,t);return!!o&&hf(e,o)}return!1}function hj(e,t){if(!(e.state.selection instanceof dq))return!0;let{$head:n,$anchor:r,empty:i}=e.state.selection;if(!n.sameParent(r))return!0;if(!i)return!1;if(e.endOfTextblock(t>0?"forward":"backward"))return!0;let s=!n.textOffset&&(t<0?n.nodeBefore:n.nodeAfter);if(s&&!s.isText){let r=e.state.tr;return t<0?r.delete(n.pos-s.nodeSize,n.pos):r.delete(n.pos,n.pos+s.nodeSize),e.dispatch(r),!0}return!1}function hN(e,t,n){e.domObserver.stop(),t.contentEditable=n,e.domObserver.start()}function hS(e,t){e.someProp("transformCopied",n=>{t=n(t,e)});let n=[],{content:r,openStart:i,openEnd:s}=t;for(;i>1&&s>1&&1==r.childCount&&1==r.firstChild.childCount;){i--,s--;let e=r.firstChild;n.push(e.type.name,e.attrs!=e.type.defaultAttrs?e.attrs:null),r=e.content}let o=e.someProp("clipboardSerializer")||c6.fromSchema(e.state.schema),a=hR(),l=a.createElement("div");l.appendChild(o.serializeFragment(r,{document:a}));let c=l.firstChild,d,u=0;for(;c&&1==c.nodeType&&(d=hD[c.nodeName.toLowerCase()]);){for(let e=d.length-1;e>=0;e--){let t=a.createElement(d[e]);for(;l.firstChild;)t.appendChild(l.firstChild);l.appendChild(t),u++}c=l.firstChild}return c&&1==c.nodeType&&c.setAttribute("data-pm-slice",`${i} ${s}${u?` -${u}`:""} ${JSON.stringify(n)}`),{dom:l,text:e.someProp("clipboardTextSerializer",n=>n(t,e))||t.content.textBetween(0,t.content.size,"\n\n"),slice:t}}function hC(e,t,n,r,i){let s,o,a=i.parent.type.spec.code;if(!n&&!t)return null;let l=t&&(r||a||!n);if(l){if(e.someProp("transformPastedText",n=>{t=n(t,a||r,e)}),a)return t?new cw(cm.from(e.state.schema.text(t.replace(/\r\n?/g,"\n"))),0,0):cw.empty;let n=e.someProp("clipboardTextParser",n=>n(t,i,r,e));if(n)o=n;else{let n=i.marks(),{schema:r}=e.state,o=c6.fromSchema(r);s=document.createElement("div"),t.split(/(?:\r\n?|\n)+/).forEach(e=>{let t=s.appendChild(document.createElement("p"));e&&t.appendChild(o.serializeNode(r.text(e,n)))})}}else e.someProp("transformPastedHTML",t=>{n=t(n,e)}),s=function(e){var t;let n,r=/^(\s*<meta [^>]*>)*/.exec(e);r&&(e=e.slice(r[0].length));let i=hR().createElement("div"),s=/<([a-z][^>\s]+)/i.exec(e),o;if((o=s&&hD[s[1].toLowerCase()])&&(e=o.map(e=>"<"+e+">").join("")+e+o.map(e=>"</"+e+">").reverse().join("")),i.innerHTML=(t=e,(n=window.trustedTypes)?(hP||(hP=n.defaultPolicy||n.createPolicy("ProseMirrorClipboard",{createHTML:e=>e})),hP.createHTML(t)):t),o)for(let e=0;e<o.length;e++)i=i.querySelector(o[e])||i;return i}(n),uM&&function(e){let t=e.querySelectorAll(ub?"span:not([class]):not([style])":"span.Apple-converted-space");for(let n=0;n<t.length;n++){let r=t[n];1==r.childNodes.length&&"\xa0"==r.textContent&&r.parentNode&&r.parentNode.replaceChild(e.ownerDocument.createTextNode(" "),r)}}(s);let c=s&&s.querySelector("[data-pm-slice]"),d=c&&/^(\d+) (\d+)(?: -(\d+))? (.*)/.exec(c.getAttribute("data-pm-slice")||"");if(d&&d[3])for(let e=+d[3];e>0;e--){let e=s.firstChild;for(;e&&1!=e.nodeType;)e=e.nextSibling;if(!e)break;s=e}if(o||(o=(e.someProp("clipboardParser")||e.someProp("domParser")||cX.fromSchema(e.state.schema)).parseSlice(s,{preserveWhitespace:!!(l||d),context:i,ruleFromNode:e=>"BR"!=e.nodeName||e.nextSibling||!e.parentNode||hM.test(e.parentNode.nodeName)?null:{ignore:!0}})),d)o=function(e,t){if(!e.size)return e;let n=e.content.firstChild.type.schema,r;try{r=JSON.parse(t)}catch(t){return e}let{content:i,openStart:s,openEnd:o}=e;for(let e=r.length-2;e>=0;e-=2){let t=n.nodes[r[e]];if(!t||t.hasRequiredAttrs())break;i=cm.from(t.create(r[e+1],i)),s++,o++}return new cw(i,s,o)}(hA(o,+d[1],+d[2]),d[4]);else if((o=cw.maxOpen(function(e,t){if(e.childCount<2)return e;for(let n=t.depth;n>=0;n--){let r=t.node(n).contentMatchAt(t.index(n)),i,s=[];if(e.forEach(e=>{if(!s)return;let t=r.findWrapping(e.type),n;if(!t)return s=null;if(n=s.length&&i.length&&function e(t,n,r,i,s){if(s<t.length&&s<n.length&&t[s]==n[s]){let o=e(t,n,r,i.lastChild,s+1);if(o)return i.copy(i.content.replaceChild(i.childCount-1,o));if(i.contentMatchAt(i.childCount).matchType(s==t.length-1?r.type:t[s+1]))return i.copy(i.content.append(cm.from(hE(r,t,s+1))))}}(t,i,e,s[s.length-1],0))s[s.length-1]=n;else{s.length&&(s[s.length-1]=function e(t,n){if(0==n)return t;let r=t.content.replaceChild(t.childCount-1,e(t.lastChild,n-1)),i=t.contentMatchAt(t.childCount).fillBefore(cm.empty,!0);return t.copy(r.append(i))}(s[s.length-1],i.length));let n=hE(e,t);s.push(n),r=r.matchType(n.type),i=t}}),s)return cm.from(s)}return e}(o.content,i),!0)).openStart||o.openEnd){let e=0,t=0;for(let t=o.content.firstChild;e<o.openStart&&!t.type.spec.isolating;e++,t=t.firstChild);for(let e=o.content.lastChild;t<o.openEnd&&!e.type.spec.isolating;t++,e=e.lastChild);o=hA(o,e,t)}return e.someProp("transformPasted",t=>{o=t(o,e)}),o}let hM=/^(a|abbr|acronym|b|cite|code|del|em|i|ins|kbd|label|output|q|ruby|s|samp|span|strong|sub|sup|time|u|tt|var)$/i;function hE(e,t,n=0){for(let r=t.length-1;r>=n;r--)e=t[r].create(null,cm.from(e));return e}function hT(e,t,n,r,i,s){let o=t<0?e.firstChild:e.lastChild,a=o.content;return e.childCount>1&&(s=0),i<r-1&&(a=hT(a,t,n,r,i+1,s)),i>=n&&(a=t<0?o.contentMatchAt(0).fillBefore(a,s<=i).append(a):a.append(o.contentMatchAt(o.childCount).fillBefore(cm.empty,!0))),e.replaceChild(t<0?0:e.childCount-1,o.copy(a))}function hA(e,t,n){return t<e.openStart&&(e=new cw(hT(e.content,-1,t,e.openStart,0,e.openEnd),t,e.openEnd)),n<e.openEnd&&(e=new cw(hT(e.content,1,n,e.openEnd,0,0),e.openStart,n)),e}let hD={thead:["table"],tbody:["table"],tfoot:["table"],caption:["table"],colgroup:["table"],col:["table","colgroup"],tr:["table","tbody"],td:["table","tbody","tr"],th:["table","tbody","tr"]},hO=null;function hR(){return hO||(hO=document.implementation.createHTMLDocument("title"))}let hP=null,hI={},hL={},hz={touchstart:!0,touchmove:!0};class hV{constructor(){this.shiftKey=!1,this.mouseDown=null,this.lastKeyCode=null,this.lastKeyCodeTime=0,this.lastClick={time:0,x:0,y:0,type:"",button:0},this.lastSelectionOrigin=null,this.lastSelectionTime=0,this.lastIOSEnter=0,this.lastIOSEnterFallbackTimeout=-1,this.lastFocus=0,this.lastTouch=0,this.lastChromeDelete=0,this.composing=!1,this.compositionNode=null,this.composingTimeout=-1,this.compositionNodes=[],this.compositionEndedAt=-2e8,this.compositionID=1,this.compositionPendingChanges=0,this.domChangeCount=0,this.eventHandlers=Object.create(null),this.hideSelectionGuard=null}}function h$(e,t){e.input.lastSelectionOrigin=t,e.input.lastSelectionTime=Date.now()}function h_(e){e.someProp("handleDOMEvents",t=>{for(let n in t)e.input.eventHandlers[n]||e.dom.addEventListener(n,e.input.eventHandlers[n]=t=>hF(e,t))})}function hF(e,t){return e.someProp("handleDOMEvents",n=>{let r=n[t.type];return!!r&&(r(e,t)||t.defaultPrevented)})}function hB(e){return{left:e.clientX,top:e.clientY}}function hW(e,t,n,r,i){if(-1==r)return!1;let s=e.state.doc.resolve(r);for(let r=s.depth+1;r>0;r--)if(e.someProp(t,t=>r>s.depth?t(e,n,s.nodeAfter,s.before(r),i,!0):t(e,n,s.node(r),s.before(r),i,!1)))return!0;return!1}function hq(e,t,n){if(e.focused||e.focus(),e.state.selection.eq(t))return;let r=e.state.tr.setSelection(t);"pointer"==n&&r.setMeta("pointer",!0),e.dispatch(r)}hL.keydown=(e,t)=>{if((e.input.shiftKey=16==t.keyCode||t.shiftKey,!hK(e,t))&&(e.input.lastKeyCode=t.keyCode,e.input.lastKeyCodeTime=Date.now(),!uC||!ub||13!=t.keyCode))if(229!=t.keyCode&&e.domObserver.forceFlush(),!uj||13!=t.keyCode||t.ctrlKey||t.altKey||t.metaKey)e.someProp("handleKeyDown",n=>n(e,t))||function(e,t){let n,r=t.keyCode,i=(n="",t.ctrlKey&&(n+="c"),t.metaKey&&(n+="m"),t.altKey&&(n+="a"),t.shiftKey&&(n+="s"),n);if(8==r||uN&&72==r&&"c"==i)return hj(e,-1)||hx(e,-1);if(46==r&&!t.shiftKey||uN&&68==r&&"c"==i)return hj(e,1)||hx(e,1);if(13==r||27==r)return!0;if(37==r||uN&&66==r&&"c"==i){let t=37==r?"ltr"==hw(e,e.state.selection.from)?-1:1:-1;return hm(e,t,i)||hx(e,t)}if(39==r||uN&&70==r&&"c"==i){let t=39==r?"ltr"==hw(e,e.state.selection.from)?1:-1:1;return hm(e,t,i)||hx(e,t)}else if(38==r||uN&&80==r&&"c"==i)return hk(e,-1,i)||hx(e,-1);else if(40==r||uN&&78==r&&"c"==i)return function(e){if(!uk||e.state.selection.$head.parentOffset>0)return!1;let{focusNode:t,focusOffset:n}=e.domSelectionRange();if(t&&1==t.nodeType&&0==n&&t.firstChild&&"false"==t.firstChild.contentEditable){let n=t.firstChild;hN(e,n,"true"),setTimeout(()=>hN(e,n,"false"),20)}return!1}(e)||hk(e,1,i)||hx(e,1);else if(i==(uN?"m":"c")&&(66==r||73==r||89==r||90==r))return!0;return!1}(e,t)?t.preventDefault():h$(e,"key");else{let t=Date.now();e.input.lastIOSEnter=t,e.input.lastIOSEnterFallbackTimeout=setTimeout(()=>{e.input.lastIOSEnter==t&&(e.someProp("handleKeyDown",t=>t(e,uc(13,"Enter"))),e.input.lastIOSEnter=0)},200)}},hL.keyup=(e,t)=>{16==t.keyCode&&(e.input.shiftKey=!1)},hL.keypress=(e,t)=>{if(hK(e,t)||!t.charCode||t.ctrlKey&&!t.altKey||uN&&t.metaKey)return;if(e.someProp("handleKeyPress",n=>n(e,t)))return void t.preventDefault();let n=e.state.selection;if(!(n instanceof dq)||!n.$from.sameParent(n.$to)){let r=String.fromCharCode(t.charCode),i=()=>e.state.tr.insertText(r).scrollIntoView();/[\r\n]/.test(r)||e.someProp("handleTextInput",t=>t(e,n.$from.pos,n.$to.pos,r,i))||e.dispatch(i()),t.preventDefault()}};let hH=uN?"metaKey":"ctrlKey";hI.mousedown=(e,t)=>{e.input.shiftKey=t.shiftKey;let n=hX(e),r=Date.now(),i="singleClick";r-e.input.lastClick.time<500&&function(e,t){let n=t.x-e.clientX,r=t.y-e.clientY;return n*n+r*r<100}(t,e.input.lastClick)&&!t[hH]&&e.input.lastClick.button==t.button&&("singleClick"==e.input.lastClick.type?i="doubleClick":"doubleClick"==e.input.lastClick.type&&(i="tripleClick")),e.input.lastClick={time:r,x:t.clientX,y:t.clientY,type:i,button:t.button};let s=e.posAtCoords(hB(t));s&&("singleClick"==i?(e.input.mouseDown&&e.input.mouseDown.done(),e.input.mouseDown=new hU(e,s,t,!!n)):("doubleClick"==i?function(e,t,n,r){return hW(e,"handleDoubleClickOn",t,n,r)||e.someProp("handleDoubleClick",n=>n(e,t,r))}:function(e,t,n,r){return hW(e,"handleTripleClickOn",t,n,r)||e.someProp("handleTripleClick",n=>n(e,t,r))||function(e,t,n){if(0!=n.button)return!1;let r=e.state.doc;if(-1==t)return!!r.inlineContent&&(hq(e,dq.create(r,0,r.content.size),"pointer"),!0);let i=r.resolve(t);for(let t=i.depth+1;t>0;t--){let n=t>i.depth?i.nodeAfter:i.node(t),s=i.before(t);if(n.inlineContent)hq(e,dq.create(r,s+1,s+1+n.content.size),"pointer");else{if(!dU.isSelectable(n))continue;hq(e,dU.create(r,s),"pointer")}return!0}}(e,n,r)})(e,s.pos,s.inside,t)?t.preventDefault():h$(e,"pointer"))};class hU{constructor(e,t,n,r){let i,s;if(this.view=e,this.pos=t,this.event=n,this.flushed=r,this.delayedSelectionSync=!1,this.mightDrag=null,this.startDoc=e.state.doc,this.selectNode=!!n[hH],this.allowDefault=n.shiftKey,t.inside>-1)i=e.state.doc.nodeAt(t.inside),s=t.inside;else{let n=e.state.doc.resolve(t.pos);i=n.parent,s=n.depth?n.before():0}let o=r?null:n.target,a=o?e.docView.nearestDesc(o,!0):null;this.target=a&&1==a.dom.nodeType?a.dom:null;let{selection:l}=e.state;(0==n.button&&i.type.spec.draggable&&!1!==i.type.spec.selectable||l instanceof dU&&l.from<=s&&l.to>s)&&(this.mightDrag={node:i,pos:s,addAttr:!!(this.target&&!this.target.draggable),setUneditable:!!(this.target&&ux&&!this.target.hasAttribute("contentEditable"))}),this.target&&this.mightDrag&&(this.mightDrag.addAttr||this.mightDrag.setUneditable)&&(this.view.domObserver.stop(),this.mightDrag.addAttr&&(this.target.draggable=!0),this.mightDrag.setUneditable&&setTimeout(()=>{this.view.input.mouseDown==this&&this.target.setAttribute("contentEditable","false")},20),this.view.domObserver.start()),e.root.addEventListener("mouseup",this.up=this.up.bind(this)),e.root.addEventListener("mousemove",this.move=this.move.bind(this)),h$(e,"pointer")}done(){this.view.root.removeEventListener("mouseup",this.up),this.view.root.removeEventListener("mousemove",this.move),this.mightDrag&&this.target&&(this.view.domObserver.stop(),this.mightDrag.addAttr&&this.target.removeAttribute("draggable"),this.mightDrag.setUneditable&&this.target.removeAttribute("contentEditable"),this.view.domObserver.start()),this.delayedSelectionSync&&setTimeout(()=>hr(this.view)),this.view.input.mouseDown=null}up(e){if(this.done(),!this.view.dom.contains(e.target))return;let t=this.pos;if(this.view.state.doc!=this.startDoc&&(t=this.view.posAtCoords(hB(e))),this.updateAllowDefault(e),this.allowDefault||!t)h$(this.view,"pointer");else{var n,r,i,s;(n=this.view,r=t.pos,i=t.inside,s=this.selectNode,hW(n,"handleClickOn",r,i,e)||n.someProp("handleClick",t=>t(n,r,e))||(s?function(e,t){if(-1==t)return!1;let n=e.state.selection,r,i;n instanceof dU&&(r=n.node);let s=e.state.doc.resolve(t);for(let e=s.depth+1;e>0;e--){let t=e>s.depth?s.nodeAfter:s.node(e);if(dU.isSelectable(t)){i=r&&n.$from.depth>0&&e>=n.$from.depth&&s.before(n.$from.depth+1)==n.$from.pos?s.before(n.$from.depth):s.before(e);break}}return null!=i&&(hq(e,dU.create(e.state.doc,i),"pointer"),!0)}(n,i):function(e,t){if(-1==t)return!1;let n=e.state.doc.resolve(t),r=n.nodeAfter;return!!(r&&r.isAtom&&dU.isSelectable(r))&&(hq(e,new dU(n),"pointer"),!0)}(n,i)))?e.preventDefault():0==e.button&&(this.flushed||uk&&this.mightDrag&&!this.mightDrag.node.isAtom||ub&&!this.view.state.selection.visible&&2>=Math.min(Math.abs(t.pos-this.view.state.selection.from),Math.abs(t.pos-this.view.state.selection.to)))?(hq(this.view,d_.near(this.view.state.doc.resolve(t.pos)),"pointer"),e.preventDefault()):h$(this.view,"pointer")}}move(e){this.updateAllowDefault(e),h$(this.view,"pointer"),0==e.buttons&&this.done()}updateAllowDefault(e){!this.allowDefault&&(Math.abs(this.event.x-e.clientX)>4||Math.abs(this.event.y-e.clientY)>4)&&(this.allowDefault=!0)}}function hK(e,t){return!!e.composing||!!(uk&&500>Math.abs(t.timeStamp-e.input.compositionEndedAt))&&(e.input.compositionEndedAt=-2e8,!0)}hI.touchstart=e=>{e.input.lastTouch=Date.now(),hX(e),h$(e,"pointer")},hI.touchmove=e=>{e.input.lastTouch=Date.now(),h$(e,"pointer")},hI.contextmenu=e=>hX(e);let hJ=uC?5e3:-1;function hG(e,t){clearTimeout(e.input.composingTimeout),t>-1&&(e.input.composingTimeout=setTimeout(()=>hX(e),t))}function hY(e){let t;for(e.composing&&(e.input.composing=!1,e.input.compositionEndedAt=((t=document.createEvent("Event")).initEvent("event",!0,!0),t.timeStamp));e.input.compositionNodes.length>0;)e.input.compositionNodes.pop().markParentsDirty()}function hX(e,t=!1){if(!uC||!(e.domObserver.flushingSoon>=0)){if(e.domObserver.forceFlush(),hY(e),t||e.docView&&e.docView.dirty){let n=ht(e),r=e.state.selection;return n&&!n.eq(r)?e.dispatch(e.state.tr.setSelection(n)):(e.markCursor||t)&&!r.$from.node(r.$from.sharedDepth(r.to)).inlineContent?e.dispatch(e.state.tr.deleteSelection()):e.updateState(e.state),!0}return!1}}hL.compositionstart=hL.compositionupdate=e=>{if(!e.composing){e.domObserver.flush();let{state:t}=e,n=t.selection.$to;if(t.selection instanceof dq&&(t.storedMarks||!n.textOffset&&n.parentOffset&&n.nodeBefore.marks.some(e=>!1===e.type.spec.inclusive)))e.markCursor=e.state.storedMarks||n.marks(),hX(e,!0),e.markCursor=null;else if(hX(e,!t.selection.empty),ux&&t.selection.empty&&n.parentOffset&&!n.textOffset&&n.nodeBefore.marks.length){let t=e.domSelectionRange();for(let n=t.focusNode,r=t.focusOffset;n&&1==n.nodeType&&0!=r;){let t=r<0?n.lastChild:n.childNodes[r-1];if(!t)break;if(3==t.nodeType){let n=e.domSelection();n&&n.collapse(t,t.nodeValue.length);break}n=t,r=-1}}e.input.composing=!0}hG(e,hJ)},hL.compositionend=(e,t)=>{e.composing&&(e.input.composing=!1,e.input.compositionEndedAt=t.timeStamp,e.input.compositionPendingChanges=e.domObserver.pendingRecords().length?e.input.compositionID:0,e.input.compositionNode=null,e.input.compositionPendingChanges&&Promise.resolve().then(()=>e.domObserver.flush()),e.input.compositionID++,hG(e,20))};let hZ=ug&&uy<15||uj&&uE<604;function hQ(e,t,n,r,i){let s=hC(e,t,n,r,e.state.selection.$from);if(e.someProp("handlePaste",t=>t(e,i,s||cw.empty)))return!0;if(!s)return!1;let o=0==s.openStart&&0==s.openEnd&&1==s.content.childCount?s.content.firstChild:null,a=o?e.state.tr.replaceSelectionWith(o,r):e.state.tr.replaceSelection(s);return e.dispatch(a.scrollIntoView().setMeta("paste",!0).setMeta("uiEvent","paste")),!0}function h0(e){let t=e.getData("text/plain")||e.getData("Text");if(t)return t;let n=e.getData("text/uri-list");return n?n.replace(/\r?\n/g," "):""}hI.copy=hL.cut=(e,t)=>{let n=e.state.selection,r="cut"==t.type;if(n.empty)return;let i=hZ?null:t.clipboardData,{dom:s,text:o}=hS(e,n.content());i?(t.preventDefault(),i.clearData(),i.setData("text/html",s.innerHTML),i.setData("text/plain",o)):function(e,t){if(!e.dom.parentNode)return;let n=e.dom.parentNode.appendChild(document.createElement("div"));n.appendChild(t),n.style.cssText="position: fixed; left: -10000px; top: 10px";let r=getSelection(),i=document.createRange();i.selectNodeContents(t),e.dom.blur(),r.removeAllRanges(),r.addRange(i),setTimeout(()=>{n.parentNode&&n.parentNode.removeChild(n),e.focus()},50)}(e,s),r&&e.dispatch(e.state.tr.deleteSelection().scrollIntoView().setMeta("uiEvent","cut"))},hL.paste=(e,t)=>{if(e.composing&&!uC)return;let n=hZ?null:t.clipboardData,r=e.input.shiftKey&&45!=e.input.lastKeyCode;n&&hQ(e,h0(n),n.getData("text/html"),r,t)?t.preventDefault():function(e,t){if(!e.dom.parentNode)return;let n=e.input.shiftKey||e.state.selection.$from.parent.type.spec.code,r=e.dom.parentNode.appendChild(document.createElement(n?"textarea":"div"));n||(r.contentEditable="true"),r.style.cssText="position: fixed; left: -10000px; top: 10px",r.focus();let i=e.input.shiftKey&&45!=e.input.lastKeyCode;setTimeout(()=>{e.focus(),r.parentNode&&r.parentNode.removeChild(r),n?hQ(e,r.value,null,i,t):hQ(e,r.textContent,r.innerHTML,i,t)},50)}(e,t)};class h1{constructor(e,t,n){this.slice=e,this.move=t,this.node=n}}let h2=uN?"altKey":"ctrlKey";function h4(e,t){let n=e.someProp("dragCopies",e=>!e(t));return null!=n?n:!t[h2]}for(let e in hI.dragstart=(e,t)=>{let n,r=e.input.mouseDown;if(r&&r.done(),!t.dataTransfer)return;let i=e.state.selection,s=i.empty?null:e.posAtCoords(hB(t));if(s&&s.pos>=i.from&&s.pos<=(i instanceof dU?i.to-1:i.to));else if(r&&r.mightDrag)n=dU.create(e.state.doc,r.mightDrag.pos);else if(t.target&&1==t.target.nodeType){let r=e.docView.nearestDesc(t.target,!0);r&&r.node.type.spec.draggable&&r!=e.docView&&(n=dU.create(e.state.doc,r.posBefore))}let o=(n||e.state.selection).content(),{dom:a,text:l,slice:c}=hS(e,o);t.dataTransfer.files.length&&ub&&!(uw>120)||t.dataTransfer.clearData(),t.dataTransfer.setData(hZ?"Text":"text/html",a.innerHTML),t.dataTransfer.effectAllowed="copyMove",hZ||t.dataTransfer.setData("text/plain",l),e.dragging=new h1(c,h4(e,t),n)},hI.dragend=e=>{let t=e.dragging;window.setTimeout(()=>{e.dragging==t&&(e.dragging=null)},50)},hL.dragover=hL.dragenter=(e,t)=>t.preventDefault(),hL.drop=(e,t)=>{let n=e.dragging;if(e.dragging=null,!t.dataTransfer)return;let r=e.posAtCoords(hB(t));if(!r)return;let i=e.state.doc.resolve(r.pos),s=n&&n.slice;s?e.someProp("transformPasted",t=>{s=t(s,e)}):s=hC(e,h0(t.dataTransfer),hZ?null:t.dataTransfer.getData("text/html"),!1,i);let o=!!(n&&h4(e,t));if(e.someProp("handleDrop",n=>n(e,t,s||cw.empty,o)))return void t.preventDefault();if(!s)return;t.preventDefault();let a=s?dC(e.state.doc,i.pos,s):i.pos;null==a&&(a=i.pos);let l=e.state.tr;if(o){let{node:e}=n;e?e.replace(l):l.deleteSelection()}let c=l.mapping.map(a),d=0==s.openStart&&0==s.openEnd&&1==s.content.childCount,u=l.doc;if(d?l.replaceRangeWith(c,c,s.content.firstChild):l.replaceRange(c,c,s),l.doc.eq(u))return;let h=l.doc.resolve(c);if(d&&dU.isSelectable(s.content.firstChild)&&h.nodeAfter&&h.nodeAfter.sameMarkup(s.content.firstChild))l.setSelection(new dU(h));else{let t=l.mapping.map(a);l.mapping.maps[l.mapping.maps.length-1].forEach((e,n,r,i)=>t=i),l.setSelection(hd(e,h,l.doc.resolve(t)))}e.focus(),e.dispatch(l.setMeta("uiEvent","drop"))},hI.focus=e=>{e.input.lastFocus=Date.now(),e.focused||(e.domObserver.stop(),e.dom.classList.add("ProseMirror-focused"),e.domObserver.start(),e.focused=!0,setTimeout(()=>{e.docView&&e.hasFocus()&&!e.domObserver.currentSelection.eq(e.domSelectionRange())&&hr(e)},20))},hI.blur=(e,t)=>{e.focused&&(e.domObserver.stop(),e.dom.classList.remove("ProseMirror-focused"),e.domObserver.start(),t.relatedTarget&&e.dom.contains(t.relatedTarget)&&e.domObserver.currentSelection.clear(),e.focused=!1)},hI.beforeinput=(e,t)=>{if(ub&&uC&&"deleteContentBackward"==t.inputType){e.domObserver.flushSoon();let{domChangeCount:t}=e.input;setTimeout(()=>{if(e.input.domChangeCount!=t||(e.dom.blur(),e.focus(),e.someProp("handleKeyDown",t=>t(e,uc(8,"Backspace")))))return;let{$cursor:n}=e.state.selection;n&&n.pos>0&&e.dispatch(e.state.tr.delete(n.pos-1,n.pos).scrollIntoView())},50)}},hL)hI[e]=hL[e];function h3(e,t){if(e==t)return!0;for(let n in e)if(e[n]!==t[n])return!1;for(let n in t)if(!(n in e))return!1;return!0}class h5{constructor(e,t){this.toDOM=e,this.spec=t||pe,this.side=this.spec.side||0}map(e,t,n,r){let{pos:i,deleted:s}=e.mapResult(t.from+r,this.side<0?-1:1);return s?null:new h9(i-n,i-n,this)}valid(){return!0}eq(e){return this==e||e instanceof h5&&(this.spec.key&&this.spec.key==e.spec.key||this.toDOM==e.toDOM&&h3(this.spec,e.spec))}destroy(e){this.spec.destroy&&this.spec.destroy(e)}}class h6{constructor(e,t){this.attrs=e,this.spec=t||pe}map(e,t,n,r){let i=e.map(t.from+r,this.spec.inclusiveStart?-1:1)-n,s=e.map(t.to+r,this.spec.inclusiveEnd?1:-1)-n;return i>=s?null:new h9(i,s,this)}valid(e,t){return t.from<t.to}eq(e){return this==e||e instanceof h6&&h3(this.attrs,e.attrs)&&h3(this.spec,e.spec)}static is(e){return e.type instanceof h6}destroy(){}}class h8{constructor(e,t){this.attrs=e,this.spec=t||pe}map(e,t,n,r){let i=e.mapResult(t.from+r,1);if(i.deleted)return null;let s=e.mapResult(t.to+r,-1);return s.deleted||s.pos<=i.pos?null:new h9(i.pos-n,s.pos-n,this)}valid(e,t){let{index:n,offset:r}=e.content.findIndex(t.from),i;return r==t.from&&!(i=e.child(n)).isText&&r+i.nodeSize==t.to}eq(e){return this==e||e instanceof h8&&h3(this.attrs,e.attrs)&&h3(this.spec,e.spec)}destroy(){}}class h9{constructor(e,t,n){this.from=e,this.to=t,this.type=n}copy(e,t){return new h9(e,t,this.type)}eq(e,t=0){return this.type.eq(e.type)&&this.from+t==e.from&&this.to+t==e.to}map(e,t,n){return this.type.map(e,this,t,n)}static widget(e,t,n){return new h9(e,e,new h5(t,n))}static inline(e,t,n,r){return new h9(e,t,new h6(n,r))}static node(e,t,n,r){return new h9(e,t,new h8(n,r))}get spec(){return this.type.spec}get inline(){return this.type instanceof h6}get widget(){return this.type instanceof h5}}let h7=[],pe={};class pt{constructor(e,t){this.local=e.length?e:h7,this.children=t.length?t:h7}static create(e,t){return t.length?pa(t,e,0,pe):pn}find(e,t,n){let r=[];return this.findInner(null==e?0:e,null==t?1e9:t,r,0,n),r}findInner(e,t,n,r,i){for(let s=0;s<this.local.length;s++){let o=this.local[s];o.from<=t&&o.to>=e&&(!i||i(o.spec))&&n.push(o.copy(o.from+r,o.to+r))}for(let s=0;s<this.children.length;s+=3)if(this.children[s]<t&&this.children[s+1]>e){let o=this.children[s]+1;this.children[s+2].findInner(e-o,t-o,n,r+o,i)}}map(e,t,n){return this==pn||0==e.maps.length?this:this.mapInner(e,t,0,0,n||pe)}mapInner(e,t,n,r,i){let s;for(let o=0;o<this.local.length;o++){let a=this.local[o].map(e,n,r);a&&a.type.valid(t,a)?(s||(s=[])).push(a):i.onRemove&&i.onRemove(this.local[o].spec)}return this.children.length?function(e,t,n,r,i,s,o){let a=e.slice();for(let e=0,t=s;e<n.maps.length;e++){let r=0;n.maps[e].forEach((e,n,i,s)=>{let o=s-i-(n-e);for(let i=0;i<a.length;i+=3){let s=a[i+1];if(s<0||e>s+t-r)continue;let l=a[i]+t-r;n>=l?a[i+1]=e<=l?-2:-1:e>=t&&o&&(a[i]+=o,a[i+1]+=o)}r+=o}),t=n.maps[e].map(t,-1)}let l=!1;for(let t=0;t<a.length;t+=3)if(a[t+1]<0){if(-2==a[t+1]){l=!0,a[t+1]=-1;continue}let c=n.map(e[t]+s),d=c-i;if(d<0||d>=r.content.size){l=!0;continue}let u=n.map(e[t+1]+s,-1)-i,{index:h,offset:p}=r.content.findIndex(d),f=r.maybeChild(h);if(f&&p==d&&p+f.nodeSize==u){let r=a[t+2].mapInner(n,f,c+1,e[t]+s+1,o);r!=pn?(a[t]=d,a[t+1]=u,a[t+2]=r):(a[t+1]=-2,l=!0)}else l=!0}if(l){let l=pa(function(e,t,n,r,i,s,o){for(let a=0;a<e.length;a+=3)-1==e[a+1]&&function e(t,s){for(let e=0;e<t.local.length;e++){let a=t.local[e].map(r,i,s);a?n.push(a):o.onRemove&&o.onRemove(t.local[e].spec)}for(let n=0;n<t.children.length;n+=3)e(t.children[n+2],t.children[n]+s+1)}(e[a+2],t[a]+s+1);return n}(a,e,t,n,i,s,o),r,0,o);t=l.local;for(let e=0;e<a.length;e+=3)a[e+1]<0&&(a.splice(e,3),e-=3);for(let e=0,t=0;e<l.children.length;e+=3){let n=l.children[e];for(;t<a.length&&a[t]<n;)t+=3;a.splice(t,0,l.children[e],l.children[e+1],l.children[e+2])}}return new pt(t.sort(pl),a)}(this.children,s||[],e,t,n,r,i):s?new pt(s.sort(pl),h7):pn}add(e,t){return t.length?this==pn?pt.create(e,t):this.addInner(e,t,0):this}addInner(e,t,n){let r,i=0;e.forEach((e,s)=>{let o=s+n,a;if(a=ps(t,e,o)){for(r||(r=this.children.slice());i<r.length&&r[i]<s;)i+=3;r[i]==s?r[i+2]=r[i+2].addInner(e,a,o+1):r.splice(i,0,s,s+e.nodeSize,pa(a,e,o+1,pe)),i+=3}});let s=pi(i?po(t):t,-n);for(let t=0;t<s.length;t++)s[t].type.valid(e,s[t])||s.splice(t--,1);return new pt(s.length?this.local.concat(s).sort(pl):this.local,r||this.children)}remove(e){return 0==e.length||this==pn?this:this.removeInner(e,0)}removeInner(e,t){let n=this.children,r=this.local;for(let r=0;r<n.length;r+=3){let i,s=n[r]+t,o=n[r+1]+t;for(let t=0,n;t<e.length;t++)(n=e[t])&&n.from>s&&n.to<o&&(e[t]=null,(i||(i=[])).push(n));if(!i)continue;n==this.children&&(n=this.children.slice());let a=n[r+2].removeInner(i,s+1);a!=pn?n[r+2]=a:(n.splice(r,3),r-=3)}if(r.length){for(let n=0,i;n<e.length;n++)if(i=e[n])for(let e=0;e<r.length;e++)r[e].eq(i,t)&&(r==this.local&&(r=this.local.slice()),r.splice(e--,1))}return n==this.children&&r==this.local?this:r.length||n.length?new pt(r,n):pn}forChild(e,t){let n,r;if(this==pn)return this;if(t.isLeaf)return pt.empty;for(let t=0;t<this.children.length;t+=3)if(this.children[t]>=e){this.children[t]==e&&(n=this.children[t+2]);break}let i=e+1,s=i+t.content.size;for(let e=0;e<this.local.length;e++){let t=this.local[e];if(t.from<s&&t.to>i&&t.type instanceof h6){let e=Math.max(i,t.from)-i,n=Math.min(s,t.to)-i;e<n&&(r||(r=[])).push(t.copy(e,n))}}if(r){let e=new pt(r.sort(pl),h7);return n?new pr([e,n]):e}return n||pn}eq(e){if(this==e)return!0;if(!(e instanceof pt)||this.local.length!=e.local.length||this.children.length!=e.children.length)return!1;for(let t=0;t<this.local.length;t++)if(!this.local[t].eq(e.local[t]))return!1;for(let t=0;t<this.children.length;t+=3)if(this.children[t]!=e.children[t]||this.children[t+1]!=e.children[t+1]||!this.children[t+2].eq(e.children[t+2]))return!1;return!0}locals(e){return pc(this.localsInner(e))}localsInner(e){if(this==pn)return h7;if(e.inlineContent||!this.local.some(h6.is))return this.local;let t=[];for(let e=0;e<this.local.length;e++)this.local[e].type instanceof h6||t.push(this.local[e]);return t}forEachSet(e){e(this)}}pt.empty=new pt([],[]),pt.removeOverlap=pc;let pn=pt.empty;class pr{constructor(e){this.members=e}map(e,t){let n=this.members.map(n=>n.map(e,t,pe));return pr.from(n)}forChild(e,t){if(t.isLeaf)return pt.empty;let n=[];for(let r=0;r<this.members.length;r++){let i=this.members[r].forChild(e,t);i!=pn&&(i instanceof pr?n=n.concat(i.members):n.push(i))}return pr.from(n)}eq(e){if(!(e instanceof pr)||e.members.length!=this.members.length)return!1;for(let t=0;t<this.members.length;t++)if(!this.members[t].eq(e.members[t]))return!1;return!0}locals(e){let t,n=!0;for(let r=0;r<this.members.length;r++){let i=this.members[r].localsInner(e);if(i.length)if(t){n&&(t=t.slice(),n=!1);for(let e=0;e<i.length;e++)t.push(i[e])}else t=i}return t?pc(n?t:t.sort(pl)):h7}static from(e){switch(e.length){case 0:return pn;case 1:return e[0];default:return new pr(e.every(e=>e instanceof pt)?e:e.reduce((e,t)=>e.concat(t instanceof pt?t:t.members),[]))}}forEachSet(e){for(let t=0;t<this.members.length;t++)this.members[t].forEachSet(e)}}function pi(e,t){if(!t||!e.length)return e;let n=[];for(let r=0;r<e.length;r++){let i=e[r];n.push(new h9(i.from+t,i.to+t,i.type))}return n}function ps(e,t,n){if(t.isLeaf)return null;let r=n+t.nodeSize,i=null;for(let t=0,s;t<e.length;t++)(s=e[t])&&s.from>n&&s.to<r&&((i||(i=[])).push(s),e[t]=null);return i}function po(e){let t=[];for(let n=0;n<e.length;n++)null!=e[n]&&t.push(e[n]);return t}function pa(e,t,n,r){let i=[],s=!1;t.forEach((t,o)=>{let a=ps(e,t,o+n);if(a){s=!0;let e=pa(a,t,n+o+1,r);e!=pn&&i.push(o,o+t.nodeSize,e)}});let o=pi(s?po(e):e,-n).sort(pl);for(let e=0;e<o.length;e++)o[e].type.valid(t,o[e])||(r.onRemove&&r.onRemove(o[e].spec),o.splice(e--,1));return o.length||i.length?new pt(o,i):pn}function pl(e,t){return e.from-t.from||e.to-t.to}function pc(e){let t=e;for(let n=0;n<t.length-1;n++){let r=t[n];if(r.from!=r.to)for(let i=n+1;i<t.length;i++){let s=t[i];if(s.from==r.from){s.to!=r.to&&(t==e&&(t=e.slice()),t[i]=s.copy(s.from,r.to),pd(t,i+1,s.copy(r.to,s.to)));continue}s.from<r.to&&(t==e&&(t=e.slice()),t[n]=r.copy(r.from,s.from),pd(t,i,r.copy(s.from,r.to)));break}}return t}function pd(e,t,n){for(;t<e.length&&pl(n,e[t])>0;)t++;e.splice(t,0,n)}function pu(e){let t=[];return e.someProp("decorations",n=>{let r=n(e.state);r&&r!=pn&&t.push(r)}),e.cursorWrapper&&t.push(pt.create(e.state.doc,[e.cursorWrapper.deco])),pr.from(t)}let ph={childList:!0,characterData:!0,characterDataOldValue:!0,attributes:!0,attributeOldValue:!0,subtree:!0},pp=ug&&uy<=11;class pf{constructor(){this.anchorNode=null,this.anchorOffset=0,this.focusNode=null,this.focusOffset=0}set(e){this.anchorNode=e.anchorNode,this.anchorOffset=e.anchorOffset,this.focusNode=e.focusNode,this.focusOffset=e.focusOffset}clear(){this.anchorNode=this.focusNode=null}eq(e){return e.anchorNode==this.anchorNode&&e.anchorOffset==this.anchorOffset&&e.focusNode==this.focusNode&&e.focusOffset==this.focusOffset}}class pm{constructor(e,t){this.view=e,this.handleDOMChange=t,this.queue=[],this.flushingSoon=-1,this.observer=null,this.currentSelection=new pf,this.onCharData=null,this.suppressingSelectionUpdates=!1,this.lastChangedTextNode=null,this.observer=window.MutationObserver&&new window.MutationObserver(e=>{for(let t=0;t<e.length;t++)this.queue.push(e[t]);ug&&uy<=11&&e.some(e=>"childList"==e.type&&e.removedNodes.length||"characterData"==e.type&&e.oldValue.length>e.target.nodeValue.length)?this.flushSoon():this.flush()}),pp&&(this.onCharData=e=>{this.queue.push({target:e.target,type:"characterData",oldValue:e.prevValue}),this.flushSoon()}),this.onSelectionChange=this.onSelectionChange.bind(this)}flushSoon(){this.flushingSoon<0&&(this.flushingSoon=window.setTimeout(()=>{this.flushingSoon=-1,this.flush()},20))}forceFlush(){this.flushingSoon>-1&&(window.clearTimeout(this.flushingSoon),this.flushingSoon=-1,this.flush())}start(){this.observer&&(this.observer.takeRecords(),this.observer.observe(this.view.dom,ph)),this.onCharData&&this.view.dom.addEventListener("DOMCharacterDataModified",this.onCharData),this.connectSelection()}stop(){if(this.observer){let e=this.observer.takeRecords();if(e.length){for(let t=0;t<e.length;t++)this.queue.push(e[t]);window.setTimeout(()=>this.flush(),20)}this.observer.disconnect()}this.onCharData&&this.view.dom.removeEventListener("DOMCharacterDataModified",this.onCharData),this.disconnectSelection()}connectSelection(){this.view.dom.ownerDocument.addEventListener("selectionchange",this.onSelectionChange)}disconnectSelection(){this.view.dom.ownerDocument.removeEventListener("selectionchange",this.onSelectionChange)}suppressSelectionUpdates(){this.suppressingSelectionUpdates=!0,setTimeout(()=>this.suppressingSelectionUpdates=!1,50)}onSelectionChange(){if(hu(this.view)){if(this.suppressingSelectionUpdates)return hr(this.view);if(ug&&uy<=11&&!this.view.state.selection.empty){let e=this.view.domSelectionRange();if(e.focusNode&&ur(e.focusNode,e.focusOffset,e.anchorNode,e.anchorOffset))return this.flushSoon()}this.flush()}}setCurSelection(){this.currentSelection.set(this.view.domSelectionRange())}ignoreSelectionChange(e){if(!e.focusNode)return!0;let t=new Set,n;for(let n=e.focusNode;n;n=d7(n))t.add(n);for(let r=e.anchorNode;r;r=d7(r))if(t.has(r)){n=r;break}let r=n&&this.view.docView.nearestDesc(n);if(r&&r.ignoreMutation({type:"selection",target:3==n.nodeType?n.parentNode:n}))return this.setCurSelection(),!0}pendingRecords(){if(this.observer)for(let e of this.observer.takeRecords())this.queue.push(e);return this.queue}flush(){var e;let{view:t}=this;if(!t.docView||this.flushingSoon>-1)return;let n=this.pendingRecords();n.length&&(this.queue=[]);let r=t.domSelectionRange(),i=!this.suppressingSelectionUpdates&&!this.currentSelection.eq(r)&&hu(t)&&!this.ignoreSelectionChange(r),s=-1,o=-1,a=!1,l=[];if(t.editable)for(let e=0;e<n.length;e++){let t=this.registerMutation(n[e],l);t&&(s=s<0?t.from:Math.min(t.from,s),o=o<0?t.to:Math.max(t.to,o),t.typeOver&&(a=!0))}if(ux&&l.length){let e=l.filter(e=>"BR"==e.nodeName);if(2==e.length){let[t,n]=e;t.parentNode&&t.parentNode.parentNode==n.parentNode?n.remove():t.remove()}else{let{focusNode:n}=this.currentSelection;for(let r of e){let e=r.parentNode;e&&"LI"==e.nodeName&&(!n||function(e,t){for(let n=t.parentNode;n&&n!=e.dom;n=n.parentNode){let t=e.docView.nearestDesc(n,!0);if(t&&t.node.isBlock)return n}return null}(t,n)!=e)&&r.remove()}}}let c=null;s<0&&i&&t.input.lastFocus>Date.now()-200&&Math.max(t.input.lastTouch,t.input.lastClick.time)<Date.now()-300&&ul(r)&&(c=ht(t))&&c.eq(d_.near(t.state.doc.resolve(0),1))?(t.input.lastFocus=0,hr(t),this.currentSelection.set(r),t.scrollToSelection()):(s>-1||i)&&(s>-1&&(t.docView.markDirty(s,o),e=t,!pg.has(e)&&(pg.set(e,null),-1!==["normal","nowrap","pre-line"].indexOf(getComputedStyle(e.dom).whiteSpace))&&(e.requiresGeckoHackNode=ux,py||(console.warn("ProseMirror expects the CSS white-space property to be set, preferably to 'pre-wrap'. It is recommended to load style/prosemirror.css from the prosemirror-view package."),py=!0))),this.handleDOMChange(s,o,a,l),t.docView&&t.docView.dirty?t.updateState(t.state):this.currentSelection.eq(r)||hr(t),this.currentSelection.set(r))}registerMutation(e,t){if(t.indexOf(e.target)>-1)return null;let n=this.view.docView.nearestDesc(e.target);if("attributes"==e.type&&(n==this.view.docView||"contenteditable"==e.attributeName||"style"==e.attributeName&&!e.oldValue&&!e.target.getAttribute("style"))||!n||n.ignoreMutation(e))return null;if("childList"==e.type){for(let n=0;n<e.addedNodes.length;n++){let r=e.addedNodes[n];t.push(r),3==r.nodeType&&(this.lastChangedTextNode=r)}if(n.contentDOM&&n.contentDOM!=n.dom&&!n.contentDOM.contains(e.target))return{from:n.posBefore,to:n.posAfter};let r=e.previousSibling,i=e.nextSibling;if(ug&&uy<=11&&e.addedNodes.length)for(let t=0;t<e.addedNodes.length;t++){let{previousSibling:n,nextSibling:s}=e.addedNodes[t];(!n||0>Array.prototype.indexOf.call(e.addedNodes,n))&&(r=n),(!s||0>Array.prototype.indexOf.call(e.addedNodes,s))&&(i=s)}let s=r&&r.parentNode==e.target?d9(r)+1:0,o=n.localPosFromDOM(e.target,s,-1),a=i&&i.parentNode==e.target?d9(i):e.target.childNodes.length;return{from:o,to:n.localPosFromDOM(e.target,a,1)}}return"attributes"==e.type?{from:n.posAtStart-n.border,to:n.posAtEnd+n.border}:(this.lastChangedTextNode=e.target,{from:n.posAtStart,to:n.posAtEnd,typeOver:e.target.nodeValue==e.oldValue})}}let pg=new WeakMap,py=!1;function px(e,t){let n=t.startContainer,r=t.startOffset,i=t.endContainer,s=t.endOffset,o=e.domAtPos(e.state.selection.anchor);return ur(o.node,o.offset,i,s)&&([n,r,i,s]=[i,s,n,r]),{anchorNode:n,anchorOffset:r,focusNode:i,focusOffset:s}}function pv(e){let t=e.pmViewDesc;if(t)return t.parseRule();if("BR"==e.nodeName&&e.parentNode){if(uk&&/^(ul|ol)$/i.test(e.parentNode.nodeName)){let e=document.createElement("div");return e.appendChild(document.createElement("li")),{skip:e}}else if(e.parentNode.lastChild==e||uk&&/^(tr|table)$/i.test(e.parentNode.nodeName))return{ignore:!0}}else if("IMG"==e.nodeName&&e.getAttribute("mark-placeholder"))return{ignore:!0};return null}let pb=/^(a|abbr|acronym|b|bd[io]|big|br|button|cite|code|data(list)?|del|dfn|em|i|ins|kbd|label|map|mark|meter|output|q|ruby|s|samp|small|span|strong|su[bp]|time|u|tt|var)$/i;function pw(e,t,n){return Math.max(n.anchor,n.head)>t.content.size?null:hd(e,t.resolve(n.anchor),t.resolve(n.head))}function pk(e,t,n){let r=e.depth,i=t?e.end():e.pos;for(;r>0&&(t||e.indexAfter(r)==e.node(r).childCount);)r--,i++,t=!1;if(n){let t=e.node(r).maybeChild(e.indexAfter(r));for(;t&&!t.isLeaf;)t=t.firstChild,i++}return i}function pj(e){if(2!=e.length)return!1;let t=e.charCodeAt(0),n=e.charCodeAt(1);return t>=56320&&t<=57343&&n>=55296&&n<=56319}class pN{constructor(e,t){this._root=null,this.focused=!1,this.trackWrites=null,this.mounted=!1,this.markCursor=null,this.cursorWrapper=null,this.lastSelectedViewDesc=void 0,this.input=new hV,this.prevDirectPlugins=[],this.pluginViews=[],this.requiresGeckoHackNode=!1,this.dragging=null,this._props=t,this.state=t.state,this.directPlugins=t.plugins||[],this.directPlugins.forEach(pT),this.dispatch=this.dispatch.bind(this),this.dom=e&&e.mount||document.createElement("div"),e&&(e.appendChild?e.appendChild(this.dom):"function"==typeof e?e(this.dom):e.mount&&(this.mounted=!0)),this.editable=pM(this),pC(this),this.nodeViews=pE(this),this.docView=uX(this.state.doc,pS(this),pu(this),this.dom,this),this.domObserver=new pm(this,(e,t,n,r)=>(function(e,t,n,r,i){let s,o,a,l,c=e.input.compositionPendingChanges||(e.composing?e.input.compositionID:0);if(e.input.compositionPendingChanges=0,t<0){let t=e.input.lastSelectionTime>Date.now()-50?e.input.lastSelectionOrigin:null,n=ht(e,t);if(n&&!e.state.selection.eq(n)){if(ub&&uC&&13===e.input.lastKeyCode&&Date.now()-100<e.input.lastKeyCodeTime&&e.someProp("handleKeyDown",t=>t(e,uc(13,"Enter"))))return;let r=e.state.tr.setSelection(n);"pointer"==t?r.setMeta("pointer",!0):"key"==t&&r.scrollIntoView(),c&&r.setMeta("composition",c),e.dispatch(r)}return}let d=e.state.doc.resolve(t),u=d.sharedDepth(n);t=d.before(u+1),n=e.state.doc.resolve(n).after(u+1);let h=e.state.selection,p=function(e,t,n){let r,{node:i,fromOffset:s,toOffset:o,from:a,to:l}=e.docView.parseRange(t,n),c=e.domSelectionRange(),d=c.anchorNode;if(d&&e.dom.contains(1==d.nodeType?d:d.parentNode)&&(r=[{node:d,offset:c.anchorOffset}],ul(c)||r.push({node:c.focusNode,offset:c.focusOffset})),ub&&8===e.input.lastKeyCode)for(let e=o;e>s;e--){let t=i.childNodes[e-1],n=t.pmViewDesc;if("BR"==t.nodeName&&!n){o=e;break}if(!n||n.size)break}let u=e.state.doc,h=e.someProp("domParser")||cX.fromSchema(e.state.schema),p=u.resolve(a),f=null,m=h.parse(i,{topNode:p.parent,topMatch:p.parent.contentMatchAt(p.index()),topOpen:!0,from:s,to:o,preserveWhitespace:"pre"!=p.parent.type.whitespace||"full",findPositions:r,ruleFromNode:pv,context:p});if(r&&null!=r[0].pos){let e=r[0].pos,t=r[1]&&r[1].pos;null==t&&(t=e),f={anchor:e+a,head:t+a}}return{doc:m,sel:f,from:a,to:l}}(e,t,n),f=e.state.doc,m=f.slice(p.from,p.to);8===e.input.lastKeyCode&&Date.now()-100<e.input.lastKeyCodeTime?(s=e.state.selection.to,o="end"):(s=e.state.selection.from,o="start"),e.input.lastKeyCode=null;let g=function(e,t,n,r,i){let s=e.findDiffStart(t,n);if(null==s)return null;let{a:o,b:a}=e.findDiffEnd(t,n+e.size,n+t.size);if("end"==i){let e=Math.max(0,s-Math.min(o,a));r-=o+e-s}if(o<s&&e.size<t.size){let e=r<=s&&r>=o?s-r:0;(s-=e)&&s<t.size&&pj(t.textBetween(s-1,s+1))&&(s+=e?1:-1),a=s+(a-o),o=s}else if(a<s){let t=r<=s&&r>=a?s-r:0;(s-=t)&&s<e.size&&pj(e.textBetween(s-1,s+1))&&(s+=t?1:-1),o=s+(o-a),a=s}return{start:s,endA:o,endB:a}}(m.content,p.doc.content,p.from,s,o);if(g&&e.input.domChangeCount++,(uj&&e.input.lastIOSEnter>Date.now()-225||uC)&&i.some(e=>1==e.nodeType&&!pb.test(e.nodeName))&&(!g||g.endA>=g.endB)&&e.someProp("handleKeyDown",t=>t(e,uc(13,"Enter")))){e.input.lastIOSEnter=0;return}if(!g)if(r&&h instanceof dq&&!h.empty&&h.$head.sameParent(h.$anchor)&&!e.composing&&!(p.sel&&p.sel.anchor!=p.sel.head))g={start:h.from,endA:h.to,endB:h.to};else{if(p.sel){let t=pw(e,e.state.doc,p.sel);if(t&&!t.eq(e.state.selection)){let n=e.state.tr.setSelection(t);c&&n.setMeta("composition",c),e.dispatch(n)}}return}e.state.selection.from<e.state.selection.to&&g.start==g.endB&&e.state.selection instanceof dq&&(g.start>e.state.selection.from&&g.start<=e.state.selection.from+2&&e.state.selection.from>=p.from?g.start=e.state.selection.from:g.endA<e.state.selection.to&&g.endA>=e.state.selection.to-2&&e.state.selection.to<=p.to&&(g.endB+=e.state.selection.to-g.endA,g.endA=e.state.selection.to)),ug&&uy<=11&&g.endB==g.start+1&&g.endA==g.start&&g.start>p.from&&" \xa0"==p.doc.textBetween(g.start-p.from-1,g.start-p.from+1)&&(g.start--,g.endA--,g.endB--);let y=p.doc.resolveNoCache(g.start-p.from),x=p.doc.resolveNoCache(g.endB-p.from),v=f.resolve(g.start),b=y.sameParent(x)&&y.parent.inlineContent&&v.end()>=g.endA;if((uj&&e.input.lastIOSEnter>Date.now()-225&&(!b||i.some(e=>"DIV"==e.nodeName||"P"==e.nodeName))||!b&&y.pos<p.doc.content.size&&(!y.sameParent(x)||!y.parent.inlineContent)&&!/\S/.test(p.doc.textBetween(y.pos,x.pos,"",""))&&(a=d_.findFrom(p.doc.resolve(y.pos+1),1,!0))&&a.head>y.pos)&&e.someProp("handleKeyDown",t=>t(e,uc(13,"Enter")))){e.input.lastIOSEnter=0;return}if(e.state.selection.anchor>g.start&&function(e,t,n,r,i){if(n-t<=i.pos-r.pos||pk(r,!0,!1)<i.pos)return!1;let s=e.resolve(t);if(!r.parent.isTextblock){let e=s.nodeAfter;return null!=e&&n==t+e.nodeSize}if(s.parentOffset<s.parent.content.size||!s.parent.isTextblock)return!1;let o=e.resolve(pk(s,!0,!0));return!(!o.parent.isTextblock||o.pos>n||pk(o,!0,!1)<n)&&r.parent.content.cut(r.parentOffset).eq(o.parent.content)}(f,g.start,g.endA,y,x)&&e.someProp("handleKeyDown",t=>t(e,uc(8,"Backspace")))){uC&&ub&&e.domObserver.suppressSelectionUpdates();return}ub&&g.endB==g.start&&(e.input.lastChromeDelete=Date.now()),uC&&!b&&y.start()!=x.start()&&0==x.parentOffset&&y.depth==x.depth&&p.sel&&p.sel.anchor==p.sel.head&&p.sel.head==g.endA&&(g.endB-=2,x=p.doc.resolveNoCache(g.endB-p.from),setTimeout(()=>{e.someProp("handleKeyDown",function(t){return t(e,uc(13,"Enter"))})},20));let w=g.start,k=g.endA,j=t=>{let n=t||e.state.tr.replace(w,k,p.doc.slice(g.start-p.from,g.endB-p.from));if(p.sel){let t=pw(e,n.doc,p.sel);t&&!(ub&&e.composing&&t.empty&&(g.start!=g.endB||e.input.lastChromeDelete<Date.now()-100)&&(t.head==w||t.head==n.mapping.map(k)-1)||ug&&t.empty&&t.head==w)&&n.setSelection(t)}return c&&n.setMeta("composition",c),n.scrollIntoView()};if(b){if(y.pos==x.pos){ug&&uy<=11&&0==y.parentOffset&&(e.domObserver.suppressSelectionUpdates(),setTimeout(()=>hr(e),20));let t=j(e.state.tr.delete(w,k)),n=f.resolve(g.start).marksAcross(f.resolve(g.endA));n&&t.ensureMarks(n),e.dispatch(t)}else if(g.endA==g.endB&&(l=function(e,t){let n=e.firstChild.marks,r=t.firstChild.marks,i=n,s=r,o,a,l;for(let e=0;e<r.length;e++)i=r[e].removeFromSet(i);for(let e=0;e<n.length;e++)s=n[e].removeFromSet(s);if(1==i.length&&0==s.length)a=i[0],o="add",l=e=>e.mark(a.addToSet(e.marks));else{if(0!=i.length||1!=s.length)return null;a=s[0],o="remove",l=e=>e.mark(a.removeFromSet(e.marks))}let c=[];for(let e=0;e<t.childCount;e++)c.push(l(t.child(e)));if(cm.from(c).eq(e))return{mark:a,type:o}}(y.parent.content.cut(y.parentOffset,x.parentOffset),v.parent.content.cut(v.parentOffset,g.endA-v.start())))){let t=j(e.state.tr);"add"==l.type?t.addMark(w,k,l.mark):t.removeMark(w,k,l.mark),e.dispatch(t)}else if(y.parent.child(y.index()).isText&&y.index()==x.index()-!x.textOffset){let t=y.parent.textBetween(y.parentOffset,x.parentOffset),n=()=>j(e.state.tr.insertText(t,w,k));e.someProp("handleTextInput",r=>r(e,w,k,t,n))||e.dispatch(n())}}else e.dispatch(j())})(this,e,t,n,r)),this.domObserver.start(),function(e){for(let t in hI){let n=hI[t];e.dom.addEventListener(t,e.input.eventHandlers[t]=t=>{!function(e,t){if(!t.bubbles)return!0;if(t.defaultPrevented)return!1;for(let n=t.target;n!=e.dom;n=n.parentNode)if(!n||11==n.nodeType||n.pmViewDesc&&n.pmViewDesc.stopEvent(t))return!1;return!0}(e,t)||hF(e,t)||!e.editable&&t.type in hL||n(e,t)},hz[t]?{passive:!0}:void 0)}uk&&e.dom.addEventListener("input",()=>null),h_(e)}(this),this.updatePluginViews()}get composing(){return this.input.composing}get props(){if(this._props.state!=this.state){let e=this._props;for(let t in this._props={},e)this._props[t]=e[t];this._props.state=this.state}return this._props}update(e){e.handleDOMEvents!=this._props.handleDOMEvents&&h_(this);let t=this._props;this._props=e,e.plugins&&(e.plugins.forEach(pT),this.directPlugins=e.plugins),this.updateStateInner(e.state,t)}setProps(e){let t={};for(let e in this._props)t[e]=this._props[e];for(let n in t.state=this.state,e)t[n]=e[n];this.update(t)}updateState(e){this.updateStateInner(e,this._props)}updateStateInner(e,t){var n,r,i;let s=this.state,o=!1,a=!1;e.storedMarks&&this.composing&&(hY(this),a=!0),this.state=e;let l=s.plugins!=e.plugins||this._props.plugins!=t.plugins;if(l||this._props.plugins!=t.plugins||this._props.nodeViews!=t.nodeViews){let e=pE(this);(function(e,t){let n=0,r=0;for(let r in e){if(e[r]!=t[r])return!0;n++}for(let e in t)r++;return n!=r})(e,this.nodeViews)&&(this.nodeViews=e,o=!0)}(l||t.handleDOMEvents!=this._props.handleDOMEvents)&&h_(this),this.editable=pM(this),pC(this);let c=pu(this),d=pS(this),u=s.plugins==e.plugins||s.doc.eq(e.doc)?e.scrollToSelection>s.scrollToSelection?"to selection":"preserve":"reset",h=o||!this.docView.matchesNode(e.doc,d,c);(h||!e.selection.eq(s.selection))&&(a=!0);let p="preserve"==u&&a&&null==this.dom.style.overflowAnchor&&function(e){let t,n,r=e.dom.getBoundingClientRect(),i=Math.max(0,r.top);for(let s=(r.left+r.right)/2,o=i+1;o<Math.min(innerHeight,r.bottom);o+=5){let r=e.root.elementFromPoint(s,o);if(!r||r==e.dom||!e.dom.contains(r))continue;let a=r.getBoundingClientRect();if(a.top>=i-20){t=r,n=a.top;break}}return{refDOM:t,refTop:n,stack:uD(e.dom)}}(this);if(a){let t,n,a;this.domObserver.stop();let l=h&&(ug||ub)&&!this.composing&&!s.selection.empty&&!e.selection.empty&&(r=s.selection,i=e.selection,a=Math.min(r.$anchor.sharedDepth(r.head),i.$anchor.sharedDepth(i.head)),r.$anchor.start(a)!=i.$anchor.start(a));if(h){let t=ub?this.trackWrites=this.domSelectionRange().focusNode:null;this.composing&&(this.input.compositionNode=function(e){let t=e.domSelectionRange();if(!t.focusNode)return null;let n=function(e,t){for(;;){if(3==e.nodeType&&t)return e;if(1==e.nodeType&&t>0){if("false"==e.contentEditable)return null;t=uo(e=e.childNodes[t-1])}else{if(!e.parentNode||ua(e))return null;t=d9(e),e=e.parentNode}}}(t.focusNode,t.focusOffset),r=function(e,t){for(;;){if(3==e.nodeType&&t<e.nodeValue.length)return e;if(1==e.nodeType&&t<e.childNodes.length){if("false"==e.contentEditable)return null;e=e.childNodes[t],t=0}else{if(!e.parentNode||ua(e))return null;t=d9(e)+1,e=e.parentNode}}}(t.focusNode,t.focusOffset);if(n&&r&&n!=r){let t=r.pmViewDesc,i=e.domObserver.lastChangedTextNode;if(n==i||r==i)return i;if(!t||!t.isText(r.nodeValue))return r;if(e.input.compositionNode==r){let e=n.pmViewDesc;if(!(!e||!e.isText(n.nodeValue)))return r}}return n||r}(this)),(o||!this.docView.update(e.doc,d,c,this))&&(this.docView.updateOuterDeco(d),this.docView.destroy(),this.docView=uX(e.doc,d,c,this.dom,this)),t&&!this.trackWrites&&(l=!0)}l||!(this.input.mouseDown&&this.domObserver.currentSelection.eq(this.domSelectionRange())&&(t=this.docView.domFromPos(this.state.selection.anchor,0),n=this.domSelectionRange(),ur(t.node,t.offset,n.anchorNode,n.anchorOffset)))?hr(this,l):(hl(this,e.selection),this.domObserver.setCurSelection()),this.domObserver.start()}this.updatePluginViews(s),(null==(n=this.dragging)?void 0:n.node)&&!s.doc.eq(e.doc)&&this.updateDraggedNode(this.dragging,s),"reset"==u?this.dom.scrollTop=0:"to selection"==u?this.scrollToSelection():p&&function({refDOM:e,refTop:t,stack:n}){let r=e?e.getBoundingClientRect().top:0;uO(n,0==r?0:r-t)}(p)}scrollToSelection(){let e=this.domSelectionRange().focusNode;if(e&&this.dom.contains(1==e.nodeType?e:e.parentNode))if(this.someProp("handleScrollToSelection",e=>e(this)));else if(this.state.selection instanceof dU){let t=this.docView.domAfterPos(this.state.selection.from);1==t.nodeType&&uA(this,t.getBoundingClientRect(),e)}else uA(this,this.coordsAtPos(this.state.selection.head,1),e)}destroyPluginViews(){let e;for(;e=this.pluginViews.pop();)e.destroy&&e.destroy()}updatePluginViews(e){if(e&&e.plugins==this.state.plugins&&this.directPlugins==this.prevDirectPlugins)for(let t=0;t<this.pluginViews.length;t++){let n=this.pluginViews[t];n.update&&n.update(this,e)}else{this.prevDirectPlugins=this.directPlugins,this.destroyPluginViews();for(let e=0;e<this.directPlugins.length;e++){let t=this.directPlugins[e];t.spec.view&&this.pluginViews.push(t.spec.view(this))}for(let e=0;e<this.state.plugins.length;e++){let t=this.state.plugins[e];t.spec.view&&this.pluginViews.push(t.spec.view(this))}}}updateDraggedNode(e,t){let n=e.node,r=-1;if(this.state.doc.nodeAt(n.from)==n.node)r=n.from;else{let e=n.from+(this.state.doc.content.size-t.doc.content.size);(e>0&&this.state.doc.nodeAt(e))==n.node&&(r=e)}this.dragging=new h1(e.slice,e.move,r<0?void 0:dU.create(this.state.doc,r))}someProp(e,t){let n=this._props&&this._props[e],r;if(null!=n&&(r=t?t(n):n))return r;for(let n=0;n<this.directPlugins.length;n++){let i=this.directPlugins[n].props[e];if(null!=i&&(r=t?t(i):i))return r}let i=this.state.plugins;if(i)for(let n=0;n<i.length;n++){let s=i[n].props[e];if(null!=s&&(r=t?t(s):s))return r}}hasFocus(){if(ug){let e=this.root.activeElement;if(e==this.dom)return!0;if(!e||!this.dom.contains(e))return!1;for(;e&&this.dom!=e&&this.dom.contains(e);){if("false"==e.contentEditable)return!1;e=e.parentElement}return!0}return this.root.activeElement==this.dom}focus(){this.domObserver.stop(),this.editable&&function(e){if(e.setActive)return e.setActive();if(uR)return e.focus(uR);let t=uD(e);e.focus(null==uR?{get preventScroll(){return uR={preventScroll:!0},!0}}:void 0),uR||(uR=!1,uO(t,0))}(this.dom),hr(this),this.domObserver.start()}get root(){let e=this._root;if(null==e){for(let e=this.dom.parentNode;e;e=e.parentNode)if(9==e.nodeType||11==e.nodeType&&e.host)return e.getSelection||(Object.getPrototypeOf(e).getSelection=()=>e.ownerDocument.getSelection()),this._root=e}return e||document}updateRoot(){this._root=null}posAtCoords(e){return function(e,t){var n;let r,i,s=e.dom.ownerDocument,o,a=0,l=function(e,t,n){if(e.caretPositionFromPoint)try{let r=e.caretPositionFromPoint(t,n);if(r)return{node:r.offsetNode,offset:Math.min(uo(r.offsetNode),r.offset)}}catch(e){}if(e.caretRangeFromPoint){let r=e.caretRangeFromPoint(t,n);if(r)return{node:r.startContainer,offset:Math.min(uo(r.startContainer),r.startOffset)}}}(s,t.left,t.top);l&&({node:o,offset:a}=l);let c=(e.root.elementFromPoint?e.root:s).elementFromPoint(t.left,t.top);if(!c||!e.dom.contains(1!=c.nodeType?c.parentNode:c)){let n=e.dom.getBoundingClientRect();if(!uP(t,n)||!(c=function e(t,n,r){let i=t.childNodes.length;if(i&&r.top<r.bottom)for(let s=Math.max(0,Math.min(i-1,Math.floor(i*(n.top-r.top)/(r.bottom-r.top))-2)),o=s;;){let r=t.childNodes[o];if(1==r.nodeType){let t=r.getClientRects();for(let i=0;i<t.length;i++){let s=t[i];if(uP(n,s))return e(r,n,s)}}if((o=(o+1)%i)==s)break}return t}(e.dom,t,n)))return null}if(uk)for(let e=c;o&&e;e=d7(e))e.draggable&&(o=void 0);if(c=(r=(n=c).parentNode)&&/^li$/i.test(r.nodeName)&&t.left<n.getBoundingClientRect().left?r:n,o){let n;if(ux&&1==o.nodeType&&(a=Math.min(a,o.childNodes.length))<o.childNodes.length){let e=o.childNodes[a],n;"IMG"==e.nodeName&&(n=e.getBoundingClientRect()).right<=t.left&&n.bottom>t.top&&a++}uM&&a&&1==o.nodeType&&1==(n=o.childNodes[a-1]).nodeType&&"false"==n.contentEditable&&n.getBoundingClientRect().top>=t.top&&a--,o==e.dom&&a==o.childNodes.length-1&&1==o.lastChild.nodeType&&t.top>o.lastChild.getBoundingClientRect().bottom?i=e.state.doc.content.size:(0==a||1!=o.nodeType||"BR"!=o.childNodes[a-1].nodeName)&&(i=function(e,t,n,r){let i=-1;for(let n=t,s=!1;n!=e.dom;){let t=e.docView.nearestDesc(n,!0),o;if(!t)return null;if(1==t.dom.nodeType&&(t.node.isBlock&&t.parent||!t.contentDOM)&&((o=t.dom.getBoundingClientRect()).width||o.height)&&(t.node.isBlock&&t.parent&&(!s&&o.left>r.left||o.top>r.top?i=t.posBefore:(!s&&o.right<r.left||o.bottom<r.top)&&(i=t.posAfter),s=!0),!t.contentDOM&&i<0&&!t.node.isText))return(t.node.isBlock?r.top<(o.top+o.bottom)/2:r.left<(o.left+o.right)/2)?t.posBefore:t.posAfter;n=t.dom.parentNode}return i>-1?i:e.docView.posFromDOM(t,n,-1)}(e,o,a,t))}null==i&&(i=function(e,t,n){let{node:r,offset:i}=function e(t,n){let r,i,s,o=2e8,a,l=0,c=n.top,d=n.top;for(let e=t.firstChild,u=0;e;e=e.nextSibling,u++){let t;if(1==e.nodeType)t=e.getClientRects();else{if(3!=e.nodeType)continue;t=ut(e).getClientRects()}for(let h=0;h<t.length;h++){let p=t[h];if(p.top<=c&&p.bottom>=d){c=Math.max(p.bottom,c),d=Math.min(p.top,d);let t=p.left>n.left?p.left-n.left:p.right<n.left?n.left-p.right:0;if(t<o){s=e,o=t,a=t&&3==s.nodeType?{left:p.right<n.left?p.right:p.left,top:n.top}:n,1==e.nodeType&&t&&(l=u+ +(n.left>=(p.left+p.right)/2));continue}}else p.top>n.top&&!r&&p.left<=n.left&&p.right>=n.left&&(r=e,i={left:Math.max(p.left,Math.min(p.right,n.left)),top:p.top});!s&&(n.left>=p.right&&n.top>=p.top||n.left>=p.left&&n.top>=p.bottom)&&(l=u+1)}}return(!s&&r&&(s=r,a=i,o=0),s&&3==s.nodeType)?function(e,t){let n=e.nodeValue.length,r=document.createRange();for(let i=0;i<n;i++){r.setEnd(e,i+1),r.setStart(e,i);let n=uL(r,1);if(n.top!=n.bottom&&uP(t,n))return{node:e,offset:i+ +(t.left>=(n.left+n.right)/2)}}return{node:e,offset:0}}(s,a):!s||o&&1==s.nodeType?{node:t,offset:l}:e(s,a)}(t,n),s=-1;if(1==r.nodeType&&!r.firstChild){let e=r.getBoundingClientRect();s=e.left!=e.right&&n.left>(e.left+e.right)/2?1:-1}return e.docView.posFromDOM(r,i,s)}(e,c,t));let d=e.docView.nearestDesc(c,!0);return{pos:i,inside:d?d.posAtStart-d.border:-1}}(this,e)}coordsAtPos(e,t=1){return uV(this,e,t)}domAtPos(e,t=0){return this.docView.domFromPos(e,t)}nodeDOM(e){let t=this.docView.descAt(e);return t?t.nodeDOM:null}posAtDOM(e,t,n=-1){let r=this.docView.posFromDOM(e,t,n);if(null==r)throw RangeError("DOM position not inside the editor");return r}endOfTextblock(e,t){return function(e,t,n){let r,i;return uW==t&&uq==n?uH:(uW=t,uq=n,uH="up"==n||"down"==n?(r=t.selection,i="up"==n?r.$from:r.$to,uF(e,t,()=>{let{node:t}=e.docView.domFromPos(i.pos,"up"==n?-1:1);for(;;){let n=e.docView.nearestDesc(t,!0);if(!n)break;if(n.node.isBlock){t=n.contentDOM||n.dom;break}t=n.dom.parentNode}let r=uV(e,i.pos,1);for(let e=t.firstChild;e;e=e.nextSibling){let t;if(1==e.nodeType)t=e.getClientRects();else{if(3!=e.nodeType)continue;t=ut(e,0,e.nodeValue.length).getClientRects()}for(let e=0;e<t.length;e++){let i=t[e];if(i.bottom>i.top+1&&("up"==n?r.top-i.top>(i.bottom-r.top)*2:i.bottom-r.bottom>(r.bottom-i.top)*2))return!1}}return!0})):function(e,t,n){let{$head:r}=t.selection;if(!r.parent.isTextblock)return!1;let i=r.parentOffset,s=i==r.parent.content.size,o=e.domSelection();return o?uB.test(r.parent.textContent)&&o.modify?uF(e,t,()=>{let{focusNode:t,focusOffset:i,anchorNode:s,anchorOffset:a}=e.domSelectionRange(),l=o.caretBidiLevel;o.modify("move",n,"character");let c=r.depth?e.docView.domAfterPos(r.before()):e.dom,{focusNode:d,focusOffset:u}=e.domSelectionRange(),h=d&&!c.contains(1==d.nodeType?d:d.parentNode)||t==d&&i==u;try{o.collapse(s,a),t&&(t!=s||i!=a)&&o.extend&&o.extend(t,i)}catch(e){}return null!=l&&(o.caretBidiLevel=l),h}):"left"==n||"backward"==n?!i:s:r.pos==r.start()||r.pos==r.end()}(e,t,n))}(this,t||this.state,e)}pasteHTML(e,t){return hQ(this,"",e,!1,t||new ClipboardEvent("paste"))}pasteText(e,t){return hQ(this,e,null,!0,t||new ClipboardEvent("paste"))}serializeForClipboard(e){return hS(this,e)}destroy(){if(this.docView){for(let e in this.domObserver.stop(),this.input.eventHandlers)this.dom.removeEventListener(e,this.input.eventHandlers[e]);clearTimeout(this.input.composingTimeout),clearTimeout(this.input.lastIOSEnterFallbackTimeout),this.destroyPluginViews(),this.mounted?(this.docView.update(this.state.doc,[],pu(this),this),this.dom.textContent=""):this.dom.parentNode&&this.dom.parentNode.removeChild(this.dom),this.docView.destroy(),this.docView=null,un()}}get isDestroyed(){return null==this.docView}dispatchEvent(e){!hF(this,e)&&hI[e.type]&&(this.editable||!(e.type in hL))&&hI[e.type](this,e)}domSelectionRange(){let e=this.domSelection();return e?uk&&11===this.root.nodeType&&function(e){let t=e.activeElement;for(;t&&t.shadowRoot;)t=t.shadowRoot.activeElement;return t}(this.dom.ownerDocument)==this.dom&&function(e,t){let n;if(t.getComposedRanges){let n=t.getComposedRanges(e.root)[0];if(n)return px(e,n)}function r(e){e.preventDefault(),e.stopImmediatePropagation(),n=e.getTargetRanges()[0]}return e.dom.addEventListener("beforeinput",r,!0),document.execCommand("indent"),e.dom.removeEventListener("beforeinput",r,!0),n?px(e,n):null}(this,e)||e:{focusNode:null,focusOffset:0,anchorNode:null,anchorOffset:0}}domSelection(){return this.root.getSelection()}}function pS(e){let t=Object.create(null);return t.class="ProseMirror",t.contenteditable=String(e.editable),e.someProp("attributes",n=>{if("function"==typeof n&&(n=n(e.state)),n)for(let e in n)"class"==e?t.class+=" "+n[e]:"style"==e?t.style=(t.style?t.style+";":"")+n[e]:t[e]||"contenteditable"==e||"nodeName"==e||(t[e]=String(n[e]))}),t.translate||(t.translate="no"),[h9.node(0,e.state.doc.content.size,t)]}function pC(e){if(e.markCursor){let t=document.createElement("img");t.className="ProseMirror-separator",t.setAttribute("mark-placeholder","true"),t.setAttribute("alt",""),e.cursorWrapper={dom:t,deco:h9.widget(e.state.selection.from,t,{raw:!0,marks:e.markCursor})}}else e.cursorWrapper=null}function pM(e){return!e.someProp("editable",t=>!1===t(e.state))}function pE(e){let t=Object.create(null);function n(e){for(let n in e)Object.prototype.hasOwnProperty.call(t,n)||(t[n]=e[n])}return e.someProp("nodeViews",n),e.someProp("markViews",n),t}function pT(e){if(e.spec.state||e.spec.filterTransaction||e.spec.appendTransaction)throw RangeError("Plugins passed directly to the view must not have a state component")}pN.prototype.dispatch=function(e){let t=this._props.dispatchTransaction;t?t.call(this,e):this.updateState(this.state.apply(e))};for(var pA={8:"Backspace",9:"Tab",10:"Enter",12:"NumLock",13:"Enter",16:"Shift",17:"Control",18:"Alt",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",44:"PrintScreen",45:"Insert",46:"Delete",59:";",61:"=",91:"Meta",92:"Meta",106:"*",107:"+",108:",",109:"-",110:".",111:"/",144:"NumLock",145:"ScrollLock",160:"Shift",161:"Shift",162:"Control",163:"Control",164:"Alt",165:"Alt",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},pD={48:")",49:"!",50:"@",51:"#",52:"$",53:"%",54:"^",55:"&",56:"*",57:"(",59:":",61:"+",173:"_",186:":",187:"+",188:"<",189:"_",190:">",191:"?",192:"~",219:"{",220:"|",221:"}",222:'"'},pO="undefined"!=typeof navigator&&/Mac/.test(navigator.platform),pR="undefined"!=typeof navigator&&/MSIE \d|Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(navigator.userAgent),pP=0;pP<10;pP++)pA[48+pP]=pA[96+pP]=String(pP);for(var pP=1;pP<=24;pP++)pA[pP+111]="F"+pP;for(var pP=65;pP<=90;pP++)pA[pP]=String.fromCharCode(pP+32),pD[pP]=String.fromCharCode(pP);for(var pI in pA)pD.hasOwnProperty(pI)||(pD[pI]=pA[pI]);let pL="undefined"!=typeof navigator&&/Mac|iP(hone|[oa]d)/.test(navigator.platform),pz="undefined"!=typeof navigator&&/Win/.test(navigator.platform);function pV(e,t,n=!0){return t.altKey&&(e="Alt-"+e),t.ctrlKey&&(e="Ctrl-"+e),t.metaKey&&(e="Meta-"+e),n&&t.shiftKey&&(e="Shift-"+e),e}function p$(e){let t=function(e){let t=Object.create(null);for(let n in e)t[function(e){let t,n,r,i,s=e.split(/-(?!$)/),o=s[s.length-1];"Space"==o&&(o=" ");for(let e=0;e<s.length-1;e++){let o=s[e];if(/^(cmd|meta|m)$/i.test(o))i=!0;else if(/^a(lt)?$/i.test(o))t=!0;else if(/^(c|ctrl|control)$/i.test(o))n=!0;else if(/^s(hift)?$/i.test(o))r=!0;else if(/^mod$/i.test(o))pL?i=!0:n=!0;else throw Error("Unrecognized modifier name: "+o)}return t&&(o="Alt-"+o),n&&(o="Ctrl-"+o),i&&(o="Meta-"+o),r&&(o="Shift-"+o),o}(n)]=e[n];return t}(e);return function(e,n){var r;let i=("Esc"==(r=!(pO&&n.metaKey&&n.shiftKey&&!n.ctrlKey&&!n.altKey||pR&&n.shiftKey&&n.key&&1==n.key.length||"Unidentified"==n.key)&&n.key||(n.shiftKey?pD:pA)[n.keyCode]||n.key||"Unidentified")&&(r="Escape"),"Del"==r&&(r="Delete"),"Left"==r&&(r="ArrowLeft"),"Up"==r&&(r="ArrowUp"),"Right"==r&&(r="ArrowRight"),"Down"==r&&(r="ArrowDown"),r),s,o=t[pV(i,n)];if(o&&o(e.state,e.dispatch,e))return!0;if(1==i.length&&" "!=i){if(n.shiftKey){let r=t[pV(i,n,!1)];if(r&&r(e.state,e.dispatch,e))return!0}if((n.altKey||n.metaKey||n.ctrlKey)&&!(pz&&n.ctrlKey&&n.altKey)&&(s=pA[n.keyCode])&&s!=i){let r=t[pV(s,n)];if(r&&r(e.state,e.dispatch,e))return!0}}return!1}}let p_=(e,t)=>!e.selection.empty&&(t&&t(e.tr.deleteSelection().scrollIntoView()),!0);function pF(e,t){let{$cursor:n}=e.selection;return n&&(t?t.endOfTextblock("backward",e):!(n.parentOffset>0))?n:null}let pB=(e,t,n)=>{let r=pF(e,n);if(!r)return!1;let i=pJ(r);if(!i){let n=r.blockRange(),i=n&&dy(n);return null!=i&&(t&&t(e.tr.lift(n,i).scrollIntoView()),!0)}let s=i.nodeBefore;if(p9(e,i,t,-1))return!0;if(0==r.parent.content.size&&(pU(s,"end")||dU.isSelectable(s)))for(let n=r.depth;;n--){let o=dM(e.doc,r.before(n),r.after(n),cw.empty);if(o&&o.slice.size<o.to-o.from){if(t){let n=e.tr.step(o);n.setSelection(pU(s,"end")?d_.findFrom(n.doc.resolve(n.mapping.map(i.pos,-1)),-1):dU.create(n.doc,i.pos-s.nodeSize)),t(n.scrollIntoView())}return!0}if(1==n||r.node(n-1).childCount>1)break}return!!s.isAtom&&i.depth==r.depth-1&&(t&&t(e.tr.delete(i.pos-s.nodeSize,i.pos).scrollIntoView()),!0)},pW=(e,t,n)=>{let r=pF(e,n);if(!r)return!1;let i=pJ(r);return!!i&&pH(e,i,t)},pq=(e,t,n)=>{let r=pG(e,n);if(!r)return!1;let i=pZ(r);return!!i&&pH(e,i,t)};function pH(e,t,n){let r=t.nodeBefore,i=t.pos-1;for(;!r.isTextblock;i--){if(r.type.spec.isolating)return!1;let e=r.lastChild;if(!e)return!1;r=e}let s=t.nodeAfter,o=t.pos+1;for(;!s.isTextblock;o++){if(s.type.spec.isolating)return!1;let e=s.firstChild;if(!e)return!1;s=e}let a=dM(e.doc,i,o,cw.empty);if(!a||a.from!=i||a instanceof dp&&a.slice.size>=o-i)return!1;if(n){let t=e.tr.step(a);t.setSelection(dq.create(t.doc,i)),n(t.scrollIntoView())}return!0}function pU(e,t,n=!1){for(let r=e;r;r="start"==t?r.firstChild:r.lastChild){if(r.isTextblock)return!0;if(n&&1!=r.childCount)break}return!1}let pK=(e,t,n)=>{let{$head:r,empty:i}=e.selection,s=r;if(!i)return!1;if(r.parent.isTextblock){if(n?!n.endOfTextblock("backward",e):r.parentOffset>0)return!1;s=pJ(r)}let o=s&&s.nodeBefore;return!!o&&!!dU.isSelectable(o)&&(t&&t(e.tr.setSelection(dU.create(e.doc,s.pos-o.nodeSize)).scrollIntoView()),!0)};function pJ(e){if(!e.parent.type.spec.isolating)for(let t=e.depth-1;t>=0;t--){if(e.index(t)>0)return e.doc.resolve(e.before(t+1));if(e.node(t).type.spec.isolating)break}return null}function pG(e,t){let{$cursor:n}=e.selection;return n&&(t?t.endOfTextblock("forward",e):!(n.parentOffset<n.parent.content.size))?n:null}let pY=(e,t,n)=>{let r=pG(e,n);if(!r)return!1;let i=pZ(r);if(!i)return!1;let s=i.nodeAfter;if(p9(e,i,t,1))return!0;if(0==r.parent.content.size&&(pU(s,"start")||dU.isSelectable(s))){let n=dM(e.doc,r.before(),r.after(),cw.empty);if(n&&n.slice.size<n.to-n.from){if(t){let r=e.tr.step(n);r.setSelection(pU(s,"start")?d_.findFrom(r.doc.resolve(r.mapping.map(i.pos)),1):dU.create(r.doc,r.mapping.map(i.pos))),t(r.scrollIntoView())}return!0}}return!!s.isAtom&&i.depth==r.depth-1&&(t&&t(e.tr.delete(i.pos,i.pos+s.nodeSize).scrollIntoView()),!0)},pX=(e,t,n)=>{let{$head:r,empty:i}=e.selection,s=r;if(!i)return!1;if(r.parent.isTextblock){if(n?!n.endOfTextblock("forward",e):r.parentOffset<r.parent.content.size)return!1;s=pZ(r)}let o=s&&s.nodeAfter;return!!o&&!!dU.isSelectable(o)&&(t&&t(e.tr.setSelection(dU.create(e.doc,s.pos)).scrollIntoView()),!0)};function pZ(e){if(!e.parent.type.spec.isolating)for(let t=e.depth-1;t>=0;t--){let n=e.node(t);if(e.index(t)+1<n.childCount)return e.doc.resolve(e.after(t+1));if(n.type.spec.isolating)break}return null}let pQ=(e,t)=>{let n=e.selection,r=n instanceof dU,i;if(r){if(n.node.isTextblock||!dj(e.doc,n.from))return!1;i=n.from}else if(null==(i=dS(e.doc,n.from,-1)))return!1;if(t){let n=e.tr.join(i);r&&n.setSelection(dU.create(n.doc,i-e.doc.resolve(i).nodeBefore.nodeSize)),t(n.scrollIntoView())}return!0},p0=(e,t)=>{let n=e.selection,r;if(n instanceof dU){if(n.node.isTextblock||!dj(e.doc,n.to))return!1;r=n.to}else if(null==(r=dS(e.doc,n.to,1)))return!1;return t&&t(e.tr.join(r).scrollIntoView()),!0},p1=(e,t)=>{let{$from:n,$to:r}=e.selection,i=n.blockRange(r),s=i&&dy(i);return null!=s&&(t&&t(e.tr.lift(i,s).scrollIntoView()),!0)},p2=(e,t)=>{let{$head:n,$anchor:r}=e.selection;return!!n.parent.type.spec.code&&!!n.sameParent(r)&&(t&&t(e.tr.insertText("\n").scrollIntoView()),!0)};function p4(e){for(let t=0;t<e.edgeCount;t++){let{type:n}=e.edge(t);if(n.isTextblock&&!n.hasRequiredAttrs())return n}return null}let p3=(e,t)=>{let{$head:n,$anchor:r}=e.selection;if(!n.parent.type.spec.code||!n.sameParent(r))return!1;let i=n.node(-1),s=n.indexAfter(-1),o=p4(i.contentMatchAt(s));if(!o||!i.canReplaceWith(s,s,o))return!1;if(t){let r=n.after(),i=e.tr.replaceWith(r,r,o.createAndFill());i.setSelection(d_.near(i.doc.resolve(r),1)),t(i.scrollIntoView())}return!0},p5=(e,t)=>{let n=e.selection,{$from:r,$to:i}=n;if(n instanceof dJ||r.parent.inlineContent||i.parent.inlineContent)return!1;let s=p4(i.parent.contentMatchAt(i.indexAfter()));if(!s||!s.isTextblock)return!1;if(t){let n=(!r.parentOffset&&i.index()<i.parent.childCount?r:i).pos,o=e.tr.insert(n,s.createAndFill());o.setSelection(dq.create(o.doc,n+1)),t(o.scrollIntoView())}return!0},p6=(e,t)=>{let{$cursor:n}=e.selection;if(!n||n.parent.content.size)return!1;if(n.depth>1&&n.after()!=n.end(-1)){let r=n.before();if(dk(e.doc,r))return t&&t(e.tr.split(r).scrollIntoView()),!0}let r=n.blockRange(),i=r&&dy(r);return null!=i&&(t&&t(e.tr.lift(r,i).scrollIntoView()),!0)},p8=(e,t)=>{let{$from:n,to:r}=e.selection,i,s=n.sharedDepth(r);return 0!=s&&(i=n.before(s),t&&t(e.tr.setSelection(dU.create(e.doc,i))),!0)};function p9(e,t,n,r){let i,s,o,a=t.nodeBefore,l=t.nodeAfter,c,d,u=a.type.spec.isolating||l.type.spec.isolating;if(!u&&(i=t.nodeBefore,s=t.nodeAfter,o=t.index(),i&&s&&i.type.compatibleContent(s.type)&&(!i.content.size&&t.parent.canReplace(o-1,o)?(n&&n(e.tr.delete(t.pos-i.nodeSize,t.pos).scrollIntoView()),!0):!!t.parent.canReplace(o,o+1)&&!!(s.isTextblock||dj(e.doc,t.pos))&&(n&&n(e.tr.join(t.pos).scrollIntoView()),!0))))return!0;let h=!u&&t.parent.canReplace(t.index(),t.index()+1);if(h&&(c=(d=a.contentMatchAt(a.childCount)).findWrapping(l.type))&&d.matchType(c[0]||l.type).validEnd){if(n){let r=t.pos+l.nodeSize,i=cm.empty;for(let e=c.length-1;e>=0;e--)i=cm.from(c[e].create(null,i));i=cm.from(a.copy(i));let s=e.tr.step(new df(t.pos-1,r,t.pos,r,new cw(i,1,0),c.length,!0)),o=s.doc.resolve(r+2*c.length);o.nodeAfter&&o.nodeAfter.type==a.type&&dj(s.doc,o.pos)&&s.join(o.pos),n(s.scrollIntoView())}return!0}let p=l.type.spec.isolating||r>0&&u?null:d_.findFrom(t,1),f=p&&p.$from.blockRange(p.$to),m=f&&dy(f);if(null!=m&&m>=t.depth)return n&&n(e.tr.lift(f,m).scrollIntoView()),!0;if(h&&pU(l,"start",!0)&&pU(a,"end")){let r=a,i=[];for(;i.push(r),!r.isTextblock;)r=r.lastChild;let s=l,o=1;for(;!s.isTextblock;s=s.firstChild)o++;if(r.canReplace(r.childCount,r.childCount,s.content)){if(n){let r=cm.empty;for(let e=i.length-1;e>=0;e--)r=cm.from(i[e].copy(r));n(e.tr.step(new df(t.pos-i.length,t.pos+l.nodeSize,t.pos+o,t.pos+l.nodeSize-o,new cw(r,i.length,0),0,!0)).scrollIntoView())}return!0}}return!1}function p7(e){return function(t,n){let r=t.selection,i=e<0?r.$from:r.$to,s=i.depth;for(;i.node(s).isInline;){if(!s)return!1;s--}return!!i.node(s).isTextblock&&(n&&n(t.tr.setSelection(dq.create(t.doc,e<0?i.start(s):i.end(s)))),!0)}}let fe=p7(-1),ft=p7(1);function fn(e,t=null){return function(n,r){let i=!1;for(let r=0;r<n.selection.ranges.length&&!i;r++){let{$from:{pos:s},$to:{pos:o}}=n.selection.ranges[r];n.doc.nodesBetween(s,o,(r,s)=>{if(i)return!1;if(!(!r.isTextblock||r.hasMarkup(e,t)))if(r.type==e)i=!0;else{let t=n.doc.resolve(s),r=t.index();i=t.parent.canReplaceWith(r,r+1,e)}})}if(!i)return!1;if(r){let i=n.tr;for(let r=0;r<n.selection.ranges.length;r++){let{$from:{pos:s},$to:{pos:o}}=n.selection.ranges[r];i.setBlockType(s,o,e,t)}r(i.scrollIntoView())}return!0}}function fr(...e){return function(t,n,r){for(let i=0;i<e.length;i++)if(e[i](t,n,r))return!0;return!1}}let fi=fr(p_,pB,pK),fs=fr(p_,pY,pX),fo={Enter:fr(p2,p5,p6,(e,t)=>{let{$from:n,$to:r}=e.selection;if(e.selection instanceof dU&&e.selection.node.isBlock)return!!n.parentOffset&&!!dk(e.doc,n.pos)&&(t&&t(e.tr.split(n.pos).scrollIntoView()),!0);if(!n.depth)return!1;let i=[],s,o,a=!1,l=!1;for(let e=n.depth;;e--){if(n.node(e).isBlock){let t;a=n.end(e)==n.pos+(n.depth-e),l=n.start(e)==n.pos-(n.depth-e),o=p4(n.node(e-1).contentMatchAt(n.indexAfter(e-1)));i.unshift(t||(a&&o?{type:o}:null)),s=e;break}if(1==e)return!1;i.unshift(null)}let c=e.tr;(e.selection instanceof dq||e.selection instanceof dJ)&&c.deleteSelection();let d=c.mapping.map(n.pos),u=dk(c.doc,d,i.length,i);if(u||(i[0]=o?{type:o}:null,u=dk(c.doc,d,i.length,i)),!u)return!1;if(c.split(d,i.length,i),!a&&l&&n.node(s).type!=o){let e=c.mapping.map(n.before(s)),t=c.doc.resolve(e);o&&n.node(s-1).canReplaceWith(t.index(),t.index()+1,o)&&c.setNodeMarkup(c.mapping.map(n.before(s)),o)}return t&&t(c.scrollIntoView()),!0}),"Mod-Enter":p3,Backspace:fi,"Mod-Backspace":fi,"Shift-Backspace":fi,Delete:fs,"Mod-Delete":fs,"Mod-a":(e,t)=>(t&&t(e.tr.setSelection(new dJ(e.doc))),!0)},fa={"Ctrl-h":fo.Backspace,"Alt-Backspace":fo["Mod-Backspace"],"Ctrl-d":fo.Delete,"Ctrl-Alt-Backspace":fo["Mod-Delete"],"Alt-Delete":fo["Mod-Delete"],"Alt-d":fo["Mod-Delete"],"Ctrl-a":fe,"Ctrl-e":ft};for(let e in fo)fa[e]=fo[e];"undefined"!=typeof navigator?/Mac|iP(hone|[oa]d)/.test(navigator.platform):"undefined"!=typeof os&&os.platform&&os.platform();let fl=["ol",0],fc=["ul",0],fd=["li",0];function fu(e){let{state:t,transaction:n}=e,{selection:r}=n,{doc:i}=n,{storedMarks:s}=n;return{...t,apply:t.apply.bind(t),applyTransaction:t.applyTransaction.bind(t),plugins:t.plugins,schema:t.schema,reconfigure:t.reconfigure.bind(t),toJSON:t.toJSON.bind(t),get storedMarks(){return s},get selection(){return r},get doc(){return i},get tr(){return r=n.selection,i=n.doc,s=n.storedMarks,n}}}class fh{constructor(e){this.editor=e.editor,this.rawCommands=this.editor.extensionManager.commands,this.customState=e.state}get hasCustomState(){return!!this.customState}get state(){return this.customState||this.editor.state}get commands(){let{rawCommands:e,editor:t,state:n}=this,{view:r}=t,{tr:i}=n,s=this.buildProps(i);return Object.fromEntries(Object.entries(e).map(([e,t])=>[e,(...e)=>{let n=t(...e)(s);return i.getMeta("preventDispatch")||this.hasCustomState||r.dispatch(i),n}]))}get chain(){return()=>this.createChain()}get can(){return()=>this.createCan()}createChain(e,t=!0){let{rawCommands:n,editor:r,state:i}=this,{view:s}=r,o=[],a=!!e,l=e||i.tr,c={...Object.fromEntries(Object.entries(n).map(([e,n])=>[e,(...e)=>{let r=this.buildProps(l,t),i=n(...e)(r);return o.push(i),c}])),run:()=>(a||!t||l.getMeta("preventDispatch")||this.hasCustomState||s.dispatch(l),o.every(e=>!0===e))};return c}createCan(e){let{rawCommands:t,state:n}=this,r=e||n.tr,i=this.buildProps(r,!1);return{...Object.fromEntries(Object.entries(t).map(([e,t])=>[e,(...e)=>t(...e)({...i,dispatch:void 0})])),chain:()=>this.createChain(r,!1)}}buildProps(e,t=!0){let{rawCommands:n,editor:r,state:i}=this,{view:s}=r,o={tr:e,editor:r,view:s,state:fu({state:i,transaction:e}),dispatch:t?()=>void 0:void 0,chain:()=>this.createChain(e,t),can:()=>this.createCan(e),get commands(){return Object.fromEntries(Object.entries(n).map(([e,t])=>[e,(...e)=>t(...e)(o)]))}};return o}}class fp{constructor(){this.callbacks={}}on(e,t){return this.callbacks[e]||(this.callbacks[e]=[]),this.callbacks[e].push(t),this}emit(e,...t){let n=this.callbacks[e];return n&&n.forEach(e=>e.apply(this,t)),this}off(e,t){let n=this.callbacks[e];return n&&(t?this.callbacks[e]=n.filter(e=>e!==t):delete this.callbacks[e]),this}once(e,t){let n=(...r)=>{this.off(e,n),t.apply(this,r)};return this.on(e,n)}removeAllListeners(){this.callbacks={}}}function ff(e,t,n){return void 0===e.config[t]&&e.parent?ff(e.parent,t,n):"function"==typeof e.config[t]?e.config[t].bind({...n,parent:e.parent?ff(e.parent,t,n):null}):e.config[t]}function fm(e){let t=e.filter(e=>"extension"===e.type);return{baseExtensions:t,nodeExtensions:e.filter(e=>"node"===e.type),markExtensions:e.filter(e=>"mark"===e.type)}}function fg(e){let t=[],{nodeExtensions:n,markExtensions:r}=fm(e),i=[...n,...r],s={default:null,rendered:!0,renderHTML:null,parseHTML:null,keepOnSplit:!0,isRequired:!1};return e.forEach(e=>{let n={name:e.name,options:e.options,storage:e.storage,extensions:i},r=ff(e,"addGlobalAttributes",n);r&&r().forEach(e=>{e.types.forEach(n=>{Object.entries(e.attributes).forEach(([e,r])=>{t.push({type:n,name:e,attribute:{...s,...r}})})})})}),i.forEach(e=>{let n={name:e.name,options:e.options,storage:e.storage},r=ff(e,"addAttributes",n);r&&Object.entries(r()).forEach(([n,r])=>{let i={...s,...r};"function"==typeof(null==i?void 0:i.default)&&(i.default=i.default()),(null==i?void 0:i.isRequired)&&(null==i?void 0:i.default)===void 0&&delete i.default,t.push({type:e.name,name:n,attribute:i})})}),t}function fy(e,t){if("string"==typeof e){if(!t.nodes[e])throw Error(`There is no node type named '${e}'. Maybe you forgot to add the extension?`);return t.nodes[e]}return e}function fx(...e){return e.filter(e=>!!e).reduce((e,t)=>{let n={...e};return Object.entries(t).forEach(([e,t])=>{if(!n[e]){n[e]=t;return}if("class"===e){let r=t?String(t).split(" "):[],i=n[e]?n[e].split(" "):[],s=r.filter(e=>!i.includes(e));n[e]=[...i,...s].join(" ")}else if("style"===e){let r=t?t.split(";").map(e=>e.trim()).filter(Boolean):[],i=n[e]?n[e].split(";").map(e=>e.trim()).filter(Boolean):[],s=new Map;i.forEach(e=>{let[t,n]=e.split(":").map(e=>e.trim());s.set(t,n)}),r.forEach(e=>{let[t,n]=e.split(":").map(e=>e.trim());s.set(t,n)}),n[e]=Array.from(s.entries()).map(([e,t])=>`${e}: ${t}`).join("; ")}else n[e]=t}),n},{})}function fv(e,t){return t.filter(t=>t.type===e.type.name).filter(e=>e.attribute.rendered).map(t=>t.attribute.renderHTML?t.attribute.renderHTML(e.attrs)||{}:{[t.name]:e.attrs[t.name]}).reduce((e,t)=>fx(e,t),{})}function fb(e){return"function"==typeof e}function fw(e,t,...n){return fb(e)?t?e.bind(t)(...n):e(...n):e}function fk(e,t){return"style"in e?e:{...e,getAttrs:n=>{let r=e.getAttrs?e.getAttrs(n):e.attrs;if(!1===r)return!1;let i=t.reduce((e,t)=>{var r;let i=t.attribute.parseHTML?t.attribute.parseHTML(n):"string"!=typeof(r=n.getAttribute(t.name))?r:r.match(/^[+-]?(?:\d*\.)?\d+$/)?Number(r):"true"===r||"false"!==r&&r;return null==i?e:{...e,[t.name]:i}},{});return{...r,...i}}}}function fj(e){return Object.fromEntries(Object.entries(e).filter(([e,t])=>!("attrs"===e&&function(e={}){return 0===Object.keys(e).length&&e.constructor===Object}(t))&&null!=t))}function fN(e,t){var n;let r=fg(e),{nodeExtensions:i,markExtensions:s}=fm(e),o=null==(n=i.find(e=>ff(e,"topNode")))?void 0:n.name;return new cG({topNode:o,nodes:Object.fromEntries(i.map(n=>{let i=r.filter(e=>e.type===n.name),s={name:n.name,options:n.options,storage:n.storage,editor:t},o=fj({...e.reduce((e,t)=>{let r=ff(t,"extendNodeSchema",s);return{...e,...r?r(n):{}}},{}),content:fw(ff(n,"content",s)),marks:fw(ff(n,"marks",s)),group:fw(ff(n,"group",s)),inline:fw(ff(n,"inline",s)),atom:fw(ff(n,"atom",s)),selectable:fw(ff(n,"selectable",s)),draggable:fw(ff(n,"draggable",s)),code:fw(ff(n,"code",s)),whitespace:fw(ff(n,"whitespace",s)),linebreakReplacement:fw(ff(n,"linebreakReplacement",s)),defining:fw(ff(n,"defining",s)),isolating:fw(ff(n,"isolating",s)),attrs:Object.fromEntries(i.map(e=>{var t;return[e.name,{default:null==(t=null==e?void 0:e.attribute)?void 0:t.default}]}))}),a=fw(ff(n,"parseHTML",s));a&&(o.parseDOM=a.map(e=>fk(e,i)));let l=ff(n,"renderHTML",s);l&&(o.toDOM=e=>l({node:e,HTMLAttributes:fv(e,i)}));let c=ff(n,"renderText",s);return c&&(o.toText=c),[n.name,o]})),marks:Object.fromEntries(s.map(n=>{let i=r.filter(e=>e.type===n.name),s={name:n.name,options:n.options,storage:n.storage,editor:t},o=fj({...e.reduce((e,t)=>{let r=ff(t,"extendMarkSchema",s);return{...e,...r?r(n):{}}},{}),inclusive:fw(ff(n,"inclusive",s)),excludes:fw(ff(n,"excludes",s)),group:fw(ff(n,"group",s)),spanning:fw(ff(n,"spanning",s)),code:fw(ff(n,"code",s)),attrs:Object.fromEntries(i.map(e=>{var t;return[e.name,{default:null==(t=null==e?void 0:e.attribute)?void 0:t.default}]}))}),a=fw(ff(n,"parseHTML",s));a&&(o.parseDOM=a.map(e=>fk(e,i)));let l=ff(n,"renderHTML",s);return l&&(o.toDOM=e=>l({mark:e,HTMLAttributes:fv(e,i)})),[n.name,o]}))})}function fS(e,t){return t.nodes[e]||t.marks[e]||null}function fC(e,t){return Array.isArray(t)?t.some(t=>("string"==typeof t?t:t.name)===e.name):t}function fM(e,t){let n=c6.fromSchema(t).serializeFragment(e),r=document.implementation.createHTMLDocument().createElement("div");return r.appendChild(n),r.innerHTML}let fE=(e,t=500)=>{let n="",r=e.parentOffset;return e.parent.nodesBetween(Math.max(0,r-t),r,(e,t,i,s)=>{var o,a;let l=(null==(a=(o=e.type.spec).toText)?void 0:a.call(o,{node:e,pos:t,parent:i,index:s}))||e.textContent||"%leaf%";n+=e.isAtom&&!e.isText?l:l.slice(0,Math.max(0,r-t))}),n};function fT(e){return"[object RegExp]"===Object.prototype.toString.call(e)}class fA{constructor(e){this.find=e.find,this.handler=e.handler}}let fD=(e,t)=>{if(fT(t))return t.exec(e);let n=t(e);if(!n)return null;let r=[n.text];return r.index=n.index,r.input=e,r.data=n.data,n.replaceWith&&(n.text.includes(n.replaceWith)||console.warn('[tiptap warn]: "inputRuleMatch.replaceWith" must be part of "inputRuleMatch.text".'),r.push(n.replaceWith)),r};function fO(e){var t;let{editor:n,from:r,to:i,text:s,rules:o,plugin:a}=e,{view:l}=n;if(l.composing)return!1;let c=l.state.doc.resolve(r);if(c.parent.type.spec.code||(null==(t=c.nodeBefore||c.nodeAfter)?void 0:t.marks.find(e=>e.type.spec.code)))return!1;let d=!1,u=fE(c)+s;return o.forEach(e=>{if(d)return;let t=fD(u,e.find);if(!t)return;let o=l.state.tr,c=fu({state:l.state,transaction:o}),h={from:r-(t[0].length-s.length),to:i},{commands:p,chain:f,can:m}=new fh({editor:n,state:c});null!==e.handler({state:c,range:h,match:t,commands:p,chain:f,can:m})&&o.steps.length&&(o.setMeta(a,{transform:o,from:r,to:i,text:s}),l.dispatch(o),d=!0)}),d}function fR(e){return"Object"===Object.prototype.toString.call(e).slice(8,-1)&&e.constructor===Object&&Object.getPrototypeOf(e)===Object.prototype}function fP(e,t){let n={...e};return fR(e)&&fR(t)&&Object.keys(t).forEach(r=>{fR(t[r])&&fR(e[r])?n[r]=fP(e[r],t[r]):n[r]=t[r]}),n}class fI{constructor(e={}){this.type="mark",this.name="mark",this.parent=null,this.child=null,this.config={name:this.name,defaultOptions:{}},this.config={...this.config,...e},this.name=this.config.name,e.defaultOptions&&Object.keys(e.defaultOptions).length>0&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${this.name}".`),this.options=this.config.defaultOptions,this.config.addOptions&&(this.options=fw(ff(this,"addOptions",{name:this.name}))),this.storage=fw(ff(this,"addStorage",{name:this.name,options:this.options}))||{}}static create(e={}){return new fI(e)}configure(e={}){let t=this.extend({...this.config,addOptions:()=>fP(this.options,e)});return t.name=this.name,t.parent=this.parent,t}extend(e={}){let t=new fI(e);return t.parent=this,this.child=t,t.name=e.name?e.name:t.parent.name,e.defaultOptions&&Object.keys(e.defaultOptions).length>0&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${t.name}".`),t.options=fw(ff(t,"addOptions",{name:t.name})),t.storage=fw(ff(t,"addStorage",{name:t.name,options:t.options})),t}static handleExit({editor:e,mark:t}){let{tr:n}=e.state,r=e.state.selection.$from;if(r.pos===r.end()){let i=r.marks();if(!i.find(e=>(null==e?void 0:e.type.name)===t.name))return!1;let s=i.find(e=>(null==e?void 0:e.type.name)===t.name);return s&&n.removeStoredMark(s),n.insertText(" ",r.pos),e.view.dispatch(n),!0}return!1}}class fL{constructor(e){this.find=e.find,this.handler=e.handler}}let fz=(e,t,n)=>{if(fT(t))return[...e.matchAll(t)];let r=t(e,n);return r?r.map(t=>{let n=[t.text];return n.index=t.index,n.input=e,n.data=t.data,t.replaceWith&&(t.text.includes(t.replaceWith)||console.warn('[tiptap warn]: "pasteRuleMatch.replaceWith" must be part of "pasteRuleMatch.text".'),n.push(t.replaceWith)),n}):[]},fV=null,f$=e=>{var t;let n=new ClipboardEvent("paste",{clipboardData:new DataTransfer});return null==(t=n.clipboardData)||t.setData("text/html",e),n};class f_{constructor(e,t){this.splittableMarks=[],this.editor=t,this.extensions=f_.resolve(e),this.schema=fN(this.extensions,t),this.setupExtensions()}static resolve(e){var t;let n=f_.sort(f_.flatten(e)),r=Array.from(new Set((t=n.map(e=>e.name)).filter((e,n)=>t.indexOf(e)!==n)));return r.length&&console.warn(`[tiptap warn]: Duplicate extension names found: [${r.map(e=>`'${e}'`).join(", ")}]. This can lead to issues.`),n}static flatten(e){return e.map(e=>{let t={name:e.name,options:e.options,storage:e.storage},n=ff(e,"addExtensions",t);return n?[e,...this.flatten(n())]:e}).flat(10)}static sort(e){return e.sort((e,t)=>{let n=ff(e,"priority")||100,r=ff(t,"priority")||100;return n>r?-1:+(n<r)})}get commands(){return this.extensions.reduce((e,t)=>{let n={name:t.name,options:t.options,storage:t.storage,editor:this.editor,type:fS(t.name,this.schema)},r=ff(t,"addCommands",n);return r?{...e,...r()}:e},{})}get plugins(){let{editor:e}=this,t=f_.sort([...this.extensions].reverse()),n=[],r=[],i=t.map(t=>{let i={name:t.name,options:t.options,storage:t.storage,editor:e,type:fS(t.name,this.schema)},s=[],o=ff(t,"addKeyboardShortcuts",i),a={};if("mark"===t.type&&ff(t,"exitable",i)&&(a.ArrowRight=()=>fI.handleExit({editor:e,mark:t})),o){let t=Object.fromEntries(Object.entries(o()).map(([t,n])=>[t,()=>n({editor:e})]));a={...a,...t}}let l=new d3({props:{handleKeyDown:p$(a)}});s.push(l);let c=ff(t,"addInputRules",i);fC(t,e.options.enableInputRules)&&c&&n.push(...c());let d=ff(t,"addPasteRules",i);fC(t,e.options.enablePasteRules)&&d&&r.push(...d());let u=ff(t,"addProseMirrorPlugins",i);if(u){let e=u();s.push(...e)}return s}).flat();return[function(e){let{editor:t,rules:n}=e,r=new d3({state:{init:()=>null,apply(e,i,s){let o=e.getMeta(r);if(o)return o;let a=e.getMeta("applyInputRules");return a&&setTimeout(()=>{let{text:e}=a;"string"==typeof e||(e=fM(cm.from(e),s.schema));let{from:i}=a,o=i+e.length;fO({editor:t,from:i,to:o,text:e,rules:n,plugin:r})}),e.selectionSet||e.docChanged?null:i}},props:{handleTextInput:(e,i,s,o)=>fO({editor:t,from:i,to:s,text:o,rules:n,plugin:r}),handleDOMEvents:{compositionend:e=>(setTimeout(()=>{let{$cursor:i}=e.state.selection;i&&fO({editor:t,from:i.pos,to:i.pos,text:"",rules:n,plugin:r})}),!1)},handleKeyDown(e,i){if("Enter"!==i.key)return!1;let{$cursor:s}=e.state.selection;return!!s&&fO({editor:t,from:s.pos,to:s.pos,text:"\n",rules:n,plugin:r})}},isInputRules:!0});return r}({editor:e,rules:n}),...function(e){let t,{editor:n,rules:r}=e,i=null,s=!1,o=!1,a="undefined"!=typeof ClipboardEvent?new ClipboardEvent("paste"):null;try{t="undefined"!=typeof DragEvent?new DragEvent("drop"):null}catch{t=null}let l=({state:e,from:r,to:i,rule:s,pasteEvt:o})=>{let l=e.tr;if(function(e){let{editor:t,state:n,from:r,to:i,rule:s,pasteEvent:o,dropEvent:a}=e,{commands:l,chain:c,can:d}=new fh({editor:t,state:n}),u=[];return n.doc.nodesBetween(r,i,(e,t)=>{if(!e.isTextblock||e.type.spec.code)return;let h=Math.max(r,t),p=Math.min(i,t+e.content.size);fz(e.textBetween(h-t,p-t,void 0,""),s.find,o).forEach(e=>{if(void 0===e.index)return;let t=h+e.index+1,r=t+e[0].length,i={from:n.tr.mapping.map(t),to:n.tr.mapping.map(r)},p=s.handler({state:n,range:i,match:e,commands:l,chain:c,can:d,pasteEvent:o,dropEvent:a});u.push(p)})}),u.every(e=>null!==e)}({editor:n,state:fu({state:e,transaction:l}),from:Math.max(r-1,0),to:i.b-1,rule:s,pasteEvent:o,dropEvent:t})&&l.steps.length){try{t="undefined"!=typeof DragEvent?new DragEvent("drop"):null}catch{t=null}return a="undefined"!=typeof ClipboardEvent?new ClipboardEvent("paste"):null,l}};return r.map(e=>new d3({view(e){let t=t=>{var r;(i=(null==(r=e.dom.parentElement)?void 0:r.contains(t.target))?e.dom.parentElement:null)&&(fV=n)},r=()=>{fV&&(fV=null)};return window.addEventListener("dragstart",t),window.addEventListener("dragend",r),{destroy(){window.removeEventListener("dragstart",t),window.removeEventListener("dragend",r)}}},props:{handleDOMEvents:{drop:(e,n)=>{if(o=i===e.dom.parentElement,t=n,!o){let e=fV;(null==e?void 0:e.isEditable)&&setTimeout(()=>{let t=e.state.selection;t&&e.commands.deleteRange({from:t.from,to:t.to})},10)}return!1},paste:(e,t)=>{var n;let r=null==(n=t.clipboardData)?void 0:n.getData("text/html");return a=t,s=!!(null==r?void 0:r.includes("data-pm-slice")),!1}}},appendTransaction:(t,n,r)=>{let i=t[0],c="paste"===i.getMeta("uiEvent")&&!s,d="drop"===i.getMeta("uiEvent")&&!o,u=i.getMeta("applyPasteRules"),h=!!u;if(!c&&!d&&!h)return;if(h){let{text:t}=u;"string"==typeof t||(t=fM(cm.from(t),r.schema));let{from:n}=u,i=n+t.length;return l({rule:e,state:r,from:n,to:{b:i},pasteEvt:f$(t)})}let p=n.doc.content.findDiffStart(r.doc.content),f=n.doc.content.findDiffEnd(r.doc.content);if("number"==typeof p&&f&&p!==f.b)return l({rule:e,state:r,from:p,to:f,pasteEvt:a})}}))}({editor:e,rules:r}),...i]}get attributes(){return fg(this.extensions)}get nodeViews(){let{editor:e}=this,{nodeExtensions:t}=fm(this.extensions);return Object.fromEntries(t.filter(e=>!!ff(e,"addNodeView")).map(t=>{let n=this.attributes.filter(e=>e.type===t.name),r={name:t.name,options:t.options,storage:t.storage,editor:e,type:fy(t.name,this.schema)},i=ff(t,"addNodeView",r);return i?[t.name,(r,s,o,a,l)=>{let c=fv(r,n);return i()({node:r,view:s,getPos:o,decorations:a,innerDecorations:l,editor:e,extension:t,HTMLAttributes:c})}]:[]}))}setupExtensions(){this.extensions.forEach(e=>{var t;this.editor.extensionStorage[e.name]=e.storage;let n={name:e.name,options:e.options,storage:e.storage,editor:this.editor,type:fS(e.name,this.schema)};"mark"===e.type&&(null==(t=fw(ff(e,"keepOnSplit",n)))||t)&&this.splittableMarks.push(e.name);let r=ff(e,"onBeforeCreate",n),i=ff(e,"onCreate",n),s=ff(e,"onUpdate",n),o=ff(e,"onSelectionUpdate",n),a=ff(e,"onTransaction",n),l=ff(e,"onFocus",n),c=ff(e,"onBlur",n),d=ff(e,"onDestroy",n);r&&this.editor.on("beforeCreate",r),i&&this.editor.on("create",i),s&&this.editor.on("update",s),o&&this.editor.on("selectionUpdate",o),a&&this.editor.on("transaction",a),l&&this.editor.on("focus",l),c&&this.editor.on("blur",c),d&&this.editor.on("destroy",d)})}}class fF{constructor(e={}){this.type="extension",this.name="extension",this.parent=null,this.child=null,this.config={name:this.name,defaultOptions:{}},this.config={...this.config,...e},this.name=this.config.name,e.defaultOptions&&Object.keys(e.defaultOptions).length>0&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${this.name}".`),this.options=this.config.defaultOptions,this.config.addOptions&&(this.options=fw(ff(this,"addOptions",{name:this.name}))),this.storage=fw(ff(this,"addStorage",{name:this.name,options:this.options}))||{}}static create(e={}){return new fF(e)}configure(e={}){let t=this.extend({...this.config,addOptions:()=>fP(this.options,e)});return t.name=this.name,t.parent=this.parent,t}extend(e={}){let t=new fF({...this.config,...e});return t.parent=this,this.child=t,t.name=e.name?e.name:t.parent.name,e.defaultOptions&&Object.keys(e.defaultOptions).length>0&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${t.name}".`),t.options=fw(ff(t,"addOptions",{name:t.name})),t.storage=fw(ff(t,"addStorage",{name:t.name,options:t.options})),t}}function fB(e,t,n){let{from:r,to:i}=t,{blockSeparator:s="\n\n",textSerializers:o={}}=n||{},a="";return e.nodesBetween(r,i,(e,n,l,c)=>{var d;e.isBlock&&n>r&&(a+=s);let u=null==o?void 0:o[e.type.name];if(u)return l&&(a+=u({node:e,pos:n,parent:l,index:c,range:t})),!1;e.isText&&(a+=null==(d=null==e?void 0:e.text)?void 0:d.slice(Math.max(r,n)-n,i-n))}),a}function fW(e){return Object.fromEntries(Object.entries(e.nodes).filter(([,e])=>e.spec.toText).map(([e,t])=>[e,t.spec.toText]))}let fq=fF.create({name:"clipboardTextSerializer",addOptions:()=>({blockSeparator:void 0}),addProseMirrorPlugins(){return[new d3({key:new d8("clipboardTextSerializer"),props:{clipboardTextSerializer:()=>{let{editor:e}=this,{state:t,schema:n}=e,{doc:r,selection:i}=t,{ranges:s}=i,o=Math.min(...s.map(e=>e.$from.pos)),a=Math.max(...s.map(e=>e.$to.pos)),l=fW(n);return fB(r,{from:o,to:a},{...void 0!==this.options.blockSeparator?{blockSeparator:this.options.blockSeparator}:{},textSerializers:l})}}})]}});function fH(e,t,n={strict:!0}){let r=Object.keys(t);return!r.length||r.every(r=>n.strict?t[r]===e[r]:fT(t[r])?t[r].test(e[r]):t[r]===e[r])}function fU(e,t,n={}){return e.find(e=>e.type===t&&fH(Object.fromEntries(Object.keys(n).map(t=>[t,e.attrs[t]])),n))}function fK(e,t,n={}){return!!fU(e,t,n)}function fJ(e,t,n){var r;if(!e||!t)return;let i=e.parent.childAfter(e.parentOffset);if(i.node&&i.node.marks.some(e=>e.type===t)||(i=e.parent.childBefore(e.parentOffset)),!i.node||!i.node.marks.some(e=>e.type===t)||(n=n||(null==(r=i.node.marks[0])?void 0:r.attrs),!fU([...i.node.marks],t,n)))return;let s=i.index,o=e.start()+i.offset,a=s+1,l=o+i.node.nodeSize;for(;s>0&&fK([...e.parent.child(s-1).marks],t,n);)s-=1,o-=e.parent.child(s).nodeSize;for(;a<e.parent.childCount&&fK([...e.parent.child(a).marks],t,n);)l+=e.parent.child(a).nodeSize,a+=1;return{from:o,to:l}}function fG(e,t){if("string"==typeof e){if(!t.marks[e])throw Error(`There is no mark type named '${e}'. Maybe you forgot to add the extension?`);return t.marks[e]}return e}function fY(e){return e instanceof dq}function fX(e=0,t=0,n=0){return Math.min(Math.max(e,t),n)}function fZ(e,t=null){if(!t)return null;let n=d_.atStart(e),r=d_.atEnd(e);if("start"===t||!0===t)return n;if("end"===t)return r;let i=n.from,s=r.to;return"all"===t?dq.create(e,fX(0,i,s),fX(e.content.size,i,s)):dq.create(e,fX(t,i,s),fX(t,i,s))}function fQ(){return["iPad Simulator","iPhone Simulator","iPod Simulator","iPad","iPhone","iPod"].includes(navigator.platform)||navigator.userAgent.includes("Mac")&&"ontouchend"in document}let f0=e=>{let t=e.childNodes;for(let n=t.length-1;n>=0;n-=1){let r=t[n];3===r.nodeType&&r.nodeValue&&/^(\n\s\s|\n)$/.test(r.nodeValue)?e.removeChild(r):1===r.nodeType&&f0(r)}return e};function f1(e){let t=`<body>${e}</body>`;return f0(new window.DOMParser().parseFromString(t,"text/html").body)}function f2(e,t,n){if(e instanceof cP||e instanceof cm)return e;n={slice:!0,parseOptions:{},...n};let r="object"==typeof e&&null!==e,i="string"==typeof e;if(r)try{if(Array.isArray(e)&&e.length>0)return cm.fromArray(e.map(e=>t.nodeFromJSON(e)));let r=t.nodeFromJSON(e);return n.errorOnInvalidContent&&r.check(),r}catch(r){if(n.errorOnInvalidContent)throw Error("[tiptap error]: Invalid JSON content",{cause:r});return console.warn("[tiptap warn]: Invalid content.","Passed value:",e,"Error:",r),f2("",t,n)}if(i){if(n.errorOnInvalidContent){let r=!1,i="",s=new cG({topNode:t.spec.topNode,marks:t.spec.marks,nodes:t.spec.nodes.append({__tiptap__private__unknown__catch__all__node:{content:"inline*",group:"block",parseDOM:[{tag:"*",getAttrs:e=>(r=!0,i="string"==typeof e?e:e.outerHTML,null)}]}})});if(n.slice?cX.fromSchema(s).parseSlice(f1(e),n.parseOptions):cX.fromSchema(s).parse(f1(e),n.parseOptions),n.errorOnInvalidContent&&r)throw Error("[tiptap error]: Invalid HTML content",{cause:Error(`Invalid element found: ${i}`)})}let r=cX.fromSchema(t);return n.slice?r.parseSlice(f1(e),n.parseOptions).content:r.parse(f1(e),n.parseOptions)}return f2("",t,n)}let f4=e=>!("type"in e);function f3(){return"undefined"!=typeof navigator&&/Mac/.test(navigator.platform)}function f5(e,t,n={}){let{from:r,to:i,empty:s}=e.selection,o=t?fy(t,e.schema):null,a=[];e.doc.nodesBetween(r,i,(e,t)=>{if(e.isText)return;let n=Math.max(r,t),s=Math.min(i,t+e.nodeSize);a.push({node:e,from:n,to:s})});let l=i-r,c=a.filter(e=>!o||o.name===e.node.type.name).filter(e=>fH(e.node.attrs,n,{strict:!1}));return s?!!c.length:c.reduce((e,t)=>e+t.to-t.from,0)>=l}function f6(e,t){return t.nodes[e]?"node":t.marks[e]?"mark":null}function f8(e,t){let n="string"==typeof t?[t]:t;return Object.keys(e).reduce((t,r)=>(n.includes(r)||(t[r]=e[r]),t),{})}function f9(e,t,n={},r={}){return f2(e,t,{slice:!1,parseOptions:n,errorOnInvalidContent:r.errorOnInvalidContent})}function f7(e,t){let n=fG(t,e.schema),{from:r,to:i,empty:s}=e.selection,o=[];s?(e.storedMarks&&o.push(...e.storedMarks),o.push(...e.selection.$head.marks())):e.doc.nodesBetween(r,i,e=>{o.push(...e.marks)});let a=o.find(e=>e.type.name===n.name);return a?{...a.attrs}:{}}function me(e){return t=>(function(e,t){for(let n=e.depth;n>0;n-=1){let r=e.node(n);if(t(r))return{pos:n>0?e.before(n):0,start:e.start(n),depth:n,node:r}}})(t.$from,e)}function mt(e,t,n){let r=[];return e===t?n.resolve(e).marks().forEach(t=>{let i=fJ(n.resolve(e),t.type);i&&r.push({mark:t,...i})}):n.nodesBetween(e,t,(e,t)=>{e&&(null==e?void 0:e.nodeSize)!==void 0&&r.push(...e.marks.map(n=>({from:t,to:t+e.nodeSize,mark:n})))}),r}function mn(e,t,n){return Object.fromEntries(Object.entries(n).filter(([n])=>{let r=e.find(e=>e.type===t&&e.name===n);return!!r&&r.attribute.keepOnSplit}))}function mr(e,t,n={}){let{empty:r,ranges:i}=e.selection,s=t?fG(t,e.schema):null;if(r)return!!(e.storedMarks||e.selection.$from.marks()).filter(e=>!s||s.name===e.type.name).find(e=>fH(e.attrs,n,{strict:!1}));let o=0,a=[];if(i.forEach(({$from:t,$to:n})=>{let r=t.pos,i=n.pos;e.doc.nodesBetween(r,i,(e,t)=>{if(!e.isText&&!e.marks.length)return;let n=Math.max(r,t),s=Math.min(i,t+e.nodeSize);o+=s-n,a.push(...e.marks.map(e=>({mark:e,from:n,to:s})))})}),0===o)return!1;let l=a.filter(e=>!s||s.name===e.mark.type.name).filter(e=>fH(e.mark.attrs,n,{strict:!1})).reduce((e,t)=>e+t.to-t.from,0),c=a.filter(e=>!s||e.mark.type!==s&&e.mark.type.excludes(s)).reduce((e,t)=>e+t.to-t.from,0);return(l>0?l+c:l)>=o}function mi(e,t){let{nodeExtensions:n}=fm(t),r=n.find(t=>t.name===e);if(!r)return!1;let i={name:r.name,options:r.options,storage:r.storage},s=fw(ff(r,"group",i));return"string"==typeof s&&s.split(" ").includes("list")}function ms(e,{checkChildren:t=!0,ignoreWhitespace:n=!1}={}){var r;if(n){if("hardBreak"===e.type.name)return!0;if(e.isText)return/^\s*$/m.test(null!=(r=e.text)?r:"")}if(e.isText)return!e.text;if(e.isAtom||e.isLeaf)return!1;if(0===e.content.childCount)return!0;if(t){let r=!0;return e.content.forEach(e=>{!1!==r&&(ms(e,{ignoreWhitespace:n,checkChildren:t})||(r=!1))}),r}return!1}function mo(e,t){let n=e.storedMarks||e.selection.$to.parentOffset&&e.selection.$from.marks();if(n){let r=n.filter(e=>null==t?void 0:t.includes(e.type.name));e.tr.ensureMarks(r)}}let ma=(e,t)=>{let n=me(e=>e.type===t)(e.selection);if(!n)return!0;let r=e.doc.resolve(Math.max(0,n.pos-1)).before(n.depth);if(void 0===r)return!0;let i=e.doc.nodeAt(r);return!(n.node.type===(null==i?void 0:i.type)&&dj(e.doc,n.pos))||(e.join(n.pos),!0)},ml=(e,t)=>{let n=me(e=>e.type===t)(e.selection);if(!n)return!0;let r=e.doc.resolve(n.start).after(n.depth);if(void 0===r)return!0;let i=e.doc.nodeAt(r);return!(n.node.type===(null==i?void 0:i.type)&&dj(e.doc,r))||(e.join(r),!0)};var mc=Object.freeze({__proto__:null,blur:()=>({editor:e,view:t})=>(requestAnimationFrame(()=>{var n;e.isDestroyed||(t.dom.blur(),null==(n=null==window?void 0:window.getSelection())||n.removeAllRanges())}),!0),clearContent:(e=!1)=>({commands:t})=>t.setContent("",e),clearNodes:()=>({state:e,tr:t,dispatch:n})=>{let{selection:r}=t,{ranges:i}=r;return!n||(i.forEach(({$from:n,$to:r})=>{e.doc.nodesBetween(n.pos,r.pos,(e,n)=>{if(e.type.isText)return;let{doc:r,mapping:i}=t,s=r.resolve(i.map(n)),o=r.resolve(i.map(n+e.nodeSize)),a=s.blockRange(o);if(!a)return;let l=dy(a);if(e.type.isTextblock){let{defaultType:e}=s.parent.contentMatchAt(s.index());t.setNodeMarkup(a.start,e)}(l||0===l)&&t.lift(a,l)})}),!0)},command:e=>t=>e(t),createParagraphNear:()=>({state:e,dispatch:t})=>p5(e,t),cut:(e,t)=>({editor:n,tr:r})=>{let{state:i}=n,s=i.doc.slice(e.from,e.to);r.deleteRange(e.from,e.to);let o=r.mapping.map(t);return r.insert(o,s.content),r.setSelection(new dq(r.doc.resolve(o-1))),!0},deleteCurrentNode:()=>({tr:e,dispatch:t})=>{let{selection:n}=e,r=n.$anchor.node();if(r.content.size>0)return!1;let i=e.selection.$anchor;for(let n=i.depth;n>0;n-=1)if(i.node(n).type===r.type){if(t){let t=i.before(n),r=i.after(n);e.delete(t,r).scrollIntoView()}return!0}return!1},deleteNode:e=>({tr:t,state:n,dispatch:r})=>{let i=fy(e,n.schema),s=t.selection.$anchor;for(let e=s.depth;e>0;e-=1)if(s.node(e).type===i){if(r){let n=s.before(e),r=s.after(e);t.delete(n,r).scrollIntoView()}return!0}return!1},deleteRange:e=>({tr:t,dispatch:n})=>{let{from:r,to:i}=e;return n&&t.delete(r,i),!0},deleteSelection:()=>({state:e,dispatch:t})=>p_(e,t),enter:()=>({commands:e})=>e.keyboardShortcut("Enter"),exitCode:()=>({state:e,dispatch:t})=>p3(e,t),extendMarkRange:(e,t={})=>({tr:n,state:r,dispatch:i})=>{let s=fG(e,r.schema),{doc:o,selection:a}=n,{$from:l,from:c,to:d}=a;if(i){let e=fJ(l,s,t);if(e&&e.from<=c&&e.to>=d){let t=dq.create(o,e.from,e.to);n.setSelection(t)}}return!0},first:e=>t=>{let n="function"==typeof e?e(t):e;for(let e=0;e<n.length;e+=1)if(n[e](t))return!0;return!1},focus:(e=null,t={})=>({editor:n,view:r,tr:i,dispatch:s})=>{t={scrollIntoView:!0,...t};let o=()=>{(fQ()||"Android"===navigator.platform||/android/i.test(navigator.userAgent))&&r.dom.focus(),requestAnimationFrame(()=>{!n.isDestroyed&&(r.focus(),(null==t?void 0:t.scrollIntoView)&&n.commands.scrollIntoView())})};if(r.hasFocus()&&null===e||!1===e)return!0;if(s&&null===e&&!fY(n.state.selection))return o(),!0;let a=fZ(i.doc,e)||n.state.selection,l=n.state.selection.eq(a);return s&&(l||i.setSelection(a),l&&i.storedMarks&&i.setStoredMarks(i.storedMarks),o()),!0},forEach:(e,t)=>n=>e.every((e,r)=>t(e,{...n,index:r})),insertContent:(e,t)=>({tr:n,commands:r})=>r.insertContentAt({from:n.selection.from,to:n.selection.to},e,t),insertContentAt:(e,t,n)=>({tr:r,dispatch:i,editor:s})=>{var o;if(i){let i,a;n={parseOptions:s.options.parseOptions,updateSelection:!0,applyInputRules:!1,applyPasteRules:!1,...n};let l=e=>{s.emit("contentError",{editor:s,error:e,disableCollaboration:()=>{s.storage.collaboration&&(s.storage.collaboration.isDisabled=!0)}})},c={preserveWhitespace:"full",...n.parseOptions};if(!n.errorOnInvalidContent&&!s.options.enableContentCheck&&s.options.emitContentError)try{f2(t,s.schema,{parseOptions:c,errorOnInvalidContent:!0})}catch(e){l(e)}try{i=f2(t,s.schema,{parseOptions:c,errorOnInvalidContent:null!=(o=n.errorOnInvalidContent)?o:s.options.enableContentCheck})}catch(e){return l(e),!1}let{from:d,to:u}="number"==typeof e?{from:e,to:e}:{from:e.from,to:e.to},h=!0,p=!0;if((f4(i)?i:[i]).forEach(e=>{e.check(),h=!!h&&e.isText&&0===e.marks.length,p=!!p&&e.isBlock}),d===u&&p){let{parent:e}=r.doc.resolve(d);!e.isTextblock||e.type.spec.code||e.childCount||(d-=1,u+=1)}if(h){if(Array.isArray(t))a=t.map(e=>e.text||"").join("");else if(t instanceof cm){let e="";t.forEach(t=>{t.text&&(e+=t.text)}),a=e}else a="object"==typeof t&&t&&t.text?t.text:t;r.insertText(a,d,u)}else a=i,r.replaceWith(d,u,a);n.updateSelection&&function(e,t,n){let r=e.steps.length-1;if(r<t)return;let i=e.steps[r];if(!(i instanceof dp||i instanceof df))return;let s=e.mapping.maps[r],o=0;s.forEach((e,t,n,r)=>{0===o&&(o=r)}),e.setSelection(d_.near(e.doc.resolve(o),-1))}(r,r.steps.length-1,0),n.applyInputRules&&r.setMeta("applyInputRules",{from:d,text:a}),n.applyPasteRules&&r.setMeta("applyPasteRules",{from:d,text:a})}return!0},joinBackward:()=>({state:e,dispatch:t})=>pB(e,t),joinDown:()=>({state:e,dispatch:t})=>p0(e,t),joinForward:()=>({state:e,dispatch:t})=>pY(e,t),joinItemBackward:()=>({state:e,dispatch:t,tr:n})=>{try{let r=dS(e.doc,e.selection.$from.pos,-1);if(null==r)return!1;return n.join(r,2),t&&t(n),!0}catch{return!1}},joinItemForward:()=>({state:e,dispatch:t,tr:n})=>{try{let r=dS(e.doc,e.selection.$from.pos,1);if(null==r)return!1;return n.join(r,2),t&&t(n),!0}catch{return!1}},joinTextblockBackward:()=>({state:e,dispatch:t})=>pW(e,t),joinTextblockForward:()=>({state:e,dispatch:t})=>pq(e,t),joinUp:()=>({state:e,dispatch:t})=>pQ(e,t),keyboardShortcut:e=>({editor:t,view:n,tr:r,dispatch:i})=>{let s=(function(e){let t,n,r,i,s=e.split(/-(?!$)/),o=s[s.length-1];"Space"===o&&(o=" ");for(let e=0;e<s.length-1;e+=1){let o=s[e];if(/^(cmd|meta|m)$/i.test(o))i=!0;else if(/^a(lt)?$/i.test(o))t=!0;else if(/^(c|ctrl|control)$/i.test(o))n=!0;else if(/^s(hift)?$/i.test(o))r=!0;else if(/^mod$/i.test(o))fQ()||f3()?i=!0:n=!0;else throw Error(`Unrecognized modifier name: ${o}`)}return t&&(o=`Alt-${o}`),n&&(o=`Ctrl-${o}`),i&&(o=`Meta-${o}`),r&&(o=`Shift-${o}`),o})(e).split(/-(?!$)/),o=s.find(e=>!["Alt","Ctrl","Meta","Shift"].includes(e)),a=new KeyboardEvent("keydown",{key:"Space"===o?" ":o,altKey:s.includes("Alt"),ctrlKey:s.includes("Ctrl"),metaKey:s.includes("Meta"),shiftKey:s.includes("Shift"),bubbles:!0,cancelable:!0}),l=t.captureTransaction(()=>{n.someProp("handleKeyDown",e=>e(n,a))});return null==l||l.steps.forEach(e=>{let t=e.map(r.mapping);t&&i&&r.maybeStep(t)}),!0},lift:(e,t={})=>({state:n,dispatch:r})=>{let i=fy(e,n.schema);return!!f5(n,i,t)&&p1(n,r)},liftEmptyBlock:()=>({state:e,dispatch:t})=>p6(e,t),liftListItem:e=>({state:t,dispatch:n})=>(function(e){return function(t,n){let{$from:r,$to:i}=t.selection,s=r.blockRange(i,t=>t.childCount>0&&t.firstChild.type==e);return!!s&&(!n||(r.node(s.depth-1).type==e?function(e,t,n,r){let i=e.tr,s=r.end,o=r.$to.end(r.depth);s<o&&(i.step(new df(s-1,o,s,o,new cw(cm.from(n.create(null,r.parent.copy())),1,0),1,!0)),r=new cO(i.doc.resolve(r.$from.pos),i.doc.resolve(o),r.depth));let a=dy(r);if(null==a)return!1;i.lift(r,a);let l=i.doc.resolve(i.mapping.map(s,-1)-1);return dj(i.doc,l.pos)&&l.nodeBefore.type==l.nodeAfter.type&&i.join(l.pos),t(i.scrollIntoView()),!0}(t,n,e,s):function(e,t,n){let r=e.tr,i=n.parent;for(let e=n.end,t=n.endIndex-1,s=n.startIndex;t>s;t--)e-=i.child(t).nodeSize,r.delete(e-1,e+1);let s=r.doc.resolve(n.start),o=s.nodeAfter;if(r.mapping.map(n.end)!=n.start+s.nodeAfter.nodeSize)return!1;let a=0==n.startIndex,l=n.endIndex==i.childCount,c=s.node(-1),d=s.index(-1);if(!c.canReplace(d+ +!a,d+1,o.content.append(l?cm.empty:cm.from(i))))return!1;let u=s.pos,h=u+o.nodeSize;return r.step(new df(u-!!a,h+ +!!l,u+1,h-1,new cw((a?cm.empty:cm.from(i.copy(cm.empty))).append(l?cm.empty:cm.from(i.copy(cm.empty))),+!a,+!l),+!a)),t(r.scrollIntoView()),!0}(t,n,s)))}})(fy(e,t.schema))(t,n),newlineInCode:()=>({state:e,dispatch:t})=>p2(e,t),resetAttributes:(e,t)=>({tr:n,state:r,dispatch:i})=>{let s=null,o=null,a=f6("string"==typeof e?e:e.name,r.schema);return!!a&&("node"===a&&(s=fy(e,r.schema)),"mark"===a&&(o=fG(e,r.schema)),i&&n.selection.ranges.forEach(e=>{r.doc.nodesBetween(e.$from.pos,e.$to.pos,(e,r)=>{s&&s===e.type&&n.setNodeMarkup(r,void 0,f8(e.attrs,t)),o&&e.marks.length&&e.marks.forEach(i=>{o===i.type&&n.addMark(r,r+e.nodeSize,o.create(f8(i.attrs,t)))})})}),!0)},scrollIntoView:()=>({tr:e,dispatch:t})=>(t&&e.scrollIntoView(),!0),selectAll:()=>({tr:e,dispatch:t})=>{if(t){let t=new dJ(e.doc);e.setSelection(t)}return!0},selectNodeBackward:()=>({state:e,dispatch:t})=>pK(e,t),selectNodeForward:()=>({state:e,dispatch:t})=>pX(e,t),selectParentNode:()=>({state:e,dispatch:t})=>p8(e,t),selectTextblockEnd:()=>({state:e,dispatch:t})=>ft(e,t),selectTextblockStart:()=>({state:e,dispatch:t})=>fe(e,t),setContent:(e,t=!1,n={},r={})=>({editor:i,tr:s,dispatch:o,commands:a})=>{var l,c;let{doc:d}=s;if("full"!==n.preserveWhitespace){let a=f9(e,i.schema,n,{errorOnInvalidContent:null!=(l=r.errorOnInvalidContent)?l:i.options.enableContentCheck});return o&&s.replaceWith(0,d.content.size,a).setMeta("preventUpdate",!t),!0}return o&&s.setMeta("preventUpdate",!t),a.insertContentAt({from:0,to:d.content.size},e,{parseOptions:n,errorOnInvalidContent:null!=(c=r.errorOnInvalidContent)?c:i.options.enableContentCheck})},setMark:(e,t={})=>({tr:n,state:r,dispatch:i})=>{let{selection:s}=n,{empty:o,ranges:a}=s,l=fG(e,r.schema);if(i)if(o){let e=f7(r,l);n.addStoredMark(l.create({...e,...t}))}else a.forEach(e=>{let i=e.$from.pos,s=e.$to.pos;r.doc.nodesBetween(i,s,(e,r)=>{let o=Math.max(r,i),a=Math.min(r+e.nodeSize,s);e.marks.find(e=>e.type===l)?e.marks.forEach(e=>{l===e.type&&n.addMark(o,a,l.create({...e.attrs,...t}))}):n.addMark(o,a,l.create(t))})});return function(e,t,n){var r;let{selection:i}=t,s=null;if(fY(i)&&(s=i.$cursor),s){let t=null!=(r=e.storedMarks)?r:s.marks();return!!n.isInSet(t)||!t.some(e=>e.type.excludes(n))}let{ranges:o}=i;return o.some(({$from:t,$to:r})=>{let i=0===t.depth&&e.doc.inlineContent&&e.doc.type.allowsMarkType(n);return e.doc.nodesBetween(t.pos,r.pos,(e,t,r)=>{if(i)return!1;if(e.isInline){let t=!r||r.type.allowsMarkType(n),s=!!n.isInSet(e.marks)||!e.marks.some(e=>e.type.excludes(n));i=t&&s}return!i}),i})}(r,n,l)},setMeta:(e,t)=>({tr:n})=>(n.setMeta(e,t),!0),setNode:(e,t={})=>({state:n,dispatch:r,chain:i})=>{let s,o=fy(e,n.schema);return(n.selection.$anchor.sameParent(n.selection.$head)&&(s=n.selection.$anchor.parent.attrs),o.isTextblock)?i().command(({commands:e})=>!!fn(o,{...s,...t})(n)||e.clearNodes()).command(({state:e})=>fn(o,{...s,...t})(e,r)).run():(console.warn('[tiptap warn]: Currently "setNode()" only supports text block nodes.'),!1)},setNodeSelection:e=>({tr:t,dispatch:n})=>{if(n){let{doc:n}=t,r=fX(e,0,n.content.size),i=dU.create(n,r);t.setSelection(i)}return!0},setTextSelection:e=>({tr:t,dispatch:n})=>{if(n){let{doc:n}=t,{from:r,to:i}="number"==typeof e?{from:e,to:e}:e,s=dq.atStart(n).from,o=dq.atEnd(n).to,a=fX(r,s,o),l=fX(i,s,o),c=dq.create(n,a,l);t.setSelection(c)}return!0},sinkListItem:e=>({state:t,dispatch:n})=>(function(e){return function(t,n){let{$from:r,$to:i}=t.selection,s=r.blockRange(i,t=>t.childCount>0&&t.firstChild.type==e);if(!s)return!1;let o=s.startIndex;if(0==o)return!1;let a=s.parent,l=a.child(o-1);if(l.type!=e)return!1;if(n){let r=l.lastChild&&l.lastChild.type==a.type,i=cm.from(r?e.create():null),o=new cw(cm.from(e.create(null,cm.from(a.type.create(null,i)))),r?3:1,0),c=s.start,d=s.end;n(t.tr.step(new df(c-(r?3:1),d,c,d,o,1,!0)).scrollIntoView())}return!0}})(fy(e,t.schema))(t,n),splitBlock:({keepMarks:e=!0}={})=>({tr:t,state:n,dispatch:r,editor:i})=>{let{selection:s,doc:o}=t,{$from:a,$to:l}=s,c=mn(i.extensionManager.attributes,a.node().type.name,a.node().attrs);if(s instanceof dU&&s.node.isBlock)return!!a.parentOffset&&!!dk(o,a.pos)&&(r&&(e&&mo(n,i.extensionManager.splittableMarks),t.split(a.pos).scrollIntoView()),!0);if(!a.parent.isBlock)return!1;let d=l.parentOffset===l.parent.content.size,u=0===a.depth?void 0:function(e){for(let t=0;t<e.edgeCount;t+=1){let{type:n}=e.edge(t);if(n.isTextblock&&!n.hasRequiredAttrs())return n}return null}(a.node(-1).contentMatchAt(a.indexAfter(-1))),h=d&&u?[{type:u,attrs:c}]:void 0,p=dk(t.doc,t.mapping.map(a.pos),1,h);if(!h&&!p&&dk(t.doc,t.mapping.map(a.pos),1,u?[{type:u}]:void 0)&&(p=!0,h=u?[{type:u,attrs:c}]:void 0),r){if(p&&(s instanceof dq&&t.deleteSelection(),t.split(t.mapping.map(a.pos),1,h),u&&!d&&!a.parentOffset&&a.parent.type!==u)){let e=t.mapping.map(a.before()),n=t.doc.resolve(e);a.node(-1).canReplaceWith(n.index(),n.index()+1,u)&&t.setNodeMarkup(t.mapping.map(a.before()),u)}e&&mo(n,i.extensionManager.splittableMarks),t.scrollIntoView()}return p},splitListItem:(e,t={})=>({tr:n,state:r,dispatch:i,editor:s})=>{var o;let a=fy(e,r.schema),{$from:l,$to:c}=r.selection,d=r.selection.node;if(d&&d.isBlock||l.depth<2||!l.sameParent(c))return!1;let u=l.node(-1);if(u.type!==a)return!1;let h=s.extensionManager.attributes;if(0===l.parent.content.size&&l.node(-1).childCount===l.indexAfter(-1)){if(2===l.depth||l.node(-3).type!==a||l.index(-2)!==l.node(-2).childCount-1)return!1;if(i){let e=cm.empty,r=l.index(-1)?1:l.index(-2)?2:3;for(let t=l.depth-r;t>=l.depth-3;t-=1)e=cm.from(l.node(t).copy(e));let i=l.indexAfter(-1)<l.node(-2).childCount?1:l.indexAfter(-2)<l.node(-3).childCount?2:3,s={...mn(h,l.node().type.name,l.node().attrs),...t},c=(null==(o=a.contentMatch.defaultType)?void 0:o.createAndFill(s))||void 0;e=e.append(cm.from(a.createAndFill(null,c)||void 0));let d=l.before(l.depth-(r-1));n.replace(d,l.after(-i),new cw(e,4-r,0));let u=-1;n.doc.nodesBetween(d,n.doc.content.size,(e,t)=>{if(u>-1)return!1;e.isTextblock&&0===e.content.size&&(u=t+1)}),u>-1&&n.setSelection(dq.near(n.doc.resolve(u))),n.scrollIntoView()}return!0}let p=c.pos===l.end()?u.contentMatchAt(0).defaultType:null,f={...mn(h,u.type.name,u.attrs),...t},m={...mn(h,l.node().type.name,l.node().attrs),...t};n.delete(l.pos,c.pos);let g=p?[{type:a,attrs:f},{type:p,attrs:m}]:[{type:a,attrs:f}];if(!dk(n.doc,l.pos,2))return!1;if(i){let{selection:e,storedMarks:t}=r,{splittableMarks:o}=s.extensionManager,a=t||e.$to.parentOffset&&e.$from.marks();if(n.split(l.pos,2,g).scrollIntoView(),!a||!i)return!0;let c=a.filter(e=>o.includes(e.type.name));n.ensureMarks(c)}return!0},toggleList:(e,t,n,r={})=>({editor:i,tr:s,state:o,dispatch:a,chain:l,commands:c,can:d})=>{let{extensions:u,splittableMarks:h}=i.extensionManager,p=fy(e,o.schema),f=fy(t,o.schema),{selection:m,storedMarks:g}=o,{$from:y,$to:x}=m,v=y.blockRange(x),b=g||m.$to.parentOffset&&m.$from.marks();if(!v)return!1;let w=me(e=>mi(e.type.name,u))(m);if(v.depth>=1&&w&&v.depth-w.depth<=1){if(w.node.type===p)return c.liftListItem(f);if(mi(w.node.type.name,u)&&p.validContent(w.node.content)&&a)return l().command(()=>(s.setNodeMarkup(w.pos,p),!0)).command(()=>ma(s,p)).command(()=>ml(s,p)).run()}return n&&b&&a?l().command(()=>{let e=d().wrapInList(p,r),t=b.filter(e=>h.includes(e.type.name));return s.ensureMarks(t),!!e||c.clearNodes()}).wrapInList(p,r).command(()=>ma(s,p)).command(()=>ml(s,p)).run():l().command(()=>!!d().wrapInList(p,r)||c.clearNodes()).wrapInList(p,r).command(()=>ma(s,p)).command(()=>ml(s,p)).run()},toggleMark:(e,t={},n={})=>({state:r,commands:i})=>{let{extendEmptyMarkRange:s=!1}=n,o=fG(e,r.schema);return mr(r,o,t)?i.unsetMark(o,{extendEmptyMarkRange:s}):i.setMark(o,t)},toggleNode:(e,t,n={})=>({state:r,commands:i})=>{let s,o=fy(e,r.schema),a=fy(t,r.schema),l=f5(r,o,n);return(r.selection.$anchor.sameParent(r.selection.$head)&&(s=r.selection.$anchor.parent.attrs),l)?i.setNode(a,s):i.setNode(o,{...s,...n})},toggleWrap:(e,t={})=>({state:n,commands:r})=>{let i=fy(e,n.schema);return f5(n,i,t)?r.lift(i):r.wrapIn(i,t)},undoInputRule:()=>({state:e,dispatch:t})=>{let n=e.plugins;for(let r=0;r<n.length;r+=1){let i,s=n[r];if(s.spec.isInputRules&&(i=s.getState(e))){if(t){let t=e.tr,n=i.transform;for(let e=n.steps.length-1;e>=0;e-=1)t.step(n.steps[e].invert(n.docs[e]));if(i.text){let n=t.doc.resolve(i.from).marks();t.replaceWith(i.from,i.to,e.schema.text(i.text,n))}else t.delete(i.from,i.to)}return!0}}return!1},unsetAllMarks:()=>({tr:e,dispatch:t})=>{let{selection:n}=e,{empty:r,ranges:i}=n;return!!r||(t&&i.forEach(t=>{e.removeMark(t.$from.pos,t.$to.pos)}),!0)},unsetMark:(e,t={})=>({tr:n,state:r,dispatch:i})=>{var s;let{extendEmptyMarkRange:o=!1}=t,{selection:a}=n,l=fG(e,r.schema),{$from:c,empty:d,ranges:u}=a;if(!i)return!0;if(d&&o){let{from:e,to:t}=a,r=null==(s=c.marks().find(e=>e.type===l))?void 0:s.attrs,i=fJ(c,l,r);i&&(e=i.from,t=i.to),n.removeMark(e,t,l)}else u.forEach(e=>{n.removeMark(e.$from.pos,e.$to.pos,l)});return n.removeStoredMark(l),!0},updateAttributes:(e,t={})=>({tr:n,state:r,dispatch:i})=>{let s=null,o=null,a=f6("string"==typeof e?e:e.name,r.schema);return!!a&&("node"===a&&(s=fy(e,r.schema)),"mark"===a&&(o=fG(e,r.schema)),i&&n.selection.ranges.forEach(e=>{let i,a,l,c,d=e.$from.pos,u=e.$to.pos;n.selection.empty?r.doc.nodesBetween(d,u,(e,t)=>{s&&s===e.type&&(l=Math.max(t,d),c=Math.min(t+e.nodeSize,u),i=t,a=e)}):r.doc.nodesBetween(d,u,(e,r)=>{r<d&&s&&s===e.type&&(l=Math.max(r,d),c=Math.min(r+e.nodeSize,u),i=r,a=e),r>=d&&r<=u&&(s&&s===e.type&&n.setNodeMarkup(r,void 0,{...e.attrs,...t}),o&&e.marks.length&&e.marks.forEach(i=>{if(o===i.type){let s=Math.max(r,d),a=Math.min(r+e.nodeSize,u);n.addMark(s,a,o.create({...i.attrs,...t}))}}))}),a&&(void 0!==i&&n.setNodeMarkup(i,void 0,{...a.attrs,...t}),o&&a.marks.length&&a.marks.forEach(e=>{o===e.type&&n.addMark(l,c,o.create({...e.attrs,...t}))}))}),!0)},wrapIn:(e,t={})=>({state:n,dispatch:r})=>(function(e,t=null){return function(n,r){let{$from:i,$to:s}=n.selection,o=i.blockRange(s),a=o&&dx(o,e,t);return!!a&&(r&&r(n.tr.wrap(o,a).scrollIntoView()),!0)}})(fy(e,n.schema),t)(n,r),wrapInList:(e,t={})=>({state:n,dispatch:r})=>(function(e,t=null){return function(n,r){let{$from:i,$to:s}=n.selection,o=i.blockRange(s);if(!o)return!1;let a=r?n.tr:null;return!!function(e,t,n,r=null){let i=!1,s=t,o=t.$from.doc;if(t.depth>=2&&t.$from.node(t.depth-1).type.compatibleContent(n)&&0==t.startIndex){if(0==t.$from.index(t.depth-1))return!1;let e=o.resolve(t.start-2);s=new cO(e,e,t.depth),t.endIndex<t.parent.childCount&&(t=new cO(t.$from,o.resolve(t.$to.end(t.depth)),t.depth)),i=!0}let a=dx(s,n,r,t);return!!a&&(e&&function(e,t,n,r,i){let s=cm.empty;for(let e=n.length-1;e>=0;e--)s=cm.from(n[e].type.create(n[e].attrs,s));e.step(new df(t.start-2*!!r,t.end,t.start,t.end,new cw(s,0,0),n.length,!0));let o=0;for(let e=0;e<n.length;e++)n[e].type==i&&(o=e+1);let a=n.length-o,l=t.start+n.length-2*!!r,c=t.parent;for(let n=t.startIndex,r=t.endIndex,i=!0;n<r;n++,i=!1)!i&&dk(e.doc,l,a)&&(e.split(l,a),l+=2*a),l+=c.child(n).nodeSize}(e,t,a,i,n),!0)}(a,o,e,t)&&(r&&r(a.scrollIntoView()),!0)}})(fy(e,n.schema),t)(n,r)});let md=fF.create({name:"commands",addCommands:()=>({...mc})}),mu=fF.create({name:"drop",addProseMirrorPlugins(){return[new d3({key:new d8("tiptapDrop"),props:{handleDrop:(e,t,n,r)=>{this.editor.emit("drop",{editor:this.editor,event:t,slice:n,moved:r})}}})]}}),mh=fF.create({name:"editable",addProseMirrorPlugins(){return[new d3({key:new d8("editable"),props:{editable:()=>this.editor.options.editable}})]}}),mp=new d8("focusEvents"),mf=fF.create({name:"focusEvents",addProseMirrorPlugins(){let{editor:e}=this;return[new d3({key:mp,props:{handleDOMEvents:{focus:(t,n)=>{e.isFocused=!0;let r=e.state.tr.setMeta("focus",{event:n}).setMeta("addToHistory",!1);return t.dispatch(r),!1},blur:(t,n)=>{e.isFocused=!1;let r=e.state.tr.setMeta("blur",{event:n}).setMeta("addToHistory",!1);return t.dispatch(r),!1}}}})]}}),mm=fF.create({name:"keymap",addKeyboardShortcuts(){let e=()=>this.editor.commands.first(({commands:e})=>[()=>e.undoInputRule(),()=>e.command(({tr:t})=>{let{selection:n,doc:r}=t,{empty:i,$anchor:s}=n,{pos:o,parent:a}=s,l=s.parent.isTextblock&&o>0?t.doc.resolve(o-1):s,c=l.parent.type.spec.isolating,d=s.pos-s.parentOffset,u=c&&1===l.parent.childCount?d===s.pos:d_.atStart(r).from===o;return!!i&&!!a.type.isTextblock&&!a.textContent.length&&!!u&&(!u||"paragraph"!==s.parent.type.name)&&e.clearNodes()}),()=>e.deleteSelection(),()=>e.joinBackward(),()=>e.selectNodeBackward()]),t=()=>this.editor.commands.first(({commands:e})=>[()=>e.deleteSelection(),()=>e.deleteCurrentNode(),()=>e.joinForward(),()=>e.selectNodeForward()]),n={Enter:()=>this.editor.commands.first(({commands:e})=>[()=>e.newlineInCode(),()=>e.createParagraphNear(),()=>e.liftEmptyBlock(),()=>e.splitBlock()]),"Mod-Enter":()=>this.editor.commands.exitCode(),Backspace:e,"Mod-Backspace":e,"Shift-Backspace":e,Delete:t,"Mod-Delete":t,"Mod-a":()=>this.editor.commands.selectAll()},r={...n},i={...n,"Ctrl-h":e,"Alt-Backspace":e,"Ctrl-d":t,"Ctrl-Alt-Backspace":t,"Alt-Delete":t,"Alt-d":t,"Ctrl-a":()=>this.editor.commands.selectTextblockStart(),"Ctrl-e":()=>this.editor.commands.selectTextblockEnd()};return fQ()||f3()?i:r},addProseMirrorPlugins(){return[new d3({key:new d8("clearDocument"),appendTransaction:(e,t,n)=>{if(e.some(e=>e.getMeta("composition")))return;let r=e.some(e=>e.docChanged)&&!t.doc.eq(n.doc),i=e.some(e=>e.getMeta("preventClearDocument"));if(!r||i)return;let{empty:s,from:o,to:a}=t.selection,l=d_.atStart(t.doc).from,c=d_.atEnd(t.doc).to;if(s||o!==l||a!==c||!ms(n.doc))return;let d=n.tr,u=fu({state:n,transaction:d}),{commands:h}=new fh({editor:this.editor,state:u});if(h.clearNodes(),d.steps.length)return d}})]}}),mg=fF.create({name:"paste",addProseMirrorPlugins(){return[new d3({key:new d8("tiptapPaste"),props:{handlePaste:(e,t,n)=>{this.editor.emit("paste",{editor:this.editor,event:t,slice:n})}}})]}}),my=fF.create({name:"tabindex",addProseMirrorPlugins(){return[new d3({key:new d8("tabindex"),props:{attributes:()=>this.editor.isEditable?{tabindex:"0"}:{}}})]}});class mx{get name(){return this.node.type.name}constructor(e,t,n=!1,r=null){this.currentNode=null,this.actualDepth=null,this.isBlock=n,this.resolvedPos=e,this.editor=t,this.currentNode=r}get node(){return this.currentNode||this.resolvedPos.node()}get element(){return this.editor.view.domAtPos(this.pos).node}get depth(){var e;return null!=(e=this.actualDepth)?e:this.resolvedPos.depth}get pos(){return this.resolvedPos.pos}get content(){return this.node.content}set content(e){let t=this.from,n=this.to;if(this.isBlock){if(0===this.content.size)return void console.error(`You cant set content on a block node. Tried to set content on ${this.name} at ${this.pos}`);t=this.from+1,n=this.to-1}this.editor.commands.insertContentAt({from:t,to:n},e)}get attributes(){return this.node.attrs}get textContent(){return this.node.textContent}get size(){return this.node.nodeSize}get from(){return this.isBlock?this.pos:this.resolvedPos.start(this.resolvedPos.depth)}get range(){return{from:this.from,to:this.to}}get to(){return this.isBlock?this.pos+this.size:this.resolvedPos.end(this.resolvedPos.depth)+ +!this.node.isText}get parent(){if(0===this.depth)return null;let e=this.resolvedPos.start(this.resolvedPos.depth-1);return new mx(this.resolvedPos.doc.resolve(e),this.editor)}get before(){let e=this.resolvedPos.doc.resolve(this.from-(this.isBlock?1:2));return e.depth!==this.depth&&(e=this.resolvedPos.doc.resolve(this.from-3)),new mx(e,this.editor)}get after(){let e=this.resolvedPos.doc.resolve(this.to+(this.isBlock?2:1));return e.depth!==this.depth&&(e=this.resolvedPos.doc.resolve(this.to+3)),new mx(e,this.editor)}get children(){let e=[];return this.node.content.forEach((t,n)=>{let r=t.isBlock&&!t.isTextblock,i=t.isAtom&&!t.isText,s=this.pos+n+ +!i;if(s<0||s>this.resolvedPos.doc.nodeSize-2)return;let o=this.resolvedPos.doc.resolve(s);if(!r&&o.depth<=this.depth)return;let a=new mx(o,this.editor,r,r?t:null);r&&(a.actualDepth=this.depth+1),e.push(new mx(o,this.editor,r,r?t:null))}),e}get firstChild(){return this.children[0]||null}get lastChild(){let e=this.children;return e[e.length-1]||null}closest(e,t={}){let n=null,r=this.parent;for(;r&&!n;){if(r.node.type.name===e)if(Object.keys(t).length>0){let e=r.node.attrs,n=Object.keys(t);for(let r=0;r<n.length;r+=1){let i=n[r];if(e[i]!==t[i])break}}else n=r;r=r.parent}return n}querySelector(e,t={}){return this.querySelectorAll(e,t,!0)[0]||null}querySelectorAll(e,t={},n=!1){let r=[];if(!this.children||0===this.children.length)return r;let i=Object.keys(t);return this.children.forEach(s=>{(!n||!(r.length>0))&&(s.node.type.name===e&&i.every(e=>t[e]===s.node.attrs[e])&&r.push(s),n&&r.length>0||(r=r.concat(s.querySelectorAll(e,t,n))))}),r}setAttribute(e){let{tr:t}=this.editor.state;t.setNodeMarkup(this.from,void 0,{...this.node.attrs,...e}),this.editor.view.dispatch(t)}}let mv=`.ProseMirror {
  position: relative;
}

.ProseMirror {
  word-wrap: break-word;
  white-space: pre-wrap;
  white-space: break-spaces;
  -webkit-font-variant-ligatures: none;
  font-variant-ligatures: none;
  font-feature-settings: "liga" 0; /* the above doesn't seem to work in Edge */
}

.ProseMirror [contenteditable="false"] {
  white-space: normal;
}

.ProseMirror [contenteditable="false"] [contenteditable="true"] {
  white-space: pre-wrap;
}

.ProseMirror pre {
  white-space: pre-wrap;
}

img.ProseMirror-separator {
  display: inline !important;
  border: none !important;
  margin: 0 !important;
  width: 0 !important;
  height: 0 !important;
}

.ProseMirror-gapcursor {
  display: none;
  pointer-events: none;
  position: absolute;
  margin: 0;
}

.ProseMirror-gapcursor:after {
  content: "";
  display: block;
  position: absolute;
  top: -2px;
  width: 20px;
  border-top: 1px solid black;
  animation: ProseMirror-cursor-blink 1.1s steps(2, start) infinite;
}

@keyframes ProseMirror-cursor-blink {
  to {
    visibility: hidden;
  }
}

.ProseMirror-hideselection *::selection {
  background: transparent;
}

.ProseMirror-hideselection *::-moz-selection {
  background: transparent;
}

.ProseMirror-hideselection * {
  caret-color: transparent;
}

.ProseMirror-focused .ProseMirror-gapcursor {
  display: block;
}

.tippy-box[data-animation=fade][data-state=hidden] {
  opacity: 0
}`;class mb extends fp{constructor(e={}){super(),this.isFocused=!1,this.isInitialized=!1,this.extensionStorage={},this.options={element:document.createElement("div"),content:"",injectCSS:!0,injectNonce:void 0,extensions:[],autofocus:!1,editable:!0,editorProps:{},parseOptions:{},coreExtensionOptions:{},enableInputRules:!0,enablePasteRules:!0,enableCoreExtensions:!0,enableContentCheck:!1,emitContentError:!1,onBeforeCreate:()=>null,onCreate:()=>null,onUpdate:()=>null,onSelectionUpdate:()=>null,onTransaction:()=>null,onFocus:()=>null,onBlur:()=>null,onDestroy:()=>null,onContentError:({error:e})=>{throw e},onPaste:()=>null,onDrop:()=>null},this.isCapturingTransaction=!1,this.capturedTransaction=null,this.setOptions(e),this.createExtensionManager(),this.createCommandManager(),this.createSchema(),this.on("beforeCreate",this.options.onBeforeCreate),this.emit("beforeCreate",{editor:this}),this.on("contentError",this.options.onContentError),this.createView(),this.injectCSS(),this.on("create",this.options.onCreate),this.on("update",this.options.onUpdate),this.on("selectionUpdate",this.options.onSelectionUpdate),this.on("transaction",this.options.onTransaction),this.on("focus",this.options.onFocus),this.on("blur",this.options.onBlur),this.on("destroy",this.options.onDestroy),this.on("drop",({event:e,slice:t,moved:n})=>this.options.onDrop(e,t,n)),this.on("paste",({event:e,slice:t})=>this.options.onPaste(e,t)),window.setTimeout(()=>{this.isDestroyed||(this.commands.focus(this.options.autofocus),this.emit("create",{editor:this}),this.isInitialized=!0)},0)}get storage(){return this.extensionStorage}get commands(){return this.commandManager.commands}chain(){return this.commandManager.chain()}can(){return this.commandManager.can()}injectCSS(){this.options.injectCSS&&document&&(this.css=function(e,t,n){let r=document.querySelector("style[data-tiptap-style]");if(null!==r)return r;let i=document.createElement("style");return t&&i.setAttribute("nonce",t),i.setAttribute("data-tiptap-style",""),i.innerHTML=e,document.getElementsByTagName("head")[0].appendChild(i),i}(mv,this.options.injectNonce))}setOptions(e={}){this.options={...this.options,...e},this.view&&this.state&&!this.isDestroyed&&(this.options.editorProps&&this.view.setProps(this.options.editorProps),this.view.updateState(this.state))}setEditable(e,t=!0){this.setOptions({editable:e}),t&&this.emit("update",{editor:this,transaction:this.state.tr})}get isEditable(){return this.options.editable&&this.view&&this.view.editable}get state(){return this.view.state}registerPlugin(e,t){let n=fb(t)?t(e,[...this.state.plugins]):[...this.state.plugins,e],r=this.state.reconfigure({plugins:n});return this.view.updateState(r),r}unregisterPlugin(e){if(this.isDestroyed)return;let t=this.state.plugins,n=t;if([].concat(e).forEach(e=>{let t="string"==typeof e?`${e}$`:e.key;n=n.filter(e=>!e.key.startsWith(t))}),t.length===n.length)return;let r=this.state.reconfigure({plugins:n});return this.view.updateState(r),r}createExtensionManager(){var e,t;let n=[...this.options.enableCoreExtensions?[mh,fq.configure({blockSeparator:null==(t=null==(e=this.options.coreExtensionOptions)?void 0:e.clipboardTextSerializer)?void 0:t.blockSeparator}),md,mf,mm,my,mu,mg].filter(e=>"object"!=typeof this.options.enableCoreExtensions||!1!==this.options.enableCoreExtensions[e.name]):[],...this.options.extensions].filter(e=>["extension","node","mark"].includes(null==e?void 0:e.type));this.extensionManager=new f_(n,this)}createCommandManager(){this.commandManager=new fh({editor:this})}createSchema(){this.schema=this.extensionManager.schema}createView(){var e;let t;try{t=f9(this.options.content,this.schema,this.options.parseOptions,{errorOnInvalidContent:this.options.enableContentCheck})}catch(e){if(!(e instanceof Error)||!["[tiptap error]: Invalid JSON content","[tiptap error]: Invalid HTML content"].includes(e.message))throw e;this.emit("contentError",{editor:this,error:e,disableCollaboration:()=>{this.storage.collaboration&&(this.storage.collaboration.isDisabled=!0),this.options.extensions=this.options.extensions.filter(e=>"collaboration"!==e.name),this.createExtensionManager()}}),t=f9(this.options.content,this.schema,this.options.parseOptions,{errorOnInvalidContent:!1})}let n=fZ(t,this.options.autofocus);this.view=new pN(this.options.element,{...this.options.editorProps,attributes:{role:"textbox",...null==(e=this.options.editorProps)?void 0:e.attributes},dispatchTransaction:this.dispatchTransaction.bind(this),state:d4.create({doc:t,selection:n||void 0})});let r=this.state.reconfigure({plugins:this.extensionManager.plugins});this.view.updateState(r),this.createNodeViews(),this.prependClass(),this.view.dom.editor=this}createNodeViews(){this.view.isDestroyed||this.view.setProps({nodeViews:this.extensionManager.nodeViews})}prependClass(){this.view.dom.className=`tiptap ${this.view.dom.className}`}captureTransaction(e){this.isCapturingTransaction=!0,e(),this.isCapturingTransaction=!1;let t=this.capturedTransaction;return this.capturedTransaction=null,t}dispatchTransaction(e){if(this.view.isDestroyed)return;if(this.isCapturingTransaction){if(!this.capturedTransaction){this.capturedTransaction=e;return}e.steps.forEach(e=>{var t;return null==(t=this.capturedTransaction)?void 0:t.step(e)});return}let t=this.state.apply(e),n=!this.state.selection.eq(t.selection);this.emit("beforeTransaction",{editor:this,transaction:e,nextState:t}),this.view.updateState(t),this.emit("transaction",{editor:this,transaction:e}),n&&this.emit("selectionUpdate",{editor:this,transaction:e});let r=e.getMeta("focus"),i=e.getMeta("blur");r&&this.emit("focus",{editor:this,event:r.event,transaction:e}),i&&this.emit("blur",{editor:this,event:i.event,transaction:e}),!e.docChanged||e.getMeta("preventUpdate")||this.emit("update",{editor:this,transaction:e})}getAttributes(e){return function(e,t){let n=f6("string"==typeof t?t:t.name,e.schema);if("node"===n){let n=fy(t,e.schema),{from:r,to:i}=e.selection,s=[];e.doc.nodesBetween(r,i,e=>{s.push(e)});let o=s.reverse().find(e=>e.type.name===n.name);return o?{...o.attrs}:{}}return"mark"===n?f7(e,t):{}}(this.state,e)}isActive(e,t){let n="string"==typeof e?e:null,r="string"==typeof e?t:e;return function(e,t,n={}){if(!t)return f5(e,null,n)||mr(e,null,n);let r=f6(t,e.schema);return"node"===r?f5(e,t,n):"mark"===r&&mr(e,t,n)}(this.state,n,r)}getJSON(){return this.state.doc.toJSON()}getHTML(){return fM(this.state.doc.content,this.schema)}getText(e){let{blockSeparator:t="\n\n",textSerializers:n={}}=e||{};return function(e,t){let n={from:0,to:e.content.size};return fB(e,n,t)}(this.state.doc,{blockSeparator:t,textSerializers:{...fW(this.schema),...n}})}get isEmpty(){return ms(this.state.doc)}getCharacterCount(){return console.warn('[tiptap warn]: "editor.getCharacterCount()" is deprecated. Please use "editor.storage.characterCount.characters()" instead.'),this.state.doc.content.size-2}destroy(){if(this.emit("destroy"),this.view){let e=this.view.dom;e&&e.editor&&delete e.editor,this.view.destroy()}this.removeAllListeners()}get isDestroyed(){var e;return!(null==(e=this.view)?void 0:e.docView)}$node(e,t){var n;return(null==(n=this.$doc)?void 0:n.querySelector(e,t))||null}$nodes(e,t){var n;return(null==(n=this.$doc)?void 0:n.querySelectorAll(e,t))||null}$pos(e){return new mx(this.state.doc.resolve(e),this)}get $doc(){return this.$pos(0)}}function mw(e){return new fA({find:e.find,handler:({state:t,range:n,match:r})=>{let i=fw(e.getAttributes,void 0,r);if(!1===i||null===i)return null;let{tr:s}=t,o=r[r.length-1],a=r[0];if(o){let r=a.search(/\S/),l=n.from+a.indexOf(o),c=l+o.length;if(mt(n.from,n.to,t.doc).filter(t=>t.mark.type.excluded.find(n=>n===e.type&&n!==t.mark.type)).filter(e=>e.to>l).length)return null;c<n.to&&s.delete(c,n.to),l>n.from&&s.delete(n.from+r,l);let d=n.from+r+o.length;s.addMark(n.from+r,d,e.type.create(i||{})),s.removeStoredMark(e.type)}}})}function mk(e){return new fA({find:e.find,handler:({state:t,range:n,match:r})=>{let i=t.doc.resolve(n.from),s=fw(e.getAttributes,void 0,r)||{};if(!i.node(-1).canReplaceWith(i.index(-1),i.indexAfter(-1),e.type))return null;t.tr.delete(n.from,n.to).setBlockType(n.from,n.from,e.type,s)}})}function mj(e){return new fA({find:e.find,handler:({state:t,range:n,match:r,chain:i})=>{let s=fw(e.getAttributes,void 0,r)||{},o=t.tr.delete(n.from,n.to),a=o.doc.resolve(n.from).blockRange(),l=a&&dx(a,e.type,s);if(!l)return null;if(o.wrap(a,l),e.keepMarks&&e.editor){let{selection:n,storedMarks:r}=t,{splittableMarks:i}=e.editor.extensionManager,s=r||n.$to.parentOffset&&n.$from.marks();if(s){let e=s.filter(e=>i.includes(e.type.name));o.ensureMarks(e)}}if(e.keepAttributes){let t="bulletList"===e.type.name||"orderedList"===e.type.name?"listItem":"taskList";i().updateAttributes(t,s).run()}let c=o.doc.resolve(n.from-1).nodeBefore;c&&c.type===e.type&&dj(o.doc,n.from-1)&&(!e.joinPredicate||e.joinPredicate(r,c))&&o.join(n.from-1)}})}class mN{constructor(e={}){this.type="node",this.name="node",this.parent=null,this.child=null,this.config={name:this.name,defaultOptions:{}},this.config={...this.config,...e},this.name=this.config.name,e.defaultOptions&&Object.keys(e.defaultOptions).length>0&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${this.name}".`),this.options=this.config.defaultOptions,this.config.addOptions&&(this.options=fw(ff(this,"addOptions",{name:this.name}))),this.storage=fw(ff(this,"addStorage",{name:this.name,options:this.options}))||{}}static create(e={}){return new mN(e)}configure(e={}){let t=this.extend({...this.config,addOptions:()=>fP(this.options,e)});return t.name=this.name,t.parent=this.parent,t}extend(e={}){let t=new mN(e);return t.parent=this,this.child=t,t.name=e.name?e.name:t.parent.name,e.defaultOptions&&Object.keys(e.defaultOptions).length>0&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${t.name}".`),t.options=fw(ff(t,"addOptions",{name:t.name})),t.storage=fw(ff(t,"addStorage",{name:t.name,options:t.options})),t}}function mS(e){return new fL({find:e.find,handler:({state:t,range:n,match:r,pasteEvent:i})=>{let s=fw(e.getAttributes,void 0,r,i);if(!1===s||null===s)return null;let{tr:o}=t,a=r[r.length-1],l=r[0],c=n.to;if(a){let r=l.search(/\S/),i=n.from+l.indexOf(a),d=i+a.length;if(mt(n.from,n.to,t.doc).filter(t=>t.mark.type.excluded.find(n=>n===e.type&&n!==t.mark.type)).filter(e=>e.to>i).length)return null;d<n.to&&o.delete(d,n.to),i>n.from&&o.delete(n.from+r,i),c=n.from+r+a.length,o.addMark(n.from+r,c,e.type.create(s||{})),o.removeStoredMark(e.type)}}})}var mC={exports:{}},mM={};mC.exports=function(){if(c)return mM;c=1;var e="function"==typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e==1/t)||e!=e&&t!=t},t=h.useState,n=h.useEffect,r=h.useLayoutEffect,i=h.useDebugValue;function s(t){var n=t.getSnapshot;t=t.value;try{var r=n();return!e(t,r)}catch(e){return!0}}var o="undefined"==typeof window||void 0===window.document||void 0===window.document.createElement?function(e,t){return t()}:function(e,o){var a=o(),l=t({inst:{value:a,getSnapshot:o}}),c=l[0].inst,d=l[1];return r(function(){c.value=a,c.getSnapshot=o,s(c)&&d({inst:c})},[e,a,o]),n(function(){return s(c)&&d({inst:c}),e(function(){s(c)&&d({inst:c})})},[e]),i(a),a};return mM.useSyncExternalStore=void 0!==h.useSyncExternalStore?h.useSyncExternalStore:o,mM}();var mE=mC.exports;let mT=(...e)=>t=>{e.forEach(e=>{"function"==typeof e?e(t):e&&(e.current=t)})},mA=({contentComponent:e})=>{let t=mE.useSyncExternalStore(e.subscribe,e.getSnapshot,e.getServerSnapshot);return h.createElement(h.Fragment,null,Object.values(t))};class mD extends h.Component{constructor(e){var t;super(e),this.editorContentRef=h.createRef(),this.initialized=!1,this.state={hasContentComponentInitialized:!!(null==(t=e.editor)?void 0:t.contentComponent)}}componentDidMount(){this.init()}componentDidUpdate(){this.init()}init(){let e=this.props.editor;if(e&&!e.isDestroyed&&e.options.element){if(e.contentComponent)return;let t=this.editorContentRef.current;t.append(...e.options.element.childNodes),e.setOptions({element:t}),e.contentComponent=function(){let e=new Set,t={};return{subscribe:t=>(e.add(t),()=>{e.delete(t)}),getSnapshot:()=>t,getServerSnapshot:()=>t,setRenderer(n,r){t={...t,[n]:cp.createPortal(r.reactElement,r.element,n)},e.forEach(e=>e())},removeRenderer(n){let r={...t};delete r[n],t=r,e.forEach(e=>e())}}}(),this.state.hasContentComponentInitialized||(this.unsubscribeToContentComponent=e.contentComponent.subscribe(()=>{this.setState(e=>e.hasContentComponentInitialized?e:{hasContentComponentInitialized:!0}),this.unsubscribeToContentComponent&&this.unsubscribeToContentComponent()})),e.createNodeViews(),this.initialized=!0}}componentWillUnmount(){let e=this.props.editor;if(!e||(this.initialized=!1,e.isDestroyed||e.view.setProps({nodeViews:{}}),this.unsubscribeToContentComponent&&this.unsubscribeToContentComponent(),e.contentComponent=null,!e.options.element.firstChild))return;let t=document.createElement("div");t.append(...e.options.element.childNodes),e.setOptions({element:t})}render(){let{editor:e,innerRef:t,...n}=this.props;return h.createElement(h.Fragment,null,h.createElement("div",{ref:mT(t,this.editorContentRef),...n}),(null==e?void 0:e.contentComponent)&&h.createElement(mA,{contentComponent:e.contentComponent}))}}let mO=(0,h.forwardRef)((e,t)=>{let n=h.useMemo(()=>Math.floor(0xffffffff*Math.random()).toString(),[e.editor]);return h.createElement(mD,{key:n,innerRef:t,...e})}),mR=h.memo(mO);var mP=function(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}(function e(t,n){if(t===n)return!0;if(t&&n&&"object"==typeof t&&"object"==typeof n){if(t.constructor!==n.constructor)return!1;if(Array.isArray(t)){if((r=t.length)!=n.length)return!1;for(i=r;0!=i--;)if(!e(t[i],n[i]))return!1;return!0}if(t instanceof Map&&n instanceof Map){if(t.size!==n.size)return!1;for(i of t.entries())if(!n.has(i[0]))return!1;for(i of t.entries())if(!e(i[1],n.get(i[0])))return!1;return!0}if(t instanceof Set&&n instanceof Set){if(t.size!==n.size)return!1;for(i of t.entries())if(!n.has(i[0]))return!1;return!0}if(ArrayBuffer.isView(t)&&ArrayBuffer.isView(n)){if((r=t.length)!=n.length)return!1;for(i=r;0!=i--;)if(t[i]!==n[i])return!1;return!0}if(t.constructor===RegExp)return t.source===n.source&&t.flags===n.flags;if(t.valueOf!==Object.prototype.valueOf)return t.valueOf()===n.valueOf();if(t.toString!==Object.prototype.toString)return t.toString()===n.toString();if((r=(s=Object.keys(t)).length)!==Object.keys(n).length)return!1;for(i=r;0!=i--;)if(!Object.prototype.hasOwnProperty.call(n,s[i]))return!1;for(i=r;0!=i--;){var r,i,s,o=s[i];if(("_owner"!==o||!t.$$typeof)&&!e(t[o],n[o]))return!1}return!0}return t!=t&&n!=n}),mI={exports:{}},mL={};mI.exports=function(){if(d)return mL;d=1;var e="function"==typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e==1/t)||e!=e&&t!=t},t=mE.useSyncExternalStore,n=h.useRef,r=h.useEffect,i=h.useMemo,s=h.useDebugValue;return mL.useSyncExternalStoreWithSelector=function(o,a,l,c,d){var u=n(null);if(null===u.current){var h={hasValue:!1,value:null};u.current=h}else h=u.current;var p=t(o,(u=i(function(){function t(t){if(!i){if(i=!0,n=t,t=c(t),void 0!==d&&h.hasValue){var s=h.value;if(d(s,t))return r=s}return r=t}if(s=r,e(n,t))return s;var o=c(t);return void 0!==d&&d(s,o)?s:(n=t,r=o)}var n,r,i=!1,s=void 0===l?null:l;return[function(){return t(a())},null===s?void 0:function(){return t(s())}]},[a,l,c,d]))[0],u[1]);return r(function(){h.hasValue=!0,h.value=p},[p]),s(p),p},mL}();var mz=mI.exports;let mV="undefined"!=typeof window?h.useLayoutEffect:h.useEffect;class m${constructor(e){this.transactionNumber=0,this.lastTransactionNumber=0,this.subscribers=new Set,this.editor=e,this.lastSnapshot={editor:e,transactionNumber:0},this.getSnapshot=this.getSnapshot.bind(this),this.getServerSnapshot=this.getServerSnapshot.bind(this),this.watch=this.watch.bind(this),this.subscribe=this.subscribe.bind(this)}getSnapshot(){return this.transactionNumber===this.lastTransactionNumber||(this.lastTransactionNumber=this.transactionNumber,this.lastSnapshot={editor:this.editor,transactionNumber:this.transactionNumber}),this.lastSnapshot}getServerSnapshot(){return{editor:null,transactionNumber:0}}subscribe(e){return this.subscribers.add(e),()=>{this.subscribers.delete(e)}}watch(e){if(this.editor=e,this.editor){let e=()=>{this.transactionNumber+=1,this.subscribers.forEach(e=>e())},t=this.editor;return t.on("transaction",e),()=>{t.off("transaction",e)}}}}let m_="undefined"==typeof window,mF=m_||!!("undefined"!=typeof window&&window.next);class mB{constructor(e){this.editor=null,this.subscriptions=new Set,this.isComponentMounted=!1,this.previousDeps=null,this.instanceId="",this.options=e,this.subscriptions=new Set,this.setEditor(this.getInitialEditor()),this.scheduleDestroy(),this.getEditor=this.getEditor.bind(this),this.getServerSnapshot=this.getServerSnapshot.bind(this),this.subscribe=this.subscribe.bind(this),this.refreshEditorInstance=this.refreshEditorInstance.bind(this),this.scheduleDestroy=this.scheduleDestroy.bind(this),this.onRender=this.onRender.bind(this),this.createEditor=this.createEditor.bind(this)}setEditor(e){this.editor=e,this.instanceId=Math.random().toString(36).slice(2,9),this.subscriptions.forEach(e=>e())}getInitialEditor(){return void 0===this.options.current.immediatelyRender?m_||mF?null:this.createEditor():(this.options.current.immediatelyRender,this.options.current.immediatelyRender?this.createEditor():null)}createEditor(){return new mb({...this.options.current,onBeforeCreate:(...e)=>{var t,n;return null==(n=(t=this.options.current).onBeforeCreate)?void 0:n.call(t,...e)},onBlur:(...e)=>{var t,n;return null==(n=(t=this.options.current).onBlur)?void 0:n.call(t,...e)},onCreate:(...e)=>{var t,n;return null==(n=(t=this.options.current).onCreate)?void 0:n.call(t,...e)},onDestroy:(...e)=>{var t,n;return null==(n=(t=this.options.current).onDestroy)?void 0:n.call(t,...e)},onFocus:(...e)=>{var t,n;return null==(n=(t=this.options.current).onFocus)?void 0:n.call(t,...e)},onSelectionUpdate:(...e)=>{var t,n;return null==(n=(t=this.options.current).onSelectionUpdate)?void 0:n.call(t,...e)},onTransaction:(...e)=>{var t,n;return null==(n=(t=this.options.current).onTransaction)?void 0:n.call(t,...e)},onUpdate:(...e)=>{var t,n;return null==(n=(t=this.options.current).onUpdate)?void 0:n.call(t,...e)},onContentError:(...e)=>{var t,n;return null==(n=(t=this.options.current).onContentError)?void 0:n.call(t,...e)},onDrop:(...e)=>{var t,n;return null==(n=(t=this.options.current).onDrop)?void 0:n.call(t,...e)},onPaste:(...e)=>{var t,n;return null==(n=(t=this.options.current).onPaste)?void 0:n.call(t,...e)}})}getEditor(){return this.editor}getServerSnapshot(){return null}subscribe(e){return this.subscriptions.add(e),()=>{this.subscriptions.delete(e)}}static compareOptions(e,t){return Object.keys(e).every(n=>!!["onCreate","onBeforeCreate","onDestroy","onUpdate","onTransaction","onFocus","onBlur","onSelectionUpdate","onContentError","onDrop","onPaste"].includes(n)||("extensions"===n&&e.extensions&&t.extensions?e.extensions.length===t.extensions.length&&e.extensions.every((e,n)=>{var r;return e===(null==(r=t.extensions)?void 0:r[n])}):e[n]===t[n]))}onRender(e){return()=>(this.isComponentMounted=!0,clearTimeout(this.scheduledDestructionTimeout),this.editor&&!this.editor.isDestroyed&&0===e.length?mB.compareOptions(this.options.current,this.editor.options)||this.editor.setOptions({...this.options.current,editable:this.editor.isEditable}):this.refreshEditorInstance(e),()=>{this.isComponentMounted=!1,this.scheduleDestroy()})}refreshEditorInstance(e){if(this.editor&&!this.editor.isDestroyed){if(null===this.previousDeps){this.previousDeps=e;return}if(this.previousDeps.length===e.length&&this.previousDeps.every((t,n)=>t===e[n]))return}this.editor&&!this.editor.isDestroyed&&this.editor.destroy(),this.setEditor(this.createEditor()),this.previousDeps=e}scheduleDestroy(){let e=this.instanceId,t=this.editor;this.scheduledDestructionTimeout=setTimeout(()=>{if(this.isComponentMounted&&this.instanceId===e){t&&t.setOptions(this.options.current);return}t&&!t.isDestroyed&&(t.destroy(),this.instanceId===e&&this.setEditor(null))},1)}}let mW=((0,h.createContext)({editor:null}).Consumer,(0,h.createContext)({onDragStart:void 0})),mq=()=>(0,h.useContext)(mW);function mH(e){return!!("function"==typeof e&&e.prototype&&e.prototype.isReactComponent)}function mU(e){return!!("object"==typeof e&&e.$$typeof&&("Symbol(react.forward_ref)"===e.$$typeof.toString()||"react.forward_ref"===e.$$typeof.description))}h.forwardRef((e,t)=>{let{onDragStart:n}=mq(),r=e.as||"div";return h.createElement(r,{...e,ref:t,"data-node-view-wrapper":"",onDragStart:n,style:{whiteSpace:"normal",...e.style}})});class mK{constructor(e,{editor:t,props:n={},as:r="div",className:i=""}){this.ref=null,this.id=Math.floor(0xffffffff*Math.random()).toString(),this.component=e,this.editor=t,this.props=n,this.element=document.createElement(r),this.element.classList.add("react-renderer"),i&&this.element.classList.add(...i.split(" ")),this.editor.isInitialized?flushSync(()=>{this.render()}):this.render()}render(){var e;let t=this.component,n=this.props,r=this.editor,i=function(){try{if(version)return parseInt(version.split(".")[0],10)>=19}catch{}return!1}(),s=function(e){if(mH(e)||mU(e))return!0;if("object"==typeof e&&e.$$typeof&&("Symbol(react.memo)"===e.$$typeof.toString()||"react.memo"===e.$$typeof.description)){let t=e.type;if(t)return mH(t)||mU(t)}return!1}(t),o={...n};o.ref&&!(i||s)&&delete o.ref,!o.ref&&(i||s)&&(o.ref=e=>{this.ref=e}),this.reactElement=React.createElement(t,{...o}),null==(e=null==r?void 0:r.contentComponent)||e.setRenderer(this.id,this)}updateProps(e={}){this.props={...this.props,...e},this.render()}destroy(){var e;let t=this.editor;null==(e=null==t?void 0:t.contentComponent)||e.removeRenderer(this.id)}updateAttributes(e){Object.keys(e).forEach(t=>{this.element.setAttribute(t,e[t])})}}let mJ=/^\s*>\s$/,mG=mN.create({name:"blockquote",addOptions:()=>({HTMLAttributes:{}}),content:"block+",group:"block",defining:!0,parseHTML:()=>[{tag:"blockquote"}],renderHTML({HTMLAttributes:e}){return["blockquote",fx(this.options.HTMLAttributes,e),0]},addCommands(){return{setBlockquote:()=>({commands:e})=>e.wrapIn(this.name),toggleBlockquote:()=>({commands:e})=>e.toggleWrap(this.name),unsetBlockquote:()=>({commands:e})=>e.lift(this.name)}},addKeyboardShortcuts(){return{"Mod-Shift-b":()=>this.editor.commands.toggleBlockquote()}},addInputRules(){return[mj({find:mJ,type:this.type})]}}),mY=/(?:^|\s)(\*\*(?!\s+\*\*)((?:[^*]+))\*\*(?!\s+\*\*))$/,mX=/(?:^|\s)(\*\*(?!\s+\*\*)((?:[^*]+))\*\*(?!\s+\*\*))/g,mZ=/(?:^|\s)(__(?!\s+__)((?:[^_]+))__(?!\s+__))$/,mQ=/(?:^|\s)(__(?!\s+__)((?:[^_]+))__(?!\s+__))/g,m0=fI.create({name:"bold",addOptions:()=>({HTMLAttributes:{}}),parseHTML(){return[{tag:"strong"},{tag:"b",getAttrs:e=>"normal"!==e.style.fontWeight&&null},{style:"font-weight=400",clearMark:e=>e.type.name===this.name},{style:"font-weight",getAttrs:e=>/^(bold(er)?|[5-9]\d{2,})$/.test(e)&&null}]},renderHTML({HTMLAttributes:e}){return["strong",fx(this.options.HTMLAttributes,e),0]},addCommands(){return{setBold:()=>({commands:e})=>e.setMark(this.name),toggleBold:()=>({commands:e})=>e.toggleMark(this.name),unsetBold:()=>({commands:e})=>e.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-b":()=>this.editor.commands.toggleBold(),"Mod-B":()=>this.editor.commands.toggleBold()}},addInputRules(){return[mw({find:mY,type:this.type}),mw({find:mZ,type:this.type})]},addPasteRules(){return[mS({find:mX,type:this.type}),mS({find:mQ,type:this.type})]}}),m1="textStyle",m2=/^\s*([-+*])\s$/,m4=mN.create({name:"bulletList",addOptions:()=>({itemTypeName:"listItem",HTMLAttributes:{},keepMarks:!1,keepAttributes:!1}),group:"block list",content(){return`${this.options.itemTypeName}+`},parseHTML:()=>[{tag:"ul"}],renderHTML({HTMLAttributes:e}){return["ul",fx(this.options.HTMLAttributes,e),0]},addCommands(){return{toggleBulletList:()=>({commands:e,chain:t})=>this.options.keepAttributes?t().toggleList(this.name,this.options.itemTypeName,this.options.keepMarks).updateAttributes("listItem",this.editor.getAttributes(m1)).run():e.toggleList(this.name,this.options.itemTypeName,this.options.keepMarks)}},addKeyboardShortcuts(){return{"Mod-Shift-8":()=>this.editor.commands.toggleBulletList()}},addInputRules(){let e=mj({find:m2,type:this.type});return(this.options.keepMarks||this.options.keepAttributes)&&(e=mj({find:m2,type:this.type,keepMarks:this.options.keepMarks,keepAttributes:this.options.keepAttributes,getAttributes:()=>this.editor.getAttributes(m1),editor:this.editor})),[e]}}),m3=/(^|[^`])`([^`]+)`(?!`)/,m5=/(^|[^`])`([^`]+)`(?!`)/g,m6=fI.create({name:"code",addOptions:()=>({HTMLAttributes:{}}),excludes:"_",code:!0,exitable:!0,parseHTML:()=>[{tag:"code"}],renderHTML({HTMLAttributes:e}){return["code",fx(this.options.HTMLAttributes,e),0]},addCommands(){return{setCode:()=>({commands:e})=>e.setMark(this.name),toggleCode:()=>({commands:e})=>e.toggleMark(this.name),unsetCode:()=>({commands:e})=>e.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-e":()=>this.editor.commands.toggleCode()}},addInputRules(){return[mw({find:m3,type:this.type})]},addPasteRules(){return[mS({find:m5,type:this.type})]}}),m8=/^```([a-z]+)?[\s\n]$/,m9=/^~~~([a-z]+)?[\s\n]$/,m7=mN.create({name:"codeBlock",addOptions:()=>({languageClassPrefix:"language-",exitOnTripleEnter:!0,exitOnArrowDown:!0,defaultLanguage:null,HTMLAttributes:{}}),content:"text*",marks:"",group:"block",code:!0,defining:!0,addAttributes(){return{language:{default:this.options.defaultLanguage,parseHTML:e=>{var t;let{languageClassPrefix:n}=this.options,r=[...(null==(t=e.firstElementChild)?void 0:t.classList)||[]].filter(e=>e.startsWith(n)).map(e=>e.replace(n,""))[0];return r||null},rendered:!1}}},parseHTML:()=>[{tag:"pre",preserveWhitespace:"full"}],renderHTML({node:e,HTMLAttributes:t}){return["pre",fx(this.options.HTMLAttributes,t),["code",{class:e.attrs.language?this.options.languageClassPrefix+e.attrs.language:null},0]]},addCommands(){return{setCodeBlock:e=>({commands:t})=>t.setNode(this.name,e),toggleCodeBlock:e=>({commands:t})=>t.toggleNode(this.name,"paragraph",e)}},addKeyboardShortcuts(){return{"Mod-Alt-c":()=>this.editor.commands.toggleCodeBlock(),Backspace:()=>{let{empty:e,$anchor:t}=this.editor.state.selection,n=1===t.pos;return!!e&&t.parent.type.name===this.name&&(!!n||!t.parent.textContent.length)&&this.editor.commands.clearNodes()},Enter:({editor:e})=>{if(!this.options.exitOnTripleEnter)return!1;let{state:t}=e,{selection:n}=t,{$from:r,empty:i}=n;if(!i||r.parent.type!==this.type)return!1;let s=r.parentOffset===r.parent.nodeSize-2,o=r.parent.textContent.endsWith("\n\n");return!!s&&!!o&&e.chain().command(({tr:e})=>(e.delete(r.pos-2,r.pos),!0)).exitCode().run()},ArrowDown:({editor:e})=>{if(!this.options.exitOnArrowDown)return!1;let{state:t}=e,{selection:n,doc:r}=t,{$from:i,empty:s}=n;if(!s||i.parent.type!==this.type||i.parentOffset!==i.parent.nodeSize-2)return!1;let o=i.after();return void 0!==o&&(r.nodeAt(o)?e.commands.command(({tr:e})=>(e.setSelection(d_.near(r.resolve(o))),!0)):e.commands.exitCode())}}},addInputRules(){return[mk({find:m8,type:this.type,getAttributes:e=>({language:e[1]})}),mk({find:m9,type:this.type,getAttributes:e=>({language:e[1]})})]},addProseMirrorPlugins(){return[new d3({key:new d8("codeBlockVSCodeHandler"),props:{handlePaste:(e,t)=>{if(!t.clipboardData||this.editor.isActive(this.type.name))return!1;let n=t.clipboardData.getData("text/plain"),r=t.clipboardData.getData("vscode-editor-data"),i=r?JSON.parse(r):void 0,s=null==i?void 0:i.mode;if(!n||!s)return!1;let{tr:o,schema:a}=e.state,l=a.text(n.replace(/\r\n?/g,"\n"));return o.replaceSelectionWith(this.type.create({language:s},l)),o.selection.$from.parent.type!==this.type&&o.setSelection(dq.near(o.doc.resolve(Math.max(0,o.selection.from-2)))),o.setMeta("paste",!0),e.dispatch(o),!0}}})]}}),ge=mN.create({name:"doc",topNode:!0,content:"block+"});class gt{constructor(e,t){var n;this.editorView=e,this.cursorPos=null,this.element=null,this.timeout=-1,this.width=null!=(n=t.width)?n:1,this.color=!1===t.color?void 0:t.color||"black",this.class=t.class,this.handlers=["dragover","dragend","drop","dragleave"].map(t=>{let n=e=>{this[t](e)};return e.dom.addEventListener(t,n),{name:t,handler:n}})}destroy(){this.handlers.forEach(({name:e,handler:t})=>this.editorView.dom.removeEventListener(e,t))}update(e,t){null!=this.cursorPos&&t.doc!=e.state.doc&&(this.cursorPos>e.state.doc.content.size?this.setCursor(null):this.updateOverlay())}setCursor(e){e!=this.cursorPos&&(this.cursorPos=e,null==e?(this.element.parentNode.removeChild(this.element),this.element=null):this.updateOverlay())}updateOverlay(){let e,t,n=this.editorView.state.doc.resolve(this.cursorPos),r=!n.parent.inlineContent,i,s=this.editorView.dom,o=s.getBoundingClientRect(),a=o.width/s.offsetWidth,l=o.height/s.offsetHeight;if(r){let e=n.nodeBefore,t=n.nodeAfter;if(e||t){let n=this.editorView.nodeDOM(this.cursorPos-(e?e.nodeSize:0));if(n){let r=n.getBoundingClientRect(),s=e?r.bottom:r.top;e&&t&&(s=(s+this.editorView.nodeDOM(this.cursorPos).getBoundingClientRect().top)/2);let o=this.width/2*l;i={left:r.left,right:r.right,top:s-o,bottom:s+o}}}}if(!i){let e=this.editorView.coordsAtPos(this.cursorPos),t=this.width/2*a;i={left:e.left-t,right:e.left+t,top:e.top,bottom:e.bottom}}let c=this.editorView.dom.offsetParent;if(!this.element&&(this.element=c.appendChild(document.createElement("div")),this.class&&(this.element.className=this.class),this.element.style.cssText="position: absolute; z-index: 50; pointer-events: none;",this.color&&(this.element.style.backgroundColor=this.color)),this.element.classList.toggle("prosemirror-dropcursor-block",r),this.element.classList.toggle("prosemirror-dropcursor-inline",!r),c&&(c!=document.body||"static"!=getComputedStyle(c).position)){let n=c.getBoundingClientRect(),r=n.width/c.offsetWidth,i=n.height/c.offsetHeight;e=n.left-c.scrollLeft*r,t=n.top-c.scrollTop*i}else e=-pageXOffset,t=-pageYOffset;this.element.style.left=(i.left-e)/a+"px",this.element.style.top=(i.top-t)/l+"px",this.element.style.width=(i.right-i.left)/a+"px",this.element.style.height=(i.bottom-i.top)/l+"px"}scheduleRemoval(e){clearTimeout(this.timeout),this.timeout=setTimeout(()=>this.setCursor(null),e)}dragover(e){if(!this.editorView.editable)return;let t=this.editorView.posAtCoords({left:e.clientX,top:e.clientY}),n=t&&t.inside>=0&&this.editorView.state.doc.nodeAt(t.inside),r=n&&n.type.spec.disableDropCursor,i="function"==typeof r?r(this.editorView,t,e):r;if(t&&!i){let e=t.pos;if(this.editorView.dragging&&this.editorView.dragging.slice){let t=dC(this.editorView.state.doc,e,this.editorView.dragging.slice);null!=t&&(e=t)}this.setCursor(e),this.scheduleRemoval(5e3)}}dragend(){this.scheduleRemoval(20)}drop(){this.scheduleRemoval(20)}dragleave(e){this.editorView.dom.contains(e.relatedTarget)||this.setCursor(null)}}let gn=fF.create({name:"dropCursor",addOptions:()=>({color:"currentColor",width:1,class:void 0}),addProseMirrorPlugins(){return[function(e={}){return new d3({view:t=>new gt(t,e)})}(this.options)]}});class gr extends d_{constructor(e){super(e,e)}map(e,t){let n=e.resolve(t.map(this.head));return gr.valid(n)?new gr(n):d_.near(n)}content(){return cw.empty}eq(e){return e instanceof gr&&e.head==this.head}toJSON(){return{type:"gapcursor",pos:this.head}}static fromJSON(e,t){if("number"!=typeof t.pos)throw RangeError("Invalid input for GapCursor.fromJSON");return new gr(e.resolve(t.pos))}getBookmark(){return new gi(this.anchor)}static valid(e){let t=e.parent;if(t.isTextblock||!function(e){for(let t=e.depth;t>=0;t--){let n=e.index(t),r=e.node(t);if(0==n){if(r.type.spec.isolating)return!0;continue}for(let e=r.child(n-1);;e=e.lastChild){if(0==e.childCount&&!e.inlineContent||e.isAtom||e.type.spec.isolating)return!0;if(e.inlineContent)return!1}}return!0}(e)||!function(e){for(let t=e.depth;t>=0;t--){let n=e.indexAfter(t),r=e.node(t);if(n==r.childCount){if(r.type.spec.isolating)return!0;continue}for(let e=r.child(n);;e=e.firstChild){if(0==e.childCount&&!e.inlineContent||e.isAtom||e.type.spec.isolating)return!0;if(e.inlineContent)return!1}}return!0}(e))return!1;let n=t.type.spec.allowGapCursor;if(null!=n)return n;let r=t.contentMatchAt(e.index()).defaultType;return r&&r.isTextblock}static findGapCursorFrom(e,t,n=!1){r:for(;;){if(!n&&gr.valid(e))return e;let r=e.pos,i=null;for(let n=e.depth;;n--){let s=e.node(n);if(t>0?e.indexAfter(n)<s.childCount:e.index(n)>0){i=s.child(t>0?e.indexAfter(n):e.index(n)-1);break}if(0==n)return null;r+=t;let o=e.doc.resolve(r);if(gr.valid(o))return o}for(;;){let s=t>0?i.firstChild:i.lastChild;if(!s){if(i.isAtom&&!i.isText&&!dU.isSelectable(i)){e=e.doc.resolve(r+i.nodeSize*t),n=!1;continue r}break}i=s,r+=t;let o=e.doc.resolve(r);if(gr.valid(o))return o}return null}}}gr.prototype.visible=!1,gr.findFrom=gr.findGapCursorFrom,d_.jsonID("gapcursor",gr);class gi{constructor(e){this.pos=e}map(e){return new gi(e.map(this.pos))}resolve(e){let t=e.resolve(this.pos);return gr.valid(t)?new gr(t):d_.near(t)}}let gs=p$({ArrowLeft:go("horiz",-1),ArrowRight:go("horiz",1),ArrowUp:go("vert",-1),ArrowDown:go("vert",1)});function go(e,t){let n="vert"==e?t>0?"down":"up":t>0?"right":"left";return function(e,r,i){let s=e.selection,o=t>0?s.$to:s.$from,a=s.empty;if(s instanceof dq){if(!i.endOfTextblock(n)||0==o.depth)return!1;a=!1,o=e.doc.resolve(t>0?o.after():o.before())}let l=gr.findGapCursorFrom(o,t,a);return!!l&&(r&&r(e.tr.setSelection(new gr(l))),!0)}}function ga(e,t,n){if(!e||!e.editable)return!1;let r=e.state.doc.resolve(t);if(!gr.valid(r))return!1;let i=e.posAtCoords({left:n.clientX,top:n.clientY});return!(i&&i.inside>-1&&dU.isSelectable(e.state.doc.nodeAt(i.inside)))&&(e.dispatch(e.state.tr.setSelection(new gr(r))),!0)}function gl(e,t){if("insertCompositionText"!=t.inputType||!(e.state.selection instanceof gr))return!1;let{$from:n}=e.state.selection,r=n.parent.contentMatchAt(n.index()).findWrapping(e.state.schema.nodes.text);if(!r)return!1;let i=cm.empty;for(let e=r.length-1;e>=0;e--)i=cm.from(r[e].createAndFill(null,i));let s=e.state.tr.replace(n.pos,n.pos,new cw(i,0,0));return s.setSelection(dq.near(s.doc.resolve(n.pos+1))),e.dispatch(s),!1}function gc(e){if(!(e.selection instanceof gr))return null;let t=document.createElement("div");return t.className="ProseMirror-gapcursor",pt.create(e.doc,[h9.widget(e.selection.head,t,{key:"gapcursor"})])}let gd=fF.create({name:"gapCursor",addProseMirrorPlugins:()=>[new d3({props:{decorations:gc,createSelectionBetween:(e,t,n)=>t.pos==n.pos&&gr.valid(n)?new gr(n):null,handleClick:ga,handleKeyDown:gs,handleDOMEvents:{beforeinput:gl}}})],extendNodeSchema(e){var t;let n={name:e.name,options:e.options,storage:e.storage};return{allowGapCursor:null!=(t=fw(ff(e,"allowGapCursor",n)))?t:null}}}),gu=mN.create({name:"hardBreak",addOptions:()=>({keepMarks:!0,HTMLAttributes:{}}),inline:!0,group:"inline",selectable:!1,linebreakReplacement:!0,parseHTML:()=>[{tag:"br"}],renderHTML({HTMLAttributes:e}){return["br",fx(this.options.HTMLAttributes,e)]},renderText:()=>"\n",addCommands(){return{setHardBreak:()=>({commands:e,chain:t,state:n,editor:r})=>e.first([()=>e.exitCode(),()=>e.command(()=>{let{selection:e,storedMarks:i}=n;if(e.$from.parent.type.spec.isolating)return!1;let{keepMarks:s}=this.options,{splittableMarks:o}=r.extensionManager,a=i||e.$to.parentOffset&&e.$from.marks();return t().insertContent({type:this.name}).command(({tr:e,dispatch:t})=>{if(t&&a&&s){let t=a.filter(e=>o.includes(e.type.name));e.ensureMarks(t)}return!0}).run()})])}},addKeyboardShortcuts(){return{"Mod-Enter":()=>this.editor.commands.setHardBreak(),"Shift-Enter":()=>this.editor.commands.setHardBreak()}}}),gh=mN.create({name:"heading",addOptions:()=>({levels:[1,2,3,4,5,6],HTMLAttributes:{}}),content:"inline*",group:"block",defining:!0,addAttributes:()=>({level:{default:1,rendered:!1}}),parseHTML(){return this.options.levels.map(e=>({tag:`h${e}`,attrs:{level:e}}))},renderHTML({node:e,HTMLAttributes:t}){let n=this.options.levels.includes(e.attrs.level)?e.attrs.level:this.options.levels[0];return[`h${n}`,fx(this.options.HTMLAttributes,t),0]},addCommands(){return{setHeading:e=>({commands:t})=>!!this.options.levels.includes(e.level)&&t.setNode(this.name,e),toggleHeading:e=>({commands:t})=>!!this.options.levels.includes(e.level)&&t.toggleNode(this.name,"paragraph",e)}},addKeyboardShortcuts(){return this.options.levels.reduce((e,t)=>({...e,...{[`Mod-Alt-${t}`]:()=>this.editor.commands.toggleHeading({level:t})}}),{})},addInputRules(){return this.options.levels.map(e=>mk({find:RegExp(`^(#{${Math.min(...this.options.levels)},${e}})\\s$`),type:this.type,getAttributes:{level:e}}))}});var gp=function(){};gp.prototype.append=function(e){return e.length?(e=gp.from(e),!this.length&&e||e.length<200&&this.leafAppend(e)||this.length<200&&e.leafPrepend(this)||this.appendInner(e)):this},gp.prototype.prepend=function(e){return e.length?gp.from(e).append(this):this},gp.prototype.appendInner=function(e){return new gm(this,e)},gp.prototype.slice=function(e,t){return(void 0===e&&(e=0),void 0===t&&(t=this.length),e>=t)?gp.empty:this.sliceInner(Math.max(0,e),Math.min(this.length,t))},gp.prototype.get=function(e){if(!(e<0)&&!(e>=this.length))return this.getInner(e)},gp.prototype.forEach=function(e,t,n){void 0===t&&(t=0),void 0===n&&(n=this.length),t<=n?this.forEachInner(e,t,n,0):this.forEachInvertedInner(e,t,n,0)},gp.prototype.map=function(e,t,n){void 0===t&&(t=0),void 0===n&&(n=this.length);var r=[];return this.forEach(function(t,n){return r.push(e(t,n))},t,n),r},gp.from=function(e){return e instanceof gp?e:e&&e.length?new gf(e):gp.empty};var gf=function(e){function t(t){e.call(this),this.values=t}e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t;var n={length:{configurable:!0},depth:{configurable:!0}};return t.prototype.flatten=function(){return this.values},t.prototype.sliceInner=function(e,n){return 0==e&&n==this.length?this:new t(this.values.slice(e,n))},t.prototype.getInner=function(e){return this.values[e]},t.prototype.forEachInner=function(e,t,n,r){for(var i=t;i<n;i++)if(!1===e(this.values[i],r+i))return!1},t.prototype.forEachInvertedInner=function(e,t,n,r){for(var i=t-1;i>=n;i--)if(!1===e(this.values[i],r+i))return!1},t.prototype.leafAppend=function(e){if(this.length+e.length<=200)return new t(this.values.concat(e.flatten()))},t.prototype.leafPrepend=function(e){if(this.length+e.length<=200)return new t(e.flatten().concat(this.values))},n.length.get=function(){return this.values.length},n.depth.get=function(){return 0},Object.defineProperties(t.prototype,n),t}(gp);gp.empty=new gf([]);var gm=function(e){function t(t,n){e.call(this),this.left=t,this.right=n,this.length=t.length+n.length,this.depth=Math.max(t.depth,n.depth)+1}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.flatten=function(){return this.left.flatten().concat(this.right.flatten())},t.prototype.getInner=function(e){return e<this.left.length?this.left.get(e):this.right.get(e-this.left.length)},t.prototype.forEachInner=function(e,t,n,r){var i=this.left.length;if(t<i&&!1===this.left.forEachInner(e,t,Math.min(n,i),r)||n>i&&!1===this.right.forEachInner(e,Math.max(t-i,0),Math.min(this.length,n)-i,r+i))return!1},t.prototype.forEachInvertedInner=function(e,t,n,r){var i=this.left.length;if(t>i&&!1===this.right.forEachInvertedInner(e,t-i,Math.max(n,i)-i,r+i)||n<i&&!1===this.left.forEachInvertedInner(e,Math.min(t,i),n,r))return!1},t.prototype.sliceInner=function(e,t){if(0==e&&t==this.length)return this;var n=this.left.length;return t<=n?this.left.slice(e,t):e>=n?this.right.slice(e-n,t-n):this.left.slice(e,n).append(this.right.slice(0,t-n))},t.prototype.leafAppend=function(e){var n=this.right.leafAppend(e);if(n)return new t(this.left,n)},t.prototype.leafPrepend=function(e){var n=this.left.leafPrepend(e);if(n)return new t(n,this.right)},t.prototype.appendInner=function(e){return this.left.depth>=Math.max(this.right.depth,e.depth)+1?new t(this.left,new t(this.right,e)):new t(this,e)},t}(gp);class gg{constructor(e,t){this.items=e,this.eventCount=t}popEvent(e,t){let n,r,i,s;if(0==this.eventCount)return null;let o=this.items.length;for(;;o--)if(this.items.get(o-1).selection){--o;break}t&&(r=(n=this.remapping(o,this.items.length)).maps.length);let a=e.tr,l=[],c=[];return this.items.forEach((e,t)=>{if(!e.step){n||(r=(n=this.remapping(o,t+1)).maps.length),r--,c.push(e);return}if(n){c.push(new gy(e.map));let t=e.step.map(n.slice(r)),i;t&&a.maybeStep(t).doc&&(i=a.mapping.maps[a.mapping.maps.length-1],l.push(new gy(i,void 0,void 0,l.length+c.length))),r--,i&&n.appendMap(i,r)}else a.maybeStep(e.step);if(e.selection)return i=n?e.selection.map(n.slice(r)):e.selection,s=new gg(this.items.slice(0,o).append(c.reverse().concat(l)),this.eventCount-1),!1},this.items.length,0),{remaining:s,transform:a,selection:i}}addTransform(e,t,n,r){var i,s;let o,a=[],l=this.eventCount,c=this.items,d=!r&&c.length?c.get(c.length-1):null;for(let n=0;n<e.steps.length;n++){let i=e.steps[n].invert(e.docs[n]),s=new gy(e.mapping.maps[n],i,t),o;(o=d&&d.merge(s))&&(s=o,n?a.pop():c=c.slice(0,c.length-1)),a.push(s),t&&(l++,t=void 0),r||(d=s)}let u=l-n.depth;return u>gv&&(i=c,s=u,i.forEach((e,t)=>{if(e.selection&&0==s--)return o=t,!1}),c=i.slice(o),l-=u),new gg(c.append(a),l)}remapping(e,t){let n=new dr;return this.items.forEach((t,r)=>{let i=null!=t.mirrorOffset&&r-t.mirrorOffset>=e?n.maps.length-t.mirrorOffset:void 0;n.appendMap(t.map,i)},e,t),n}addMaps(e){return 0==this.eventCount?this:new gg(this.items.append(e.map(e=>new gy(e))),this.eventCount)}rebased(e,t){if(!this.eventCount)return this;let n=[],r=Math.max(0,this.items.length-t),i=e.mapping,s=e.steps.length,o=this.eventCount;this.items.forEach(e=>{e.selection&&o--},r);let a=t;this.items.forEach(t=>{let r=i.getMirror(--a);if(null==r)return;s=Math.min(s,r);let l=i.maps[r];if(t.step){let s=e.steps[r].invert(e.docs[r]),c=t.selection&&t.selection.map(i.slice(a+1,r));c&&o++,n.push(new gy(l,s,c))}else n.push(new gy(l))},r);let l=[];for(let e=t;e<s;e++)l.push(new gy(i.maps[e]));let c=new gg(this.items.slice(0,r).append(l).append(n),o);return c.emptyItemCount()>500&&(c=c.compress(this.items.length-n.length)),c}emptyItemCount(){let e=0;return this.items.forEach(t=>{!t.step&&e++}),e}compress(e=this.items.length){let t=this.remapping(0,e),n=t.maps.length,r=[],i=0;return this.items.forEach((s,o)=>{if(o>=e)r.push(s),s.selection&&i++;else if(s.step){let e=s.step.map(t.slice(n)),o=e&&e.getMap();if(n--,o&&t.appendMap(o,n),e){let a=s.selection&&s.selection.map(t.slice(n));a&&i++;let l=new gy(o.invert(),e,a),c,d=r.length-1;(c=r.length&&r[d].merge(l))?r[d]=c:r.push(l)}}else s.map&&n--},this.items.length,0),new gg(gp.from(r.reverse()),i)}}gg.empty=new gg(gp.empty,0);class gy{constructor(e,t,n,r){this.map=e,this.step=t,this.selection=n,this.mirrorOffset=r}merge(e){if(this.step&&e.step&&!e.selection){let t=e.step.merge(this.step);if(t)return new gy(t.getMap().invert(),t,this.selection)}}}class gx{constructor(e,t,n,r,i){this.done=e,this.undone=t,this.prevRanges=n,this.prevTime=r,this.prevComposition=i}}let gv=20;function gb(e){let t=[];for(let n=e.length-1;n>=0&&0==t.length;n--)e[n].forEach((e,n,r,i)=>t.push(r,i));return t}function gw(e,t){if(!e)return null;let n=[];for(let r=0;r<e.length;r+=2){let i=t.map(e[r],1),s=t.map(e[r+1],-1);i<=s&&n.push(i,s)}return n}let gk=!1,gj=null;function gN(e){let t=e.plugins;if(gj!=t){gk=!1,gj=t;for(let e=0;e<t.length;e++)if(t[e].spec.historyPreserveItems){gk=!0;break}}return gk}let gS=new d8("history"),gC=new d8("closeHistory");function gM(e,t){return(n,r)=>{let i=gS.getState(n);if(!i||0==(e?i.undone:i.done).eventCount)return!1;if(r){let s=function(e,t,n){let r=gN(t),i=gS.get(t).spec.config,s=(n?e.undone:e.done).popEvent(t,r);if(!s)return null;let o=s.selection.resolve(s.transform.doc),a=(n?e.done:e.undone).addTransform(s.transform,t.selection.getBookmark(),i,r),l=new gx(n?a:s.remaining,n?s.remaining:a,null,0,-1);return s.transform.setSelection(o).setMeta(gS,{redo:n,historyState:l})}(i,n,e);s&&r(t?s.scrollIntoView():s)}return!0}}let gE=gM(!1,!0),gT=gM(!0,!0);gM(!1,!1),gM(!0,!1);let gA=fF.create({name:"history",addOptions:()=>({depth:100,newGroupDelay:500}),addCommands:()=>({undo:()=>({state:e,dispatch:t})=>gE(e,t),redo:()=>({state:e,dispatch:t})=>gT(e,t)}),addProseMirrorPlugins(){return[function(e={}){return new d3({key:gS,state:{init:()=>new gx(gg.empty,gg.empty,null,0,-1),apply:(t,n,r)=>(function(e,t,n,r){let i=n.getMeta(gS),s;if(i)return i.historyState;n.getMeta(gC)&&(e=new gx(e.done,e.undone,null,0,-1));let o=n.getMeta("appendedTransaction");if(0==n.steps.length)return e;if(o&&o.getMeta(gS))if(o.getMeta(gS).redo)return new gx(e.done.addTransform(n,void 0,r,gN(t)),e.undone,gb(n.mapping.maps),e.prevTime,e.prevComposition);else return new gx(e.done,e.undone.addTransform(n,void 0,r,gN(t)),null,e.prevTime,e.prevComposition);if(!1===n.getMeta("addToHistory")||o&&!1===o.getMeta("addToHistory"))if(s=n.getMeta("rebased"))return new gx(e.done.rebased(n,s),e.undone.rebased(n,s),gw(e.prevRanges,n.mapping),e.prevTime,e.prevComposition);else return new gx(e.done.addMaps(n.mapping.maps),e.undone.addMaps(n.mapping.maps),gw(e.prevRanges,n.mapping),e.prevTime,e.prevComposition);{let i=n.getMeta("composition"),s=0==e.prevTime||!o&&e.prevComposition!=i&&(e.prevTime<(n.time||0)-r.newGroupDelay||!function(e,t){if(!t)return!1;if(!e.docChanged)return!0;let n=!1;return e.mapping.maps[0].forEach((e,r)=>{for(let i=0;i<t.length;i+=2)e<=t[i+1]&&r>=t[i]&&(n=!0)}),n}(n,e.prevRanges)),a=o?gw(e.prevRanges,n.mapping):gb(n.mapping.maps);return new gx(e.done.addTransform(n,s?t.selection.getBookmark():void 0,r,gN(t)),gg.empty,a,n.time,null==i?e.prevComposition:i)}})(n,r,t,e)},config:e={depth:e.depth||100,newGroupDelay:e.newGroupDelay||500},props:{handleDOMEvents:{beforeinput(e,t){let n=t.inputType,r="historyUndo"==n?gE:"historyRedo"==n?gT:null;return!!r&&(t.preventDefault(),r(e.state,e.dispatch))}}}})}(this.options)]},addKeyboardShortcuts(){return{"Mod-z":()=>this.editor.commands.undo(),"Shift-Mod-z":()=>this.editor.commands.redo(),"Mod-y":()=>this.editor.commands.redo(),"Mod-":()=>this.editor.commands.undo(),"Shift-Mod-":()=>this.editor.commands.redo()}}}),gD=mN.create({name:"horizontalRule",addOptions:()=>({HTMLAttributes:{}}),group:"block",parseHTML:()=>[{tag:"hr"}],renderHTML({HTMLAttributes:e}){return["hr",fx(this.options.HTMLAttributes,e)]},addCommands(){return{setHorizontalRule:()=>({chain:e,state:t})=>{if(!function(e,t){let{selection:n}=e,{$from:r}=n;if(n instanceof dU){let e=r.index();return r.parent.canReplaceWith(e,e+1,t)}let i=r.depth;for(;i>=0;){let e=r.index(i);if(r.node(i).contentMatchAt(e).matchType(t))return!0;i-=1}return!1}(t,t.schema.nodes[this.name]))return!1;let{selection:n}=t,{$from:r,$to:i}=n,s=e();return 0===r.parentOffset?s.insertContentAt({from:Math.max(r.pos-1,0),to:i.pos},{type:this.name}):n instanceof dU?s.insertContentAt(i.pos,{type:this.name}):s.insertContent({type:this.name}),s.command(({tr:e,dispatch:t})=>{var n;if(t){let{$to:t}=e.selection,r=t.end();if(t.nodeAfter)t.nodeAfter.isTextblock?e.setSelection(dq.create(e.doc,t.pos+1)):t.nodeAfter.isBlock?e.setSelection(dU.create(e.doc,t.pos)):e.setSelection(dq.create(e.doc,t.pos));else{let i=null==(n=t.parent.type.contentMatch.defaultType)?void 0:n.create();i&&(e.insert(r,i),e.setSelection(dq.create(e.doc,r+1)))}e.scrollIntoView()}return!0}).run()}}},addInputRules(){var e;return[new fA({find:(e={find:/^(?:---|-|___\s|\*\*\*\s)$/,type:this.type}).find,handler:({state:t,range:n,match:r})=>{let i=fw(e.getAttributes,void 0,r)||{},{tr:s}=t,o=n.from,a=n.to,l=e.type.create(i);if(r[1]){let e=o+r[0].lastIndexOf(r[1]);e>a?e=a:a=e+r[1].length;let t=r[0][r[0].length-1];s.insertText(t,o+r[0].length-1),s.replaceWith(e,a,l)}else if(r[0]){let t=e.type.isInline?o:o-1;s.insert(t,e.type.create(i)).delete(s.mapping.map(o),s.mapping.map(a))}s.scrollIntoView()}})]}}),gO=/(?:^|\s)(\*(?!\s+\*)((?:[^*]+))\*(?!\s+\*))$/,gR=/(?:^|\s)(\*(?!\s+\*)((?:[^*]+))\*(?!\s+\*))/g,gP=/(?:^|\s)(_(?!\s+_)((?:[^_]+))_(?!\s+_))$/,gI=/(?:^|\s)(_(?!\s+_)((?:[^_]+))_(?!\s+_))/g,gL=fI.create({name:"italic",addOptions:()=>({HTMLAttributes:{}}),parseHTML(){return[{tag:"em"},{tag:"i",getAttrs:e=>"normal"!==e.style.fontStyle&&null},{style:"font-style=normal",clearMark:e=>e.type.name===this.name},{style:"font-style=italic"}]},renderHTML({HTMLAttributes:e}){return["em",fx(this.options.HTMLAttributes,e),0]},addCommands(){return{setItalic:()=>({commands:e})=>e.setMark(this.name),toggleItalic:()=>({commands:e})=>e.toggleMark(this.name),unsetItalic:()=>({commands:e})=>e.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-i":()=>this.editor.commands.toggleItalic(),"Mod-I":()=>this.editor.commands.toggleItalic()}},addInputRules(){return[mw({find:gO,type:this.type}),mw({find:gP,type:this.type})]},addPasteRules(){return[mS({find:gR,type:this.type}),mS({find:gI,type:this.type})]}}),gz=mN.create({name:"listItem",addOptions:()=>({HTMLAttributes:{},bulletListTypeName:"bulletList",orderedListTypeName:"orderedList"}),content:"paragraph block*",defining:!0,parseHTML:()=>[{tag:"li"}],renderHTML({HTMLAttributes:e}){return["li",fx(this.options.HTMLAttributes,e),0]},addKeyboardShortcuts(){return{Enter:()=>this.editor.commands.splitListItem(this.name),Tab:()=>this.editor.commands.sinkListItem(this.name),"Shift-Tab":()=>this.editor.commands.liftListItem(this.name)}}}),gV="textStyle",g$=/^(\d+)\.\s$/,g_=mN.create({name:"orderedList",addOptions:()=>({itemTypeName:"listItem",HTMLAttributes:{},keepMarks:!1,keepAttributes:!1}),group:"block list",content(){return`${this.options.itemTypeName}+`},addAttributes:()=>({start:{default:1,parseHTML:e=>e.hasAttribute("start")?parseInt(e.getAttribute("start")||"",10):1},type:{default:null,parseHTML:e=>e.getAttribute("type")}}),parseHTML:()=>[{tag:"ol"}],renderHTML({HTMLAttributes:e}){let{start:t,...n}=e;return 1===t?["ol",fx(this.options.HTMLAttributes,n),0]:["ol",fx(this.options.HTMLAttributes,e),0]},addCommands(){return{toggleOrderedList:()=>({commands:e,chain:t})=>this.options.keepAttributes?t().toggleList(this.name,this.options.itemTypeName,this.options.keepMarks).updateAttributes("listItem",this.editor.getAttributes(gV)).run():e.toggleList(this.name,this.options.itemTypeName,this.options.keepMarks)}},addKeyboardShortcuts(){return{"Mod-Shift-7":()=>this.editor.commands.toggleOrderedList()}},addInputRules(){let e=mj({find:g$,type:this.type,getAttributes:e=>({start:+e[1]}),joinPredicate:(e,t)=>t.childCount+t.attrs.start===+e[1]});return(this.options.keepMarks||this.options.keepAttributes)&&(e=mj({find:g$,type:this.type,keepMarks:this.options.keepMarks,keepAttributes:this.options.keepAttributes,getAttributes:e=>({start:+e[1],...this.editor.getAttributes(gV)}),joinPredicate:(e,t)=>t.childCount+t.attrs.start===+e[1],editor:this.editor})),[e]}}),gF=mN.create({name:"paragraph",priority:1e3,addOptions:()=>({HTMLAttributes:{}}),group:"block",content:"inline*",parseHTML:()=>[{tag:"p"}],renderHTML({HTMLAttributes:e}){return["p",fx(this.options.HTMLAttributes,e),0]},addCommands(){return{setParagraph:()=>({commands:e})=>e.setNode(this.name)}},addKeyboardShortcuts(){return{"Mod-Alt-0":()=>this.editor.commands.setParagraph()}}}),gB=/(?:^|\s)(~~(?!\s+~~)((?:[^~]+))~~(?!\s+~~))$/,gW=/(?:^|\s)(~~(?!\s+~~)((?:[^~]+))~~(?!\s+~~))/g,gq=fI.create({name:"strike",addOptions:()=>({HTMLAttributes:{}}),parseHTML:()=>[{tag:"s"},{tag:"del"},{tag:"strike"},{style:"text-decoration",consuming:!1,getAttrs:e=>!!e.includes("line-through")&&{}}],renderHTML({HTMLAttributes:e}){return["s",fx(this.options.HTMLAttributes,e),0]},addCommands(){return{setStrike:()=>({commands:e})=>e.setMark(this.name),toggleStrike:()=>({commands:e})=>e.toggleMark(this.name),unsetStrike:()=>({commands:e})=>e.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-Shift-s":()=>this.editor.commands.toggleStrike()}},addInputRules(){return[mw({find:gB,type:this.type})]},addPasteRules(){return[mS({find:gW,type:this.type})]}}),gH=mN.create({name:"text",group:"inline"}),gU=fF.create({name:"starterKit",addExtensions(){let e=[];return!1!==this.options.bold&&e.push(m0.configure(this.options.bold)),!1!==this.options.blockquote&&e.push(mG.configure(this.options.blockquote)),!1!==this.options.bulletList&&e.push(m4.configure(this.options.bulletList)),!1!==this.options.code&&e.push(m6.configure(this.options.code)),!1!==this.options.codeBlock&&e.push(m7.configure(this.options.codeBlock)),!1!==this.options.document&&e.push(ge.configure(this.options.document)),!1!==this.options.dropcursor&&e.push(gn.configure(this.options.dropcursor)),!1!==this.options.gapcursor&&e.push(gd.configure(this.options.gapcursor)),!1!==this.options.hardBreak&&e.push(gu.configure(this.options.hardBreak)),!1!==this.options.heading&&e.push(gh.configure(this.options.heading)),!1!==this.options.history&&e.push(gA.configure(this.options.history)),!1!==this.options.horizontalRule&&e.push(gD.configure(this.options.horizontalRule)),!1!==this.options.italic&&e.push(gL.configure(this.options.italic)),!1!==this.options.listItem&&e.push(gz.configure(this.options.listItem)),!1!==this.options.orderedList&&e.push(g_.configure(this.options.orderedList)),!1!==this.options.paragraph&&e.push(gF.configure(this.options.paragraph)),!1!==this.options.strike&&e.push(gq.configure(this.options.strike)),!1!==this.options.text&&e.push(gH.configure(this.options.text)),e}}),gK=fF.create({name:"placeholder",addOptions:()=>({emptyEditorClass:"is-editor-empty",emptyNodeClass:"is-empty",placeholder:"Write something ",showOnlyWhenEditable:!0,showOnlyCurrent:!0,includeChildren:!1}),addProseMirrorPlugins(){return[new d3({key:new d8("placeholder"),props:{decorations:({doc:e,selection:t})=>{let n=this.editor.isEditable||!this.options.showOnlyWhenEditable,{anchor:r}=t,i=[];if(!n)return null;let s=this.editor.isEmpty;return e.descendants((e,t)=>{let n=r>=t&&r<=t+e.nodeSize,o=!e.isLeaf&&ms(e);if((n||!this.options.showOnlyCurrent)&&o){let r=[this.options.emptyNodeClass];s&&r.push(this.options.emptyEditorClass);let o=h9.node(t,t+e.nodeSize,{class:r.join(" "),"data-placeholder":"function"==typeof this.options.placeholder?this.options.placeholder({editor:this.editor,node:e,pos:t,hasAnchor:n}):this.options.placeholder});i.push(o)}return this.options.includeChildren}),pt.create(e,i)}}})]}}),gJ=(0,K.A)("Bold",[["path",{d:"M6 12h9a4 4 0 0 1 0 8H7a1 1 0 0 1-1-1V5a1 1 0 0 1 1-1h7a4 4 0 0 1 0 8",key:"mg9rjx"}]]),gG=(0,K.A)("Italic",[["line",{x1:"19",x2:"10",y1:"4",y2:"4",key:"15jd3p"}],["line",{x1:"14",x2:"5",y1:"20",y2:"20",key:"bu0au3"}],["line",{x1:"15",x2:"9",y1:"4",y2:"20",key:"uljnxc"}]]),gY=(0,K.A)("Strikethrough",[["path",{d:"M16 4H9a3 3 0 0 0-2.83 4",key:"43sutm"}],["path",{d:"M14 12a4 4 0 0 1 0 8H6",key:"nlfj13"}],["line",{x1:"4",x2:"20",y1:"12",y2:"12",key:"1e0a9i"}]]),gX=(0,K.A)("Heading1",[["path",{d:"M4 12h8",key:"17cfdx"}],["path",{d:"M4 18V6",key:"1rz3zl"}],["path",{d:"M12 18V6",key:"zqpxq5"}],["path",{d:"m17 12 3-2v8",key:"1hhhft"}]]),gZ=(0,K.A)("Heading2",[["path",{d:"M4 12h8",key:"17cfdx"}],["path",{d:"M4 18V6",key:"1rz3zl"}],["path",{d:"M12 18V6",key:"zqpxq5"}],["path",{d:"M21 18h-4c0-4 4-3 4-6 0-1.5-2-2.5-4-1",key:"9jr5yi"}]]),gQ=(0,K.A)("Heading3",[["path",{d:"M4 12h8",key:"17cfdx"}],["path",{d:"M4 18V6",key:"1rz3zl"}],["path",{d:"M12 18V6",key:"zqpxq5"}],["path",{d:"M17.5 10.5c1.7-1 3.5 0 3.5 1.5a2 2 0 0 1-2 2",key:"68ncm8"}],["path",{d:"M17 17.5c2 1.5 4 .3 4-1.5a2 2 0 0 0-2-2",key:"1ejuhz"}]]),g0=(0,K.A)("ListOrdered",[["path",{d:"M10 12h11",key:"6m4ad9"}],["path",{d:"M10 18h11",key:"11hvi2"}],["path",{d:"M10 6h11",key:"c7qv1k"}],["path",{d:"M4 10h2",key:"16xx2s"}],["path",{d:"M4 6h1v4",key:"cnovpq"}],["path",{d:"M6 18H4c0-1 2-2 2-3s-1-1.5-2-1",key:"m9a95d"}]]),g1=(0,K.A)("Minus",[["path",{d:"M5 12h14",key:"1ays0h"}]]),g2=(0,K.A)("Undo",[["path",{d:"M3 7v6h6",key:"1v2h90"}],["path",{d:"M21 17a9 9 0 0 0-9-9 9 9 0 0 0-6 2.3L3 13",key:"1r6uu6"}]]),g4=(0,K.A)("Redo",[["path",{d:"M21 7v6h-6",key:"3ptur4"}],["path",{d:"M3 17a9 9 0 0 1 9-9 9 9 0 0 1 6 2.3l3 2.7",key:"1kgawr"}]]);var g3=globalThis?.document?h.useLayoutEffect:()=>{},g5=p[" useInsertionEffect ".trim().toString()]||g3;function g6(e,t){if("function"==typeof e)return e(t);null!=e&&(e.current=t)}Symbol("RADIX:SYNC_STATE");var g8=Symbol("radix.slottable");function g9(e){return h.isValidElement(e)&&"function"==typeof e.type&&"__radixId"in e.type&&e.type.__radixId===g8}var g7=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"].reduce((e,t)=>{let n=function(e){let t=function(e){let t=h.forwardRef((e,t)=>{let{children:n,...r}=e;if(h.isValidElement(n)){var i;let e,s,o=(i=n,(s=(e=Object.getOwnPropertyDescriptor(i.props,"ref")?.get)&&"isReactWarning"in e&&e.isReactWarning)?i.ref:(s=(e=Object.getOwnPropertyDescriptor(i,"ref")?.get)&&"isReactWarning"in e&&e.isReactWarning)?i.props.ref:i.props.ref||i.ref),a=function(e,t){let n={...t};for(let r in t){let i=e[r],s=t[r];/^on[A-Z]/.test(r)?i&&s?n[r]=(...e)=>{let t=s(...e);return i(...e),t}:i&&(n[r]=i):"style"===r?n[r]={...i,...s}:"className"===r&&(n[r]=[i,s].filter(Boolean).join(" "))}return{...e,...n}}(r,n.props);return n.type!==h.Fragment&&(a.ref=t?function(...e){return t=>{let n=!1,r=e.map(e=>{let r=g6(e,t);return n||"function"!=typeof r||(n=!0),r});if(n)return()=>{for(let t=0;t<r.length;t++){let n=r[t];"function"==typeof n?n():g6(e[t],null)}}}}(t,o):o),h.cloneElement(n,a)}return h.Children.count(n)>1?h.Children.only(null):null});return t.displayName=`${e}.SlotClone`,t}(e),n=h.forwardRef((e,n)=>{let{children:r,...i}=e,s=h.Children.toArray(r),o=s.find(g9);if(o){let e=o.props.children,r=s.map(t=>t!==o?t:h.Children.count(e)>1?h.Children.only(null):h.isValidElement(e)?e.props.children:null);return(0,u.jsx)(t,{...i,ref:n,children:h.isValidElement(e)?h.cloneElement(e,void 0,r):null})}return(0,u.jsx)(t,{...i,ref:n,children:r})});return n.displayName=`${e}.Slot`,n}(`Primitive.${t}`),r=h.forwardRef((e,r)=>{let{asChild:i,...s}=e;return"undefined"!=typeof window&&(window[Symbol.for("radix-ui")]=!0),(0,u.jsx)(i?n:t,{...s,ref:r})});return r.displayName=`Primitive.${t}`,{...e,[t]:r}},{}),ye="Toggle",yt=h.forwardRef((e,t)=>{let{pressed:n,defaultPressed:r,onPressedChange:i,...s}=e,[o,a]=function({prop:e,defaultProp:t,onChange:n=()=>{},caller:r}){let[i,s,o]=function({defaultProp:e,onChange:t}){let[n,r]=h.useState(e),i=h.useRef(n),s=h.useRef(t);return g5(()=>{s.current=t},[t]),h.useEffect(()=>{i.current!==n&&(s.current?.(n),i.current=n)},[n,i]),[n,r,s]}({defaultProp:t,onChange:n}),a=void 0!==e,l=a?e:i;{let t=h.useRef(void 0!==e);h.useEffect(()=>{let e=t.current;if(e!==a){let t=a?"controlled":"uncontrolled";console.warn(`${r} is changing from ${e?"controlled":"uncontrolled"} to ${t}. Components should not switch from controlled to uncontrolled (or vice versa). Decide between using a controlled or uncontrolled value for the lifetime of the component.`)}t.current=a},[a,r])}return[l,h.useCallback(t=>{if(a){let n="function"==typeof t?t(e):t;n!==e&&o.current?.(n)}else s(t)},[a,e,s,o])]}({prop:n,onChange:i,defaultProp:r??!1,caller:ye});return(0,u.jsx)(g7.button,{type:"button","aria-pressed":o,"data-state":o?"on":"off","data-disabled":e.disabled?"":void 0,...s,ref:t,onClick:function(e,t,{checkForDefaultPrevented:n=!0}={}){return function(r){if(e?.(r),!1===n||!r.defaultPrevented)return t?.(r)}}(e.onClick,()=>{e.disabled||a(!o)})})});yt.displayName=ye;var yn=n(4224);let yr=(0,yn.F)("inline-flex items-center justify-center rounded-md text-sm font-medium ring-offset-background transition-colors hover:bg-muted hover:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=on]:bg-accent data-[state=on]:text-accent-foreground",{variants:{variant:{default:"bg-transparent",outline:"border border-input bg-transparent hover:bg-accent hover:text-accent-foreground"},size:{default:"h-10 px-3",sm:"h-9 px-2.5",lg:"h-11 px-5"}},defaultVariants:{variant:"default",size:"default"}}),yi=h.forwardRef(({className:e,variant:t,size:n,...r},i)=>(0,u.jsx)(yt,{ref:i,className:(0,X.cn)(yr({variant:t,size:n,className:e})),...r}));function ys({editor:e}){return e?(0,u.jsxs)("div",{className:"flex flex-wrap items-center gap-1 border-b border-outline-variant p-2",children:[(0,u.jsx)(yi,{size:"sm",pressed:e.isActive("bold"),onPressedChange:()=>e.chain().focus().toggleBold().run(),"aria-label":"Toggle bold",children:(0,u.jsx)(gJ,{className:"h-4 w-4"})}),(0,u.jsx)(yi,{size:"sm",pressed:e.isActive("italic"),onPressedChange:()=>e.chain().focus().toggleItalic().run(),"aria-label":"Toggle italic",children:(0,u.jsx)(gG,{className:"h-4 w-4"})}),(0,u.jsx)(yi,{size:"sm",pressed:e.isActive("strike"),onPressedChange:()=>e.chain().focus().toggleStrike().run(),"aria-label":"Toggle strikethrough",children:(0,u.jsx)(gY,{className:"h-4 w-4"})}),(0,u.jsx)("div",{className:"mx-1 h-6 w-px bg-outline-variant"}),(0,u.jsx)(yi,{size:"sm",pressed:e.isActive("heading",{level:1}),onPressedChange:()=>e.chain().focus().toggleHeading({level:1}).run(),"aria-label":"Toggle heading 1",children:(0,u.jsx)(gX,{className:"h-4 w-4"})}),(0,u.jsx)(yi,{size:"sm",pressed:e.isActive("heading",{level:2}),onPressedChange:()=>e.chain().focus().toggleHeading({level:2}).run(),"aria-label":"Toggle heading 2",children:(0,u.jsx)(gZ,{className:"h-4 w-4"})}),(0,u.jsx)(yi,{size:"sm",pressed:e.isActive("heading",{level:3}),onPressedChange:()=>e.chain().focus().toggleHeading({level:3}).run(),"aria-label":"Toggle heading 3",children:(0,u.jsx)(gQ,{className:"h-4 w-4"})}),(0,u.jsx)("div",{className:"mx-1 h-6 w-px bg-outline-variant"}),(0,u.jsx)(yi,{size:"sm",pressed:e.isActive("bulletList"),onPressedChange:()=>e.chain().focus().toggleBulletList().run(),"aria-label":"Toggle bullet list",children:(0,u.jsx)(ew,{className:"h-4 w-4"})}),(0,u.jsx)(yi,{size:"sm",pressed:e.isActive("orderedList"),onPressedChange:()=>e.chain().focus().toggleOrderedList().run(),"aria-label":"Toggle ordered list",children:(0,u.jsx)(g0,{className:"h-4 w-4"})}),(0,u.jsx)("div",{className:"mx-1 h-6 w-px bg-outline-variant"}),(0,u.jsx)(yi,{size:"sm",onPressedChange:()=>e.chain().focus().setHorizontalRule().run(),"aria-label":"Add horizontal rule",children:(0,u.jsx)(g1,{className:"h-4 w-4"})}),(0,u.jsx)(yi,{size:"sm",onPressedChange:()=>e.chain().focus().undo().run(),disabled:!e.can().chain().focus().undo().run(),"aria-label":"Undo",children:(0,u.jsx)(g2,{className:"h-4 w-4"})}),(0,u.jsx)(yi,{size:"sm",onPressedChange:()=>e.chain().focus().redo().run(),disabled:!e.can().chain().focus().redo().run(),"aria-label":"Redo",children:(0,u.jsx)(g4,{className:"h-4 w-4"})})]}):null}yi.displayName=yt.displayName;let yo=[{id:"situation",title:"Situation / Trigger",prompt:"What happened? Where? When? Who with? How?",placeholder:"Describe the event or situation..."},{id:"feelings",title:"Feelings & Body Sensations",prompt:"What emotion did I feel? What did I notice in my body? Where?",placeholder:"e.g., Anxiety, tightness in chest..."},{id:"unhelpfulThoughts",title:"Unhelpful / Initial Thoughts & Images",prompt:"What went through my mind? What disturbed me? Meaning? What button is this pressing for me? Worst outcome?",placeholder:'e.g., "I\'m going to fail", image of messing up...'},{id:"evidenceAgainst",title:"Facts Against Initial Thought",prompt:"What facts counter the unhelpful thoughts? Is it opinion, not fact? Others' views?",placeholder:'e.g., "I\'ve prepared well", "I\'ve succeeded before"...'},{id:"evidenceFor",title:"Facts Supporting Initial Thought",prompt:"What facts support the unhelpful thoughts? What makes them seem true?",placeholder:'e.g., "This is a difficult task", "I made a mistake previously"...'},{id:"alternativePerspective",title:"Alternative, Balanced Perspective",prompt:"Breathe. Someone else's view? Bigger picture? Reframe? Advice to others? Proportional reaction? Importance?",placeholder:'e.g., "One mistake doesn\'t define me", "I can ask for help"...'},{id:"outcome",title:"Outcome",prompt:"Feeling now? What to do differently/more effectively? Act wisely. Most helpful action? Consequences?",placeholder:"e.g., Hopeful, plan to practice mindfulness..."}],ya={situation:"",feelings:"",feelingsRating:50,unhelpfulThoughts:"",evidenceAgainst:"",evidenceFor:"",alternativePerspective:"",outcome:"",outcomeRating:50},yl=({onSave:e,initialData:t,onClose:n,isActive:r})=>{let[i,s]=(0,h.useState)(0),[o,a]=(0,h.useState)(ya),[l,c]=(0,h.useState)(null),[d,p]=(0,h.useState)(""),f=yo[i],m=function(e={},t=[]){let n=(0,h.useRef)(e);n.current=e;let[r]=(0,h.useState)(()=>new mB(n)),i=mE.useSyncExternalStore(r.subscribe,r.getEditor,r.getServerSnapshot);return(0,h.useDebugValue)(i),(0,h.useEffect)(r.onRender(t)),!function(e){var t;let[n]=(0,h.useState)(()=>new m$(e.editor)),r=mz.useSyncExternalStoreWithSelector(n.subscribe,n.getSnapshot,n.getServerSnapshot,e.selector,null!=(t=e.equalityFn)?t:mP);mV(()=>n.watch(e.editor),[e.editor,n]),(0,h.useDebugValue)(r)}({editor:i,selector:({transactionNumber:t})=>!1===e.shouldRerenderOnTransaction?null:e.immediatelyRender&&0===t?0:t+1}),i}({extensions:[gU,gK.configure({placeholder:f.placeholder})],editorProps:{attributes:{class:"prose prose-sm sm:prose-base dark:prose-invert max-w-none focus:outline-none flex-grow min-h-[200px]"}},onUpdate:({editor:e})=>{let t=yo[i].id;a(n=>({...n,[t]:e.getHTML()})),l&&c(null)}},[f.placeholder]);(0,h.useEffect)(()=>{r&&(t?(a(t.data),p(t.title)):(a(ya),p(`Thought Record - ${new Date().toLocaleDateString()}`)),s(0),c(null))},[r,t]),(0,h.useEffect)(()=>{if(!m||!r)return;let e=o[f.id]||"";m.getHTML()!==e&&m.commands.setContent(e,!1),m.commands.focus();let t=document.getElementById("thought-record-form-top");t?.scrollIntoView({behavior:"smooth",block:"start"})},[i,m,r]);let{isRecording:g,startRecording:y,stopRecording:x,speechError:v,isSpeechSupported:b}=oU({onTranscriptUpdate:(0,h.useCallback)((e,t)=>{t&&m&&m.chain().focus().insertContent(e.trim()+" ").run()},[m])}),w=e=>{"feelings"===f.id?a(t=>({...t,feelingsRating:e})):"outcome"===f.id&&a(t=>({...t,outcomeRating:e}))},k=e=>{g&&x(),s(e)},j=()=>{if(g&&x(),!Object.values(o).some(e=>{if("string"!=typeof e)return!1;let t=document.createElement("div");return t.innerHTML=e,""!==(t.textContent||t.innerText||"").trim()}))return void c("Please fill in at least one section before saving.");e(t?.id,o),n()},N=async()=>{b&&(g?x():(await y(),m?.commands.focus()))},S=0===i,C=i===yo.length-1,M="feelings"===f.id?o.feelingsRating:o.outcomeRating;return(0,u.jsxs)("div",{className:"flex flex-col h-full bg-surface-container overflow-hidden rounded-t-3xl md:rounded-3xl",children:[(0,u.jsxs)("div",{className:"flex flex-shrink-0 items-center justify-between p-4 pt-6 border-b border-outline-variant",children:[(0,u.jsx)("h2",{className:"font-serif text-headline-md text-surface-on",children:t?"Edit Thought Record":"New Thought Record"}),(0,u.jsx)(Q,{onClick:()=>{g&&x(),n()},variant:"text",size:"sm",isIconOnly:!0,className:"text-surface-on-variant","aria-label":"Close form",title:"Close",children:(0,u.jsx)(eu.A,{className:"h-6 w-6"})})]}),(0,u.jsxs)("div",{id:"thought-record-form-top",className:"p-6 space-y-6 flex-grow overflow-y-auto",children:[l&&(0,u.jsx)("p",{className:"text-label-md text-error p-3 bg-error-container/20 rounded-lg",children:l}),(0,u.jsxs)("div",{className:"space-y-3 pt-2",children:[(0,u.jsxs)("div",{children:[(0,u.jsx)("h3",{className:"font-serif text-title-lg text-primary",children:f.title}),(0,u.jsx)("p",{className:"text-body-md text-surface-on-variant italic mt-1.5",children:f.prompt})]}),("feelings"===f.id||"outcome"===f.id)&&(0,u.jsxs)("div",{className:"space-y-3 pt-4",children:[(0,u.jsxs)("label",{htmlFor:`${f.id}-rating`,className:"block text-sm font-medium text-surface-on-variant mb-1",children:["feelings"===f.id?"Rate Intensity (0-100)":"Re-rate Emotion",": ",(0,u.jsx)("span",{className:"font-bold text-surface-on",children:M})]}),(0,u.jsx)(ch,{id:`${f.id}-rating`,min:0,max:100,step:1,value:[M],onValueChange:e=>w(e[0]),className:"w-full","aria-label":"outcome"===f.id?"Re-rate emotion slider":"Intensity rating slider"})]}),(0,u.jsxs)("div",{className:"relative pt-2",children:[(0,u.jsxs)("div",{className:"flex flex-col bg-surface-container-low border border-outline-variant rounded-xl overflow-hidden",children:[(0,u.jsx)(ys,{editor:m}),(0,u.jsx)("div",{className:"p-4 flex-grow min-h-[250px]",children:(0,u.jsx)(mR,{editor:m})})]}),b&&(0,u.jsx)(Q,{onClick:N,variant:g?"filled":"tonal",size:"sm",isIconOnly:!0,className:"absolute top-5 right-3","aria-label":g?"Stop Dictation":"Start Dictation",title:g?"Stop Dictation":"Start Dictation",leadingIcon:g?(0,u.jsx)(l_,{}):(0,u.jsx)(oW,{})})]}),v&&(0,u.jsx)("p",{className:"text-label-md text-error mt-1",children:v})]})]}),(0,u.jsxs)("div",{className:"flex flex-row justify-between items-center gap-3 p-6 border-t border-outline-variant",children:[(0,u.jsx)(Q,{onClick:()=>{g&&x(),S||s(e=>e-1)},variant:"outlined",isIconOnly:!0,leadingIcon:(0,u.jsx)(lF,{}),"aria-label":"Previous step in thought record",disabled:S,className:(0,X.cn)(S&&"invisible")}),(0,u.jsx)("div",{className:"flex justify-center items-center gap-4",children:yo.map((e,t)=>(0,u.jsx)("button",{type:"button",onClick:()=>k(t),className:(0,X.cn)("w-3 h-3 rounded-full cursor-pointer transition-all duration-300",t===i?"bg-primary scale-125":t<i?"bg-primary/50":"bg-outline hover:bg-outline-variant"),"aria-label":`Go to step ${t+1}`,"aria-current":t===i?"step":void 0},`step-${t}`))}),(0,u.jsx)(Q,{onClick:()=>{g&&x(),C?j():s(e=>e+1)},variant:"filled",isIconOnly:!0,leadingIcon:C?(0,u.jsx)(oq,{}):(0,u.jsx)(lB,{}),"aria-label":C?"Save thought record":"Next step in thought record"})]})]})},yc=[{id:"situation",title:"Situation / Trigger"},{id:"feelings",title:"Feelings & Body Sensations"},{id:"unhelpfulThoughts",title:"Unhelpful / Initial Thoughts & Images"},{id:"evidenceFor",title:"Facts Supporting Initial Thought"},{id:"evidenceAgainst",title:"Facts Against Initial Thought"},{id:"alternativePerspective",title:"Alternative, Balanced Perspective"},{id:"outcome",title:"Outcome"}],yd=({isOpen:e,onClose:t,record:n,onEdit:r})=>n?(0,u.jsxs)(lL,{isOpen:e,onClose:t,title:n.title,children:[(0,u.jsxs)("div",{className:"p-6 max-h-[70vh] overflow-y-auto",children:[(0,u.jsxs)("p",{className:"text-sm text-surface-on-variant mb-4",children:["Recorded on ",new Date(n.timestamp).toLocaleString()]}),(0,u.jsx)("div",{className:"space-y-4",children:yc.map(e=>{let t=n.data[e.id];if(!(t&&"string"==typeof t&&""!==t.replace(/<p><\/p>/g,"").trim()))return null;let r=e.title;return"feelings"===e.id&&n.data.feelingsRating?r+=` (${n.data.feelingsRating}/100)`:"outcome"===e.id&&n.data.outcomeRating&&(r+=` (${n.data.outcomeRating}/100)`),(0,u.jsxs)("div",{children:[(0,u.jsx)("h4",{className:"font-serif text-title-md text-surface-on mb-1",children:r}),(0,u.jsx)("div",{className:"prose prose-sm sm:prose-base dark:prose-invert max-w-none break-words",dangerouslySetInnerHTML:{__html:t}})]},e.id)})})]}),(0,u.jsxs)("div",{className:"flex justify-end space-x-3 p-6 border-t border-outline-variant",children:[(0,u.jsx)(Q,{type:"button",variant:"text",onClick:t,children:"Close"}),(0,u.jsx)(Q,{type:"button",variant:"filled",leadingIcon:(0,u.jsx)(oG,{}),onClick:()=>{r(n),t()},children:"Edit Record"})]})]}):null,yu=(0,K.A)("Smile",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 14s1.5 2 4 2 4-2 4-2",key:"1y1vjs"}],["line",{x1:"9",x2:"9.01",y1:"9",y2:"9",key:"yxxnd0"}],["line",{x1:"15",x2:"15.01",y1:"9",y2:"9",key:"1p4y9e"}]]),yh=(0,K.A)("Meh",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"8",x2:"16",y1:"15",y2:"15",key:"1xb1d9"}],["line",{x1:"9",x2:"9.01",y1:"9",y2:"9",key:"yxxnd0"}],["line",{x1:"15",x2:"15.01",y1:"9",y2:"9",key:"1p4y9e"}]]),yp=(0,K.A)("Frown",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M16 16s-1.5-2-4-2-4 2-4 2",key:"epbg0q"}],["line",{x1:"9",x2:"9.01",y1:"9",y2:"9",key:"yxxnd0"}],["line",{x1:"15",x2:"15.01",y1:"9",y2:"9",key:"1p4y9e"}]]),yf=(0,K.A)("Zap",[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]]),ym=(0,K.A)("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]),yg=(0,K.A)("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]),yy=(e,t="en-US")=>e.toLocaleDateString(t,{month:"long"}),yx=e=>e.getFullYear(),yv=(e,t)=>{let n=new Date(e);return n.setMonth(n.getMonth()+t),n},yb=(e,t)=>{let n=new Date(e);return n.setDate(n.getDate()+t),n},yw=e=>new Date(e.getFullYear(),e.getMonth(),1),yk=e=>new Date(e.getFullYear(),e.getMonth()+1,0),yj=(e,t=0)=>{let n=e.getDay(),r=new Date(e);return r.setDate(e.getDate()-(7*(n<t)+n-t)),r.setHours(0,0,0,0),r},yN=(e,t=0)=>{let n=yj(e,t),r=new Date(n);return r.setDate(n.getDate()+6),r.setHours(23,59,59,999),r},yS=(e,t)=>e.getFullYear()===t.getFullYear()&&e.getMonth()===t.getMonth()&&e.getDate()===t.getDate(),yC=(e,t)=>e.getFullYear()===t.getFullYear()&&e.getMonth()===t.getMonth(),yM=e=>{let t=e.getFullYear(),n=(e.getMonth()+1).toString().padStart(2,"0"),r=e.getDate().toString().padStart(2,"0");return`${t}-${n}-${r}`},yE=e=>{let t=e.getHours().toString().padStart(2,"0"),n=e.getMinutes().toString().padStart(2,"0");return`${t}:${n}`},yT=(e,t)=>{if(!t){let[t,n,r]=e.split("-").map(Number);return new Date(Date.UTC(t,n-1,r))}let[n,r,i]=e.split("-").map(Number),[s,o]=t.split(":").map(Number);return new Date(n,r-1,i,s,o)},yA=(e,t)=>{if(t)return yM(e);let n=e.getFullYear(),r=(e.getMonth()+1).toString().padStart(2,"0"),i=e.getDate().toString().padStart(2,"0"),s=e.getHours().toString().padStart(2,"0"),o=e.getMinutes().toString().padStart(2,"0"),a=e.getSeconds().toString().padStart(2,"0");return`${n}-${r}-${i}T${s}:${o}:${a}`},yD=e=>{if(10===e.length&&e.match(/^\d{4}-\d{2}-\d{2}$/)){let[t,n,r]=e.split("-").map(Number);return new Date(t,n-1,r)}return new Date(e)},yO=(e="en-US",t=0)=>{let n=yj(new Date,t),r=[];for(let t=0;t<7;t++)r.push(yb(n,t).toLocaleDateString(e,{weekday:"short"}));return r},yR=(e,t=0)=>{let n=yj(e,t),r=yN(e,t),i=n.toLocaleDateString("en-US",{month:"short"}),s=r.toLocaleDateString("en-US",{month:"short"});return n.getFullYear()!==r.getFullYear()?`${n.toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"})} - ${r.toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"})}`:i===s?`${i} ${n.getDate()} - ${r.getDate()}, ${n.getFullYear()}`:`${i} ${n.getDate()} - ${s} ${r.getDate()}, ${n.getFullYear()}`},yP=e=>e.toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"}),yI=({options:e,value:t,onChange:n,className:r=""})=>(0,u.jsx)("div",{className:`inline-flex items-center bg-surface-container-low p-1 rounded-full space-x-1 ${r}`,children:e.map(e=>(0,u.jsx)(Q,{onClick:()=>n(e.value),variant:t===e.value?"tonal":"text",size:"md",className:`!rounded-full transition-all duration-300 ${t===e.value?"bg-secondary-container text-on-secondary-container shadow-sm":"text-surface-on-variant hover:bg-black/5"}`,"aria-pressed":t===e.value,children:e.label},e.value))}),yL=({viewMode:e,onViewChange:t,onAddEvent:n})=>(0,u.jsx)("div",{className:"flex flex-col sm:flex-row items-center justify-end gap-4 p-2 bg-surface-container rounded-xl shadow mb-6",children:(0,u.jsxs)("div",{className:"flex items-center gap-3",children:[(0,u.jsx)(yI,{value:e,onChange:e=>t(e),options:[{value:"month",label:"Month"},{value:"week",label:"Week"},{value:"day",label:"Day"}]}),(0,u.jsx)(Q,{onClick:n,variant:"filled",size:"md",leadingIcon:(0,u.jsx)(eM,{}),children:"Add Event"})]})}),yz=(0,K.A)("BookOpen",[["path",{d:"M12 7v14",key:"1akyts"}],["path",{d:"M3 18a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1h5a4 4 0 0 1 4 4 4 4 0 0 1 4-4h5a1 1 0 0 1 1 1v13a1 1 0 0 1-1 1h-6a3 3 0 0 0-3 3 3 3 0 0 0-3-3z",key:"ruj8y"}]]),yV=({currentDisplayDate:e,events:t,journalEntries:n,thoughtRecords:r,onDateClick:i,onEventClick:s,onPrev:o,onNext:a,currentDateTitle:l,onViewJournalEntry:c,onViewThoughtRecord:d})=>{let h=new Date,p=yw(e),f=yk(e),m=yj(p,0),g=yN(f,0),y=yO("en-US",0),x=[],v=m;for(;v<=g;)x.push(new Date(v)),v=yb(v,1);let b=e=>t.filter(t=>{let n=yD(t.start),r=yD(t.end);if(t.allDay){let t=new Date(e.getFullYear(),e.getMonth(),e.getDate()),i=new Date(n.getFullYear(),n.getMonth(),n.getDate()),s=new Date(r.getFullYear(),r.getMonth(),r.getDate());return t>=i&&t<=s}return e>=n&&e<yb(r,1)}).sort((e,t)=>e.allDay===t.allDay?0:e.allDay?-1:1),w=e=>n.find(t=>yS(new Date(t.timestamp),e)),k=e=>r.find(t=>yS(new Date(t.timestamp),e));return(0,u.jsxs)("div",{className:"bg-surface-container-low shadow-lg rounded-xl overflow-hidden",children:[(0,u.jsxs)("div",{className:"flex items-center justify-between p-4 border-b border-outline-variant",children:[(0,u.jsx)("h2",{className:"font-serif text-headline-sm sm:text-headline-md text-surface-on truncate",title:l,children:l}),(0,u.jsxs)("div",{className:"flex items-center gap-1",children:[(0,u.jsx)(Q,{onClick:o,variant:"tonal",size:"sm",isIconOnly:!0,leadingIcon:(0,u.jsx)(ym,{}),"aria-label":"Previous month"}),(0,u.jsx)(Q,{onClick:a,variant:"tonal",size:"sm",isIconOnly:!0,leadingIcon:(0,u.jsx)(yg,{}),"aria-label":"Next month"})]})]}),(0,u.jsx)("div",{className:"grid grid-cols-7 border-b border-outline-variant",children:y.map(e=>(0,u.jsx)("div",{className:"p-2 text-center text-label-md font-medium text-surface-on-variant",children:e},e))}),(0,u.jsx)("div",{className:"grid grid-cols-7 auto-rows-[minmax(100px,_1fr)] sm:auto-rows-[minmax(140px,_1fr)] md:auto-rows-[minmax(160px,_1fr)]",children:x.map((t,n)=>{let r=yC(t,e),o=yS(t,h),a=b(t),l=w(t),p=k(t);return(0,u.jsxs)("div",{className:`p-2 sm:p-3 border border-outline-variant/30 
                          transition-colors duration-200 ease-in-out cursor-pointer group
                          ${r?"bg-surface-container-low hover:bg-surface-container":"bg-surface-container-lowest text-surface-on-variant/50 hover:bg-surface-container/50"}
                          `,onClick:()=>i(t),role:"gridcell","aria-label":`Date ${t.getDate()} ${yy(t)}`,children:[(0,u.jsxs)("div",{className:"flex justify-between items-center mb-1",children:[(0,u.jsx)("span",{className:`text-xs sm:text-sm font-medium rounded-full w-6 h-6 sm:w-7 sm:h-7 flex items-center justify-center
                  ${o?"bg-primary text-primary-foreground":r?"text-surface-on":"text-surface-on-variant/70"}
                  group-hover:text-primary`,children:t.getDate()}),(0,u.jsxs)("div",{className:"flex items-center gap-1.5",children:[l&&r&&(0,u.jsx)("button",{onClick:e=>{e.stopPropagation(),c(l)},className:"p-1 -m-1 rounded-full hover:bg-surface-container-high","aria-label":"View journal entry",children:(0,u.jsx)(yz,{className:"w-3 h-3 sm:w-4 sm:h-4 text-secondary"})}),p&&r&&(0,u.jsx)("button",{onClick:e=>{e.stopPropagation(),d(p)},className:"p-1 -m-1 rounded-full hover:bg-surface-container-high","aria-label":"View thought record",children:(0,u.jsx)(ea,{className:"w-3 h-3 sm:w-4 sm:h-4 text-tertiary"})})]})]}),r&&(0,u.jsxs)("div",{className:"space-y-0.5 overflow-y-auto max-h-[48px] sm:max-h-[80px] md:max-h-[100px] text-xs",children:[a.slice(0,3).map(e=>(0,u.jsxs)("div",{onClick:t=>{t.stopPropagation(),s(e)},className:`px-1.5 py-0.5 rounded ${e.color||"bg-indigo-500"} text-white text-[0.6rem] sm:text-xs truncate cursor-pointer hover:opacity-80`,title:e.title,children:[e.allDay&&(0,u.jsx)("span",{className:"font-semibold",children:"All Day: "}),e.title]},e.id)),a.length>3&&(0,u.jsxs)("div",{className:"text-[0.6rem] sm:text-xs text-surface-on-variant text-center",children:["+",a.length-3," more"]})]})]},n)})})]})},y$=({currentDisplayDate:e,events:t,journalEntries:n,thoughtRecords:r,onDateClick:i,onEventClick:s,onPrev:o,onNext:a,currentDateTitle:l,onViewJournalEntry:c,onViewThoughtRecord:d})=>{let h=new Date,p=yj(e,0),f=[];for(let e=0;e<7;e++)f.push(yb(p,e));let m=e=>t.filter(t=>{let n=yD(t.start),r=yD(t.end);if(t.allDay){let t=new Date(e.getFullYear(),e.getMonth(),e.getDate()),i=new Date(n.getFullYear(),n.getMonth(),n.getDate()),s=new Date(r.getFullYear(),r.getMonth(),r.getDate());return t>=i&&t<=s}return yS(n,e)}).sort((e,t)=>e.allDay!==t.allDay?e.allDay?-1:1:yD(e.start).getTime()-yD(t.start).getTime()),g=e=>n.find(t=>yS(new Date(t.timestamp),e)),y=e=>r.find(t=>yS(new Date(t.timestamp),e));return(0,u.jsxs)("div",{className:"space-y-4",children:[(0,u.jsxs)("div",{className:"flex items-center justify-between p-4 bg-surface-container-low shadow-lg rounded-xl",children:[(0,u.jsx)("h2",{className:"font-serif text-headline-sm sm:text-headline-md text-surface-on truncate",title:l,children:l}),(0,u.jsxs)("div",{className:"flex items-center gap-1",children:[(0,u.jsx)(Q,{onClick:o,variant:"tonal",size:"sm",isIconOnly:!0,leadingIcon:(0,u.jsx)(ym,{}),"aria-label":"Previous week"}),(0,u.jsx)(Q,{onClick:a,variant:"tonal",size:"sm",isIconOnly:!0,leadingIcon:(0,u.jsx)(yg,{}),"aria-label":"Next week"})]})]}),f.map((e,t)=>{let n=m(e),r=g(e),o=y(e),a=yS(e,h);return(0,u.jsxs)("div",{className:"bg-surface-container-low shadow-lg rounded-xl p-4 sm:p-5 cursor-pointer hover:bg-surface-container transition-colors",onClick:()=>i(e),role:"article","aria-labelledby":`day-header-${t}`,children:[(0,u.jsxs)("div",{id:`day-header-${t}`,className:"flex items-center justify-between mb-3",children:[(0,u.jsx)("h3",{className:`font-serif text-title-lg ${a?"text-primary":"text-surface-on"}`,children:e.toLocaleDateString("en-US",{weekday:"long",month:"short",day:"numeric"})}),(0,u.jsxs)("div",{className:"flex items-center gap-2",children:[r&&(0,u.jsx)("button",{onClick:e=>{e.stopPropagation(),c(r)},className:"p-1 -m-1 rounded-full hover:bg-surface-container-high","aria-label":"View journal entry on this day",children:(0,u.jsx)(yz,{className:"w-5 h-5 text-secondary"})}),o&&(0,u.jsx)("button",{onClick:e=>{e.stopPropagation(),d(o)},className:"p-1 -m-1 rounded-full hover:bg-surface-container-high","aria-label":"View thought record on this day",children:(0,u.jsx)(ea,{className:"w-5 h-5 text-tertiary"})})]})]}),n.length>0?(0,u.jsx)("div",{className:"space-y-1.5",children:n.map(e=>(0,u.jsxs)("div",{onClick:t=>{t.stopPropagation(),s(e)},className:`p-2 rounded-md text-white text-sm truncate cursor-pointer hover:opacity-80 transition-opacity flex items-center gap-2 ${e.color||"bg-indigo-500"}`,title:e.title,children:[!e.allDay&&(0,u.jsx)("span",{className:"font-semibold text-xs whitespace-nowrap",children:yE(yD(e.start))}),(0,u.jsx)("span",{className:"truncate",children:e.title})]},e.id))}):(0,u.jsx)("p",{className:"text-sm text-surface-on-variant text-center py-4 italic",children:"No events scheduled."})]},t)})]})},y_=({currentDisplayDate:e,events:t,journalEntries:n,thoughtRecords:r,onEventClick:i,onAddEvent:s,onPrev:o,onNext:a,currentDateTitle:l,onViewJournalEntry:c,onViewThoughtRecord:d})=>{let h=t.filter(t=>{let n=yD(t.start),r=yD(t.end);if(t.allDay){let t=new Date(e.getFullYear(),e.getMonth(),e.getDate()),i=new Date(n.getFullYear(),n.getMonth(),n.getDate()),s=new Date(r.getFullYear(),r.getMonth(),r.getDate());return t>=i&&t<=s}return yS(n,e)}).sort((e,t)=>e.allDay!==t.allDay?e.allDay?-1:1:yD(e.start).getTime()-yD(t.start).getTime()),p=h.filter(e=>e.allDay),f=h.filter(e=>!e.allDay),m=n.filter(t=>yS(new Date(t.timestamp),e)),g=r.filter(t=>yS(new Date(t.timestamp),e));return(0,u.jsxs)("div",{className:"bg-surface-container-low shadow-lg rounded-xl p-4 sm:p-6",children:[(0,u.jsxs)("div",{className:"flex items-center justify-between pb-4 mb-4 border-b border-outline-variant",children:[(0,u.jsx)("h2",{className:"font-serif text-headline-sm sm:text-headline-md text-surface-on truncate",title:l,children:l}),(0,u.jsxs)("div",{className:"flex items-center gap-1",children:[(0,u.jsx)(Q,{onClick:o,variant:"tonal",size:"sm",isIconOnly:!0,leadingIcon:(0,u.jsx)(ym,{}),"aria-label":"Previous day"}),(0,u.jsx)(Q,{onClick:a,variant:"tonal",size:"sm",isIconOnly:!0,leadingIcon:(0,u.jsx)(yg,{}),"aria-label":"Next day"})]})]}),(0,u.jsxs)("div",{className:"space-y-6",children:[(m.length>0||g.length>0)&&(0,u.jsxs)("div",{className:"space-y-2",children:[(0,u.jsx)("h3",{className:"font-serif text-title-md text-surface-on",children:"Entries & Records"}),m.map(e=>(0,u.jsxs)("button",{onClick:()=>c(e),className:"w-full text-left flex items-center gap-2 p-3 bg-secondary-container/30 rounded-lg text-sm text-on-secondary-container cursor-pointer hover:bg-secondary-container/50",children:[(0,u.jsx)(yz,{className:"w-5 h-5 flex-shrink-0"}),(0,u.jsxs)("span",{className:"truncate",children:["Journal: ",e.title||`Entry from ${yE(new Date(e.timestamp))}`]})]},e.id)),g.map(e=>(0,u.jsxs)("button",{onClick:()=>d(e),className:"w-full text-left flex items-center gap-2 p-3 bg-tertiary-container/30 rounded-lg text-sm text-on-tertiary-container cursor-pointer hover:bg-tertiary-container/50",children:[(0,u.jsx)(ea,{className:"w-5 h-5 flex-shrink-0"}),(0,u.jsxs)("span",{className:"truncate",children:["Thought Record: ",e.title]})]},e.id))]}),p.length>0&&(0,u.jsxs)("div",{className:"space-y-2",children:[(0,u.jsx)("h3",{className:"font-serif text-title-md text-surface-on",children:"All-Day Events"}),(0,u.jsx)("div",{className:"space-y-1",children:p.map(e=>(0,u.jsx)("div",{onClick:()=>i(e),className:`p-2 rounded-md text-white text-sm truncate cursor-pointer hover:opacity-80 transition-opacity ${e.color||"bg-indigo-500"}`,title:e.title,children:e.title},e.id))})]}),(0,u.jsxs)("div",{className:"space-y-4",children:[(0,u.jsx)("h3",{className:"font-serif text-title-md text-surface-on",children:f.length>0?"Scheduled Events":"No Scheduled Events"}),f.length>0?(0,u.jsx)("ul",{className:"space-y-3",children:f.map(e=>(0,u.jsxs)("li",{onClick:()=>i(e),className:"flex items-start gap-3 cursor-pointer group",children:[(0,u.jsxs)("div",{className:"text-right",children:[(0,u.jsx)("p",{className:"text-sm font-medium text-primary whitespace-nowrap",children:yE(yD(e.start))}),(0,u.jsx)("p",{className:"text-xs text-primary/80 whitespace-nowrap",children:yE(yD(e.end))})]}),(0,u.jsx)("div",{className:"w-1 h-full flex justify-center",children:(0,u.jsx)("div",{className:`w-0.5 h-full rounded-full ${e.color||"bg-indigo-500"}`})}),(0,u.jsxs)("div",{className:`flex-grow p-3 rounded-md text-white -mt-1 group-hover:opacity-80 transition-opacity ${e.color||"bg-indigo-500"}`,children:[(0,u.jsx)("p",{className:"font-bold text-sm",children:e.title}),e.description&&(0,u.jsx)("p",{className:"text-xs opacity-90",children:e.description})]})]},e.id))}):(0,u.jsx)("div",{onClick:()=>s(e),className:"text-center text-surface-on-variant py-8 cursor-pointer hover:bg-surface-container rounded-lg",children:(0,u.jsx)("p",{children:"Click here to add an event."})})]})]})]})},yF=(0,K.A)("TriangleAlert",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]),yB=[{name:"Indigo",class:"bg-indigo-500"},{name:"Teal",class:"bg-teal-500"},{name:"Amber",class:"bg-amber-500"},{name:"Rose",class:"bg-rose-600"},{name:"Sky",class:"bg-sky-500"},{name:"Lime",class:"bg-lime-500"},{name:"Violet",class:"bg-violet-500"},{name:"Fuchsia",class:"bg-fuchsia-500"}],yW=({isOpen:e,onClose:t,onSave:n,eventToEdit:r,initialDate:i})=>{let[s,o]=(0,h.useState)(""),[a,l]=(0,h.useState)(""),[c,d]=(0,h.useState)(""),[p,f]=(0,h.useState)(""),[m,g]=(0,h.useState)(""),[y,x]=(0,h.useState)(!0),[v,b]=(0,h.useState)(""),[w,k]=(0,h.useState)(yB[0].class),[j,N]=(0,h.useState)(null),S=(0,h.useRef)(null);return(0,h.useEffect)(()=>{if(e){if(N(null),r){let e=yD(r.start),t=yD(r.end);o(r.title),x(r.allDay),l(yM(e)),d(r.allDay?"00:00":yE(e)),f(yM(t)),g(r.allDay?"23:59":yE(t)),b(r.description||""),k(r.color||yB[0].class)}else{let e=i||new Date;o(""),x(!0),l(yM(e)),d("09:00"),f(yM(e)),g("10:00"),b(""),k(yB[0].class)}setTimeout(()=>S.current?.focus(),100)}},[e,r,i]),(0,u.jsx)(lL,{isOpen:e,onClose:t,title:r?"Edit Event":"Add New Event",children:(0,u.jsxs)("form",{onSubmit:e=>{let i,o;if(e.preventDefault(),N(null),!s.trim())return void N("Title is required.");if(!a)return void N("Start date is required.");if(!y&&!c)return void N("Start time is required for timed events.");if(p||f(a),!y&&!m){let e=yT(a,c);e.setHours(e.getHours()+1),g(yE(e))}if(y?(i=yT(a),o=yT(p||a)):(i=yT(a,c),o=yT(p||a,m||c)),o<i)return void N("End date/time cannot be before start date/time.");n({id:r?.id,title:s.trim(),start:yA(i,y),end:yA(o,y),allDay:y,description:v.trim()||void 0,color:w}),t()},className:"space-y-5 px-6 pb-6",children:[j&&(0,u.jsxs)("div",{className:"bg-error-container text-on-error-container p-3 rounded-lg text-sm flex items-center gap-2",role:"alert",children:[(0,u.jsx)(yF,{size:18})," ",j]}),(0,u.jsxs)("div",{children:[(0,u.jsxs)("label",{htmlFor:"eventTitle",className:"block text-sm font-medium text-surface-on-variant mb-1",children:["Event Title ",(0,u.jsx)("span",{className:"text-error",children:"*"})]}),(0,u.jsx)("input",{ref:S,type:"text",id:"eventTitle",value:s,onChange:e=>o(e.target.value),className:"w-full p-4 bg-surface-container-low border border-outline-variant hover:border-outline focus:border-primary focus:ring-1 focus:ring-primary rounded-lg text-surface-on placeholder-surface-on-variant",required:!0})]}),(0,u.jsxs)("div",{className:"flex items-center gap-4",children:[(0,u.jsxs)("div",{className:"flex-1",children:[(0,u.jsxs)("label",{htmlFor:"eventStartDate",className:"block text-sm font-medium text-surface-on-variant mb-1",children:["Start Date ",(0,u.jsx)("span",{className:"text-error",children:"*"})]}),(0,u.jsx)("input",{type:"date",id:"eventStartDate",value:a,onChange:e=>l(e.target.value),className:"w-full p-4 bg-surface-container-low border border-outline-variant hover:border-outline focus:border-primary focus:ring-1 focus:ring-primary rounded-lg text-surface-on",required:!0})]}),!y&&(0,u.jsxs)("div",{className:"flex-1",children:[(0,u.jsxs)("label",{htmlFor:"eventStartTime",className:"block text-sm font-medium text-surface-on-variant mb-1",children:["Start Time ",(0,u.jsx)("span",{className:"text-error",children:"*"})]}),(0,u.jsx)("input",{type:"time",id:"eventStartTime",value:c,onChange:e=>d(e.target.value),className:"w-full p-4 bg-surface-container-low border border-outline-variant hover:border-outline focus:border-primary focus:ring-1 focus:ring-primary rounded-lg text-surface-on",required:!y})]})]}),(0,u.jsxs)("div",{className:"flex items-center gap-4",children:[(0,u.jsxs)("div",{className:"flex-1",children:[(0,u.jsxs)("label",{htmlFor:"eventEndDate",className:"block text-sm font-medium text-surface-on-variant mb-1",children:["End Date ",(0,u.jsx)("span",{className:"text-error",children:"*"})]}),(0,u.jsx)("input",{type:"date",id:"eventEndDate",value:p,onChange:e=>f(e.target.value),min:a,className:"w-full p-4 bg-surface-container-low border border-outline-variant hover:border-outline focus:border-primary focus:ring-1 focus:ring-primary rounded-lg text-surface-on",required:!0})]}),!y&&(0,u.jsxs)("div",{className:"flex-1",children:[(0,u.jsxs)("label",{htmlFor:"eventEndTime",className:"block text-sm font-medium text-surface-on-variant mb-1",children:["End Time ",(0,u.jsx)("span",{className:"text-error",children:"*"})]}),(0,u.jsx)("input",{type:"time",id:"eventEndTime",value:m,onChange:e=>g(e.target.value),className:"w-full p-4 bg-surface-container-low border border-outline-variant hover:border-outline focus:border-primary focus:ring-1 focus:ring-primary rounded-lg text-surface-on",required:!y})]})]}),(0,u.jsxs)("div",{className:"flex items-center",children:[(0,u.jsx)("input",{type:"checkbox",id:"allDayEvent",checked:y,onChange:e=>{x(e.target.checked),e.target.checked||(c||d("09:00"),m||g("10:00"))},className:"h-4 w-4 text-primary focus:ring-primary border-outline-variant rounded"}),(0,u.jsx)("label",{htmlFor:"allDayEvent",className:"ml-2 text-sm font-medium text-surface-on",children:"All-day event"})]}),(0,u.jsxs)("div",{children:[(0,u.jsx)("label",{htmlFor:"eventDescription",className:"block text-sm font-medium text-surface-on-variant mb-1",children:"Description (Optional)"}),(0,u.jsx)("textarea",{id:"eventDescription",value:v,onChange:e=>b(e.target.value),rows:3,className:"w-full p-4 bg-surface-container-low border border-outline-variant hover:border-outline focus:border-primary focus:ring-1 focus:ring-primary rounded-lg text-surface-on placeholder-surface-on-variant"})]}),(0,u.jsxs)("div",{children:[(0,u.jsx)("label",{className:"block text-sm font-medium text-surface-on-variant mb-1",children:"Event Color"}),(0,u.jsx)("div",{className:"flex flex-wrap gap-2",children:yB.map(e=>(0,u.jsx)("button",{type:"button",onClick:()=>k(e.class),className:`w-8 h-8 rounded-full ${e.class} ${w===e.class?"ring-2 ring-offset-2 ring-primary":""} transition-all focus:outline-none`,"aria-label":`Select color ${e.name}`,"aria-pressed":w===e.class},e.class))})]}),(0,u.jsxs)("div",{className:"flex justify-end space-x-3 pt-2",children:[(0,u.jsx)(Q,{type:"button",variant:"text",onClick:t,children:"Cancel"}),(0,u.jsx)(Q,{type:"submit",variant:"filled",leadingIcon:(0,u.jsx)(oq,{}),children:r?"Save Changes":"Add Event"})]})]})})},yq=(0,K.A)("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]),yH=(0,K.A)("AlignLeft",[["path",{d:"M15 12H3",key:"6jk70r"}],["path",{d:"M17 18H3",key:"1amg6g"}],["path",{d:"M21 6H3",key:"1jwq7v"}]]),yU=(0,K.A)("SquarePen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]]),yK=({isOpen:e,onClose:t,onEdit:n,onDelete:r,event:i})=>{if(!i)return null;let s=yD(i.start),o=yD(i.end),a=e=>e.toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric",timeZone:"UTC"}),l=e=>e.toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit",hour12:!0}),c=i.allDay&&!yS(s,o);return(0,u.jsx)(lL,{isOpen:e,onClose:t,title:i.title,children:(0,u.jsxs)("div",{className:"p-6 space-y-6",children:[(0,u.jsxs)("div",{className:"space-y-4 text-surface-on-variant",children:[(0,u.jsxs)("div",{className:"flex items-center gap-3",children:[(0,u.jsx)("div",{className:`w-4 h-4 rounded-full flex-shrink-0 ${i.color||"bg-indigo-500"}`}),(0,u.jsx)("p",{className:"text-sm font-medium text-surface-on",children:"Event Color"})]}),(0,u.jsxs)("div",{className:"flex items-center gap-3",children:[(0,u.jsx)(yq,{className:"w-5 h-5 flex-shrink-0 text-primary"}),(0,u.jsxs)("div",{children:[(0,u.jsx)("p",{className:"text-sm font-medium text-surface-on",children:"Time"}),i.allDay?(0,u.jsx)("p",{children:"All-day event"}):(0,u.jsx)("p",{children:`${l(s)} - ${l(o)}`})]})]}),(0,u.jsxs)("div",{className:"flex items-center gap-3",children:[(0,u.jsx)(eo,{className:"w-5 h-5 flex-shrink-0 text-primary"}),(0,u.jsxs)("div",{children:[(0,u.jsx)("p",{className:"text-sm font-medium text-surface-on",children:"Date"}),(0,u.jsxs)("p",{children:[a(s),c&&` to ${a(o)}`]})]})]}),i.description&&(0,u.jsxs)("div",{className:"flex items-start gap-3",children:[(0,u.jsx)(yH,{className:"w-5 h-5 flex-shrink-0 text-primary mt-1"}),(0,u.jsxs)("div",{children:[(0,u.jsx)("p",{className:"text-sm font-medium text-surface-on",children:"Description"}),(0,u.jsx)("p",{className:"whitespace-pre-wrap break-words",children:i.description})]})]})]}),(0,u.jsxs)("div",{className:"flex justify-end space-x-3 pt-4 border-t border-outline-variant",children:[(0,u.jsx)(Q,{type:"button",variant:"text",onClick:t,children:"Close"}),(0,u.jsx)(Q,{type:"button",variant:"outlined",onClick:()=>{r(i.id),t()},className:"text-error border-error hover:bg-error-container/20",isIconOnly:!0,title:"Delete Event",children:(0,u.jsx)(oY,{className:"w-5 h-5"})}),(0,u.jsx)(Q,{type:"button",variant:"filled",onClick:()=>{n(i),t()},leadingIcon:(0,u.jsx)(yU,{className:"w-5 h-5"}),children:"Edit"})]})]})})},yJ=e=>yj(new Date(e),1),yG=e=>e.toISOString().split("T")[0],yY=e=>{let t=yb(e,6),n=e.toLocaleString("en-US",{month:"short"}),r=t.toLocaleString("en-US",{month:"short"});return n===r?`${n} ${e.getDate()} - ${t.getDate()}, ${e.getFullYear()}`:`${n} ${e.getDate()} - ${r} ${t.getDate()}, ${e.getFullYear()}`},yX=e=>e.map(e=>`- [${e.completed?"x":" "}] ${e.text}`).join("\n"),yZ=e=>{if(!e.trim())return[];let t=/^-?\s*\[([xX\s])\]\s*(.*)/;return e.split("\n").map((e,n)=>{let r=e.match(t);return{id:`${Date.now()}-${n}`,text:r?r[2].trim():e.trim(),completed:!!r&&"x"===r[1].toLowerCase()}}).filter(e=>e.text.length>0)},yQ=[{name:"Happy",icon:(0,u.jsx)(yu,{}),colorClass:"text-green-500",darkColorClass:"dark:text-green-400"},{name:"Okay",icon:(0,u.jsx)(yh,{}),colorClass:"text-blue-500",darkColorClass:"dark:text-blue-400"},{name:"Sad",icon:(0,u.jsx)(yp,{}),colorClass:"text-red-500",darkColorClass:"dark:text-red-400"},{name:"Productive",icon:(0,u.jsx)(yf,{}),colorClass:"text-purple-500",darkColorClass:"dark:text-purple-400"},{name:"Tired",icon:(0,u.jsx)(ey,{}),colorClass:"text-gray-500",darkColorClass:"dark:text-gray-400"}],y0=({getDailyPlan:e,saveDailyPlan:t,getWeeklyPlan:n,saveWeeklyPlan:r,onSavePlanToJournal:i,events:s,journalEntries:o,thoughtRecords:a,onAddEvent:l,onUpdateEvent:c,onDeleteEvent:d,onViewJournalEntry:p,onViewThoughtRecord:f})=>{let[m,g]=(0,h.useState)("goals"),[y]=(0,h.useState)(new Date),[x,v]=(0,h.useState)(()=>yJ(new Date)),b=yG(y),w=x.toISOString().split("T")[0],[k,j]=(0,h.useState)(void 0),[N,S]=(0,h.useState)([]),[C,M]=(0,h.useState)(""),[E,T]=(0,h.useState)(""),[A,D]=(0,h.useState)([]),[O,R]=(0,h.useState)(""),[P,I]=(0,h.useState)(""),L=(0,h.useRef)(null),z=(0,h.useRef)(null),V=(0,h.useRef)(null),$=(0,h.useRef)(!0),[_,F]=(0,h.useState)(new Date),[B,W]=(0,h.useState)("month"),[q,H]=(0,h.useState)(!1),[U,K]=(0,h.useState)(null),[J,G]=(0,h.useState)(void 0),[Y,X]=(0,h.useState)(!1),[Z,ee]=(0,h.useState)(null),et=(0,h.useMemo)(()=>s,[s]),en=(0,h.useMemo)(()=>o,[o]),er=(0,h.useMemo)(()=>a,[a]);(0,h.useEffect)(()=>{$.current=!0;let t=e(b);j(t?.mood),S(t?.goals||[]),T(yX(t?.tasks||[]));let r=n(w);D(r?.goals||[]),I(r?.notes||"");let i=setTimeout(()=>{$.current=!1},0);return()=>clearTimeout(i)},[b,w,e,n]),(0,h.useEffect)(()=>{$.current||t({date:b,mood:k,goals:N,tasks:yZ(E)})},[k,N,E,b,t]),(0,h.useEffect)(()=>{$.current||r({weekStartDate:w,goals:A,notes:P})},[A,P,w,r]);let ei=oU({onTranscriptUpdate:(0,h.useCallback)((e,t)=>{t&&(T(t=>t+(t&&!t.endsWith(" ")?" ":"")+e.trim()),L.current?.focus(),setTimeout(()=>{L.current&&(L.current.selectionStart=L.current.selectionEnd=L.current.value.length)},0))},[])}),ea=()=>{C.trim()&&(S(e=>[...e,{id:Date.now().toString(),text:C.trim(),completed:!1}]),M(""),z.current?.focus())},el=()=>{O.trim()&&(D(e=>[...e,{id:Date.now().toString(),text:O.trim(),completed:!1}]),R(""),V.current?.focus())},ec=(e,t)=>{t(t=>t.map(t=>t.id===e?{...t,completed:!t.completed}:t))},ed=(e,t)=>{t(t=>t.filter(t=>t.id!==e))},eu=(0,h.useCallback)(()=>{F(e=>{switch(B){case"month":return yv(e,-1);case"week":return yb(e,-7);case"day":return yb(e,-1);default:return e}})},[B]),eh=(0,h.useCallback)(()=>{F(e=>{switch(B){case"month":return yv(e,1);case"week":return yb(e,7);case"day":return yb(e,1);default:return e}})},[B]),ep=e=>{K(null),G(e||new Date),H(!0)},ef=e=>{ee(e),X(!0)},em=e=>{"month"===B||"week"===B?(F(e),W("day")):ep(e)},eg=()=>{switch(B){case"month":return`${yy(_)} ${yx(_)}`;case"week":return yR(_,0);case"day":return yP(_);default:return""}};return(0,u.jsxs)("div",{className:"space-y-10 animate-in fade-in-0 duration-1000 max-w-7xl w-full",children:[(0,u.jsxs)("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4",children:[(0,u.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,u.jsx)(eo,{className:"w-8 h-8 text-primary"}),(0,u.jsx)("h2",{className:"font-serif text-headline-lg text-surface-on",children:"Planner & Calendar"})]}),(0,u.jsx)(yI,{value:m,onChange:e=>g(e),options:[{value:"goals",label:"Goal Tracker"},{value:"calendar",label:"Calendar View"}]})]}),"goals"===m&&(0,u.jsx)("div",{className:"max-w-3xl mx-auto w-full space-y-10",children:(0,u.jsxs)(u.Fragment,{children:[(0,u.jsxs)("section",{className:"bg-surface-container-low p-4 sm:p-6 lg:p-8 rounded-2xl shadow-lg hover:shadow-xl","aria-labelledby":"daily-planner-heading",children:[(0,u.jsx)("h3",{id:"daily-planner-heading",className:"font-serif text-headline-sm text-surface-on mb-1",children:"Today's Focus"}),(0,u.jsx)("p",{className:"text-body-md text-surface-on-variant mb-4",children:y.toLocaleDateString("en-US",{weekday:"long",month:"long",day:"numeric"})}),(0,u.jsxs)("div",{className:"mb-8",children:[(0,u.jsx)("h4",{className:"font-serif text-title-lg text-surface-on mb-3",children:"How are you feeling today?"}),(0,u.jsx)("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-5 gap-3",children:yQ.map(e=>(0,u.jsxs)("button",{onClick:()=>j(e.name),className:`p-4 rounded-xl flex flex-col items-center justify-center space-y-2 transition-all transform hover:scale-105 ${k===e.name?"bg-primary-container text-on-primary-container ring-2 ring-primary":"bg-surface-container hover:bg-surface-container-high text-surface-on-variant"}`,"aria-pressed":k===e.name,children:[(0,u.jsx)("span",{className:`w-8 h-8 ${e.colorClass} ${e.darkColorClass}`,children:e.icon}),(0,u.jsx)("span",{className:"text-label-md font-medium",children:e.name})]},e.name))})]}),(0,u.jsxs)("div",{className:"mb-8",children:[(0,u.jsxs)("div",{className:"flex items-center mb-1",children:[(0,u.jsx)(ev,{className:"w-6 h-6 text-secondary mr-2"}),(0,u.jsx)("h4",{className:"font-serif text-title-lg text-surface-on",children:"Daily Goals"})]}),(0,u.jsxs)("div",{className:"flex gap-3 my-3",children:[(0,u.jsx)("input",{ref:z,type:"text",value:C,onChange:e=>M(e.target.value),onKeyPress:e=>"Enter"===e.key&&ea(),placeholder:"Add a daily goal...",className:"flex-grow p-3 bg-surface-container border border-outline-variant rounded-xl text-body-lg","aria-label":"New daily goal"}),(0,u.jsx)(Q,{onClick:ea,variant:"tonal",leadingIcon:(0,u.jsx)(eA,{}),"aria-label":"Add daily goal",children:"Add"})]}),N.length>0?(0,u.jsx)("ul",{className:"space-y-2 max-h-48 overflow-y-auto",children:N.map(e=>(0,u.jsxs)("li",{className:"flex items-center justify-between p-2.5 bg-surface rounded-lg",children:[(0,u.jsxs)("label",{className:"flex items-center gap-3 cursor-pointer group flex-grow mr-2",children:[(0,u.jsx)("input",{type:"checkbox",checked:e.completed,onChange:()=>ec(e.id,S),className:"h-5 w-5 rounded text-secondary focus:ring-secondary"}),(0,u.jsx)("span",{className:`text-body-md group-hover:text-secondary ${e.completed?"line-through text-surface-on-variant":""}`,children:e.text})]}),(0,u.jsx)(Q,{onClick:()=>ed(e.id,S),variant:"text",size:"sm",isIconOnly:!0,title:"Delete goal",className:"text-error hover:bg-error-container/20",children:(0,u.jsx)(oY,{className:"w-5 h-5"})})]},e.id))}):(0,u.jsx)("p",{className:"text-center text-sm text-surface-on-variant py-3",children:"No goals set for today."})]}),(0,u.jsxs)("div",{children:[(0,u.jsxs)("div",{className:"flex items-center mb-2",children:[(0,u.jsx)(es,{className:"w-6 h-6 text-tertiary mr-2"}),(0,u.jsx)("h4",{className:"font-serif text-title-lg text-surface-on",children:"Daily Notes & Tasks"})]}),(0,u.jsxs)("div",{className:"relative",children:[(0,u.jsx)("textarea",{ref:L,value:E,onChange:e=>T(e.target.value),placeholder:"Jot down other thoughts, to-dos... Use [ ] or [x] for tasks.",rows:8,className:"w-full p-3 bg-surface-container border border-outline-variant rounded-xl text-body-lg","aria-label":"General tasks and notes"}),ei.isSpeechSupported&&(0,u.jsx)(Q,{onClick:()=>ei.isRecording?ei.stopRecording():ei.startRecording(),variant:ei.isRecording?"filled":"tonal",size:"sm",isIconOnly:!0,className:"absolute top-2.5 right-2.5",title:ei.isRecording?"Stop Dictation":"Start Dictation",leadingIcon:ei.isRecording?(0,u.jsx)(l_,{}):(0,u.jsx)(oW,{})})]}),ei.speechError&&(0,u.jsx)("p",{className:"text-label-md text-error mt-1 px-1",children:ei.speechError})]})]}),(0,u.jsxs)("section",{className:"bg-surface-container-low p-4 sm:p-6 lg:p-8 rounded-2xl shadow-lg hover:shadow-xl","aria-labelledby":"weekly-planner-heading",children:[(0,u.jsxs)("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-2 mb-4",children:[(0,u.jsx)("h3",{id:"weekly-planner-heading",className:"font-serif text-headline-sm text-surface-on",children:"Weekly Plan"}),(0,u.jsxs)("div",{className:"flex items-center gap-1",children:[(0,u.jsx)(Q,{onClick:()=>v(e=>yb(e,-7)),variant:"text",size:"sm",isIconOnly:!0,"aria-label":"Previous Week",children:(0,u.jsx)(ym,{})}),(0,u.jsx)("span",{className:"text-title-sm text-surface-on-variant whitespace-nowrap",children:yY(x)}),(0,u.jsx)(Q,{onClick:()=>v(e=>yb(e,7)),variant:"text",size:"sm",isIconOnly:!0,"aria-label":"Next Week",children:(0,u.jsx)(yg,{})})]})]}),(0,u.jsxs)("div",{className:"mb-6",children:[(0,u.jsxs)("div",{className:"flex items-center mb-1",children:[(0,u.jsx)(ev,{className:"w-6 h-6 text-secondary mr-2"}),(0,u.jsx)("h4",{className:"font-serif text-title-lg text-surface-on",children:"Weekly Goals"})]}),(0,u.jsxs)("div",{className:"flex gap-3 my-3",children:[(0,u.jsx)("input",{ref:V,type:"text",value:O,onChange:e=>R(e.target.value),onKeyPress:e=>"Enter"===e.key&&el(),placeholder:"Add a weekly goal...",className:"flex-grow p-3 bg-surface-container border border-outline-variant rounded-xl text-body-lg","aria-label":"New weekly goal"}),(0,u.jsx)(Q,{onClick:el,variant:"tonal",leadingIcon:(0,u.jsx)(eA,{}),"aria-label":"Add weekly goal",children:"Add"})]}),A.length>0?(0,u.jsx)("ul",{className:"space-y-2 max-h-48 overflow-y-auto",children:A.map(e=>(0,u.jsxs)("li",{className:"flex items-center justify-between p-2.5 bg-surface rounded-lg",children:[(0,u.jsxs)("label",{className:"flex items-center gap-3 cursor-pointer group flex-grow mr-2",children:[(0,u.jsx)("input",{type:"checkbox",checked:e.completed,onChange:()=>ec(e.id,D),className:"h-5 w-5 rounded text-secondary focus:ring-secondary"}),(0,u.jsx)("span",{className:`text-body-md group-hover:text-secondary ${e.completed?"line-through text-surface-on-variant":""}`,children:e.text})]}),(0,u.jsx)(Q,{onClick:()=>ed(e.id,D),variant:"text",size:"sm",isIconOnly:!0,title:"Delete goal",className:"text-error hover:bg-error-container/20",children:(0,u.jsx)(oY,{className:"w-5 h-5"})})]},e.id))}):(0,u.jsx)("p",{className:"text-center text-sm text-surface-on-variant py-3",children:"No goals set for this week."})]}),(0,u.jsxs)("div",{children:[(0,u.jsxs)("div",{className:"flex items-center mb-2",children:[(0,u.jsx)(es,{className:"w-6 h-6 text-tertiary mr-2"}),(0,u.jsx)("h4",{className:"font-serif text-title-lg text-surface-on",children:"Weekly Notes"})]}),(0,u.jsx)("textarea",{value:P,onChange:e=>I(e.target.value),placeholder:"General thoughts for the week...",rows:5,className:"w-full p-3 bg-surface-container border border-outline-variant rounded-xl text-body-lg","aria-label":"Weekly notes"})]})]}),(0,u.jsx)("div",{className:"mt-8 flex justify-center",children:(0,u.jsx)(Q,{onClick:()=>{let e=`Week of ${yY(x)}

`;A.length>0&&(e+="--- Weekly Goals ---\n",A.forEach(t=>{e+=`- [${t.completed?"X":" "}] ${t.text}
`}),e+="\n"),P.trim()&&(e+="--- Weekly Notes ---\n"+P.trim()+"\n\n"),e+=`--- Today's Focus: ${y.toLocaleDateString("en-US",{weekday:"long",month:"long",day:"numeric"})} ---
`,k&&(e+=`Mood: ${k}
`),N.length>0&&N.forEach(t=>{e+=`- [${t.completed?"X":" "}] ${t.text}
`}),E.trim()&&(e+="Notes & Tasks:\n"+E.trim()+"\n"),i(e)},variant:"filled",size:"lg",leadingIcon:(0,u.jsx)(oq,{}),disabled:!(A.length>0||P.trim()||k||N.length>0||E.trim()),"aria-label":"Save current plans to journal",children:"Save Plan to Journal"})})]})}),"calendar"===m&&(0,u.jsxs)("div",{className:"space-y-8",children:[(0,u.jsx)(yL,{viewMode:B,onViewChange:e=>W(e),onAddEvent:()=>ep()}),(()=>{let e={currentDisplayDate:_,events:et,journalEntries:en,thoughtRecords:er,onPrev:eu,onNext:eh,currentDateTitle:eg(),onViewJournalEntry:p,onViewThoughtRecord:f};switch(B){case"month":return(0,u.jsx)(yV,{...e,onDateClick:em,onEventClick:ef});case"week":return(0,u.jsx)(y$,{...e,onDateClick:em,onEventClick:ef});case"day":return(0,u.jsx)(y_,{...e,onEventClick:ef,onAddEvent:ep});default:return null}})()]}),(0,u.jsx)(yW,{isOpen:q,onClose:()=>H(!1),onSave:e=>{e.id?c(e):l(e),H(!1)},eventToEdit:U,initialDate:J}),(0,u.jsx)(yK,{isOpen:Y,onClose:()=>X(!1),event:Z,onEdit:e=>{K(e),G(yD(e.start)),H(!0)},onDelete:d})]})},y1=({isOpen:e,onClose:t,onSave:n,initialData:r})=>{let[i,s]=(0,h.useState)(""),[o,a]=(0,h.useState)(""),[l,c]=(0,h.useState)(""),[d,p]=(0,h.useState)(""),[f,m]=(0,h.useState)(null),g=(0,h.useRef)(null);return(0,h.useEffect)(()=>{e&&(r?(s(r.name),a(r.dosage),c(r.frequency),p(r.notes||"")):(s(""),a(""),c(""),p("")),m(null),setTimeout(()=>g.current?.focus(),100))},[e,r]),(0,u.jsx)(lL,{isOpen:e,onClose:t,title:r?"Edit Medication":"Add New Medication",children:(0,u.jsxs)("form",{onSubmit:e=>{if(e.preventDefault(),!i.trim()||!o.trim()||!l.trim())return void m("Name, Dosage, and Frequency are required.");n({id:r?.id,name:i.trim(),dosage:o.trim(),frequency:l.trim(),notes:d.trim()||void 0}),t()},className:"space-y-7 p-6",children:[f&&(0,u.jsx)("div",{className:"bg-error-container text-on-error-container p-3 rounded-lg text-sm",role:"alert",children:f}),(0,u.jsxs)("div",{children:[(0,u.jsxs)("label",{htmlFor:"medName",className:"block text-sm font-medium text-surface-on-variant mb-1",children:["Medication Name ",(0,u.jsx)("span",{className:"text-error",children:"*"})]}),(0,u.jsx)("input",{ref:g,type:"text",id:"medName",value:i,onChange:e=>s(e.target.value),className:"w-full p-4 bg-surface-container-low border border-outline-variant hover:border-outline focus:border-primary focus:ring-1 focus:ring-primary rounded-lg text-surface-on placeholder-surface-on-variant",placeholder:"e.g., Ibuprofen",required:!0,"aria-required":"true"})]}),(0,u.jsxs)("div",{children:[(0,u.jsxs)("label",{htmlFor:"medDosage",className:"block text-sm font-medium text-surface-on-variant mb-1",children:["Dosage ",(0,u.jsx)("span",{className:"text-error",children:"*"})]}),(0,u.jsx)("input",{type:"text",id:"medDosage",value:o,onChange:e=>a(e.target.value),className:"w-full p-4 bg-surface-container-low border border-outline-variant hover:border-outline focus:border-primary focus:ring-1 focus:ring-primary rounded-lg text-surface-on placeholder-surface-on-variant",placeholder:"e.g., 200mg, 1 tablet",required:!0,"aria-required":"true"})]}),(0,u.jsxs)("div",{children:[(0,u.jsxs)("label",{htmlFor:"medFrequency",className:"block text-sm font-medium text-surface-on-variant mb-1",children:["Frequency ",(0,u.jsx)("span",{className:"text-error",children:"*"})]}),(0,u.jsx)("input",{type:"text",id:"medFrequency",value:l,onChange:e=>c(e.target.value),className:"w-full p-4 bg-surface-container-low border border-outline-variant hover:border-outline focus:border-primary focus:ring-1 focus:ring-primary rounded-lg text-surface-on placeholder-surface-on-variant",placeholder:"e.g., Daily, Twice a day, As needed",required:!0,"aria-required":"true"})]}),(0,u.jsxs)("div",{children:[(0,u.jsx)("label",{htmlFor:"medNotes",className:"block text-sm font-medium text-surface-on-variant mb-1",children:"Notes (Optional)"}),(0,u.jsx)("textarea",{id:"medNotes",value:d,onChange:e=>p(e.target.value),rows:3,className:"w-full p-4 bg-surface-container-low border border-outline-variant hover:border-outline focus:border-primary focus:ring-1 focus:ring-primary rounded-lg text-surface-on placeholder-surface-on-variant",placeholder:"e.g., Take with food, For headaches"})]}),(0,u.jsxs)("div",{className:"flex justify-end space-x-3 pt-2",children:[(0,u.jsx)(Q,{type:"button",variant:"text",onClick:t,children:"Cancel"}),(0,u.jsx)(Q,{type:"submit",variant:"filled",leadingIcon:(0,u.jsx)(oq,{}),children:r?"Save Changes":"Add Medication"})]})]})})},y2=(0,K.A)("CircleCheckBig",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]),y4=({medication:e,onLogTaken:t,onEdit:n,onDelete:r})=>(0,u.jsxs)("div",{className:"bg-surface-container-low shadow-lg rounded-xl p-5 sm:p-6 hover:shadow-xl transition-shadow duration-300",children:[(0,u.jsxs)("div",{className:"flex justify-between items-start mb-3",children:[(0,u.jsxs)("div",{children:[(0,u.jsx)("h3",{className:"font-serif text-title-lg text-surface-on",children:e.name}),(0,u.jsxs)("p",{className:"text-body-md text-surface-on-variant",children:[e.dosage," - ",e.frequency]})]}),(0,u.jsxs)("div",{className:"flex space-x-1",children:[(0,u.jsx)(Q,{variant:"text",size:"sm",isIconOnly:!0,title:"Edit Medication",onClick:()=>n(e),"aria-label":`Edit ${e.name}`,children:(0,u.jsx)(oG,{className:"w-5 h-5"})}),(0,u.jsx)(Q,{variant:"text",size:"sm",isIconOnly:!0,title:"Delete Medication",onClick:()=>{r(e.id)},"aria-label":`Delete ${e.name}`,className:"text-error hover:bg-error-container/20",children:(0,u.jsx)(oY,{className:"w-5 h-5"})})]})]}),e.notes&&(0,u.jsxs)("p",{className:"text-body-sm text-surface-on-variant italic bg-surface-container p-2 rounded-md mb-3",children:["Notes: ",e.notes]}),(0,u.jsx)(Q,{variant:"tonal",size:"md",leadingIcon:(0,u.jsx)(y2,{className:"w-5 h-5"}),onClick:()=>t(e),className:"w-full","aria-label":`Log ${e.name} as taken`,children:"Log Taken Now"})]}),y3=({logs:e})=>{if(0===e.length)return(0,u.jsx)("p",{className:"text-center text-surface-on-variant py-8 text-body-lg",children:"No medication intakes logged yet."});let t=e=>new Date(e).toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit",month:"short",day:"numeric"});return(0,u.jsx)("div",{className:"space-y-3",children:e.map(e=>(0,u.jsxs)("div",{className:"bg-surface-container-low p-4 rounded-lg shadow-sm flex items-center space-x-3",children:[(0,u.jsx)(y2,{className:"w-5 h-5 text-secondary flex-shrink-0"}),(0,u.jsxs)("div",{className:"flex-grow",children:[(0,u.jsxs)("p",{className:"text-body-md text-surface-on",children:[(0,u.jsx)("span",{className:"font-medium",children:e.medicationName})," (",e.dosage,")"]}),(0,u.jsxs)("p",{className:"text-label-sm text-surface-on-variant",children:["Logged at: ",t(e.timestamp)]})]})]},e.id))})},y5=({isOpen:e,onClose:t,onSave:n,existingMedications:r,initialData:i})=>{let[s,o]=(0,h.useState)(""),[a,l]=(0,h.useState)(new Set),[c,d]=(0,h.useState)(null),p=(0,h.useRef)(null);(0,h.useEffect)(()=>{e&&(i?(o(i.name),l(new Set(i.medicationIds))):(o(""),l(new Set)),d(null),setTimeout(()=>p.current?.focus(),100))},[e,i]);let f=e=>{l(t=>{let n=new Set(t);return n.has(e)?n.delete(e):n.add(e),n})},m=[...r].sort((e,t)=>e.name.localeCompare(t.name));return(0,u.jsx)(lL,{isOpen:e,onClose:t,title:i?"Edit Medication Bundle":"Create New Medication Bundle",children:(0,u.jsxs)("form",{onSubmit:e=>(e.preventDefault(),s.trim())?0===a.size?void d("Please select at least one medication for the bundle."):void(n({id:i?.id,name:s.trim(),medicationIds:Array.from(a)}),t()):void d("Bundle name is required."),className:"space-y-7 p-6",children:[c&&(0,u.jsx)("div",{className:"bg-error-container text-on-error-container p-3 rounded-lg text-sm",role:"alert",children:c}),(0,u.jsxs)("div",{children:[(0,u.jsxs)("label",{htmlFor:"groupName",className:"block text-sm font-medium text-surface-on-variant mb-1",children:["Bundle Name ",(0,u.jsx)("span",{className:"text-error",children:"*"})]}),(0,u.jsx)("input",{ref:p,type:"text",id:"groupName",value:s,onChange:e=>o(e.target.value),className:"w-full p-4 bg-surface-container-low border border-outline-variant hover:border-outline focus:border-primary focus:ring-1 focus:ring-primary rounded-lg text-surface-on placeholder-surface-on-variant",placeholder:"e.g., Morning Pills, Bedtime Routine",required:!0,"aria-required":"true"})]}),(0,u.jsxs)("div",{children:[(0,u.jsxs)("label",{className:"block text-sm font-medium text-surface-on-variant mb-2",children:["Select Medications for this Bundle ",(0,u.jsx)("span",{className:"text-error",children:"*"})]}),m.length>0?(0,u.jsx)("div",{className:"max-h-60 overflow-y-auto space-y-2 border border-outline-variant p-3 rounded-lg bg-surface",children:m.map(e=>(0,u.jsxs)("label",{className:"flex items-center space-x-3 p-2 rounded-md hover:bg-surface-container cursor-pointer",children:[(0,u.jsx)("input",{type:"checkbox",checked:a.has(e.id),onChange:()=>f(e.id),className:"h-5 w-5 rounded text-primary focus:ring-primary border-outline-variant"}),(0,u.jsxs)("span",{className:"text-body-md text-surface-on",children:[e.name," ",(0,u.jsxs)("span",{className:"text-sm text-surface-on-variant",children:["(",e.dosage,", ",e.frequency,")"]})]})]},e.id))}):(0,u.jsx)("p",{className:"text-sm text-surface-on-variant italic",children:"No medications available to add to a bundle. Please add medications first."})]}),(0,u.jsxs)("div",{className:"flex justify-end space-x-3 pt-2",children:[(0,u.jsx)(Q,{type:"button",variant:"text",onClick:t,children:"Cancel"}),(0,u.jsx)(Q,{type:"submit",variant:"filled",leadingIcon:(0,u.jsx)(oq,{}),children:i?"Save Changes":"Create Bundle"})]})]})})},y6=(0,K.A)("Package",[["path",{d:"M11 21.73a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73z",key:"1a0edw"}],["path",{d:"M12 22V12",key:"d0xqtd"}],["polyline",{points:"3.29 7 12 12 20.71 7",key:"ousv84"}],["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}]]),y8=(0,K.A)("ChevronUp",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]]),y9=(0,K.A)("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]),y7=({group:e,medications:t,onLogBundle:n,onEdit:r,onDelete:i})=>{let[s,o]=f().useState(!1),a=e.medicationIds.map(e=>t.find(t=>t.id===e)).filter(Boolean);return(0,u.jsxs)("div",{className:"bg-surface-container-low shadow-lg rounded-xl p-5 sm:p-6 hover:shadow-xl transition-shadow duration-300",children:[(0,u.jsxs)("div",{className:"flex justify-between items-start mb-3",children:[(0,u.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,u.jsx)(y6,{className:"w-6 h-6 text-secondary"}),(0,u.jsx)("h3",{className:"font-serif text-title-lg text-surface-on",children:e.name}),(0,u.jsxs)("span",{className:"text-sm text-surface-on-variant",children:["(",a.length," meds)"]})]}),(0,u.jsxs)("div",{className:"flex space-x-1",children:[(0,u.jsx)(Q,{variant:"text",size:"sm",isIconOnly:!0,title:"Edit Bundle",onClick:()=>r(e),"aria-label":`Edit bundle ${e.name}`,children:(0,u.jsx)(oG,{className:"w-5 h-5"})}),(0,u.jsx)(Q,{variant:"text",size:"sm",isIconOnly:!0,title:"Delete Bundle",onClick:()=>i(e.id),"aria-label":`Delete bundle ${e.name}`,className:"text-error hover:bg-error-container/20",children:(0,u.jsx)(oY,{className:"w-5 h-5"})})]})]}),a.length>0&&(0,u.jsxs)("div",{className:"mb-4",children:[(0,u.jsx)(Q,{onClick:()=>o(!s),variant:"text",size:"sm",className:"text-xs text-surface-on-variant",trailingIcon:s?(0,u.jsx)(y8,{className:"w-4 h-4"}):(0,u.jsx)(y9,{className:"w-4 h-4"}),"aria-expanded":s,"aria-controls":`bundle-meds-${e.id}`,children:s?"Hide Medications":"Show Medications"}),s&&(0,u.jsx)("ul",{id:`bundle-meds-${e.id}`,className:"list-disc list-inside mt-2 pl-4 space-y-1 text-sm text-surface-on-variant",children:a.map(e=>(0,u.jsxs)("li",{children:[e.name," (",e.dosage,")"]},e.id))})]}),0===a.length&&(0,u.jsx)("p",{className:"text-sm text-surface-on-variant italic mb-3",children:"This bundle is empty. Edit to add medications."}),(0,u.jsx)(Q,{variant:"filled",size:"md",leadingIcon:(0,u.jsx)(eb,{className:"w-5 h-5"}),onClick:()=>n(e.id),className:"w-full","aria-label":`Log all medications in bundle ${e.name} as taken`,disabled:0===a.length,children:"Log All in Bundle Taken"})]})},xe=({medications:e,medicationLogs:t,medicationGroups:n,onAddMedication:r,onUpdateMedication:i,onDeleteMedication:s,onLogMedicationIntake:o,onClearMedicationLog:a,onAddMedicationGroup:l,onUpdateMedicationGroup:c,onDeleteMedicationGroup:d,onLogMedicationBundle:p})=>{let[f,m]=(0,h.useState)(!1),[g,y]=(0,h.useState)(null),[x,v]=(0,h.useState)(!1),[b,w]=(0,h.useState)(null),[k,j]=(0,h.useState)("medications"),N=e=>{y(e),m(!0)},S=e=>{w(e),v(!0)},C=[...t].sort((e,t)=>t.timestamp-e.timestamp),M=[...e].sort((e,t)=>t.addedTimestamp-e.addedTimestamp),E=[...n].sort((e,t)=>e.name.localeCompare(t.name));return(0,u.jsxs)("div",{className:"space-y-10 animate-in fade-in-0 duration-750 max-w-3xl w-full",children:[(0,u.jsxs)("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4",children:[(0,u.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,u.jsx)(ec,{className:"w-8 h-8 text-primary transform rotate-90"}),(0,u.jsx)("h2",{className:"font-serif text-headline-lg text-surface-on",children:"Medication Tracker"})]}),(0,u.jsx)(Q,{variant:"filled",size:"md",leadingIcon:(0,u.jsx)(eM,{}),onClick:()=>{y(null),m(!0)},className:"w-full sm:w-auto","aria-label":"Add new medication",children:"Add New Medication"})]}),(0,u.jsx)("div",{className:"flex justify-start",children:(0,u.jsx)(yI,{value:k,onChange:e=>j(e),options:[{value:"medications",label:"My Medications"},{value:"log",label:"Log"}]})}),"medications"===k&&(0,u.jsxs)("div",{className:"space-y-10",children:[(0,u.jsxs)("section",{"aria-labelledby":"medication-bundles-heading",children:[(0,u.jsxs)("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-3 mb-4",children:[(0,u.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,u.jsx)(y6,{className:"w-7 h-7 text-secondary"}),(0,u.jsx)("h3",{id:"medication-bundles-heading",className:"font-serif text-headline-sm text-surface-on",children:"My Medication Bundles"})]}),(0,u.jsx)(Q,{variant:"tonal",size:"md",leadingIcon:(0,u.jsx)(eM,{}),onClick:()=>{w(null),v(!0)},className:"w-full sm:w-auto","aria-label":"Create new medication bundle",disabled:0===e.length,children:"Create New Bundle"})]}),0===e.length&&(0,u.jsx)("p",{className:"text-sm text-center text-surface-on-variant py-4 italic",children:"Add medications first to create bundles."}),e.length>0&&0===E.length&&(0,u.jsx)("p",{className:"text-center text-surface-on-variant py-8 text-body-lg",children:'No medication bundles created yet. Click "Create New Bundle".'}),E.length>0&&(0,u.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:E.map(t=>(0,u.jsx)(y7,{group:t,medications:e,onLogBundle:p,onEdit:S,onDelete:d},t.id))})]}),(0,u.jsxs)("section",{"aria-labelledby":"medications-list-heading",className:"pt-10 border-t border-outline-variant",children:[(0,u.jsx)("h3",{id:"medications-list-heading",className:"font-serif text-headline-sm text-surface-on mb-4",children:"All Individual Medications"}),0!==M.length||f?(0,u.jsx)("div",{className:"space-y-4",children:M.map(e=>(0,u.jsx)(y4,{medication:e,onLogTaken:o,onEdit:N,onDelete:s},e.id))}):(0,u.jsx)("p",{className:"text-center text-surface-on-variant py-8 text-body-lg",children:"No medications added yet."})]})]}),"log"===k&&(0,u.jsxs)("section",{"aria-labelledby":"medication-log-heading",children:[(0,u.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,u.jsx)("h3",{id:"medication-log-heading",className:"font-serif text-headline-sm text-surface-on",children:"Medication Log"}),t.length>0&&(0,u.jsx)(Q,{variant:"outlined",size:"sm",leadingIcon:(0,u.jsx)(oY,{className:"w-4 h-4"}),onClick:a,"aria-label":"Clear entire medication log",className:"text-error hover:bg-error-container/20 border-error",children:"Clear Log"})]}),(0,u.jsx)("div",{className:"bg-surface-container p-6 rounded-xl shadow",children:(0,u.jsx)("div",{className:"max-h-[600px] overflow-y-auto",children:(0,u.jsx)(y3,{logs:C})})})]}),(0,u.jsx)(y1,{isOpen:f,onClose:()=>m(!1),onSave:t=>{if(t.id){let n=e.find(e=>e.id===t.id);n&&i({...n,name:t.name,dosage:t.dosage,frequency:t.frequency,notes:t.notes})}else r(t)},initialData:g}),(0,u.jsx)(y5,{isOpen:x,onClose:()=>v(!1),onSave:e=>{if(e.id){let t=n.find(t=>t.id===e.id);t&&c({...t,name:e.name,medicationIds:e.medicationIds})}else l(e.name,e.medicationIds)},existingMedications:e,initialData:b})]})},xt=(0,K.A)("Heart",[["path",{d:"M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z",key:"c3ymky"}]]),xn=({className:e="w-6 h-6 text-blue-500"})=>(0,u.jsxs)("svg",{className:`animate-spin ${e}`,xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,u.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,u.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),xr=["I am capable and strong, and I face challenges with courage.","I choose to be happy and grateful today, embracing all life offers.","I am worthy of love, respect, and all good things life brings.","I embrace challenges as opportunities for profound growth and learning.","I am resilient and can overcome any obstacle with grace and determination.","I trust in my unique abilities and listen to my inner wisdom.","I attract positivity, abundance, and joy into my life effortlessly.","I am at peace with who I am, and I celebrate my journey.","I make a positive and meaningful impact on the world around me.","Every day is a new beginning, filled with endless potential and hope.","I am surrounded by love, support, and understanding.","I believe deeply in myself and my dreams, and I pursue them with passion.","I forgive myself and others, releasing the past and embracing the present.","I am a creative and resourceful being, capable of finding solutions.","I radiate confidence, self-assurance, and inner calm.","My body is healthy, my mind is brilliant, my soul is tranquil.","I am creating the life of my dreams, one step at a time.","I have the power to create change and make a difference.","I am grateful for all the blessings in my life, big and small.","I release all doubts and fears, and I step into my power.","Embracing support empowers me; seeking help is a testament to my strength and awareness.","Flexibility is my superpower; changing my mind is a sign of growth, not weakness.","Every choice I make is grounded in my rich and undeniable personal journey.","I uplift others with the same encouragement and affirmation I offer myself.","My authentic self is a truth only I can define and embody.","I am fully entitled to voice my desires and needs.","Joy is my birthright; I allow myself to feel good and embrace happiness.","I possess the innate ability to harmonize ease and effort within my life's rhythm.","I am whole and complete in this moment; others enhance my journey, they do not define it.","A sense of peace and freedom from suffering fills me.","I am engaged in fulfilling work that aligns with my purpose and well-being.","I am inherently good, and I am continuously evolving for the better.","My growth journey is unique, and I am progressing at my perfect pace.","I am cradled and sustained by the love of those around me.","My emotional state is within my control; I consciously choose happiness.","I am receptive and open to the profound messages the universe unfolds for me daily.","I am cherished and inherently worthy of all good things.","My potential transcends any current circumstances.","I am open and welcoming to the process of healing and restoration.","Optimism guides me, for each day presents a fresh beginning and new possibilities.","I reside in a state of inner peace and completeness.","My very existence is evidence of who I am and what I deserve.","My responsibility begins with myself, and I build my strength from that foundation.","I am secure and enveloped by a network of love and unwavering support.","Learning is a lifelong journey, and making mistakes is an integral, acceptable part of it.","My voice is heard, and my unique perspective holds significant value.","I am a valuable contributor and an appreciated presence.","I am well-rested, energized, and enthusiastic for the day ahead.","I am deserving of self-investment, knowing it yields abundant returns.","I belong exactly where I am, and I have every right to occupy my space fully.","With each breath, I inhale healing energy, releasing all burdens and sorrows from my heart.","I breathe in unwavering trust and exhale all traces of doubt.","My heart can be tender and compassionate, while my boundaries remain strong and clear.","I have the power to consciously choose my response to challenging situations.","Holding contrasting emotions simultaneously is a sign of deep processing and growth.","I joyfully acknowledge and celebrate the good within myself and in others.","I am worthy of respectful physical connection, on my own terms.","I deserve access to information, and equally, moments of peaceful silence.","Self-respect is my due, and I thrive in a clean and organized environment.","Love is the guiding principle behind all my actions.","I do not have to remain in challenging places; assistance and light are always available to me.","I live authentically, presenting only my true self to the world.","My worth is intrinsic; I do not depend on others to define or elevate me.","I move through life with mindful intention, balancing activity with moments of serene stillness.","I embrace change gracefully, seeing each shift as a fresh opportunity for growth.","I nurture myself with empowering words and nourishing, joyful foods.","I welcome the mysteries in my heart, trusting that answers will unfold at the perfect time.","I naturally gravitate towards what inspires me, like a plant reaching for life-giving sunlight.","I have journeyed further than I ever imagined, learning and evolving with every step.","I possess all the necessary resources and inner strength for success.","I contribute to my community and receive steadfast support from it in return.","My intuition holds a profound wisdom that transcends mere knowledge.","I open my life to abundance and cultivate a generous spirit.","I invite artistic expression and harmonious music to enrich my daily existence.","I create space in my life for delightful spontaneity and unexpected adventures.","I release attachment to what is unattainable, freeing my energy for what is truly meant for me.","I anticipate tomorrow with excitement, eager for the opportunities it holds.","I revel in my passions and celebrate the things that bring me joy.","My decisions are guided by my inner wisdom, and my growth prompts necessary adjustments.","I dedicate time to fully experience grief and sadness when they arise, allowing for natural processing.","I nourish my being with kind words and wholesome, joyful foods.","I practice deep gratitude for all that I possess and all that is yet to manifest.","I release any fears that no longer serve my highest good.","I honor and respect the natural rhythms and cycles of life's seasons.","I actively seek out the magic and wonder hidden within everyday moments.","My aim is authentic joy, not an unattainable perfection.","I welcome the profound wisdom that accompanies the journey of aging.","I communicate my true self and my needs to others with honesty and clarity.","I elevate my own joy and contribute to the happiness of those around me.","I embrace the wisdom that comes with the passage of time and experience.","I greet what is present and welcome what is yet to come with an open heart.","I grant myself permission to continuously grow and transform.","Releasing what no longer serves me creates fertile ground for new opportunities to flourish.","My body is a beautiful and worthy vessel in this very moment, at its current form.","My body deserves devoted care and the adornment of garments that make me feel beautiful.","My emotions deserve to be identified, acknowledged, and fully experienced.","My heart is open to receiving support and helpfulness, both from myself and from others.","My heart possesses its own infallible compass, guiding me true.","My life is a unique journey, not a competition or a race against anyone else.","My viewpoint is singular and holds immense significance.","My happiness does not depend on, nor should it ever cause, another's suffering.","My sensitivity is a beautiful facet of who I am, and all my feelings and emotions are valid.","My unique quirks and eccentricities are wonderfully part of me.",'The act of saying "no" is a powerful affirmation of my self-worth and boundaries.',"Rest is productive work; sometimes the greatest progress comes from stillness.","Profound growth can be found in moments of quiet reflection and stillness.","There is peace and integrity in altering my perspective when motivated by love.","I discover poetry and beauty in every aspect of life, if I only choose to look for it.","There is a rightful place for me at every table; I am deserving of inclusion.","There is a singular contribution only I can offer to the world; this is my purpose for being here.","There is immense power in quiet strength, and vulnerability in speaking loudly.","Today, I celebrate the vitality of being younger than I will ever be again.","Each new day is a precious chance to grow, learn, and expand.","When fear arises, I consciously choose to feed my trust instead.","When I align with my deepest purpose, I become infinitely courageous.","Forgiving myself is the ultimate act of liberation.","Releasing shame allows me to step more fully and beautifully into my true self.","As I connect with the earth, it reciprocates by rising to support me.","When I clearly articulate my needs, they are met abundantly.","By treating myself with the kindness and understanding I'd offer a friend, I illuminate my best qualities and allow my true radiance to shine.","While words can influence me, they do not define my essence; I already exist, whole and complete.","I embrace imperfections as unique textures in the masterpiece of my life.","My intuition is a trusted guide, leading me toward my highest good.","I am capable of navigating challenges with grace and resilience.","Every step I take is a step towards my authentic self.","I create my own opportunities through my dedication and passion.","My creativity flows freely, manifesting beauty in all I do.","I am a powerful creator of my reality, shaping my world with intention.","Inspiration finds me in unexpected places, fueling my creative spirit.","I trust my artistic vision and bring it to life with confidence.","My designs tell a story, and I am the master storyteller.","I learn from every project, refining my craft with each new challenge.","My work brings joy and value to others, reflecting my unique perspective.","I am an endless source of innovative ideas and fresh perspectives.","I celebrate my progress, no matter how small, knowing it leads to great achievements."],xi=({profileData:e,onUpdateProfile:t})=>{let[n,r]=(0,h.useState)(null),{toast:i}=(0,oV.dj)();(0,h.useEffect)(()=>{r(Math.floor(Math.random()*xr.length))},[]);let s=(0,h.useCallback)(()=>{null!==n&&r(e=>{let t=e;for(;t===e;)t=Math.floor(Math.random()*xr.length);return t})},[n]),o=(0,h.useMemo)(()=>null===n?null:xr[n],[n]),a=(0,h.useMemo)(()=>!!o&&!!e.favoriteAffirmations&&e.favoriteAffirmations.includes(o),[o,e.favoriteAffirmations]);return(0,u.jsx)("div",{className:"flex flex-col items-center justify-center min-h-[calc(100vh-10rem)] py-12 animate-in fade-in-0 duration-1000",children:(0,u.jsxs)("div",{className:"text-center p-4 sm:p-8 lg:p-12 bg-gradient-to-br from-primary-container via-secondary-container/30 to-tertiary-container/20 rounded-3xl shadow-2xl max-w-2xl w-full transform transition-all hover:scale-[1.01] duration-500",children:[(0,u.jsxs)("div",{className:"flex flex-col items-center mb-6",children:[(0,u.jsx)(el,{className:"w-16 h-16 text-primary mb-3"}),(0,u.jsx)("h2",{className:"font-serif text-headline-lg text-on-primary-container",children:"Your Daily Affirmation"}),(0,u.jsx)("p",{className:"text-body-lg text-on-primary-container/80 mt-1",children:"Embrace positivity and empower your day."})]}),(0,u.jsx)("div",{className:"my-10 p-6 bg-surface/80 rounded-2xl min-h-[150px] flex items-center justify-center",role:"region","aria-live":"polite","aria-atomic":"true",children:o?(0,u.jsxs)("p",{className:"font-serif text-headline-md sm:text-display-sm text-surface-on leading-tight",children:['"',o,'"']}):(0,u.jsxs)("div",{className:"flex flex-col items-center justify-center text-surface-on-variant",children:[(0,u.jsx)(xn,{className:"w-8 h-8 text-primary"}),(0,u.jsx)("p",{className:"mt-2 text-sm",children:"Finding your inspiration..."})]})}),(0,u.jsxs)("div",{className:"flex flex-col sm:flex-row justify-center items-center gap-4 mt-8",children:[(0,u.jsx)(Q,{onClick:s,variant:"filled",size:"lg",leadingIcon:(0,u.jsx)(eC,{}),"aria-label":"Show another affirmation",disabled:null===o,children:"Show Another"}),(0,u.jsx)(Q,{variant:"tonal",size:"lg",leadingIcon:(0,u.jsx)(xt,{className:a?"fill-current":""}),onClick:()=>{let n;if(!o)return;let r=e.favoriteAffirmations||[];a?(n=r.filter(e=>e!==o),i({title:"Removed from Favorites"})):(n=[...r,o],i({title:"Added to Favorites!"})),t({...e,favoriteAffirmations:n})},disabled:null===o,"aria-label":a?"Remove from favorites":"Favorite this affirmation",children:a?"Favorited":"Favorite"})]})]})})},xs=(0,K.A)("Palette",[["circle",{cx:"13.5",cy:"6.5",r:".5",fill:"currentColor",key:"1okk4w"}],["circle",{cx:"17.5",cy:"10.5",r:".5",fill:"currentColor",key:"f64h9f"}],["circle",{cx:"8.5",cy:"7.5",r:".5",fill:"currentColor",key:"fotxhn"}],["circle",{cx:"6.5",cy:"12.5",r:".5",fill:"currentColor",key:"qy21gx"}],["path",{d:"M12 2C6.5 2 2 6.5 2 12s4.5 10 10 10c.926 0 1.648-.746 1.648-1.688 0-.437-.18-.835-.437-1.125-.29-.289-.438-.652-.438-1.125a1.64 1.64 0 0 1 1.668-1.668h1.996c3.051 0 5.555-2.503 5.555-5.554C21.965 6.012 17.461 2 12 2z",key:"12rzf8"}]]),xo=(0,K.A)("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]),xa=(0,K.A)("Layers",[["path",{d:"M12.83 2.18a2 2 0 0 0-1.66 0L2.6 6.08a1 1 0 0 0 0 1.83l8.58 3.91a2 2 0 0 0 1.66 0l8.58-3.9a1 1 0 0 0 0-1.83z",key:"zw3jo"}],["path",{d:"M2 12a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 12",key:"1wduqc"}],["path",{d:"M2 17a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 17",key:"kqbvx6"}]]),xl=(0,K.A)("Server",[["rect",{width:"20",height:"8",x:"2",y:"2",rx:"2",ry:"2",key:"ngkwjq"}],["rect",{width:"20",height:"8",x:"2",y:"14",rx:"2",ry:"2",key:"iecqi9"}],["line",{x1:"6",x2:"6.01",y1:"6",y2:"6",key:"16zg32"}],["line",{x1:"6",x2:"6.01",y1:"18",y2:"18",key:"nzw8ys"}]]),xc=(0,K.A)("CloudDownload",[["path",{d:"M12 13v8l-4-4",key:"1f5nwf"}],["path",{d:"m12 21 4-4",key:"1lfcce"}],["path",{d:"M4.393 15.269A7 7 0 1 1 15.71 8h1.79a4.5 4.5 0 0 1 2.436 8.284",key:"ui1hmy"}]]),xd=(0,K.A)("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]),xu=["Adventurous","Ambition","Artistic Ability","Assertiveness","Athleticism","Bravery","Common Sense","Confidence","Cooperation","Creativity","Curiosity","Discipline","Empathy","Enthusiasm","Fairness","Flexibility","Forgiveness","Gratitude","Honesty","Humor","Independence","Intelligence","Kindness","Leadership","Logic","Love","Love of Learning","Mindedness","Modesty","Optimism","Patience","Persistence","Self-Control","Social Awareness","Spirituality","Wisdom"];var xh="Switch",[xp,xf]=(0,o1.A)(xh),[xm,xg]=xp(xh),xy=h.forwardRef((e,t)=>{let{__scopeSwitch:n,name:r,checked:i,defaultChecked:s,required:o,disabled:a,value:l="on",onCheckedChange:c,form:d,...p}=e,[f,m]=h.useState(null),g=(0,o0.s)(t,e=>m(e)),y=h.useRef(!1),x=!f||d||!!f.closest("form"),[v=!1,b]=(0,o6.i)({prop:i,defaultProp:s,onChange:c});return(0,u.jsxs)(xm,{scope:n,checked:v,disabled:a,children:[(0,u.jsx)(o9.sG.button,{type:"button",role:"switch","aria-checked":v,"aria-required":o,"data-state":xw(v),"data-disabled":a?"":void 0,disabled:a,value:l,...p,ref:g,onClick:(0,oQ.m)(e.onClick,e=>{b(e=>!e),x&&(y.current=e.isPropagationStopped(),y.current||e.stopPropagation())})}),x&&(0,u.jsx)(xb,{control:f,bubbles:!y.current,name:r,value:l,checked:v,required:o,disabled:a,form:d,style:{transform:"translateX(-100%)"}})]})});xy.displayName=xh;var xx="SwitchThumb",xv=h.forwardRef((e,t)=>{let{__scopeSwitch:n,...r}=e,i=xg(xx,n);return(0,u.jsx)(o9.sG.span,{"data-state":xw(i.checked),"data-disabled":i.disabled?"":void 0,...r,ref:t})});xv.displayName=xx;var xb=e=>{let{control:t,checked:n,bubbles:r=!0,...i}=e,s=h.useRef(null),o=lU(n),a=lK(t);return h.useEffect(()=>{let e=s.current,t=Object.getOwnPropertyDescriptor(window.HTMLInputElement.prototype,"checked").set;if(o!==n&&t){let i=new Event("click",{bubbles:r});t.call(e,n),e.dispatchEvent(i)}},[o,n,r]),(0,u.jsx)("input",{type:"checkbox","aria-hidden":!0,defaultChecked:n,...i,tabIndex:-1,ref:s,style:{...e.style,...a,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})};function xw(e){return e?"checked":"unchecked"}let xk=h.forwardRef(({className:e,...t},n)=>(0,u.jsx)(xy,{className:(0,X.cn)("peer inline-flex h-6 w-11 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=unchecked]:bg-input",e),...t,ref:n,children:(0,u.jsx)(xv,{className:(0,X.cn)("pointer-events-none block h-5 w-5 rounded-full bg-background shadow-lg ring-0 transition-transform data-[state=checked]:translate-x-5 data-[state=unchecked]:translate-x-0")})}));xk.displayName=xy.displayName;let xj=h.forwardRef(({className:e,...t},n)=>(0,u.jsx)("div",{ref:n,className:(0,X.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",e),...t}));xj.displayName="Card";let xN=h.forwardRef(({className:e,...t},n)=>(0,u.jsx)("div",{ref:n,className:(0,X.cn)("flex flex-col space-y-1.5 p-6",e),...t}));xN.displayName="CardHeader";let xS=h.forwardRef(({className:e,...t},n)=>(0,u.jsx)("div",{ref:n,className:(0,X.cn)("text-2xl font-semibold leading-none tracking-tight",e),...t}));xS.displayName="CardTitle";let xC=h.forwardRef(({className:e,...t},n)=>(0,u.jsx)("div",{ref:n,className:(0,X.cn)("text-sm text-muted-foreground",e),...t}));xC.displayName="CardDescription";let xM=h.forwardRef(({className:e,...t},n)=>(0,u.jsx)("div",{ref:n,className:(0,X.cn)("p-6 pt-0",e),...t}));xM.displayName="CardContent",h.forwardRef(({className:e,...t},n)=>(0,u.jsx)("div",{ref:n,className:(0,X.cn)("flex items-center p-6 pt-0",e),...t})).displayName="CardFooter";let xE=(0,yn.F)("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function xT({className:e,variant:t,...n}){return(0,u.jsx)("div",{className:(0,X.cn)(xE({variant:t}),e),...n})}let xA=()=>{let[e,t]=(0,h.useState)(null);(0,h.useEffect)(()=>{let e=e=>{e.preventDefault(),t(e)};window.addEventListener("beforeinstallprompt",e);let n=()=>{t(null)};return window.addEventListener("appinstalled",n),()=>{window.removeEventListener("beforeinstallprompt",e),window.removeEventListener("appinstalled",n)}},[]);let n=(0,h.useCallback)(async()=>{e&&(await e.prompt(),t(null))},[e]);return{installPrompt:e,handleInstallClick:n}},xD={planner:{label:"Planner Widget",description:"Shows today's goals and progress."},affirmations:{label:"Affirmations Widget",description:"Displays your favorite affirmations."},medication:{label:"Medication Widget",description:"Tracks medication counts and bundles."},copingMechanisms:{label:"Coping Strategies Widget",description:"Displays one of your quick strategies."}},xO=[{name:"echo",label:"Echo",bgColor:"hsl(205 75% 45%)",textColor:"hsl(0 0% 100%)"},{name:"forest",label:"Forest",bgColor:"hsl(110 35% 45%)",textColor:"hsl(110 35% 98%)"},{name:"buttercup",label:"Buttercup",bgColor:"hsl(45 80% 60%)",textColor:"hsl(45 25% 15%)"},{name:"sunset",label:"Sunset",bgColor:"hsl(20 80% 45%)",textColor:"hsl(20 80% 98%)"}],xR=({profileData:e,onUpdateProfile:t,currentTheme:n,currentPalette:r,onToggleTheme:i,onChangePalette:s,onDownloadJournal:o,onClearJournal:a,onClearPlanner:l,onClearMedication:c,onClearAllData:d,onNavigateToView:p,onReOnboard:f})=>{let[m,g]=(0,h.useState)(""),[y,x]=(0,h.useState)([]),[v,b]=(0,h.useState)([]),[w,k]=(0,h.useState)({}),[j,N]=(0,h.useState)([]),[S,C]=(0,h.useState)(""),[M,E]=(0,h.useState)(!0),[T,A]=(0,h.useState)(!1),{installPrompt:D,handleInstallClick:O}=xA();(0,h.useEffect)(()=>{g(e.name||""),x(e.strengths||[]),b(e.copingMechanisms||[]),k(e.dashboardWidgets||{}),N(e.favoriteAffirmations||[]),E(!0)},[e]);let R=(0,h.useCallback)(()=>{E(!1)},[]);(0,h.useEffect)(()=>{m!==e.name||JSON.stringify(y.sort())!==JSON.stringify(e.strengths?.sort()||[])||JSON.stringify(v)!==JSON.stringify(e.copingMechanisms)||JSON.stringify(w)!==JSON.stringify(e.dashboardWidgets)||JSON.stringify(j)!==JSON.stringify(e.favoriteAffirmations)?R():E(!0)},[m,y,v,w,j,e,R]);let P=e=>{x(t=>t.includes(e)?t.filter(t=>t!==e):[...t,e])},I=e=>{N(t=>t.filter(t=>t!==e))},L=e=>k(t=>({...t,[e]:!t[e]}));return(0,u.jsxs)("div",{className:"space-y-10 animate-in fade-in-0 duration-750 max-w-4xl w-full",children:[(0,u.jsxs)("div",{className:"flex items-center justify-between",children:[(0,u.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,u.jsx)(J,{className:"w-8 h-8 text-primary"}),(0,u.jsx)("h2",{className:"font-serif text-headline-lg text-surface-on",children:"Profile & Settings"})]}),(0,u.jsx)(Q,{onClick:()=>{t({name:m.trim(),strengths:y,copingMechanisms:v,dashboardWidgets:w,favoriteAffirmations:j}),E(!0)},variant:"filled",size:"md",leadingIcon:(0,u.jsx)(oq,{}),disabled:M,children:M?"Saved":"Save Changes"})]}),(0,u.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[(0,u.jsxs)(xj,{className:"bg-surface-container-low shadow-lg border-none",children:[(0,u.jsx)(xN,{children:(0,u.jsxs)(xS,{className:"flex items-center gap-2",children:[(0,u.jsx)(J,{className:"w-5 h-5"})," Personal Information"]})}),(0,u.jsxs)(xM,{className:"space-y-4",children:[(0,u.jsxs)("div",{children:[(0,u.jsx)("label",{htmlFor:"userName",className:"block text-sm font-medium text-surface-on-variant mb-1",children:"Your Name"}),(0,u.jsx)("input",{id:"userName",type:"text",value:m,onChange:e=>g(e.target.value),placeholder:"What should we call you?",className:"w-full p-4 bg-surface-container border border-outline-variant hover:border-outline focus:border-primary focus:ring-1 focus:ring-primary rounded-xl text-surface-on placeholder-surface-on-variant"})]}),(0,u.jsxs)("div",{children:[(0,u.jsx)("p",{className:"block text-sm font-medium text-surface-on-variant mb-1",children:"Account"}),(0,u.jsx)("p",{className:"w-full p-4 bg-surface border border-outline-variant rounded-xl text-surface-on-variant truncate",children:"Guest Mode"})]})]})]}),(0,u.jsxs)(xj,{className:"bg-surface-container-low shadow-lg border-none",children:[(0,u.jsx)(xN,{children:(0,u.jsxs)(xS,{className:"flex items-center gap-2",children:[(0,u.jsx)(xs,{className:"w-5 h-5"})," Appearance"]})}),(0,u.jsxs)(xM,{className:"space-y-4",children:[(0,u.jsxs)("div",{className:"flex items-center justify-between p-3 bg-surface rounded-lg",children:[(0,u.jsx)("h4",{className:"font-medium text-surface-on",children:"Theme"}),(0,u.jsxs)(Q,{variant:"tonal",size:"sm",leadingIcon:"light"===n?(0,u.jsx)(ey,{}):(0,u.jsx)(eg,{}),onClick:i,children:["Switch to ","light"===n?"Dark":"Light"]})]}),(0,u.jsxs)("div",{children:[(0,u.jsx)("h4",{className:"font-medium text-surface-on mb-3",children:"Color Palette"}),(0,u.jsx)("div",{className:"flex flex-wrap gap-2",children:xO.map(e=>(0,u.jsxs)("button",{onClick:()=>s(e.name),style:{backgroundColor:e.bgColor,color:e.textColor},className:(0,X.cn)("inline-flex items-center justify-center gap-1.5 whitespace-nowrap rounded-full text-xs font-medium px-4 h-8 transition-all","hover:brightness-110 active:brightness-90 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background",r===e.name&&"ring-2 ring-offset-2 ring-ring"),children:[(0,u.jsx)("span",{children:e.label}),r===e.name&&(0,u.jsx)(xo,{className:"w-4 h-4"})]},e.name))})]})]})]})]}),(0,u.jsxs)(xj,{className:"bg-surface-container-low shadow-lg border-none",children:[(0,u.jsxs)(xN,{children:[(0,u.jsxs)("div",{className:"flex justify-between items-center",children:[(0,u.jsxs)(xS,{className:"flex items-center gap-2",children:[(0,u.jsx)(xt,{className:"w-5 h-5"})," My Strengths"]}),!T&&(0,u.jsx)(Q,{variant:"tonal",size:"sm",onClick:()=>A(!0),children:"Edit"})]}),!T&&(0,u.jsx)(xC,{children:'A reminder of your best qualities. Click "Edit" to update.'})]}),(0,u.jsx)(xM,{children:T?(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)("p",{className:"text-body-md text-surface-on-variant mb-4",children:"Select the qualities that resonate with you."}),(0,u.jsx)("div",{className:"flex flex-wrap gap-2",children:xu.map(e=>{let t=y.includes(e);return(0,u.jsx)("button",{onClick:()=>P(e),className:`px-3 py-1.5 rounded-full text-sm font-medium transition-all duration-200 border ${t?"bg-secondary-container border-secondary-container text-on-secondary-container":"bg-surface border-outline-variant hover:border-outline text-surface-on-variant"}`,children:(0,u.jsxs)("div",{className:"flex items-center gap-1.5",children:[e,t&&(0,u.jsx)(xo,{className:"w-4 h-4"})]})},e)})}),(0,u.jsxs)("div",{className:"flex justify-end gap-2 mt-6",children:[(0,u.jsx)(Q,{variant:"text",onClick:()=>{A(!1),x(e.strengths||[])},children:"Cancel"}),(0,u.jsx)(Q,{variant:"tonal",onClick:()=>A(!1),children:"Done"})]})]}):(0,u.jsx)("div",{className:"flex flex-wrap gap-2",children:y.length>0?y.map(e=>(0,u.jsx)(xT,{variant:"secondary",className:"text-base px-3 py-1 bg-secondary-container text-on-secondary-container border-transparent",children:e},e)):(0,u.jsx)("p",{className:"text-body-md text-surface-on-variant italic",children:'No strengths selected yet. Click "Edit" to add some.'})})})]}),(0,u.jsxs)(xj,{className:"bg-surface-container-low shadow-lg border-none",children:[(0,u.jsxs)(xN,{children:[(0,u.jsxs)(xS,{className:"flex items-center gap-2",children:[(0,u.jsx)(xt,{className:"w-5 h-5 text-yellow-500"})," My Affirmations"]}),(0,u.jsx)(xC,{children:"Manage your list of custom and favorite affirmations."})]}),(0,u.jsx)(xM,{children:j.length>0?(0,u.jsx)("ul",{className:"space-y-2 max-h-60 overflow-y-auto",children:j.map((e,t)=>(0,u.jsxs)("li",{className:"flex items-center justify-between p-3 bg-surface rounded-lg",children:[(0,u.jsxs)("p",{className:"text-body-md text-surface-on flex-grow mr-2",children:['"',e,'"']}),(0,u.jsx)(Q,{variant:"text",size:"sm",isIconOnly:!0,title:"Remove affirmation",className:"text-error hover:bg-error-container/20",onClick:()=>I(e),children:(0,u.jsx)(oY,{className:"w-5 h-5"})})]},t))}):(0,u.jsx)("p",{className:"text-body-md text-surface-on-variant italic",children:"No affirmations favorited yet. Find some on the Affirmations page!"})})]}),(0,u.jsxs)(xj,{className:"bg-surface-container-low shadow-lg border-none",children:[(0,u.jsxs)(xN,{children:[(0,u.jsxs)(xS,{className:"flex items-center gap-2",children:[(0,u.jsx)(xa,{className:"w-5 h-5"})," Dashboard Customization"]}),(0,u.jsx)(xC,{children:"Choose which widgets appear on your dashboard."})]}),(0,u.jsx)(xM,{className:"space-y-3",children:Object.entries(xD).map(([e,t])=>(0,u.jsxs)("div",{className:"flex items-center justify-between p-3 bg-surface rounded-lg",children:[(0,u.jsxs)("div",{children:[(0,u.jsx)("h4",{className:"font-medium text-surface-on",children:t.label}),(0,u.jsx)("p",{className:"text-sm text-surface-on-variant",children:t.description})]}),(0,u.jsx)(xk,{checked:!!w[e],onCheckedChange:()=>L(e),"aria-label":`Toggle ${t.label} widget`})]},e))})]}),(0,u.jsxs)(xj,{className:"bg-surface-container-low shadow-lg border-none",children:[(0,u.jsx)(xN,{children:(0,u.jsxs)(xS,{className:"flex items-center gap-2",children:[(0,u.jsx)(xl,{className:"w-5 h-5"})," Data & Information"]})}),(0,u.jsxs)(xM,{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-3",children:[D&&(0,u.jsx)(Q,{variant:"filled",size:"md",leadingIcon:(0,u.jsx)(xc,{}),onClick:O,children:"Install App"}),(0,u.jsx)(Q,{variant:"tonal",size:"md",leadingIcon:(0,u.jsx)(xd,{}),onClick:o,children:"Export Journal"}),(0,u.jsx)(Q,{variant:"tonal",size:"md",leadingIcon:(0,u.jsx)(xa,{}),onClick:()=>p("designSystem"),children:"View Design System"})]})]}),(0,u.jsxs)(xj,{className:"bg-surface-container-low shadow-lg border-none",children:[(0,u.jsxs)(xN,{children:[(0,u.jsxs)(xS,{className:"flex items-center gap-2",children:[(0,u.jsx)(yF,{className:"w-5 h-5 text-error"})," Danger Zone"]}),(0,u.jsx)(xC,{className:"!text-error/80",children:"These actions are irreversible. Please be certain before proceeding."})]}),(0,u.jsxs)(xM,{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,u.jsxs)("div",{className:"p-4 bg-surface rounded-lg border border-outline-variant space-y-2",children:[(0,u.jsx)("h4",{className:"font-medium text-surface-on",children:"Clear Journal & Planner"}),(0,u.jsx)("p",{className:"text-sm text-surface-on-variant",children:"Permanently delete all entries, records, and plans."}),(0,u.jsxs)("div",{className:"flex gap-2 pt-2",children:[(0,u.jsx)(Q,{variant:"outlined",size:"sm",onClick:a,className:"text-error hover:bg-error-container/20 border-error",children:"Journal"}),(0,u.jsx)(Q,{variant:"outlined",size:"sm",onClick:l,className:"text-error hover:bg-error-container/20 border-error",children:"Planner"})]})]}),(0,u.jsxs)("div",{className:"p-4 bg-surface rounded-lg border border-outline-variant space-y-2",children:[(0,u.jsx)("h4",{className:"font-medium text-surface-on",children:"Clear Medication Data"}),(0,u.jsx)("p",{className:"text-sm text-surface-on-variant",children:"Permanently delete all meds, bundles, and logs."}),(0,u.jsx)(Q,{variant:"outlined",size:"sm",onClick:c,className:"text-error hover:bg-error-container/20 border-error mt-6",children:"Clear Meds"})]}),(0,u.jsxs)("div",{className:"md:col-span-2 p-4 bg-error-container/40 rounded-lg mt-4 flex flex-col sm:flex-row justify-between items-start sm:items-center gap-3",children:[(0,u.jsxs)("div",{children:[(0,u.jsx)("h4",{className:"font-bold text-on-error-container",children:"Clear All Application Data"}),(0,u.jsx)("p",{className:"text-sm text-on-error-container/80",children:"Permanently delete EVERYTHING. This cannot be undone."})]}),(0,u.jsx)(Q,{variant:"filled",size:"sm",onClick:d,leadingIcon:(0,u.jsx)(oY,{}),className:"!bg-error !text-on-error shrink-0",children:"Clear All Data"})]})]})]}),(0,u.jsx)("div",{className:"text-center pt-6 border-t border-outline-variant",children:(0,u.jsx)(Q,{variant:"text",size:"sm",leadingIcon:(0,u.jsx)(eC,{}),onClick:f,children:"Re-run Onboarding (for testing)"})})]})},xP=(0,K.A)("Wind",[["path",{d:"M12.8 19.6A2 2 0 1 0 14 16H2",key:"148xed"}],["path",{d:"M17.5 8a2.5 2.5 0 1 1 2 4H2",key:"1u4tom"}],["path",{d:"M9.8 4.4A2 2 0 1 1 11 8H2",key:"75valh"}]]),xI=(0,K.A)("BrainCircuit",[["path",{d:"M12 5a3 3 0 1 0-5.997.125 4 4 0 0 0-2.526 5.77 4 4 0 0 0 .556 6.588A4 4 0 1 0 12 18Z",key:"l5xja"}],["path",{d:"M9 13a4.5 4.5 0 0 0 3-4",key:"10igwf"}],["path",{d:"M6.003 5.125A3 3 0 0 0 6.401 6.5",key:"105sqy"}],["path",{d:"M3.477 10.896a4 4 0 0 1 .585-.396",key:"ql3yin"}],["path",{d:"M6 18a4 4 0 0 1-1.967-.516",key:"2e4loj"}],["path",{d:"M12 13h4",key:"1ku699"}],["path",{d:"M12 18h6a2 2 0 0 1 2 2v1",key:"105ag5"}],["path",{d:"M12 8h8",key:"1lhi5i"}],["path",{d:"M16 8V5a2 2 0 0 1 2-2",key:"u6izg6"}],["circle",{cx:"16",cy:"13",r:".5",key:"ry7gng"}],["circle",{cx:"18",cy:"3",r:".5",key:"1aiba7"}],["circle",{cx:"20",cy:"21",r:".5",key:"yhc1fs"}],["circle",{cx:"20",cy:"8",r:".5",key:"1e43v0"}]]),xL=(0,K.A)("ListChecks",[["path",{d:"m3 17 2 2 4-4",key:"1jhpwq"}],["path",{d:"m3 7 2 2 4-4",key:"1obspn"}],["path",{d:"M13 6h8",key:"15sg57"}],["path",{d:"M13 12h8",key:"h98zly"}],["path",{d:"M13 18h8",key:"oe0vm4"}]]),xz=(0,K.A)("Waves",[["path",{d:"M2 6c.6.5 1.2 1 2.5 1C7 7 7 5 9.5 5c2.6 0 2.4 2 5 2 2.5 0 2.5-2 5-2 1.3 0 1.9.5 2.5 1",key:"knzxuh"}],["path",{d:"M2 12c.6.5 1.2 1 2.5 1 2.5 0 2.5-2 5-2 2.6 0 2.4 2 5 2 2.5 0 2.5-2 5-2 1.3 0 1.9.5 2.5 1",key:"2jd2cc"}],["path",{d:"M2 18c.6.5 1.2 1 2.5 1 2.5 0 2.5-2 5-2 2.6 0 2.4 2 5 2 2.5 0 2.5-2 5-2 1.3 0 1.9.5 2.5 1",key:"rd2r6e"}]]),xV=[{id:"rain-exercise",text:"Practice the RAIN mindfulness exercise"},{id:"grounding-54321",text:"Use the 5-4-3-2-1 grounding technique"},{id:"distress-accepts",text:"Use ACCEPTS for distress tolerance"},{id:"urge-surfing",text:'Practice "Urge Surfing"'},{id:"categories-exercise",text:"Use the Categories distraction technique"}],x$=({title:e,description:t,icon:n,view:r,onNavigate:i})=>(0,u.jsxs)("div",{className:"bg-surface rounded-lg shadow-sm hover:shadow-md transition-shadow p-6 flex flex-col",children:[(0,u.jsxs)("div",{className:"flex items-start gap-4",children:[(0,u.jsx)("div",{className:"text-primary mt-1",children:n}),(0,u.jsxs)("div",{className:"flex-grow",children:[(0,u.jsx)("h4",{className:"text-title-lg font-medium text-surface-on",children:e}),(0,u.jsx)("p",{className:"text-body-md text-surface-on-variant mt-1 mb-4",children:t})]})]}),(0,u.jsx)(Q,{variant:"tonal",size:"md",onClick:()=>i(r),className:"mt-auto self-start",trailingIcon:(0,u.jsx)(lB,{}),children:"Learn More"})]}),x_=({id:e,title:t,icon:n,isAdded:r,onAdd:i,children:s,className:o})=>(0,u.jsxs)(xj,{className:(0,X.cn)("bg-surface-container-low shadow-sm border-outline-variant flex flex-col",o),children:[(0,u.jsx)(xN,{children:(0,u.jsxs)("div",{className:"flex justify-between items-start gap-4",children:[(0,u.jsxs)("div",{className:"flex items-center gap-3",children:[(0,u.jsx)("div",{className:"text-primary",children:n}),(0,u.jsx)(xS,{className:"font-serif text-title-lg text-surface-on",children:t})]}),(0,u.jsx)(Q,{variant:r?"tonal":"outlined",size:"sm",leadingIcon:r?(0,u.jsx)(xo,{className:"w-4 h-4"}):(0,u.jsx)(eA,{className:"w-4 h-4"}),onClick:i,disabled:r,"aria-label":r?`Added ${t} to your strategies`:`Add ${t} to your strategies`,children:r?"Added":"Add"})]})}),(0,u.jsx)(xM,{className:"text-body-md text-surface-on-variant flex-grow",children:s})]}),xF=({onNavigateToView:e,onAddCopingMechanism:t,userCopingMechanisms:n})=>{let r=e=>n.some(t=>t.id===e);return(0,u.jsxs)("div",{className:"space-y-10 animate-in fade-in-0 duration-750 max-w-4xl",children:[(0,u.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,u.jsx)(ed,{className:"w-8 h-8 text-primary"}),(0,u.jsx)("h2",{className:"font-serif text-headline-lg text-surface-on",children:"Resources"})]}),(0,u.jsx)("p",{className:"text-body-lg text-surface-on-variant",children:"Explore these guides to better understand the concepts behind the tools in this app and find support when you need it."}),(0,u.jsxs)("div",{className:"space-y-8",children:[(0,u.jsxs)("section",{className:"space-y-6",children:[(0,u.jsx)("h3",{className:"font-serif text-headline-sm text-surface-on",children:"Mindfulness & Coping Techniques"}),(0,u.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 items-start",children:[(0,u.jsxs)(x_,{id:"rain-exercise",title:"RAIN Mindfulness Exercise",icon:(0,u.jsx)(xP,{className:"w-6 h-6"}),isAdded:r("rain-exercise"),onAdd:()=>t(xV[0]),children:[(0,u.jsx)("p",{className:"mb-4 text-sm",children:"Mindfulness is a state of nonjudgmental awareness of whats happening in the present moment. RAIN is a mindfulness practice that will help you focus on the present and cope with uncomfortable thoughts and emotions."}),(0,u.jsxs)("div",{className:"mb-4 p-3 bg-surface rounded-lg border border-outline-variant",children:[(0,u.jsx)("h5",{className:"font-semibold text-primary",children:"Prepare"}),(0,u.jsx)("p",{className:"text-sm",children:"Sit or lie down in a comfortable position. Close your eyes or let your gaze soften. Take three slow, deep breaths."})]}),(0,u.jsxs)("div",{className:"space-y-4",children:[(0,u.jsxs)("div",{className:"flex gap-4",children:[(0,u.jsx)("div",{className:"font-bold text-4xl text-primary",children:"R"}),(0,u.jsxs)("div",{children:[(0,u.jsx)("h5",{className:"font-semibold text-surface-on",children:"Recognize"}),(0,u.jsx)("p",{className:"text-sm",children:"Let yourself feel at ease in the present moment. Slowly take in your surroundings. Recognize your thoughts, feelings, and physical sensations. Name your feelings out loud or silently to yourself."})]})]}),(0,u.jsxs)("div",{className:"flex gap-4",children:[(0,u.jsx)("div",{className:"font-bold text-4xl text-primary",children:"A"}),(0,u.jsxs)("div",{children:[(0,u.jsx)("h5",{className:"font-semibold text-surface-on",children:"Allow"}),(0,u.jsx)("p",{className:"text-sm",children:'Observe your experience as if watching a movie. Let your thoughts, feelings, and sensations come and go as they are. Let go of any judgmentit is okay to feel however you are feeling. You may tell yourself, "This is how it is right now."'})]})]}),(0,u.jsxs)("div",{className:"flex gap-4",children:[(0,u.jsx)("div",{className:"font-bold text-4xl text-primary",children:"I"}),(0,u.jsxs)("div",{children:[(0,u.jsx)("h5",{className:"font-semibold text-surface-on",children:"Investigate"}),(0,u.jsx)("p",{className:"text-sm",children:"What words are going through your mind? What emotions are you feeling, and where are they coming from? How are these feelings experienced in your body? Sense the most vulnerable part of yourself and reflect on what it needs, such as acceptance, forgiveness, love, or belonging."})]})]}),(0,u.jsxs)("div",{className:"flex gap-4",children:[(0,u.jsx)("div",{className:"font-bold text-4xl text-primary",children:"N"}),(0,u.jsxs)("div",{children:[(0,u.jsx)("h5",{className:"font-semibold text-surface-on",children:"Nurture"}),(0,u.jsx)("p",{className:"text-sm",children:'Be kind toward your experience. Give yourself a comforting message, such as "I love you," "you are okay," or anything else you need. Think of a friend, family member, pet, or spiritual figure, and imagine their love flowing to you. Let in healing and compassion until you feel calm and centered.'})]})]})]}),(0,u.jsxs)("div",{className:"mt-4 p-3 bg-surface rounded-lg border border-outline-variant",children:[(0,u.jsx)("h5",{className:"font-semibold text-primary",children:"Conclude"}),(0,u.jsx)("p",{className:"text-sm",children:"Take three slow, deep breaths. Continue to be mindful and kind to yourself throughout your day."})]})]}),(0,u.jsxs)("div",{className:"flex flex-col gap-6",children:[(0,u.jsxs)(x_,{id:"grounding-54321",title:"5-4-3-2-1 Grounding",icon:(0,u.jsx)(xI,{className:"w-6 h-6"}),isAdded:r("grounding-54321"),onAdd:()=>t(xV[1]),children:[(0,u.jsx)("p",{className:"mb-4",children:"Use your five senses to bring yourself back to the present moment."}),(0,u.jsxs)("ul",{className:"list-disc pl-5 space-y-1 text-sm",children:[(0,u.jsxs)("li",{children:[(0,u.jsx)("strong",{children:"5"})," things you can see."]}),(0,u.jsxs)("li",{children:[(0,u.jsx)("strong",{children:"4"})," things you can feel."]}),(0,u.jsxs)("li",{children:[(0,u.jsx)("strong",{children:"3"})," things you can hear."]}),(0,u.jsxs)("li",{children:[(0,u.jsx)("strong",{children:"2"})," things you can smell."]}),(0,u.jsxs)("li",{children:[(0,u.jsx)("strong",{children:"1"})," thing you can taste."]})]})]}),(0,u.jsxs)(x_,{id:"distress-accepts",title:"ACCEPTS Technique",icon:(0,u.jsx)(xt,{className:"w-6 h-6"}),isAdded:r("distress-accepts"),onAdd:()=>t(xV[2]),children:[(0,u.jsx)("p",{className:"mb-4",children:"An acronym for distracting yourself from distressing emotions until they pass."}),(0,u.jsxs)("ul",{className:"list-disc pl-5 space-y-1 text-sm",children:[(0,u.jsxs)("li",{children:[(0,u.jsx)("strong",{children:"A"}),"ctivities"]}),(0,u.jsxs)("li",{children:[(0,u.jsx)("strong",{children:"C"}),"ontributing"]}),(0,u.jsxs)("li",{children:[(0,u.jsx)("strong",{children:"C"}),"omparisons"]}),(0,u.jsxs)("li",{children:[(0,u.jsx)("strong",{children:"E"}),"motions"]}),(0,u.jsxs)("li",{children:[(0,u.jsx)("strong",{children:"P"}),"ushing Away"]}),(0,u.jsxs)("li",{children:[(0,u.jsx)("strong",{children:"T"}),"houghts"]}),(0,u.jsxs)("li",{children:[(0,u.jsx)("strong",{children:"S"}),"ensations"]})]})]}),(0,u.jsxs)(x_,{id:"categories-exercise",title:"Categories",icon:(0,u.jsx)(xL,{className:"w-6 h-6"}),isAdded:r("categories-exercise"),onAdd:()=>t(xV[4]),children:[(0,u.jsx)("p",{className:"mb-4",children:"A simple distraction technique to shift your focus away from distressing thoughts."}),(0,u.jsxs)("ol",{className:"list-decimal pl-5 space-y-2 text-sm",children:[(0,u.jsx)("li",{children:"Pick a broad category (e.g., animals, countries, car models, fruits, breakfast cereals)."}),(0,u.jsx)("li",{children:"Mentally list as many items from that category as you can."}),(0,u.jsx)("li",{children:"Try to visualize each item as you name it."}),(0,u.jsx)("li",{children:"If you get stuck, simply choose a new category and begin again."})]})]})]}),(0,u.jsxs)(x_,{id:"urge-surfing",title:"Urge Surfing",icon:(0,u.jsx)(xz,{className:"w-6 h-6"}),isAdded:r("urge-surfing"),onAdd:()=>t(xV[3]),className:"md:col-span-2",children:[(0,u.jsx)("p",{className:"mb-4",children:"A technique for managing your unwanted behaviors. Rather than giving in to an urge, you will ride it out, like a surfer riding a wave. After a short time, the urge will pass on its own."}),(0,u.jsx)("h4",{className:"font-semibold text-surface-on mb-2",children:"How to Practice"}),(0,u.jsxs)("ol",{className:"list-decimal pl-5 space-y-2 text-sm mb-4",children:[(0,u.jsx)("li",{children:"Acknowledge you are having an urge."}),(0,u.jsxs)("li",{children:["Notice your thoughts and feelings without trying to change or suppress them.",(0,u.jsx)("em",{className:"block text-xs text-surface-on-variant/80 pl-2 border-l-2 border-outline ml-2 mt-1",children:"Note: It is normal to feel some discomfort during an urge."})]}),(0,u.jsxs)("li",{children:["Remind yourself...",(0,u.jsxs)("ul",{className:"list-disc pl-5 mt-1 space-y-1",children:[(0,u.jsx)("li",{children:"It's okay to have urges. They're natural reactions to addictions and habits."}),(0,u.jsx)("li",{children:"Some discomfort is okay. I don't have to change it."}),(0,u.jsx)("li",{children:'An urge is a feeling, not a "must." I can have this feeling and choose not to act.'}),(0,u.jsx)("li",{children:"An urge is temporary. Like any other feeling, it will pass on its own."})]})]})]}),(0,u.jsx)("h4",{className:"font-semibold text-surface-on mb-2",children:"Other Skills"}),(0,u.jsxs)("div",{className:"space-y-2 text-sm mb-6",children:[(0,u.jsxs)("div",{children:[(0,u.jsx)("h5",{className:"font-medium text-surface-on",children:"Managing Triggers"}),(0,u.jsx)("p",{children:"Use coping skills to reduce the power of triggers. Know your triggers ahead of time, and have a strategy or skill prepared for each one."})]}),(0,u.jsxs)("div",{children:[(0,u.jsx)("h5",{className:"font-medium text-surface-on",children:"Delay & Distraction"}),(0,u.jsx)("p",{children:"Do something to take your mind off the urge. Every minute you delay increases the chance of the urge weakening on its own."})]})]}),(0,u.jsxs)("div",{className:"relative mt-4",children:[(0,u.jsx)("div",{className:"h-48 w-full rounded-lg bg-surface border border-outline-variant"}),(0,u.jsxs)("div",{className:"absolute inset-0 grid grid-cols-4 grid-rows-2 gap-x-2 p-2 sm:p-4 text-xs",children:[(0,u.jsxs)("div",{className:"col-start-1 row-start-2 p-2 bg-surface-container/80 rounded-lg text-center shadow-md",children:[(0,u.jsx)("p",{className:"font-bold text-primary",children:"Trigger"}),(0,u.jsx)("p",{className:"text-surface-on-variant text-[10px] leading-tight",children:"An urge is triggered by a person, place, thought, feeling, or something else."})]}),(0,u.jsxs)("div",{className:"col-start-2 row-start-1 p-2 bg-surface-container/80 rounded-lg text-center shadow-md",children:[(0,u.jsx)("p",{className:"font-bold text-primary",children:"Rise"}),(0,u.jsx)("p",{className:"text-surface-on-variant text-[10px] leading-tight",children:"The urge becomes more intense. This may happen gradually or very suddenly."})]}),(0,u.jsxs)("div",{className:"col-start-3 row-start-1 p-2 bg-surface-container/80 rounded-lg text-center shadow-md",children:[(0,u.jsx)("p",{className:"font-bold text-primary",children:"Peak"}),(0,u.jsx)("p",{className:"text-surface-on-variant text-[10px] leading-tight",children:"The urge reaches its most intense point. It may feel as if the urge will never go away."})]}),(0,u.jsxs)("div",{className:"col-start-4 row-start-2 p-2 bg-surface-container/80 rounded-lg text-center shadow-md",children:[(0,u.jsx)("p",{className:"font-bold text-primary",children:"Fall"}),(0,u.jsx)("p",{className:"text-surface-on-variant text-[10px] leading-tight",children:"The urge loses intensity and eventually fades away."})]})]})]})]})]}),(0,u.jsxs)(xj,{className:"bg-surface-container-low shadow-sm border-outline-variant",children:[(0,u.jsx)(xN,{children:(0,u.jsxs)(xS,{className:"font-serif text-title-lg text-surface-on flex items-center gap-2",children:[(0,u.jsx)(xI,{})," The Wise Mind"]})}),(0,u.jsxs)(xM,{className:"space-y-4",children:[(0,u.jsx)("p",{className:"text-body-md text-surface-on-variant",children:"Your mind has three states: The reasonable mind, the emotional mind, and the wise mind. Everyone possesses each of these states, but most people gravitate toward a specific one most of the time."}),(0,u.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,u.jsxs)("div",{className:"p-4 bg-surface rounded-lg border-l-4 border-red-400",children:[(0,u.jsx)("h4",{className:"font-semibold text-surface-on",children:"Emotional Mind"}),(0,u.jsx)("p",{className:"text-sm text-surface-on-variant mt-1",children:"Used when feelings control a persons thoughts and behavior. They might act impulsively with little regard for consequences."})]}),(0,u.jsxs)("div",{className:"p-4 bg-surface rounded-lg border-l-4 border-purple-400",children:[(0,u.jsx)("h4",{className:"font-semibold text-surface-on",children:"Wise Mind"}),(0,u.jsx)("p",{className:"text-sm text-surface-on-variant mt-1",children:"Refers to a balance between the reasonable and emotional halves. They are able to recognize and respect their feelings, while responding to them in a rational manner."})]}),(0,u.jsxs)("div",{className:"p-4 bg-surface rounded-lg border-l-4 border-blue-400",children:[(0,u.jsx)("h4",{className:"font-semibold text-surface-on",children:"Reasonable Mind"}),(0,u.jsx)("p",{className:"text-sm text-surface-on-variant mt-1",children:"A person uses their Reasonable mind when they approach a situation intellectually. They plan and make decisions based on fact."})]})]})]})]})]}),(0,u.jsxs)("section",{className:"bg-surface-container-low p-6 sm:p-8 rounded-2xl shadow-lg",children:[(0,u.jsx)("h3",{className:"font-serif text-headline-sm text-surface-on mb-4",children:"Guides & Information"}),(0,u.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,u.jsx)(x$,{title:"Understanding CBT",description:"Learn about Cognitive Behavioral Therapy and how the Thought Record tool can help you challenge and reframe unhelpful thoughts.",icon:(0,u.jsx)(xI,{className:"w-7 h-7"}),view:"understanding-cbt",onNavigate:e}),(0,u.jsx)(x$,{title:"Crisis Support",description:"If you are in a crisis or need immediate support, please use these resources. You are not alone.",icon:(0,u.jsx)(yF,{className:"w-7 h-7 text-error"}),view:"crisis-support",onNavigate:e})]})]})]}),(0,u.jsx)("p",{className:"text-label-md text-center text-surface-on-variant pt-4",children:"The content in this app is for informational purposes only and is not a substitute for professional medical advice, diagnosis, or treatment."})]})};var xB="Checkbox",[xW,xq]=(0,o1.A)(xB),[xH,xU]=xW(xB),xK=h.forwardRef((e,t)=>{let{__scopeCheckbox:n,name:r,checked:i,defaultChecked:s,required:o,disabled:a,value:l="on",onCheckedChange:c,form:d,...p}=e,[f,m]=h.useState(null),g=(0,o0.s)(t,e=>m(e)),y=h.useRef(!1),x=!f||d||!!f.closest("form"),[v=!1,b]=(0,o6.i)({prop:i,defaultProp:s,onChange:c}),w=h.useRef(v);return h.useEffect(()=>{let e=f?.form;if(e){let t=()=>b(w.current);return e.addEventListener("reset",t),()=>e.removeEventListener("reset",t)}},[f,b]),(0,u.jsxs)(xH,{scope:n,state:v,disabled:a,children:[(0,u.jsx)(o9.sG.button,{type:"button",role:"checkbox","aria-checked":xX(v)?"mixed":v,"aria-required":o,"data-state":xZ(v),"data-disabled":a?"":void 0,disabled:a,value:l,...p,ref:g,onKeyDown:(0,oQ.m)(e.onKeyDown,e=>{"Enter"===e.key&&e.preventDefault()}),onClick:(0,oQ.m)(e.onClick,e=>{b(e=>!!xX(e)||!e),x&&(y.current=e.isPropagationStopped(),y.current||e.stopPropagation())})}),x&&(0,u.jsx)(xY,{control:f,bubbles:!y.current,name:r,value:l,checked:v,required:o,disabled:a,form:d,style:{transform:"translateX(-100%)"},defaultChecked:!xX(s)&&s})]})});xK.displayName=xB;var xJ="CheckboxIndicator",xG=h.forwardRef((e,t)=>{let{__scopeCheckbox:n,forceMount:r,...i}=e,s=xU(xJ,n);return(0,u.jsx)(ad.C,{present:r||xX(s.state)||!0===s.state,children:(0,u.jsx)(o9.sG.span,{"data-state":xZ(s.state),"data-disabled":s.disabled?"":void 0,...i,ref:t,style:{pointerEvents:"none",...e.style}})})});xG.displayName=xJ;var xY=e=>{let{control:t,checked:n,bubbles:r=!0,defaultChecked:i,...s}=e,o=h.useRef(null),a=lU(n),l=lK(t);h.useEffect(()=>{let e=o.current,t=Object.getOwnPropertyDescriptor(window.HTMLInputElement.prototype,"checked").set;if(a!==n&&t){let i=new Event("click",{bubbles:r});e.indeterminate=xX(n),t.call(e,!xX(n)&&n),e.dispatchEvent(i)}},[a,n,r]);let c=h.useRef(!xX(n)&&n);return(0,u.jsx)("input",{type:"checkbox","aria-hidden":!0,defaultChecked:i??c.current,...s,tabIndex:-1,ref:o,style:{...e.style,...l,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})};function xX(e){return"indeterminate"===e}function xZ(e){return xX(e)?"indeterminate":e?"checked":"unchecked"}let xQ=h.forwardRef(({className:e,...t},n)=>(0,u.jsx)(xK,{ref:n,className:(0,X.cn)("peer h-4 w-4 shrink-0 rounded-sm border border-primary ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground",e),...t,children:(0,u.jsx)(xG,{className:(0,X.cn)("flex items-center justify-center text-current"),children:(0,u.jsx)(xo,{className:"h-4 w-4"})})}));xQ.displayName=xK.displayName;let x0=(0,K.A)("Type",[["polyline",{points:"4 7 4 4 20 4 20 7",key:"1nosan"}],["line",{x1:"9",x2:"15",y1:"20",y2:"20",key:"swin9y"}],["line",{x1:"12",x2:"12",y1:"4",y2:"20",key:"1tx1rr"}]]),x1=(0,K.A)("ToyBrick",[["rect",{width:"18",height:"12",x:"3",y:"8",rx:"1",key:"158fvp"}],["path",{d:"M10 8V5c0-.6-.4-1-1-1H6a1 1 0 0 0-1 1v3",key:"s0042v"}],["path",{d:"M19 8V5c0-.6-.4-1-1-1h-3a1 1 0 0 0-1 1v3",key:"9wmeh2"}]]);var x2=h.forwardRef((e,t)=>(0,u.jsx)(o9.sG.label,{...e,ref:t,onMouseDown:t=>{t.target.closest("button, input, select, textarea")||(e.onMouseDown?.(t),!t.defaultPrevented&&t.detail>1&&t.preventDefault())}}));x2.displayName="Label";let x4=(0,yn.F)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),x3=h.forwardRef(({className:e,...t},n)=>(0,u.jsx)(x2,{ref:n,className:(0,X.cn)(x4(),e),...t}));x3.displayName=x2.displayName;let x5=[{name:"echo",label:"Echo",bgColor:"hsl(205 75% 45%)",textColor:"hsl(0 0% 100%)"},{name:"forest",label:"Forest",bgColor:"hsl(110 35% 45%)",textColor:"hsl(110 35% 98%)"},{name:"buttercup",label:"Buttercup",bgColor:"hsl(45 80% 60%)",textColor:"hsl(45 25% 15%)"},{name:"sunset",label:"Sunset",bgColor:"hsl(20 80% 45%)",textColor:"hsl(20 80% 98%)"}],x6=[{name:"Primary",colors:[{name:"Primary",var:"hsl(var(--primary))",text:"hsl(var(--primary-foreground))"},{name:"Primary Container",var:"hsl(var(--primary-container))",text:"hsl(var(--on-primary-container))"}]},{name:"Secondary",colors:[{name:"Secondary",var:"hsl(var(--secondary))",text:"hsl(var(--secondary-foreground))"},{name:"Secondary Container",var:"hsl(var(--secondary-container))",text:"hsl(var(--on-secondary-container))"}]},{name:"Tertiary",colors:[{name:"Tertiary",var:"hsl(var(--tertiary))",text:"hsl(var(--on-tertiary))"},{name:"Tertiary Container",var:"hsl(var(--tertiary-container))",text:"hsl(var(--on-tertiary-container))"}]},{name:"Surface",colors:[{name:"Background",var:"hsl(var(--background))",text:"hsl(var(--foreground))"},{name:"Surface",var:"hsl(var(--surface))",text:"hsl(var(--on-surface))"},{name:"Surface Variant",var:"hsl(var(--surface-variant))",text:"hsl(var(--on-surface-variant))"},{name:"Surface Container Low",var:"hsl(var(--surface-container-low))",text:"hsl(var(--on-surface))"},{name:"Surface Container",var:"hsl(var(--surface-container))",text:"hsl(var(--on-surface))"},{name:"Surface Container High",var:"hsl(var(--surface-container-high))",text:"hsl(var(--on-surface))"}]},{name:"Utility",colors:[{name:"Error Container",var:"hsl(var(--error-container))",text:"hsl(var(--on-error-container))"},{name:"Outline",var:"hsl(var(--outline))",text:"hsl(var(--background))",border:!0},{name:"Outline Variant",var:"hsl(var(--outline-variant))",text:"hsl(var(--background))",border:!0}]}],x8=[{name:"Display Large",class:"font-serif text-display-lg"},{name:"Display Medium",class:"font-serif text-display-md"},{name:"Display Small",class:"font-serif text-display-sm"},{name:"Headline Large",class:"font-serif text-headline-lg"},{name:"Headline Medium",class:"font-serif text-headline-md"},{name:"Headline Small",class:"font-serif text-headline-sm"},{name:"Title Large",class:"font-serif text-title-lg"},{name:"Title Medium",class:"font-serif text-title-md"},{name:"Title Small",class:"font-serif text-title-sm"},{name:"Body Large",class:"text-body-lg"},{name:"Body Medium",class:"text-body-md"},{name:"Body Small",class:"text-body-sm"},{name:"Label Large",class:"text-label-lg"},{name:"Label Medium",class:"text-label-md"},{name:"Label Small",class:"text-label-sm"}],x9=({currentPalette:e,onChangePalette:t})=>{let[n,r]=f().useState([50]),[i,s]=f().useState(!1);return(0,u.jsxs)("div",{className:"space-y-12 animate-in fade-in-0 duration-750 max-w-5xl w-full",children:[(0,u.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,u.jsx)(xa,{className:"w-8 h-8 text-primary"}),(0,u.jsx)("h2",{className:"font-serif text-headline-lg text-surface-on",children:"Design System"})]}),(0,u.jsxs)("section",{"aria-labelledby":"colors-heading",className:"space-y-6",children:[(0,u.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,u.jsx)(xs,{className:"w-7 h-7 text-secondary"}),(0,u.jsx)("h3",{id:"colors-heading",className:"font-serif text-headline-md text-surface-on",children:"Color Palette"})]}),(0,u.jsxs)("div",{className:"bg-surface-container-low p-6 rounded-lg shadow-sm",children:[(0,u.jsx)("h4",{className:"text-title-md font-medium text-surface-on mb-3",children:"Live Theme Selector"}),(0,u.jsx)("p",{className:"text-body-md text-surface-on-variant mb-4",children:"Select a palette to see it applied to this page and the entire app instantly."}),(0,u.jsx)("div",{className:"flex flex-wrap gap-3",children:x5.map(n=>(0,u.jsxs)("button",{onClick:()=>t(n.name),style:{backgroundColor:n.bgColor,color:n.textColor},className:(0,X.cn)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-full text-sm font-medium px-6 h-10 transition-all duration-200","hover:brightness-110 active:brightness-90 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background",e===n.name&&"ring-2 ring-offset-2 ring-ring ring-offset-background"),"aria-pressed":e===n.name,children:[(0,u.jsx)("span",{children:n.label}),e===n.name&&(0,u.jsx)(xo,{className:"w-5 h-5"})]},n.name))})]}),x6.map(e=>(0,u.jsxs)("div",{children:[(0,u.jsx)("h4",{className:"font-serif text-title-lg text-surface-on-variant mb-3",children:e.name}),(0,u.jsx)("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-4",children:e.colors.map(e=>(0,u.jsxs)("div",{style:{backgroundColor:e.var,color:e.text,borderColor:e.border?"hsl(var(--outline))":"transparent"},className:"p-4 rounded-lg shadow-sm border",children:[(0,u.jsx)("p",{className:"font-medium text-sm",children:e.name}),(0,u.jsx)("p",{className:"text-xs opacity-80",children:e.var})]},e.name))})]},e.name))]}),(0,u.jsxs)("section",{"aria-labelledby":"typography-heading",className:"space-y-6",children:[(0,u.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,u.jsx)(x0,{className:"w-7 h-7 text-secondary"}),(0,u.jsx)("h3",{id:"typography-heading",className:"font-serif text-headline-md text-surface-on",children:"Typography"})]}),(0,u.jsx)("div",{className:"bg-surface-container-low p-6 rounded-lg shadow-sm space-y-4",children:x8.map(e=>(0,u.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-baseline gap-x-6",children:[(0,u.jsx)("p",{className:"text-sm text-surface-on-variant w-40 shrink-0",children:e.name}),(0,u.jsx)("p",{className:(0,X.cn)("text-surface-on truncate",e.class),children:"The five boxing wizards jump quickly."})]},e.name))})]}),(0,u.jsxs)("section",{"aria-labelledby":"components-heading",className:"space-y-6",children:[(0,u.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,u.jsx)(x1,{className:"w-7 h-7 text-secondary"}),(0,u.jsx)("h3",{id:"components-heading",className:"font-serif text-headline-md text-surface-on",children:"Components"})]}),(0,u.jsxs)("div",{className:"space-y-8",children:[(0,u.jsxs)("div",{children:[(0,u.jsx)("h4",{className:"font-serif text-title-lg text-surface-on-variant mb-3",children:"Action Buttons"}),(0,u.jsxs)("div",{className:"bg-surface-container-low p-6 rounded-lg shadow-sm flex flex-wrap items-center justify-center gap-4",children:[(0,u.jsx)(Q,{variant:"filled",children:"Filled Button"}),(0,u.jsx)(Q,{variant:"tonal",children:"Tonal Button"}),(0,u.jsx)(Q,{variant:"outlined",children:"Outlined Button"}),(0,u.jsx)(Q,{variant:"text",children:"Text Button"}),(0,u.jsx)(Q,{variant:"elevated",children:"Elevated Button"})]})]}),(0,u.jsxs)("div",{children:[(0,u.jsx)("h4",{className:"font-serif text-title-lg text-surface-on-variant mb-3",children:"Inputs & Controls"}),(0,u.jsxs)("div",{className:"bg-surface-container-low p-6 rounded-lg shadow-sm grid grid-cols-1 md:grid-cols-2 gap-8 items-center",children:[(0,u.jsxs)("div",{children:[(0,u.jsx)(x3,{htmlFor:"ds-input",children:"Text Input"}),(0,u.jsx)(oz,{id:"ds-input",type:"text",placeholder:"Type something...",className:"mt-1"})]}),(0,u.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,u.jsx)(xQ,{id:"ds-checkbox",checked:i,onCheckedChange:e=>s(!!e)}),(0,u.jsx)(x3,{htmlFor:"ds-checkbox",children:"Checkbox"})]}),(0,u.jsxs)("div",{className:"md:col-span-2",children:[(0,u.jsx)(x3,{htmlFor:"ds-slider",children:"Slider"}),(0,u.jsx)(ch,{id:"ds-slider",value:[n[0]],onValueChange:r,max:100,step:1,className:"mt-2"})]})]})]})]})]})]})},x7=f().memo(({currentTheme:e,onToggleTheme:t})=>{let[n,r]=(0,h.useState)(!1);return((0,h.useEffect)(()=>{r(!0)},[]),n)?(0,u.jsx)("div",{className:"fixed bottom-6 right-6 z-40",children:(0,u.jsx)("button",{onClick:t,className:(0,X.cn)("theme-toggle-button-3d","rounded-full w-12 h-12","inline-flex items-center justify-center","relative overflow-hidden"),"aria-label":"light"===e?"Switch to dark theme":"Switch to light theme",children:(0,u.jsx)(eq,{initial:!1,mode:"wait",children:(0,u.jsx)(oL.div,{initial:{y:-20,opacity:0,rotate:-90},animate:{y:0,opacity:1,rotate:0},exit:{y:20,opacity:0,rotate:90},transition:{duration:.3},className:"absolute",children:"light"===e?(0,u.jsx)(ey,{className:"h-[1.5rem] w-[1.5rem] fill-current"}):(0,u.jsx)(eg,{className:"h-[1.5rem] w-[1.5rem] fill-current"})},e)})})}):(0,u.jsx)("div",{className:"fixed bottom-6 right-6 z-40 w-12 h-12 rounded-full bg-surface-container"})}),ve=(0,K.A)("CircleX",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);var vt="Collapsible",[vn,vr]=(0,o1.A)(vt),[vi,vs]=vn(vt),vo=h.forwardRef((e,t)=>{let{__scopeCollapsible:n,open:r,defaultOpen:i,disabled:s,onOpenChange:o,...a}=e,[l=!1,c]=(0,o6.i)({prop:r,defaultProp:i,onChange:o});return(0,u.jsx)(vi,{scope:n,disabled:s,contentId:o5(),open:l,onOpenToggle:h.useCallback(()=>c(e=>!e),[c]),children:(0,u.jsx)(o9.sG.div,{"data-state":vh(l),"data-disabled":s?"":void 0,...a,ref:t})})});vo.displayName=vt;var va="CollapsibleTrigger",vl=h.forwardRef((e,t)=>{let{__scopeCollapsible:n,...r}=e,i=vs(va,n);return(0,u.jsx)(o9.sG.button,{type:"button","aria-controls":i.contentId,"aria-expanded":i.open||!1,"data-state":vh(i.open),"data-disabled":i.disabled?"":void 0,disabled:i.disabled,...r,ref:t,onClick:(0,oQ.m)(e.onClick,i.onOpenToggle)})});vl.displayName=va;var vc="CollapsibleContent",vd=h.forwardRef((e,t)=>{let{forceMount:n,...r}=e,i=vs(vc,e.__scopeCollapsible);return(0,u.jsx)(ad.C,{present:n||i.open,children:({present:e})=>(0,u.jsx)(vu,{...r,ref:t,present:e})})});vd.displayName=vc;var vu=h.forwardRef((e,t)=>{let{__scopeCollapsible:n,present:r,children:i,...s}=e,o=vs(vc,n),[a,l]=h.useState(r),c=h.useRef(null),d=(0,o0.s)(t,c),p=h.useRef(0),f=p.current,m=h.useRef(0),g=m.current,y=o.open||a,x=h.useRef(y),v=h.useRef(void 0);return h.useEffect(()=>{let e=requestAnimationFrame(()=>x.current=!1);return()=>cancelAnimationFrame(e)},[]),(0,o2.N)(()=>{let e=c.current;if(e){v.current=v.current||{transitionDuration:e.style.transitionDuration,animationName:e.style.animationName},e.style.transitionDuration="0s",e.style.animationName="none";let t=e.getBoundingClientRect();p.current=t.height,m.current=t.width,x.current||(e.style.transitionDuration=v.current.transitionDuration,e.style.animationName=v.current.animationName),l(r)}},[o.open,r]),(0,u.jsx)(o9.sG.div,{"data-state":vh(o.open),"data-disabled":o.disabled?"":void 0,id:o.contentId,hidden:!y,...s,ref:d,style:{"--radix-collapsible-content-height":f?`${f}px`:void 0,"--radix-collapsible-content-width":g?`${g}px`:void 0,...e.style},children:y&&i})});function vh(e){return e?"open":"closed"}var vp="Accordion",vf=["Home","End","ArrowDown","ArrowUp","ArrowLeft","ArrowRight"],[vm,vg,vy]=(0,lJ.N)(vp),[vx,vv]=(0,o1.A)(vp,[vy,vr]),vb=vr(),vw=h.forwardRef((e,t)=>{let{type:n,...r}=e;return(0,u.jsx)(vm.Provider,{scope:e.__scopeAccordion,children:"multiple"===n?(0,u.jsx)(vM,{...r,ref:t}):(0,u.jsx)(vC,{...r,ref:t})})});vw.displayName=vp;var[vk,vj]=vx(vp),[vN,vS]=vx(vp,{collapsible:!1}),vC=h.forwardRef((e,t)=>{let{value:n,defaultValue:r,onValueChange:i=()=>{},collapsible:s=!1,...o}=e,[a,l]=(0,o6.i)({prop:n,defaultProp:r,onChange:i});return(0,u.jsx)(vk,{scope:e.__scopeAccordion,value:a?[a]:[],onItemOpen:l,onItemClose:h.useCallback(()=>s&&l(""),[s,l]),children:(0,u.jsx)(vN,{scope:e.__scopeAccordion,collapsible:s,children:(0,u.jsx)(vA,{...o,ref:t})})})}),vM=h.forwardRef((e,t)=>{let{value:n,defaultValue:r,onValueChange:i=()=>{},...s}=e,[o=[],a]=(0,o6.i)({prop:n,defaultProp:r,onChange:i}),l=h.useCallback(e=>a((t=[])=>[...t,e]),[a]),c=h.useCallback(e=>a((t=[])=>t.filter(t=>t!==e)),[a]);return(0,u.jsx)(vk,{scope:e.__scopeAccordion,value:o,onItemOpen:l,onItemClose:c,children:(0,u.jsx)(vN,{scope:e.__scopeAccordion,collapsible:!0,children:(0,u.jsx)(vA,{...s,ref:t})})})}),[vE,vT]=vx(vp),vA=h.forwardRef((e,t)=>{let{__scopeAccordion:n,disabled:r,dir:i,orientation:s="vertical",...o}=e,a=h.useRef(null),l=(0,o0.s)(a,t),c=vg(n),d="ltr"===lH(i),p=(0,oQ.m)(e.onKeyDown,e=>{if(!vf.includes(e.key))return;let t=e.target,n=c().filter(e=>!e.ref.current?.disabled),r=n.findIndex(e=>e.ref.current===t),i=n.length;if(-1===r)return;e.preventDefault();let o=r,a=i-1,l=()=>{(o=r+1)>a&&(o=0)},u=()=>{(o=r-1)<0&&(o=a)};switch(e.key){case"Home":o=0;break;case"End":o=a;break;case"ArrowRight":"horizontal"===s&&(d?l():u());break;case"ArrowDown":"vertical"===s&&l();break;case"ArrowLeft":"horizontal"===s&&(d?u():l());break;case"ArrowUp":"vertical"===s&&u()}let h=o%i;n[h].ref.current?.focus()});return(0,u.jsx)(vE,{scope:n,disabled:r,direction:i,orientation:s,children:(0,u.jsx)(vm.Slot,{scope:n,children:(0,u.jsx)(o9.sG.div,{...o,"data-orientation":s,ref:l,onKeyDown:r?void 0:p})})})}),vD="AccordionItem",[vO,vR]=vx(vD),vP=h.forwardRef((e,t)=>{let{__scopeAccordion:n,value:r,...i}=e,s=vT(vD,n),o=vj(vD,n),a=vb(n),l=o5(),c=r&&o.value.includes(r)||!1,d=s.disabled||e.disabled;return(0,u.jsx)(vO,{scope:n,open:c,disabled:d,triggerId:l,children:(0,u.jsx)(vo,{"data-orientation":s.orientation,"data-state":vF(c),...a,...i,ref:t,disabled:d,open:c,onOpenChange:e=>{e?o.onItemOpen(r):o.onItemClose(r)}})})});vP.displayName=vD;var vI="AccordionHeader",vL=h.forwardRef((e,t)=>{let{__scopeAccordion:n,...r}=e,i=vT(vp,n),s=vR(vI,n);return(0,u.jsx)(o9.sG.h3,{"data-orientation":i.orientation,"data-state":vF(s.open),"data-disabled":s.disabled?"":void 0,...r,ref:t})});vL.displayName=vI;var vz="AccordionTrigger",vV=h.forwardRef((e,t)=>{let{__scopeAccordion:n,...r}=e,i=vT(vp,n),s=vR(vz,n),o=vS(vz,n),a=vb(n);return(0,u.jsx)(vm.ItemSlot,{scope:n,children:(0,u.jsx)(vl,{"aria-disabled":s.open&&!o.collapsible||void 0,"data-orientation":i.orientation,id:s.triggerId,...a,...r,ref:t})})});vV.displayName=vz;var v$="AccordionContent",v_=h.forwardRef((e,t)=>{let{__scopeAccordion:n,...r}=e,i=vT(vp,n),s=vR(v$,n),o=vb(n);return(0,u.jsx)(vd,{role:"region","aria-labelledby":s.triggerId,"data-orientation":i.orientation,...o,...r,ref:t,style:{"--radix-accordion-content-height":"var(--radix-collapsible-content-height)","--radix-accordion-content-width":"var(--radix-collapsible-content-width)",...e.style}})});function vF(e){return e?"open":"closed"}v_.displayName=v$;let vB=h.forwardRef(({className:e,...t},n)=>(0,u.jsx)(vP,{ref:n,className:(0,X.cn)("border-b",e),...t}));vB.displayName="AccordionItem";let vW=h.forwardRef(({className:e,children:t,...n},r)=>(0,u.jsx)(vL,{className:"flex",children:(0,u.jsxs)(vV,{ref:r,className:(0,X.cn)("flex flex-1 items-center justify-between py-4 font-medium transition-all hover:underline [&[data-state=open]>svg]:rotate-180",e),...n,children:[t,(0,u.jsx)(y9,{className:"h-4 w-4 shrink-0 transition-transform duration-200"})]})}));vW.displayName=vV.displayName;let vq=h.forwardRef(({className:e,children:t,...n},r)=>(0,u.jsx)(v_,{ref:r,className:"overflow-hidden text-sm transition-all data-[state=closed]:animate-accordion-up data-[state=open]:animate-accordion-down",...n,children:(0,u.jsx)("div",{className:(0,X.cn)("pb-4 pt-0",e),children:t})}));vq.displayName=v_.displayName;let vH=({onNavigateBack:e})=>(0,u.jsxs)("div",{className:"space-y-8 animate-in fade-in-0 duration-750 max-w-3xl w-full",children:[(0,u.jsx)(Q,{onClick:e,variant:"text",size:"sm",leadingIcon:(0,u.jsx)(lF,{}),className:"mb-4",children:"Back to Resources"}),(0,u.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,u.jsx)(xI,{className:"w-8 h-8 text-primary"}),(0,u.jsx)("h2",{className:"font-serif text-headline-lg text-surface-on",children:"Understanding CBT"})]}),(0,u.jsxs)(xj,{className:"bg-surface-container-low shadow-sm border-outline-variant",children:[(0,u.jsx)(xN,{children:(0,u.jsx)(xS,{className:"font-serif text-title-lg text-surface-on",children:"The Cognitive Model"})}),(0,u.jsxs)(xM,{className:"space-y-4",children:[(0,u.jsx)("p",{className:"text-body-md text-surface-on-variant",children:"Cognitive behavioral therapy (usually referred to as CBT) is based upon the idea that how you think determines how you feel and how you behave."}),(0,u.jsx)("div",{className:"text-center font-semibold text-lg text-surface-on",children:"Thoughts  Emotions  Behaviors"}),(0,u.jsxs)("div",{className:"space-y-2 text-body-md text-surface-on-variant",children:[(0,u.jsxs)("p",{children:[(0,u.jsx)("strong",{children:"1. Something happens."})," It could be anything."]}),(0,u.jsxs)("p",{children:[(0,u.jsx)("strong",{children:"2. You have thoughts"})," about what has just occurred."]}),(0,u.jsxs)("p",{children:[(0,u.jsx)("strong",{children:"3. You experience emotions"})," based upon your thoughts."]}),(0,u.jsxs)("p",{children:[(0,u.jsx)("strong",{children:"4. You respond"})," to your thoughts and feelings with behaviors."]})]}),(0,u.jsxs)("div",{className:"bg-surface p-4 rounded-lg border border-outline-variant",children:[(0,u.jsx)("h4",{className:"font-semibold text-surface-on mb-2",children:"Example:"}),(0,u.jsxs)("p",{className:"text-surface-on-variant",children:[(0,u.jsx)("strong",{children:"Situation:"})," A stranger scowls at you while passing you on the street."]}),(0,u.jsxs)("p",{className:"text-surface-on-variant",children:[(0,u.jsx)("strong",{children:"You think:"})," I mustve done something wrong Im so awkward."]}),(0,u.jsxs)("p",{className:"text-surface-on-variant",children:[(0,u.jsx)("strong",{children:"You feel:"})," Embarrassed and upset with yourself."]}),(0,u.jsxs)("p",{className:"text-surface-on-variant",children:[(0,u.jsx)("strong",{children:"Your behavior:"})," You apologize to the stranger and replay the situation over and over in your head."]})]}),(0,u.jsx)("p",{className:"text-body-md text-surface-on-variant",children:"The stranger couldve been scowling for any number of reasons. Unfortunately, irrational or not, these thoughts still affect how we feel, and how we behave. Consider a different response:"}),(0,u.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,u.jsxs)("div",{className:"bg-surface p-4 rounded-lg",children:[(0,u.jsxs)("p",{children:[(0,u.jsx)("strong",{children:"Thought:"})," What a jerk!"]}),(0,u.jsxs)("p",{children:[(0,u.jsx)("strong",{children:"Emotion:"})," Angry"]}),(0,u.jsxs)("p",{children:[(0,u.jsx)("strong",{children:"Behavior:"})," Shouts: Whats your problem?!"]})]}),(0,u.jsxs)("div",{className:"bg-surface p-4 rounded-lg",children:[(0,u.jsxs)("p",{children:[(0,u.jsx)("strong",{children:"Thought:"})," He must be having a bad day"]}),(0,u.jsxs)("p",{children:[(0,u.jsx)("strong",{children:"Emotion:"})," Neutral"]}),(0,u.jsxs)("p",{children:[(0,u.jsx)("strong",{children:"Behavior:"})," Walks away and forgets the incident."]})]})]}),(0,u.jsx)("p",{className:"text-body-md text-surface-on-variant !mt-6",children:"Using the cognitive model, you will learn to identify your own patterns of thoughts, emotions, and behaviors. Once you become aware of your own irrational thoughts, you will learn to change them."})]})]}),(0,u.jsxs)(xj,{className:"bg-surface-container-low shadow-sm border-outline-variant",children:[(0,u.jsx)(xN,{children:(0,u.jsx)(xS,{className:"font-serif text-title-lg text-surface-on",children:"Thinking Errors"})}),(0,u.jsxs)(xM,{className:"space-y-2",children:[(0,u.jsxs)("div",{className:"p-3 bg-surface rounded-lg",children:[(0,u.jsx)("h4",{className:"font-semibold text-primary",children:"Ignoring the Good"}),(0,u.jsx)("p",{className:"text-sm text-surface-on-variant",children:"You pay more attention to bad things, and ignore when something good happens."})]}),(0,u.jsxs)("div",{className:"p-3 bg-surface rounded-lg",children:[(0,u.jsx)("h4",{className:"font-semibold text-primary",children:"Blowing Things Up"}),(0,u.jsx)("p",{className:"text-sm text-surface-on-variant",children:"Making a really big deal out of something small, or making something a little bit bad seem like the worst thing ever."})]}),(0,u.jsxs)("div",{className:"p-3 bg-surface rounded-lg",children:[(0,u.jsx)("h4",{className:"font-semibold text-primary",children:"Fortune Telling"}),(0,u.jsx)("p",{className:"text-sm text-surface-on-variant",children:"Thinking you know what will happen in the future, and that it will be bad."})]})]})]}),(0,u.jsxs)(xj,{className:"bg-surface-container-low shadow-sm border-outline-variant",children:[(0,u.jsx)(xN,{children:(0,u.jsx)(xS,{className:"font-serif text-title-lg text-surface-on",children:"Core Beliefs"})}),(0,u.jsxs)(xM,{className:"space-y-4",children:[(0,u.jsx)("p",{className:"text-body-md text-surface-on-variant",children:"Core beliefs are the deeply held beliefs that influence how we interpret our experiences. Think of core beliefs like a pair of sunglasses. Everyone has a different shade that causes them to see things differently."}),(0,u.jsxs)("div",{className:"my-4 flex flex-col md:flex-row items-center justify-center gap-2 text-center",children:[(0,u.jsx)("div",{className:"p-3 bg-surface rounded-lg",children:(0,u.jsx)("strong",{children:"Situation"})}),(0,u.jsx)("div",{className:"text-primary font-bold text-2xl",children:""}),(0,u.jsx)("div",{className:"p-3 bg-surface rounded-lg",children:(0,u.jsx)("strong",{children:"Core Belief"})}),(0,u.jsx)("div",{className:"text-primary font-bold text-2xl",children:""}),(0,u.jsx)("div",{className:"p-3 bg-surface rounded-lg",children:(0,u.jsx)("strong",{children:"Consequence"})})]}),(0,u.jsx)("p",{className:"text-body-md text-surface-on-variant",children:"Many people have negative core beliefs that cause harmful consequences. To begin challenging them, you first need to identify them. Here are some common examples:"}),(0,u.jsx)("div",{className:"columns-2 sm:columns-3 gap-4 text-sm text-surface-on-variant bg-surface p-4 rounded-lg",children:(0,u.jsxs)("ul",{className:"list-disc list-inside space-y-1",children:[(0,u.jsx)("li",{children:"Im unlovable"}),(0,u.jsx)("li",{children:"Im Stupid"}),(0,u.jsx)("li",{children:"Im boring"}),(0,u.jsx)("li",{children:"Im not good enough"}),(0,u.jsx)("li",{children:"Im ugly"}),(0,u.jsx)("li",{children:"Im worthless"}),(0,u.jsx)("li",{children:"Im a bad person"}),(0,u.jsx)("li",{children:"Im abnormal"}),(0,u.jsx)("li",{children:"Im undeserving"})]})}),(0,u.jsxs)("div",{className:"mt-4",children:[(0,u.jsx)("h4",{className:"font-semibold text-surface-on",children:"What is one of your negative beliefs?"}),(0,u.jsx)("p",{className:"text-sm text-surface-on-variant mb-2",children:"List three pieces of evidence contrary to your negative core belief:"}),(0,u.jsxs)("ol",{className:"list-decimal list-inside space-y-1 pl-5",children:[(0,u.jsx)("li",{children:"__________________________________"}),(0,u.jsx)("li",{children:"__________________________________"}),(0,u.jsx)("li",{children:"__________________________________"})]})]})]})]}),(0,u.jsxs)(xj,{className:"bg-surface-container-low shadow-sm border-outline-variant",children:[(0,u.jsx)(xN,{children:(0,u.jsx)(xS,{className:"font-serif text-title-lg text-surface-on",children:"DEAR MAN: Effective Communication"})}),(0,u.jsxs)(xM,{children:[(0,u.jsx)("p",{className:"text-body-md text-surface-on-variant mb-4",children:"The acronym DEAR MAN outlines a strategy for communicating effectively to express your wants and needs respectfully."}),(0,u.jsxs)(vw,{type:"single",collapsible:!0,className:"w-full space-y-2",children:[(0,u.jsxs)(vB,{value:"d",className:"bg-surface rounded-lg",children:[(0,u.jsx)(vW,{className:"p-4 text-left font-semibold text-primary",children:"D - Describe"}),(0,u.jsxs)(vq,{className:"px-4 pb-4",children:["Clearly and concisely describe the facts of the situation, without any judgment. ",(0,u.jsx)("br",{}),(0,u.jsx)("em",{children:"e.g., You have asked me to work late 3 days this week."})]})]}),(0,u.jsxs)(vB,{value:"e",className:"bg-surface rounded-lg",children:[(0,u.jsx)(vW,{className:"p-4 text-left font-semibold text-primary",children:"E - Express"}),(0,u.jsxs)(vq,{className:"px-4 pb-4",children:["Use I statements to express your emotions. ",(0,u.jsx)("br",{}),(0,u.jsx)("em",{children:"e.g., I feel overwhelmed by the extra work Ive been given."})]})]}),(0,u.jsxs)(vB,{value:"a1",className:"bg-surface rounded-lg",children:[(0,u.jsx)(vW,{className:"p-4 text-left font-semibold text-primary",children:"A - Assert"}),(0,u.jsxs)(vq,{className:"px-4 pb-4",children:["Clearly state what you want or need. Be specific. ",(0,u.jsx)("br",{}),(0,u.jsx)("em",{children:"e.g., I need to resume my regular 40-hour work week."})]})]}),(0,u.jsxs)(vB,{value:"r",className:"bg-surface rounded-lg",children:[(0,u.jsx)(vW,{className:"p-4 text-left font-semibold text-primary",children:"R - Reinforce"}),(0,u.jsx)(vq,{className:"px-4 pb-4",children:"Reward the other person if they respond well to you. Smiling, saying thank you, and other kind gestures work well."})]}),(0,u.jsxs)(vB,{value:"m",className:"bg-surface rounded-lg",children:[(0,u.jsx)(vW,{className:"p-4 text-left font-semibold text-primary",children:"M - Mindfulness"}),(0,u.jsxs)(vq,{className:"px-4 pb-4",children:["Being mindful of your goal means not getting sidetracked by other issues. ",(0,u.jsx)("br",{}),(0,u.jsx)("em",{children:"e.g., I would like to resolve the overtime issue before talking about the upcoming project."})]})]}),(0,u.jsxs)(vB,{value:"a2",className:"bg-surface rounded-lg",children:[(0,u.jsx)(vW,{className:"p-4 text-left font-semibold text-primary",children:"A - Appear confident"}),(0,u.jsx)(vq,{className:"px-4 pb-4",children:"Use body language to show confidence, even if you dont feel it. Stand up straight, make appropriate eye contact, and speak clearly."})]}),(0,u.jsxs)(vB,{value:"n",className:"bg-surface rounded-lg",children:[(0,u.jsx)(vW,{className:"p-4 text-left font-semibold text-primary",children:"N - Negotiate"}),(0,u.jsxs)(vq,{className:"px-4 pb-4",children:["Know the limits of what you are willing to accept, but be willing to compromise within them. ",(0,u.jsx)("br",{}),(0,u.jsx)("em",{children:"e.g., Ill finish the extra work this week, but I wont be able to manage the same amount of work next week."})]})]})]})]})]})]}),vU=(0,K.A)("Phone",[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}]]),vK=(0,K.A)("ExternalLink",[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]]),vJ=({onNavigateBack:e})=>(0,u.jsxs)("div",{className:"space-y-8 animate-in fade-in-0 duration-750 max-w-3xl w-full",children:[(0,u.jsx)(Q,{onClick:e,variant:"text",size:"sm",leadingIcon:(0,u.jsx)(lF,{}),className:"mb-4",children:"Back to Resources"}),(0,u.jsxs)("div",{className:"bg-error-container/40 p-6 sm:p-8 rounded-2xl shadow-lg",children:[(0,u.jsxs)("div",{className:"flex flex-col sm:flex-row items-start sm:items-center gap-4 mb-4",children:[(0,u.jsx)(yF,{className:"w-10 h-10 sm:w-12 sm:h-12 text-error flex-shrink-0"}),(0,u.jsxs)("div",{children:[(0,u.jsx)("h2",{className:"font-serif text-headline-md sm:text-headline-lg text-on-error-container",children:"Immediate Support"}),(0,u.jsx)("p",{className:"text-body-lg text-on-error-container/80 mt-1",children:"If you are in a crisis or any other person may be in danger, please use these resources."})]})]}),(0,u.jsxs)("div",{className:"space-y-4 text-left",children:[(0,u.jsxs)("a",{href:"tel:988",className:"block w-full text-left p-4 bg-surface rounded-lg hover:bg-surface-container transition-colors",children:[(0,u.jsxs)("h3",{className:"font-bold text-title-lg text-surface-on flex items-center gap-2",children:[(0,u.jsx)(vU,{className:"w-5 h-5"})," Call or Text 988"]}),(0,u.jsx)("p",{className:"text-surface-on-variant",children:"The 988 Suicide & Crisis Lifeline provides 24/7, free, and confidential support."})]}),(0,u.jsxs)("a",{href:"https://www.crisistextline.org/",target:"_blank",rel:"noopener noreferrer",className:"block w-full text-left p-4 bg-surface rounded-lg hover:bg-surface-container transition-colors",children:[(0,u.jsxs)("h3",{className:"font-bold text-title-lg text-surface-on flex items-center gap-2",children:["Crisis Text Line ",(0,u.jsx)(vK,{className:"w-4 h-4"})]}),(0,u.jsx)("p",{className:"text-surface-on-variant",children:"Text HOME to 741741 from anywhere in the US, anytime, about any type of crisis."})]}),(0,u.jsxs)("a",{href:"tel:911",className:"block w-full text-left p-4 bg-surface rounded-lg hover:bg-surface-container transition-colors",children:[(0,u.jsxs)("h3",{className:"font-bold text-title-lg text-surface-on flex items-center gap-2",children:[(0,u.jsx)(vU,{className:"w-5 h-5"})," Call 911"]}),(0,u.jsx)("p",{className:"text-surface-on-variant",children:"For any immediate life-threatening emergency, please call 911."})]})]}),(0,u.jsx)("p",{className:"text-label-md text-on-error-container/80 text-center mt-8",children:"Your safety is important. This application is a tool for self-reflection and is not a substitute for professional medical advice, diagnosis, or treatment."})]})]}),vG=({onOnboardingComplete:e})=>{let[t,n]=(0,h.useState)(0),[r,i]=(0,h.useState)(""),[s,o]=(0,h.useState)([]),[a,l]=(0,h.useState)([]),c=e=>{o(t=>t.includes(e)?t.filter(t=>t!==e):[...t,e])},d=e=>{l(t=>t.some(t=>t.id===e.id)?t.filter(t=>t.id!==e.id):[...t,e])},p=()=>{(1!==t||r.trim())&&n(e=>e+1)},f=()=>{e({name:r.trim(),strengths:s,copingMechanisms:a,dashboardWidgets:{planner:!0,medication:!0,copingMechanisms:!0}})};return(0,u.jsx)("div",{className:"min-h-screen bg-surface flex items-center justify-center p-4",children:(0,u.jsx)(eq,{mode:"wait",children:(()=>{switch(t){case 0:return(0,u.jsxs)(oL.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"text-center",children:[(0,u.jsx)(Y,{className:"w-24 h-24 text-primary mx-auto mb-6"}),(0,u.jsx)("h1",{className:"font-serif text-display-md text-surface-on",children:"Welcome to Echo"}),(0,u.jsx)("p",{className:"text-body-lg text-surface-on-variant mt-4 max-w-xl mx-auto",children:"A calm, introspective space to organize your thoughts, track your well-being, and reflect on your daily life."}),(0,u.jsx)(Q,{onClick:p,size:"lg",className:"mt-10",trailingIcon:(0,u.jsx)(lB,{}),children:"Get Started"})]},0);case 1:return(0,u.jsxs)(oL.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"text-center w-full max-w-md",children:[(0,u.jsx)("h1",{className:"font-serif text-headline-lg text-surface-on",children:"What should we call you?"}),(0,u.jsx)("input",{type:"text",value:r,onChange:e=>i(e.target.value),placeholder:"Enter your name",className:"mt-8 w-full p-4 bg-surface-container border border-outline-variant hover:border-outline focus:border-primary focus:ring-1 focus:ring-primary rounded-xl text-surface-on placeholder-surface-on-variant text-center text-xl",autoFocus:!0,onKeyPress:e=>"Enter"===e.key&&p()}),(0,u.jsx)(Q,{onClick:p,size:"lg",className:"mt-8",disabled:!r.trim(),children:"Next"})]},1);case 2:return(0,u.jsxs)(oL.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"text-center w-full max-w-3xl",children:[(0,u.jsxs)("h1",{className:"font-serif text-headline-lg text-surface-on",children:["Let's celebrate your strengths, ",r,"."]}),(0,u.jsx)("p",{className:"text-body-md text-surface-on-variant mt-2 mb-8",children:"What are some of your best qualities? Select a few that resonate with you."}),(0,u.jsx)("div",{className:"flex flex-wrap gap-3 justify-center",children:xu.map(e=>{let t=s.includes(e);return(0,u.jsx)("button",{onClick:()=>c(e),className:`px-4 py-2 rounded-full text-sm font-medium transition-all duration-200 border-2 ${t?"bg-primary border-primary text-primary-foreground":"bg-surface-container border-outline-variant hover:border-outline text-surface-on-variant"}`,children:(0,u.jsxs)("div",{className:"flex items-center gap-2",children:[e,t&&(0,u.jsx)(xo,{className:"w-4 h-4"})]})},e)})}),(0,u.jsx)(Q,{onClick:p,size:"lg",className:"mt-10",children:"Continue"})]},2);case 3:return(0,u.jsxs)(oL.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"text-center w-full max-w-3xl",children:[(0,u.jsx)("h1",{className:"font-serif text-headline-lg text-surface-on",children:"Select a few starting coping strategies."}),(0,u.jsx)("p",{className:"text-body-md text-surface-on-variant mt-2 mb-8",children:"You can always change these later in your profile."}),(0,u.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:xV.map(e=>{let t=a.some(t=>t.id===e.id);return(0,u.jsx)("button",{onClick:()=>d(e),className:`p-4 rounded-lg text-left transition-all duration-200 border-2 ${t?"bg-primary-container border-primary":"bg-surface-container border-outline-variant hover:border-outline"}`,children:(0,u.jsxs)("div",{className:"flex justify-between items-center",children:[(0,u.jsx)("span",{className:`font-medium ${t?"text-on-primary-container":"text-surface-on"}`,children:e.text}),t&&(0,u.jsx)(xo,{className:`w-5 h-5 ${t?"text-primary":"text-transparent"}`})]})},e.id)})}),(0,u.jsx)(Q,{onClick:p,size:"lg",className:"mt-8",children:"Continue"})]},3);case 4:return(0,u.jsxs)(oL.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"text-center",children:[(0,u.jsx)("div",{className:"w-24 h-24 rounded-full bg-green-500/20 flex items-center justify-center mx-auto mb-6",children:(0,u.jsx)(xo,{className:"w-16 h-16 text-green-500"})}),(0,u.jsxs)("h1",{className:"font-serif text-display-sm text-surface-on",children:["You're all set, ",r,"!"]}),(0,u.jsx)("p",{className:"text-body-lg text-surface-on-variant mt-4",children:"Your personal wellness dashboard is ready."}),(0,u.jsx)(Q,{onClick:f,size:"lg",className:"mt-10",children:"Enter Echo"})]},4);default:return null}})()})})},vY=()=>{let[e,t]=(0,h.useState)([]),[n,r]=(0,h.useState)([]),[i,s]=(0,h.useState)({}),[o,a]=(0,h.useState)({}),[l,c]=(0,h.useState)([]),[d,p]=(0,h.useState)([]),[f,m]=(0,h.useState)([]),[g,y]=(0,h.useState)([]),[x,v]=(0,h.useState)(null),[b,k]=(0,h.useState)(null),{toast:j}=(0,oV.dj)(),[N,S]=(0,h.useState)(null),[K,J]=(0,h.useState)(null),[G,Y]=(0,h.useState)(null),[Z,ee]=(0,h.useState)(null),[et,en]=(0,h.useState)("dashboard"),[ei,es]=(0,h.useState)(null),[eo,ea]=(0,h.useState)(null),[el,ec]=(0,h.useState)(!1),[ed,eu]=(0,h.useState)(!1),eh=["dashboard","journal","journal-new","journal-edit","thoughtRecord","thoughtRecord-new","thoughtRecord-edit","planner","medication","affirmations","profile","resources","designSystem","understanding-cbt","crisis-support"],ep=e=>eh.includes(e),em=(0,h.useCallback)(()=>ec(!1),[]),eg=(0,h.useCallback)(e=>{window.location.hash=e},[]);(0,h.useEffect)(()=>{let e=()=>{let e=window.location.hash.substring(1);en(ep(e)?e:"dashboard"),em()};return e(),ep(window.location.hash.substring(1))||window.history.replaceState(null,"",`${window.location.pathname}#dashboard`),window.addEventListener("hashchange",e,!1),()=>{window.removeEventListener("hashchange",e,!1)}},[em]),(0,h.useEffect)(()=>{es(localStorage.getItem(w)||"light"),ea(U()),t(M().sort((e,t)=>t.timestamp-e.timestamp)),r(A().sort((e,t)=>t.timestamp-e.timestamp)),v(q()),y(B()),c(L()),m(_()),p(V()),s(O()),a(P()),eu(!0)},[]),(0,h.useEffect)(()=>{if(null===ei||null===eo||!ed)return;let e=document.documentElement;e.classList.remove("theme-echo","theme-forest","theme-buttercup","theme-sunset"),e.classList.add(`theme-${eo}`),e.classList.toggle("dark","dark"===ei),localStorage.setItem(w,ei),H(eo)},[ei,eo,ed]),(0,h.useEffect)(()=>{ed&&C(e)},[e,ed]),(0,h.useEffect)(()=>{ed&&T(n)},[n,ed]),(0,h.useEffect)(()=>{ed&&D(i)},[i,ed]),(0,h.useEffect)(()=>{ed&&R(o)},[o,ed]),(0,h.useEffect)(()=>{ed&&I(l)},[l,ed]),(0,h.useEffect)(()=>{ed&&z(d)},[d,ed]),(0,h.useEffect)(()=>{ed&&$(f)},[f,ed]),(0,h.useEffect)(()=>{ed&&F(g)},[g,ed]),(0,h.useEffect)(()=>{ed&&x&&W(x)},[x,ed]);let ey=(0,h.useCallback)(()=>{es(e=>"light"===e?"dark":"light")},[]),ex=(0,h.useCallback)(e=>{ea(e)},[]),ev=(0,h.useCallback)(()=>{J(null),eg("journal")},[eg]),eb=(0,h.useCallback)(()=>{Y(null),eg("thoughtRecord")},[eg]),ew=(0,h.useCallback)(()=>{J(null),eg("journal-new")},[eg]),ek=(0,h.useCallback)(e=>{J(e),eg("journal-edit")},[eg]),ej=(0,h.useCallback)(e=>{let n=Date.now();if(K){let n={...K,title:e.title,text:e.text,audioBase64DataUrl:e.audioBase64DataUrl};t(e=>e.map(e=>e.id===K.id?n:e))}else{let r={id:n.toString(),timestamp:n,title:e.title,text:e.text,audioBase64DataUrl:e.audioBase64DataUrl};t(e=>[r,...e].sort((e,t)=>t.timestamp-e.timestamp))}ev()},[K,ev]),eN=(0,h.useCallback)(e=>{S(e)},[]),eS=(0,h.useCallback)(e=>{t(t=>t.filter(t=>t.id!==e))},[]),eC=(0,h.useCallback)(()=>{Y(null),eg("thoughtRecord-new")},[eg]),eM=(0,h.useCallback)(e=>{Y(e),eg("thoughtRecord-edit")},[eg]),eT=(0,h.useCallback)((e,t)=>{let n=Date.now(),i=`Thought Record - ${new Date(n).toLocaleDateString()}`;if(e)r(n=>n.map(n=>n.id===e?{...n,data:t,title:i}:n));else{let e={id:n.toString(),timestamp:n,title:i,data:t};r(t=>[e,...t].sort((e,t)=>t.timestamp-e.timestamp))}eb()},[eb]),eD=(0,h.useCallback)(e=>{r(t=>t.filter(t=>t.id!==e))},[]),eO=()=>E(e),eR=e=>v(e),eP=(0,h.useCallback)(e=>{x&&v(t=>t?t.copingMechanisms.some(t=>t.id===e.id)?(j({title:"Strategy already added"}),t):(j({title:"Strategy added to your profile!"}),{...t,copingMechanisms:[...t.copingMechanisms,e]}):null)},[x,j]),eI=(0,h.useCallback)(e=>i[e],[i]),eL=(0,h.useCallback)(e=>{ed&&s(t=>({...t,[e.date]:e}))},[ed]),ez=(0,h.useCallback)(e=>o[e],[o]),eV=(0,h.useCallback)(e=>{ed&&a(t=>({...t,[e.weekStartDate]:e}))},[ed]),e$=(0,h.useCallback)(e=>{let t={...e,id:Date.now().toString(),addedTimestamp:Date.now(),frequency:e.frequency.trim()||"As needed"};c(e=>[t,...e].sort((e,t)=>t.addedTimestamp-e.addedTimestamp))},[]),e_=(0,h.useCallback)(e=>{c(t=>t.map(t=>t.id===e.id?{...e,frequency:e.frequency.trim()||"As needed"}:t).sort((e,t)=>t.addedTimestamp-e.timestamp))},[]),eF=(0,h.useCallback)(e=>{c(t=>t.filter(t=>t.id!==e)),m(t=>t.map(t=>({...t,medicationIds:t.medicationIds.filter(t=>t!==e)})))},[]),eB=(0,h.useCallback)(e=>{let t={id:Date.now().toString(),medicationId:e.id,medicationName:e.name,dosage:e.dosage,timestamp:Date.now()};p(e=>[t,...e])},[]),eW=(0,h.useCallback)(()=>{p([])},[]),eq=(0,h.useCallback)((e,t)=>{let n={id:Date.now().toString(),name:e,medicationIds:t};m(e=>[n,...e])},[]),eH=(0,h.useCallback)(e=>{m(t=>t.map(t=>t.id===e.id?e:t))},[]),eU=(0,h.useCallback)(e=>{m(t=>t.filter(t=>t.id!==e))},[]),eK=(0,h.useCallback)(e=>{let t=f.find(t=>t.id===e);if(!t)return;let n=t.medicationIds.map(e=>{let t=l.find(t=>t.id===e);return t?{id:`${Date.now()}-${t.id}`,medicationId:t.id,medicationName:t.name,dosage:t.dosage,timestamp:Date.now()}:null}).filter(e=>null!==e);n.length>0&&p(e=>[...n,...e])},[f,l]),eJ=(0,h.useCallback)(e=>{let t={...e,id:Date.now().toString()};y(e=>[...e,t])},[]),eG=(0,h.useCallback)(e=>{y(t=>t.map(t=>t.id===e.id?e:t))},[]),eY=(0,h.useCallback)(e=>{y(t=>t.filter(t=>t.id!==e))},[]),eX=(0,h.useCallback)(()=>{t([]),r([])},[]),eZ=(0,h.useCallback)(()=>{s({}),a({})},[]),eQ=(0,h.useCallback)(()=>{c([]),p([]),m([])},[]),e0=(0,h.useCallback)(()=>{t([]),r([]),s({}),a({}),c([]),p([]),m([]),y([]),v({name:"",strengths:[],copingMechanisms:[],dashboardWidgets:{},favoriteAffirmations:[]})},[]),e1=(0,h.useCallback)(e=>{let n=e.split("\n").map(e=>`<p>${e.trim()||"&nbsp;"}</p>`).join(""),r=Date.now(),i={id:r.toString(),timestamp:r,title:"My Plan",text:n};t(e=>[i,...e].sort((e,t)=>t.timestamp-e.timestamp))},[]);if(!ed||!eo||!ei||null===x)return(0,u.jsx)("div",{className:"min-h-screen flex flex-col bg-background",children:(0,u.jsxs)("div",{className:"flex flex-col flex-grow items-center justify-center",children:[(0,u.jsx)(eE,{className:"h-24 w-24 rounded-full mb-6"}),(0,u.jsx)(eE,{className:"h-10 w-64 mb-4"}),(0,u.jsx)(eE,{className:"h-6 w-96"})]})});if(!x.name)return(0,u.jsx)(vG,{onOnboardingComplete:e=>{v(e)}});let e2=et.endsWith("-new")||et.endsWith("-edit");return(0,u.jsxs)("div",{className:"min-h-screen flex flex-col bg-surface text-surface-on selection:bg-primary-container selection:text-on-primary-container",children:[(0,u.jsx)(er,{onToggleDrawer:()=>ec(e=>!e),onNavigateToView:eg,currentView:et}),(0,u.jsx)(ef,{isOpen:el,onClose:em,onNavigateToView:eg,currentView:et}),(0,u.jsxs)("div",{className:"flex flex-col flex-grow",children:[(0,u.jsxs)("main",{className:(0,X.cn)("flex-grow container mx-auto px-4 sm:px-6 lg:px-8 py-12",e2&&"h-full py-0 px-0 sm:px-0 lg:px-0"),children:[b&&(0,u.jsxs)("div",{className:"bg-error-container text-on-error-container p-4 rounded-xl relative mb-6 shadow-md flex items-start",role:"alert",children:[(0,u.jsx)("svg",{className:"fill-current h-5 w-5 text-on-error-container mr-3 mt-0.5",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",children:(0,u.jsx)("path",{d:"M2.93 17.07A10 10 0 1 1 17.07 2.93 10 10 0 0 1 2.93 17.07zM9 5v6h2V5H9zm0 8v2h2v-2H9z"})}),(0,u.jsxs)("div",{children:[(0,u.jsx)("strong",{className:"font-bold text-title-md",children:"Error"}),(0,u.jsx)("p",{className:"text-body-md",children:b})]}),(0,u.jsx)("button",{onClick:()=>k(null),className:"absolute top-3 right-3 text-on-error-container hover:text-on-error-container/80 p-1 rounded-full hover:bg-black/10","aria-label":"Close error message",children:(0,u.jsx)(ve,{className:"w-6 w-6"})})]}),(()=>{switch(et){case"dashboard":return(0,u.jsx)(oF,{dailyPlans:i,medications:l,medicationGroups:f,profileData:x,onUpdateProfile:eR,onNavigateToView:eg});case"journal":return(0,u.jsx)("div",{className:"relative flex justify-center",children:(0,u.jsx)(oZ,{entries:e,onViewEntry:eN,onEdit:ek,onDelete:eS})});case"journal-new":case"journal-edit":return(0,u.jsx)(oK,{onSave:ej,onClose:ev,initialEntry:K});case"thoughtRecord":return(0,u.jsx)("div",{className:"flex justify-center",children:(0,u.jsx)(l$,{thoughtRecords:n,onNew:eC,onView:ee,onEdit:eM,onDelete:eD})});case"thoughtRecord-new":case"thoughtRecord-edit":return(0,u.jsx)("div",{className:"flex justify-center h-full",children:(0,u.jsx)("div",{className:"max-w-3xl w-full",children:(0,u.jsx)(yl,{initialData:G,onSave:eT,onClose:eb,isActive:!0})})});case"planner":return(0,u.jsx)("div",{className:"flex justify-center",children:(0,u.jsx)(y0,{getDailyPlan:eI,saveDailyPlan:eL,getWeeklyPlan:ez,saveWeeklyPlan:eV,onSavePlanToJournal:e1,events:g,journalEntries:e,thoughtRecords:n,onAddEvent:eJ,onUpdateEvent:eG,onDeleteEvent:eY,onViewJournalEntry:eN,onViewThoughtRecord:ee})});case"medication":return(0,u.jsx)("div",{className:"flex justify-center",children:(0,u.jsx)(xe,{medications:l,medicationLogs:d,medicationGroups:f,onAddMedication:e$,onUpdateMedication:e_,onDeleteMedication:eF,onLogMedicationIntake:eB,onClearMedicationLog:eW,onAddMedicationGroup:eq,onUpdateMedicationGroup:eH,onDeleteMedicationGroup:eU,onLogMedicationBundle:eK})});case"affirmations":return(0,u.jsx)(xi,{profileData:x,onUpdateProfile:eR});case"profile":return(0,u.jsx)("div",{className:"flex justify-center",children:(0,u.jsx)(xR,{profileData:x,onUpdateProfile:eR,currentTheme:ei,currentPalette:eo,onToggleTheme:ey,onChangePalette:ex,onDownloadJournal:eO,onClearJournal:eX,onClearPlanner:eZ,onClearMedication:eQ,onClearAllData:e0,onNavigateToView:eg,onReOnboard:()=>v({...x,name:""})})});case"resources":return(0,u.jsx)("div",{className:"flex justify-center",children:(0,u.jsx)(xF,{onNavigateToView:eg,onAddCopingMechanism:eP,userCopingMechanisms:x.copingMechanisms})});case"understanding-cbt":return(0,u.jsx)("div",{className:"flex justify-center",children:(0,u.jsx)(vH,{onNavigateBack:()=>eg("resources")})});case"crisis-support":return(0,u.jsx)("div",{className:"flex justify-center",children:(0,u.jsx)(vJ,{onNavigateBack:()=>eg("resources")})});case"designSystem":return(0,u.jsx)("div",{className:"flex justify-center",children:(0,u.jsx)(x9,{currentPalette:eo,onChangePalette:ex})});default:return null}})()]}),!e2&&(0,u.jsx)("footer",{className:"text-center py-8 text-label-md text-surface-on-variant"})]}),"journal"===et&&(0,u.jsx)("div",{className:"fixed bottom-6 w-full flex justify-center z-20 md:w-auto md:left-1/2 md:right-auto md:transform md:-translate-x-1/2",children:(0,u.jsx)(Q,{onClick:ew,variant:"filled",size:"lg",className:"h-16 w-16 !rounded-full shadow-xl","aria-label":"New Journal Entry",isIconOnly:!0,leadingIcon:(0,u.jsx)(eA,{className:"w-8 h-8"})})}),(0,u.jsx)(x7,{currentTheme:ei,onToggleTheme:ey}),(0,u.jsx)(lz,{isOpen:!!N,onClose:()=>S(null),entry:N,onEdit:ek}),(0,u.jsx)(yd,{isOpen:!!Z,onClose:()=>ee(null),record:Z,onEdit:e=>{ee(null),eM(e)}})]})};function vX(){return(0,u.jsx)(vY,{})}},8034:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"getRouteMatcher",{enumerable:!0,get:function(){return i}});let r=n(4827);function i(e){let{re:t,groups:n}=e;return e=>{let i=t.exec(e);if(!i)return!1;let s=e=>{try{return decodeURIComponent(e)}catch(e){throw Object.defineProperty(new r.DecodeError("failed to decode param"),"__NEXT_ERROR_CODE",{value:"E528",enumerable:!1,configurable:!0})}},o={};for(let[e,t]of Object.entries(n)){let n=i[t.pos];void 0!==n&&(t.repeat?o[e]=n.split("/").map(e=>s(e)):o[e]=s(n))}return o}}},8212:(e,t,n)=>{"use strict";function r(e){return function(){let{cookie:t}=e;if(!t)return{};let{parse:r}=n(6415);return r(Array.isArray(t)?t.join("; "):t)}}Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"getCookieParser",{enumerable:!0,get:function(){return r}})},8299:(e,t,n)=>{Promise.resolve().then(n.bind(n,1204))},8304:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),!function(e,t){for(var n in t)Object.defineProperty(e,n,{enumerable:!0,get:t[n]})}(t,{DEFAULT_METADATA_ROUTE_EXTENSIONS:function(){return a},STATIC_METADATA_IMAGES:function(){return o},getExtensionRegexString:function(){return l},isMetadataPage:function(){return u},isMetadataRoute:function(){return h},isMetadataRouteFile:function(){return c},isStaticMetadataRoute:function(){return d}});let r=n(2958),i=n(4722),s=n(554),o={icon:{filename:"icon",extensions:["ico","jpg","jpeg","png","svg"]},apple:{filename:"apple-icon",extensions:["jpg","jpeg","png"]},favicon:{filename:"favicon",extensions:["ico"]},openGraph:{filename:"opengraph-image",extensions:["jpg","jpeg","png","gif"]},twitter:{filename:"twitter-image",extensions:["jpg","jpeg","png","gif"]}},a=["js","jsx","ts","tsx"],l=(e,t)=>t&&0!==t.length?`(?:\\.(${e.join("|")})|(\\.(${t.join("|")})))`:`(\\.(?:${e.join("|")}))`;function c(e,t,n){let i=(n?"":"?")+"$",s=`\\d?${n?"":"(-\\w{6})?"}`,a=[RegExp(`^[\\\\/]robots${l(t.concat("txt"),null)}${i}`),RegExp(`^[\\\\/]manifest${l(t.concat("webmanifest","json"),null)}${i}`),RegExp("^[\\\\/]favicon\\.ico$"),RegExp(`[\\\\/]sitemap${l(["xml"],t)}${i}`),RegExp(`[\\\\/]${o.icon.filename}${s}${l(o.icon.extensions,t)}${i}`),RegExp(`[\\\\/]${o.apple.filename}${s}${l(o.apple.extensions,t)}${i}`),RegExp(`[\\\\/]${o.openGraph.filename}${s}${l(o.openGraph.extensions,t)}${i}`),RegExp(`[\\\\/]${o.twitter.filename}${s}${l(o.twitter.extensions,t)}${i}`)],c=(0,r.normalizePathSep)(e);return a.some(e=>e.test(c))}function d(e){let t=e.replace(/\/route$/,"");return(0,s.isAppRouteRoute)(e)&&c(t,[],!0)&&"/robots.txt"!==t&&"/manifest.webmanifest"!==t&&!t.endsWith("/sitemap.xml")}function u(e){return!(0,s.isAppRouteRoute)(e)&&c(e,[],!1)}function h(e){let t=(0,i.normalizeAppPath)(e).replace(/^\/?app\//,"").replace("/[__metadata_id__]","").replace(/\/route$/,"");return"/"!==t[0]&&(t="/"+t),(0,s.isAppRouteRoute)(e)&&c(t,[],!1)}},9121:e=>{"use strict";e.exports=require("next/dist/server/app-render/action-async-storage.external.js")},9294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},9551:e=>{"use strict";e.exports=require("url")},9737:(e,t,n)=>{"use strict";n.d(t,{Toaster:()=>r});let r=(0,n(2907).registerClientReference)(function(){throw Error("Attempted to call Toaster() from the server but Toaster is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"/Users/yiannigaliatsatos/Documents/GitHub/echo/src/components/ui/toaster.tsx","Toaster")},9867:(e,t,n)=>{"use strict";n.d(t,{dj:()=>h});var r=n(3210);let i=0,s=new Map,o=e=>{if(s.has(e))return;let t=setTimeout(()=>{s.delete(e),d({type:"REMOVE_TOAST",toastId:e})},1e6);s.set(e,t)},a=(e,t)=>{switch(t.type){case"ADD_TOAST":return{...e,toasts:[t.toast,...e.toasts].slice(0,1)};case"UPDATE_TOAST":return{...e,toasts:e.toasts.map(e=>e.id===t.toast.id?{...e,...t.toast}:e)};case"DISMISS_TOAST":{let{toastId:n}=t;return n?o(n):e.toasts.forEach(e=>{o(e.id)}),{...e,toasts:e.toasts.map(e=>e.id===n||void 0===n?{...e,open:!1}:e)}}case"REMOVE_TOAST":if(void 0===t.toastId)return{...e,toasts:[]};return{...e,toasts:e.toasts.filter(e=>e.id!==t.toastId)}}},l=[],c={toasts:[]};function d(e){c=a(c,e),l.forEach(e=>{e(c)})}function u({...e}){let t=(i=(i+1)%Number.MAX_SAFE_INTEGER).toString(),n=()=>d({type:"DISMISS_TOAST",toastId:t});return d({type:"ADD_TOAST",toast:{...e,id:t,open:!0,onOpenChange:e=>{e||n()}}}),{id:t,dismiss:n,update:e=>d({type:"UPDATE_TOAST",toast:{...e,id:t}})}}function h(){let[e,t]=r.useState(c);return r.useEffect(()=>(l.push(t),()=>{let e=l.indexOf(t);e>-1&&l.splice(e,1)}),[e]),{...e,toast:u,dismiss:e=>d({type:"DISMISS_TOAST",toastId:e})}}}};var t=require("../webpack-runtime.js");t.C(e);var n=e=>t(t.s=e),r=t.X(0,[447,611],()=>n(3226));module.exports=r})();