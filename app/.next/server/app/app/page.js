(()=>{var e={};e.id=466,e.ids=[466],e.modules={3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},8086:e=>{"use strict";e.exports=require("module")},10250:(e,t,n)=>{"use strict";n.r(t),n.d(t,{GlobalError:()=>o.a,__next_app__:()=>h,pages:()=>d,routeModule:()=>u,tree:()=>c});var r=n(65239),s=n(48088),i=n(88170),o=n.n(i),a=n(30893),l={};for(let e in a)0>["default","tree","pages","GlobalError","__next_app__","routeModule"].indexOf(e)&&(l[e]=()=>a[e]);n.d(t,l);let c={children:["",{children:["app",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(n.bind(n,25380)),"C:\\Users\\ygali\\Documents\\GitHub\\echo\\app\\src\\app\\app\\page.tsx"]}]},{metadata:{icon:[async e=>(await Promise.resolve().then(n.bind(n,70440))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]},{layout:[()=>Promise.resolve().then(n.bind(n,94431)),"C:\\Users\\ygali\\Documents\\GitHub\\echo\\app\\src\\app\\layout.tsx"],"not-found":[()=>Promise.resolve().then(n.t.bind(n,57398,23)),"next/dist/client/components/not-found-error"],forbidden:[()=>Promise.resolve().then(n.t.bind(n,89999,23)),"next/dist/client/components/forbidden-error"],unauthorized:[()=>Promise.resolve().then(n.t.bind(n,65284,23)),"next/dist/client/components/unauthorized-error"],metadata:{icon:[async e=>(await Promise.resolve().then(n.bind(n,70440))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]}.children,d=["C:\\Users\\ygali\\Documents\\GitHub\\echo\\app\\src\\app\\app\\page.tsx"],h={require:n,loadChunk:()=>Promise.resolve()},u=new r.AppPageRouteModule({definition:{kind:s.RouteKind.APP_PAGE,page:"/app/page",pathname:"/app",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:c}})},10846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},19121:e=>{"use strict";e.exports=require("next/dist/server/app-render/action-async-storage.external.js")},25380:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>r});let r=(0,n(12907).registerClientReference)(function(){throw Error("Attempted to call the default export of \"C:\\\\Users\\\\ygali\\\\Documents\\\\GitHub\\\\echo\\\\app\\\\src\\\\app\\\\app\\\\page.tsx\" from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"C:\\Users\\ygali\\Documents\\GitHub\\echo\\app\\src\\app\\app\\page.tsx","default")},26361:(e,t,n)=>{Promise.resolve().then(n.bind(n,25380))},29294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},33873:e=>{"use strict";e.exports=require("path")},63033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},79551:e=>{"use strict";e.exports=require("url")},96985:(e,t,n)=>{Promise.resolve().then(n.bind(n,98959))},98959:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>pm});var r,s,i,o,a,l=n(60687),c=n(43210),d=n.t(c,2),h=n.n(c),u=n(66420),p=n(49796),f=n(82614);let m=(0,f.A)("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]),g=(0,f.A)("Menu",[["line",{x1:"4",x2:"20",y1:"12",y2:"12",key:"1e0a9i"}],["line",{x1:"4",x2:"20",y1:"6",y2:"6",key:"1owob3"}],["line",{x1:"4",x2:"20",y1:"18",y2:"18",key:"yk5zj1"}]]);var x=n(33827),y=n(71998),v=n(4780);let b=[{label:"Dashboard",view:"dashboard","aria-label":"Navigate to Dashboard"},{label:"Journal",view:"journal","aria-label":"Navigate to Journal page"},{label:"Planner",view:"planner","aria-label":"Navigate to Planner and Calendar page"},{label:"Thought Record",view:"thoughtRecord","aria-label":"Navigate to Thought Record page"},{label:"Affirmations",view:"affirmations","aria-label":"Navigate to Affirmations page"},{label:"Med Tracker",view:"medication","aria-label":"Navigate to Med Tracker page"},{label:"Resources",view:"resources","aria-label":"Navigate to Resources Page"}],w=[{label:"Profile",view:"profile",icon:(0,l.jsx)(m,{className:"w-5 h-5"}),"aria-label":"Navigate to Profile & Settings Page"}],k=(e,t)=>"journal"===t?e.startsWith("journal"):"thoughtRecord"===t?e.startsWith("thoughtRecord"):"resources"===t?e.startsWith("resources")||"understanding-cbt"===e||"crisis-support"===e:e===t,N=({onToggleDrawer:e,onNavigateToView:t,currentView:n,desktopAudioPlayer:r})=>(0,l.jsx)("nav",{className:"bg-surface-container shadow-md sticky top-0 z-40 h-20",children:(0,l.jsxs)("div",{className:"px-4 sm:px-6 lg:px-8 flex items-center justify-between h-full",children:[(0,l.jsxs)("div",{className:"flex items-center gap-2",children:[(0,l.jsx)("div",{className:"md:hidden",children:(0,l.jsx)(y.A,{onClick:e,variant:"text",size:"md",isIconOnly:!0,title:"Open navigation menu","aria-label":"Open navigation menu",className:"text-primary",leadingIcon:(0,l.jsx)(g,{className:"w-6 h-6"})})}),(0,l.jsxs)("div",{className:"flex items-center space-x-3 cursor-pointer p-2 rounded-lg transition-opacity duration-200 ease-in-out hover:opacity-80 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-primary-container",onClick:()=>{t("dashboard")},onKeyDown:e=>{("Enter"===e.key||" "===e.key)&&(e.preventDefault(),t("dashboard"))},role:"button",tabIndex:0,"aria-label":"echo - Navigate to Dashboard",children:[(0,l.jsx)(x.A,{className:"w-7 h-7 text-primary"}),(0,l.jsx)("h1",{className:"font-geologica font-medium text-2xl text-primary hidden sm:block",children:"echo"})]})]}),(0,l.jsx)("div",{className:"hidden md:flex items-center h-full gap-4",children:b.map(e=>{let r=k(n,e.view);return(0,l.jsx)("button",{onClick:()=>t(e.view),"aria-label":e["aria-label"],"aria-current":r?"page":void 0,className:(0,v.cn)("h-full inline-flex items-center px-3 border-b-2 text-sm font-medium transition-colors duration-200","focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-background",r?"border-primary text-primary":"border-transparent text-surface-on-variant hover:text-primary"),children:e.label},e.view)})}),(0,l.jsxs)("div",{className:"flex items-center space-x-2",children:[r,(0,l.jsxs)("div",{className:"hidden md:flex items-center gap-1",children:[(0,l.jsx)("div",{className:"h-6 w-px bg-outline-variant mx-2"}),w.map(e=>{let r=k(n,e.view);return(0,l.jsx)(y.A,{variant:"text",size:"md",isIconOnly:!0,title:e.label,onClick:()=>t(e.view),className:(0,v.cn)("text-surface-on-variant hover:bg-surface-on-variant/10",r&&"text-primary bg-primary-container/40"),"aria-label":e["aria-label"],"aria-current":r?"page":void 0,children:e.icon},e.view)})]}),(0,l.jsx)("div",{className:"md:hidden",children:(0,l.jsx)(y.A,{onClick:()=>t("profile"),variant:"text",size:"md",isIconOnly:!0,title:"View Profile","aria-label":"View your profile",className:"text-primary",leadingIcon:(0,l.jsx)(m,{className:"w-6 h-6"})})})]})]})}),j=(0,f.A)("House",[["path",{d:"M15 21v-8a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v8",key:"5wwlr5"}],["path",{d:"M3 10a2 2 0 0 1 .709-1.528l7-5.999a2 2 0 0 1 2.582 0l7 5.999A2 2 0 0 1 21 10v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"1d0kgt"}]]);var S=n(91840),C=n(26622),M=n(68872),A=n(25713),E=n(92793);let T=(0,f.A)("CircleHelp",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3",key:"1u773s"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);var D=n(78726);let O=[{label:"Dashboard",view:"dashboard",icon:(0,l.jsx)(j,{className:"w-6 h-6"}),"aria-label":"Navigate to Dashboard"},{label:"Journal",view:"journal",icon:(0,l.jsx)(S.A,{className:"w-6 h-6"}),"aria-label":"Navigate to Journal page"},{label:"Planner",view:"planner",icon:(0,l.jsx)(C.A,{className:"w-6 h-6"}),"aria-label":"Navigate to Planner and Calendar page"},{label:"Thought Record",view:"thoughtRecord",icon:(0,l.jsx)(M.A,{className:"w-6 h-6"}),"aria-label":"Navigate to Thought Record page"},{label:"Affirmations",view:"affirmations",icon:(0,l.jsx)(A.A,{className:"w-6 h-6"}),"aria-label":"Navigate to Affirmations page"},{label:"Med Tracker",view:"medication",icon:(0,l.jsx)(E.A,{className:"w-6 h-6 transform rotate-90"}),"aria-label":"Navigate to Med Tracker page"},{label:"Resources",view:"resources",icon:(0,l.jsx)(T,{className:"w-6 h-6"}),"aria-label":"Navigate to Resources Page"}],I=[{label:"Profile & Settings",view:"profile",icon:(0,l.jsx)(m,{className:"w-6 h-6"}),"aria-label":"Navigate to Profile & Settings Page"}],R=({isOpen:e,onClose:t,onNavigateToView:n,currentView:r})=>{let[s,i]=(0,c.useState)(e),[o,a]=(0,c.useState)(!1);if((0,c.useEffect)(()=>{let t,n,r;return e?(i(!0),t=requestAnimationFrame(()=>{n=requestAnimationFrame(()=>{a(!0)})})):(a(!1),r=window.setTimeout(()=>{i(!1)},1e3)),()=>{cancelAnimationFrame(t),cancelAnimationFrame(n),clearTimeout(r)}},[e]),!s)return null;let d=e=>"journal"===e?r.startsWith("journal"):"thoughtRecord"===e?r.startsWith("thoughtRecord"):"resources"===e?r.startsWith("resources")||"understanding-cbt"===r||"crisis-support"===r:r===e,h=({item:e,isActive:r})=>(0,l.jsx)(y.A,{variant:r?"tonal":"text",size:"lg",className:`w-full justify-start ${r?"text-primary bg-primary-container/30":"text-surface-on hover:bg-surface-container"}`,leadingIcon:e.icon,onClick:()=>{n(e.view),t()},"aria-label":e["aria-label"],"aria-current":r?"page":void 0,children:e.label});return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("div",{className:`
          fixed inset-0 z-40 bg-scrim/60 backdrop-blur-sm 
          transition-opacity ease-&lsqb;cubic-bezier(0.16,1,0.3,1)&rsqb; duration-&lsqb;1000ms&rsqb;
          md:hidden 
          ${o&&e?"opacity-100":"opacity-0"}
        `,onClick:t,"aria-hidden":"true"}),(0,l.jsx)("aside",{className:`
          fixed top-0 left-0 z-50 w-72 sm:w-80 h-full 
          bg-surface-container-highest shadow-xl 
          transform transition-transform ease-&lsqb;cubic-bezier(0.16,1,0.3,1)&rsqb; duration-&lsqb;1000ms&rsqb;
          md:hidden 
          ${o&&e?"translate-x-0":"-translate-x-full"}
        `,role:"dialog","aria-modal":"true","aria-labelledby":"sidebar-title",children:(0,l.jsxs)("div",{className:"flex flex-col h-full",children:[(0,l.jsxs)("div",{className:"relative flex items-center justify-center p-4 border-b border-outline-variant h-20",children:[(0,l.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,l.jsx)(x.A,{className:"w-7 h-7 text-primary"}),(0,l.jsx)("h2",{id:"sidebar-title",className:"font-geologica font-medium text-2xl text-primary",children:"echo"})]}),(0,l.jsx)("div",{className:"absolute right-4 top-1/2 transform -translate-y-1/2",children:(0,l.jsx)(y.A,{variant:"text",size:"sm",isIconOnly:!0,onClick:t,className:"text-surface-on-variant hover:bg-surface-on-variant/10","aria-label":"Close navigation menu",children:(0,l.jsx)(D.A,{className:"w-6 h-6"})})})]}),(0,l.jsxs)("nav",{className:"flex-grow p-6 space-y-3 overflow-y-auto",children:[O.map(e=>(0,l.jsx)(h,{item:e,isActive:d(e.view)},e.view)),(0,l.jsx)("hr",{className:"my-3 border-outline-variant"}),I.map(e=>(0,l.jsx)(h,{item:e,isActive:d(e.view)},e.view))]}),(0,l.jsx)("div",{className:"p-6 border-t border-outline-variant",children:(0,l.jsxs)("p",{className:"text-label-sm text-center text-surface-on-variant",children:["echo \xa9 ",new Date().getFullYear()]})})]})})]})},P=(0,f.A)("Coffee",[["path",{d:"M10 2v2",key:"7u0qdc"}],["path",{d:"M14 2v2",key:"6buw04"}],["path",{d:"M16 8a1 1 0 0 1 1 1v8a4 4 0 0 1-4 4H7a4 4 0 0 1-4-4V9a1 1 0 0 1 1-1h14a4 4 0 1 1 0 8h-1",key:"pwadti"}],["path",{d:"M6 2v2",key:"colzsn"}]]);var z=n(29848),$=n(10453);let L=()=>{let[e,t]=(0,c.useState)({greeting:"Hello",Icon:P,formattedDate:""});(0,c.useEffect)(()=>{let e=new Date,n="Hello",r=P,s=e.getHours();s<12?(n="Good Morning",r=z.A):s<18?(n="Good Afternoon",r=P):(n="Good Evening",r=$.A),t({greeting:n,Icon:r,formattedDate:e.toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"})})},[]);let{greeting:n,Icon:r,formattedDate:s}=e;return(0,l.jsx)("div",{className:"bg-primary-container p-8 rounded-2xl shadow-lg text-on-primary-container",children:(0,l.jsx)("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-start gap-4",children:(0,l.jsxs)("div",{className:"flex-grow",children:[(0,l.jsxs)("div",{className:"flex items-center gap-4",children:[(0,l.jsx)(r,{size:48,className:"opacity-70 flex-shrink-0"}),(0,l.jsxs)("div",{children:[(0,l.jsxs)("h1",{className:"font-serif text-headline-md sm:text-headline-lg",children:[n,"!"]}),(0,l.jsx)("p",{className:"text-title-md sm:text-title-lg opacity-90 min-h-[1.75rem]",children:s})]})]}),(0,l.jsx)("p",{className:"text-body-lg mt-4 opacity-80 max-w-2xl",children:"Welcome back. Capture your thoughts, organize your day, and reflect on your well-being."})]})})})},B=(0,f.A)("Target",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]]),F=(0,f.A)("SquareCheckBig",[["path",{d:"M21 10.5V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h12.5",key:"1uzm8b"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]),V=(0,f.A)("List",[["path",{d:"M3 12h.01",key:"nlz23k"}],["path",{d:"M3 18h.01",key:"1tta3j"}],["path",{d:"M3 6h.01",key:"1rqtza"}],["path",{d:"M8 12h13",key:"1za7za"}],["path",{d:"M8 18h13",key:"1lx6n3"}],["path",{d:"M8 6h13",key:"ik3vkj"}]]),_=({todaysGoals:e,selectedDate:t,onNavigate:n,totalGoalsToday:r,completedGoalsToday:s})=>{let[i,o]=(0,c.useState)("");return(0,c.useEffect)(()=>{o(t.toLocaleDateString("en-US",{weekday:"short",month:"long",day:"numeric"}))},[t]),(0,l.jsxs)("div",{className:"bg-surface-container-low p-8 rounded-xl shadow-md hover:shadow-lg transition-shadow duration-300 flex flex-col justify-between h-full",children:[(0,l.jsxs)("div",{children:[(0,l.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,l.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,l.jsx)(B,{className:"w-7 h-7 text-secondary"}),(0,l.jsx)("h3",{className:"font-serif text-headline-sm text-surface-on",children:"Today's Goals"})]}),r>0&&(0,l.jsxs)("span",{className:"text-xs font-medium px-2 py-0.5 bg-secondary-container text-on-secondary-container rounded-full",children:[s,"/",r," done"]})]}),(0,l.jsx)("p",{className:"text-label-lg text-surface-on-variant mb-3 min-h-[1.25rem]",children:i}),e.length>0?(0,l.jsx)("ul",{className:"space-y-2 mb-4 max-h-32 overflow-y-auto",children:e.map(e=>(0,l.jsxs)("li",{className:"flex items-center p-2 bg-surface rounded-md",children:[(0,l.jsx)(F,{className:`w-4 h-4 mr-2 flex-shrink-0 ${e.completed?"text-secondary":"text-outline-variant"}`}),(0,l.jsx)("span",{className:`text-body-sm text-surface-on truncate ${e.completed?"line-through text-surface-on-variant":""}`,title:e.text,children:e.text})]},e.id))}):(0,l.jsx)("p",{className:"text-body-md text-surface-on-variant mb-4",children:"No specific goals set for today. Plan your day!"})]}),(0,l.jsx)(y.A,{variant:"tonal",size:"md",leadingIcon:(0,l.jsx)(V,{}),onClick:()=>n("planner"),"aria-label":"Open Goal Tracker page",className:"w-full mt-auto",children:"View Today's Focus"})]})},q=(0,f.A)("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]),H=({medicationsCount:e,medicationGroupsCount:t,onNavigate:n})=>(0,l.jsxs)("div",{className:"bg-surface-container-low p-8 rounded-xl shadow-md hover:shadow-lg transition-shadow duration-300 flex flex-col justify-between h-full",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("div",{className:"flex items-center justify-between mb-3",children:(0,l.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,l.jsx)(E.A,{className:"w-7 h-7 text-error transform rotate-90"}),(0,l.jsx)("h3",{className:"font-serif text-headline-sm text-surface-on",children:"Medication"})]})}),(0,l.jsxs)("div",{className:"space-y-2 mb-4",children:[(0,l.jsxs)("div",{className:"flex justify-between items-center p-2.5 bg-surface rounded-lg",children:[(0,l.jsx)("p",{className:"text-body-md text-surface-on",children:"Tracked Medications:"}),(0,l.jsx)("span",{className:"font-semibold text-primary",children:e})]}),(0,l.jsxs)("div",{className:"flex justify-between items-center p-2.5 bg-surface rounded-lg",children:[(0,l.jsx)("p",{className:"text-body-md text-surface-on",children:"Medication Bundles:"}),(0,l.jsx)("span",{className:"font-semibold text-secondary",children:t})]})]}),0===e&&(0,l.jsx)("p",{className:"text-body-md text-surface-on-variant mb-4",children:"Add your medications to start tracking."})]}),(0,l.jsx)(y.A,{variant:"filled",style:{backgroundColor:"var(--error-container)",color:"var(--on-error-container)"},size:"md",leadingIcon:(0,l.jsx)(q,{}),onClick:()=>n("medication"),"aria-label":"Manage medications and view log",className:"w-full mt-auto",children:"Manage Medications"})]}),W=(0,f.A)("LifeBuoy",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m4.93 4.93 4.24 4.24",key:"1ymg45"}],["path",{d:"m14.83 9.17 4.24-4.24",key:"1cb5xl"}],["path",{d:"m14.83 14.83 4.24 4.24",key:"q42g0n"}],["path",{d:"m9.17 14.83-4.24 4.24",key:"bqpfvv"}],["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}]]),U=(0,f.A)("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]),J=(0,f.A)("CirclePlus",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 12h8",key:"1wcyev"}],["path",{d:"M12 8v8",key:"napkw2"}]]);function K({className:e,...t}){return(0,l.jsx)("div",{className:(0,v.cn)("animate-pulse rounded-md bg-muted",e),...t})}let G=({copingMechanisms:e,onNavigate:t,className:n=""})=>{let[r,s]=h().useState(null),[i,o]=h().useState(!1);return h().useEffect(()=>{o(!0)},[]),h().useEffect(()=>{i&&e.length>0?s(e[Math.floor(Math.random()*e.length)]):s(null)},[i,e]),(0,l.jsxs)("div",{className:`bg-surface-container-low p-8 rounded-xl shadow-md hover:shadow-lg transition-shadow duration-300 flex flex-col justify-between h-full ${n}`,children:[(0,l.jsxs)("div",{children:[(0,l.jsxs)("div",{className:"flex items-center space-x-2 mb-3",children:[(0,l.jsx)(W,{className:"w-7 h-7 text-green-500"}),(0,l.jsx)("h3",{className:"font-serif text-headline-sm text-surface-on",children:"My Coping Strategies"})]}),i?r?(0,l.jsx)("div",{className:"mb-4 p-4 bg-surface rounded-lg min-h-[80px] flex items-center justify-center text-center",children:(0,l.jsxs)("p",{className:"text-body-lg font-medium text-surface-on",children:['"',r.text,'"']})}):(0,l.jsx)("p",{className:"text-body-md text-surface-on-variant mb-4",children:"Add your personal coping mechanisms in your profile to see them here."}):(0,l.jsx)(K,{className:"h-[80px] w-full"})]}),(0,l.jsxs)("div",{className:"mt-auto grid grid-cols-1 sm:grid-cols-2 gap-3",children:[e.length>0?(0,l.jsx)(y.A,{variant:"tonal",size:"md",leadingIcon:(0,l.jsx)(U,{}),onClick:()=>{if(e.length>1){let t=r;for(;t&&t.id===r?.id;)t=e[Math.floor(Math.random()*e.length)];s(t)}},"aria-label":"Show another coping mechanism",className:"w-full",disabled:!i||e.length<2,children:"Show Another"}):(0,l.jsx)(y.A,{variant:"filled",size:"md",leadingIcon:(0,l.jsx)(J,{}),onClick:()=>t("profile"),"aria-label":"Add coping mechanisms",className:"w-full sm:col-span-2",children:"Add Mechanisms"}),e.length>0&&(0,l.jsx)(y.A,{variant:"filled",size:"md",leadingIcon:(0,l.jsx)(m,{}),onClick:()=>t("profile"),"aria-label":"Manage your coping mechanisms",className:"w-full",children:"Manage"})]})]})},Y=(0,f.A)("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);var X=n(88920),Z=n(97905);let Q=c.forwardRef(({className:e,type:t,...n},r)=>(0,l.jsx)("input",{type:t,className:(0,v.cn)("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",e),ref:r,...n}));Q.displayName="Input";var ee=n(29867);let et=({profileData:e,onUpdateProfile:t,onNavigate:n,className:r=""})=>{let[s,i]=(0,c.useState)(0),[o,a]=(0,c.useState)(""),[d,h]=(0,c.useState)(!1),{toast:u}=(0,ee.dj)(),p=e?.favoriteAffirmations||[];(0,c.useEffect)(()=>{h(!0)},[]),(0,c.useEffect)(()=>{if(p.length>1){let e=setInterval(()=>{i(e=>(e+1)%p.length)},7e3);return()=>clearInterval(e)}},[p.length]);let f=()=>{if(!o.trim())return;let n=[...p,o.trim()];t({...e,favoriteAffirmations:n}),a(""),u({title:"Custom affirmation added!"})};if(!d)return(0,l.jsx)(K,{className:`bg-surface-container-low p-8 rounded-xl h-[230px] ${r}`});let m=p&&p.length>0;return(0,l.jsxs)("div",{className:`bg-surface-container-low p-8 rounded-xl shadow-md hover:shadow-lg transition-shadow duration-300 flex flex-col justify-between h-full ${r}`,children:[(0,l.jsxs)("div",{children:[(0,l.jsxs)("div",{className:"flex items-center space-x-2 mb-3",children:[(0,l.jsx)(A.A,{className:"w-7 h-7 text-yellow-500"}),(0,l.jsx)("h3",{className:"font-serif text-headline-sm text-surface-on",children:"My Affirmations"})]}),(0,l.jsx)("div",{className:"mb-4 p-4 bg-surface rounded-lg min-h-[80px] flex items-center justify-center text-center",children:m?(0,l.jsx)(X.N,{mode:"wait",children:(0,l.jsxs)(Z.P.p,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},transition:{duration:.5},className:"text-body-lg font-medium text-surface-on",children:['"',p[s],'"']},s)}):(0,l.jsx)("p",{className:"text-body-md text-surface-on-variant",children:"Add or favorite some affirmations to see them here."})})]}),(0,l.jsxs)("div",{className:"mt-auto space-y-3",children:[(0,l.jsxs)("div",{className:"flex gap-2",children:[(0,l.jsx)(Q,{type:"text",placeholder:"Write your own affirmation...",value:o,onChange:e=>a(e.target.value),onKeyPress:e=>"Enter"===e.key&&f(),className:"h-10 bg-surface border-outline-variant"}),(0,l.jsx)(y.A,{variant:"tonal",size:"md",isIconOnly:!0,onClick:f,disabled:!o.trim(),title:"Add Custom Affirmation",children:(0,l.jsx)(Y,{})})]}),(0,l.jsx)(y.A,{variant:"tonal",size:"md",leadingIcon:(0,l.jsx)(J,{}),onClick:()=>n("affirmations"),"aria-label":"Find more affirmations to favorite",className:"w-full",children:m?"Manage & Find More":"Find Affirmations"})]})]})},en=e=>e.toISOString().split("T")[0],er=({dailyPlans:e,medications:t,medicationGroups:n,profileData:r,onNavigateToView:s})=>{let[i,o]=(0,c.useState)(null);if((0,c.useEffect)(()=>{o(new Date)},[]),!i)return(0,l.jsxs)("div",{className:"space-y-8 lg:space-y-10 animate-in fade-in-0 duration-750",children:[(0,l.jsx)(K,{className:"h-[168px] w-full rounded-2xl"}),(0,l.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8 lg:gap-10",children:[(0,l.jsx)(K,{className:"h-[230px] w-full rounded-xl"}),(0,l.jsx)(K,{className:"h-[230px] w-full rounded-xl"}),(0,l.jsx)(K,{className:"h-[180px] w-full rounded-xl"}),(0,l.jsx)(K,{className:"h-[180px] w-full rounded-xl"})]})]});let{copingMechanisms:a,dashboardWidgets:d,favoriteAffirmations:h}=r,u=e[en(i)],p=u?.goals?.filter(e=>!e.completed).slice(0,3)||[],f=u?.goals?.length||0,m=u?.goals?.filter(e=>e.completed).length||0;return(0,l.jsxs)("div",{className:"space-y-8 lg:space-y-10 animate-in fade-in-0 duration-750",children:[(0,l.jsx)(L,{}),(0,l.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8 lg:gap-10",children:[d?.planner&&(0,l.jsx)(_,{todaysGoals:p,selectedDate:i,onNavigate:s,totalGoalsToday:f,completedGoalsToday:m}),d?.affirmations&&(0,l.jsx)(et,{favoriteAffirmations:h,onNavigate:s}),d?.medication&&(0,l.jsx)(H,{medicationsCount:t.length,medicationGroupsCount:n.length,onNavigate:s}),d?.copingMechanisms&&(0,l.jsx)(G,{copingMechanisms:a,onNavigate:s})]})]})},es=(0,f.A)("File",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}]]),ei=(0,f.A)("Mic",[["path",{d:"M12 2a3 3 0 0 0-3 3v7a3 3 0 0 0 6 0V5a3 3 0 0 0-3-3Z",key:"131961"}],["path",{d:"M19 10v2a7 7 0 0 1-14 0v-2",key:"1vc78b"}],["line",{x1:"12",x2:"12",y1:"19",y2:"22",key:"x3vr5v"}]]),eo=(0,f.A)("Save",[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]]),ea=void 0,el=({onTranscriptUpdate:e,onAudioRecorded:t,lang:n="en-US"})=>{let[r,s]=(0,c.useState)(!1),[i,o]=(0,c.useState)(null),a=(0,c.useRef)(null),l=(0,c.useRef)(null),d=(0,c.useRef)([]),h=(0,c.useRef)(null),u=(0,c.useRef)(null),p=!!ea&&!!navigator.mediaDevices&&!!navigator.mediaDevices.getUserMedia,f=(0,c.useCallback)(()=>{if(h.current&&(h.current.getTracks().forEach(e=>e.stop()),h.current=null),l.current&&"inactive"!==l.current.state)try{l.current.stop()}catch(e){}if(l.current=null,a.current)try{a.current.stop()}catch(e){}a.current=null,d.current=[],u.current&&(u.current.abort(),u.current=null)},[]);(0,c.useEffect)(()=>()=>{f()},[f]);let m=()=>{ea&&(a.current=new ea,a.current.continuous=!0,a.current.interimResults=!0,a.current.lang=n,a.current.onresult=t=>{let n="",r="";for(let e=t.resultIndex;e<t.results.length;++e)t.results[e].isFinal?r+=t.results[e][0].transcript:n+=t.results[e][0].transcript;r&&e(r,!0),n&&e(n,!1)},a.current.onerror=e=>{console.error("Speech recognition error:",e.error,e.message),o(`Speech error: ${e.error}. ${e.message||"Check console."}`)})},g=e=>{let n={mimeType:"audio/webm"};!MediaRecorder.isTypeSupported(n.mimeType)&&(n={mimeType:"audio/ogg; codecs=opus"},MediaRecorder.isTypeSupported(n.mimeType)||(n={mimeType:""})),l.current=new MediaRecorder(e,n.mimeType?n:void 0),d.current=[],l.current.ondataavailable=e=>{e.data.size>0&&d.current.push(e.data)},l.current.onstop=()=>{if(d.current.length>0&&t){let e=new Blob(d.current,{type:l.current?.mimeType||"audio/webm"}),n=new FileReader;u.current=n,n.onloadend=()=>{u.current===n&&(t&&t(n.result),u.current=null)},n.onerror=e=>{console.error("FileReader error:",e),o("Failed to process recorded audio."),u.current=null},n.onabort=()=>{console.log("Audio processing cancelled."),o(null),u.current=null},n.readAsDataURL(e)}d.current=[]},l.current.onerror=e=>{console.error("MediaRecorder error:",e),o("Audio recording error. Check console.")}},x=(0,c.useCallback)(async()=>{if(f(),!p)return void o("Speech or media recording is not supported.");if(!r){o(null);try{h.current=await navigator.mediaDevices.getUserMedia({audio:!0}),m(),t&&g(h.current),a.current&&a.current.start(),l.current&&l.current.start(),s(!0)}catch(e){console.error("Error starting recording:",e),"NotAllowedError"===e.name||"PermissionDeniedError"===e.name?o("Microphone access denied. Please allow permissions."):"NotFoundError"===e.name||"DevicesNotFoundError"===e.name?o("No microphone found. Please connect a microphone."):o(`Mic/Setup error: ${e.message||"Unknown error"}`),f(),s(!1)}}},[r,p,n,e,t,f]),y=(0,c.useCallback)(()=>{r&&(f(),s(!1))},[r,f]);return{isRecording:r,startRecording:x,stopRecording:y,cancelProcessing:(0,c.useCallback)(()=>{u.current&&u.current.abort()},[]),speechError:i,isSpeechSupported:p}},ec=({onSave:e,onClose:t,initialEntry:n})=>{let[r,s]=(0,c.useState)(""),[i,o]=(0,c.useState)(void 0),[a,d]=(0,c.useState)("Ready to record"),[h,u]=(0,c.useState)(!1),p=(0,c.useRef)(null),{isRecording:f,startRecording:m,stopRecording:g,cancelProcessing:x,speechError:b,isSpeechSupported:w}=el({onTranscriptUpdate:(0,c.useCallback)((e,t)=>{p.current&&t&&(p.current.classList.contains("placeholder-active")&&(p.current.textContent="",p.current.classList.remove("placeholder-active")),p.current.textContent&&!p.current.textContent.endsWith(" ")&&(p.current.textContent+=" "),p.current.textContent+=e.trim()+" ")},[]),onAudioRecorded:e=>{o(e),u(!1)}});(0,c.useEffect)(()=>{n?(s(n.title||""),o(n.audioBase64DataUrl),p.current&&(p.current.innerHTML=n.text||"",p.current.textContent?.trim()&&p.current.classList.remove("placeholder-active"))):(s(""),o(void 0),p.current&&(p.current.innerHTML="",p.current.classList.add("placeholder-active")))},[n]);let k=()=>{f?(u(!0),g()):m()},N=()=>{x(),u(!1)};return(0,c.useEffect)(()=>{w?b?(d(b),u(!1)):f?(d("Recording... Speak now."),u(!1)):h?d("Processing..."):d("Ready to record"):d("Speech recognition not supported by your browser.")},[f,h,b,w]),(0,l.jsxs)("div",{className:"flex flex-col h-full bg-surface",children:[(0,l.jsxs)("div",{className:"flex-shrink-0 flex items-center justify-between p-4 border-b border-outline-variant md:max-w-3xl md:mx-auto md:w-full",children:[(0,l.jsx)("input",{type:"text",value:r,onChange:e=>s(e.target.value),placeholder:"Untitled Note",className:"flex-grow bg-transparent text-headline-sm font-serif text-surface-on focus:outline-none"}),(0,l.jsx)(y.A,{onClick:t,variant:"text",size:"sm",isIconOnly:!0,"aria-label":"Close",children:(0,l.jsx)(D.A,{className:"h-6 w-6"})})]}),(0,l.jsxs)("div",{className:"flex-grow flex flex-col min-h-0 md:max-w-3xl md:mx-auto md:w-full",children:[(0,l.jsx)("div",{className:"flex-grow p-4 md:p-6 overflow-y-auto min-h-0",children:(0,l.jsx)("div",{ref:p,contentEditable:!0,className:"prose prose-sm sm:prose-base dark:prose-invert max-w-none focus:outline-none h-full placeholder-active:text-surface-on-variant/80","data-placeholder":"Start typing or use the microphone to dictate your thoughts...",onInput:e=>{let t=e.currentTarget;t.textContent?.trim()?t.classList.remove("placeholder-active"):t.classList.add("placeholder-active")}})}),(0,l.jsxs)("div",{className:"flex-shrink-0 flex flex-col items-center justify-center p-4 border-t border-outline-variant space-y-3",children:[(0,l.jsx)("div",{className:"text-label-md text-surface-on-variant h-4",children:a}),(0,l.jsxs)("div",{className:"flex items-center justify-center gap-6",children:[(0,l.jsx)(y.A,{onClick:()=>{s(""),p.current&&(p.current.innerHTML="",p.current.classList.add("placeholder-active")),o(void 0),f&&g(),u(!1),d("Ready to record")},variant:"tonal",size:"md",isIconOnly:!0,title:"New Note / Clear",children:(0,l.jsx)(es,{className:"w-5 h-5"})}),(0,l.jsxs)("button",{onClick:()=>{h?N():k()},disabled:!w,className:(0,v.cn)("relative w-20 h-20 rounded-full flex items-center justify-center transition-all duration-300","bg-surface-container border border-outline-variant shadow-lg hover:scale-105",(f||h)&&"bg-destructive border-transparent",!w&&"opacity-50 cursor-not-allowed"),"aria-label":h?"Cancel Processing":f?"Stop Recording":"Start Recording",children:[(0,l.jsxs)("div",{className:(0,v.cn)(f||h?"text-white":"text-surface-on"),children:[(0,l.jsx)(ei,{className:(0,v.cn)("w-8 h-8 transition-opacity duration-300",f||h?"opacity-0":"opacity-100")}),(0,l.jsx)("div",{className:(0,v.cn)("absolute inset-0 flex items-center justify-center transition-opacity duration-300",f?"opacity-100":"opacity-0"),children:(0,l.jsx)("div",{className:"w-6 h-6 bg-white rounded-sm"})}),(0,l.jsx)("div",{className:(0,v.cn)("absolute inset-0 flex items-center justify-center transition-opacity duration-300",h?"opacity-100":"opacity-0"),children:(0,l.jsx)(D.A,{className:"w-8 h-8"})})]}),f&&(0,l.jsx)("div",{className:"absolute inset-0 flex items-center justify-center pointer-events-none",children:(0,l.jsxs)("svg",{className:"w-48 h-48",viewBox:"0 0 200 200",children:[(0,l.jsx)("circle",{className:"wave animate-wave",cx:"100",cy:"100",r:"40"}),(0,l.jsx)("circle",{className:"wave animate-wave [animation-delay:0.4s]",cx:"100",cy:"100",r:"70"}),(0,l.jsx)("circle",{className:"wave animate-wave [animation-delay:0.8s]",cx:"100",cy:"100",r:"100"})]})})]}),(0,l.jsx)(y.A,{onClick:()=>{e({title:r.trim()||`Journal Entry - ${new Date().toLocaleDateString()}`,text:p.current?.innerHTML||"",audioBase64DataUrl:i})},variant:"filled",size:"md",isIconOnly:!0,title:"Save Note",children:(0,l.jsx)(eo,{className:"w-5 h-5"})})]})]})]})]})},ed=(0,f.A)("CirclePlay",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polygon",{points:"10 8 16 12 10 16 10 8",key:"1cimsy"}]]),eh=(0,f.A)("Pen",[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]]),eu=(0,f.A)("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]),ep=({entry:e,onView:t,onEdit:n,onDelete:r,isPlaceholder:s=!1})=>{let i=s?"Just now":new Date(e.timestamp).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"}),o=e.text.replace(/<[^>]+>/g,""),a=o.length>200?o.substring(0,200)+"...":o;return(0,l.jsxs)("div",{className:"bg-surface-container-low shadow-lg rounded-xl transition-all duration-300 hover:shadow-xl flex items-stretch w-full",children:[(0,l.jsxs)("div",{onClick:()=>!s&&t(e),className:"flex-grow p-5 sm:p-6 cursor-pointer","aria-label":`View entry: ${e.title||"Journal Entry"}`,children:[(0,l.jsx)("h3",{className:"font-serif text-title-lg text-surface-on mb-0.5 break-words",children:e.title}),(0,l.jsx)("p",{className:"text-label-md text-surface-on-variant",children:i}),e.audioBase64DataUrl&&(0,l.jsxs)("div",{className:"flex items-center gap-2 mt-3 text-primary",children:[(0,l.jsx)(ed,{className:"w-4 h-4"}),(0,l.jsx)("span",{className:"text-label-md",children:"Audio entry attached"})]}),o.trim()&&(0,l.jsx)("div",{className:"text-body-md text-surface-on max-w-none mt-2 break-words",children:a}),!o.trim()&&e.audioBase64DataUrl&&(0,l.jsx)("p",{className:"text-label-md text-surface-on-variant italic mt-2",children:"This entry primarily contains audio."})]}),!s&&(0,l.jsxs)("div",{className:"flex flex-col items-center justify-center space-y-2 p-2 border-l border-outline-variant/30",children:[(0,l.jsx)(y.A,{onClick:t=>{t.stopPropagation(),n(e)},variant:"text",size:"sm",isIconOnly:!0,title:"Edit Entry",className:"text-surface-on-variant hover:bg-surface-on-variant/10","aria-label":"Edit this journal entry",children:(0,l.jsx)(eh,{className:"w-5 h-5"})}),(0,l.jsx)(y.A,{onClick:t=>{t.stopPropagation(),r(e.id)},variant:"text",size:"sm",isIconOnly:!0,title:"Delete Entry",className:"text-error hover:bg-error-container/20","aria-label":"Delete this journal entry",children:(0,l.jsx)(eu,{className:"w-5 h-5"})})]})]})},ef=({entries:e,onViewEntry:t,onEdit:n,onDelete:r})=>{if(0===e.length){let e={id:"placeholder",timestamp:Date.now(),title:"Your First Entry Awaits",text:"This is where your journal entries will appear. Click the '+' button below to capture your thoughts, reflections, and daily moments."};return(0,l.jsx)("div",{className:"flex flex-col items-center justify-center text-center py-8 animate-in fade-in-0 duration-1000",children:(0,l.jsx)("div",{className:"max-w-2xl w-full",children:(0,l.jsx)(ep,{entry:e,onView:()=>{},onEdit:()=>{},onDelete:()=>{},isPlaceholder:!0})})})}return(0,l.jsx)("div",{className:"space-y-6 max-w-2xl w-full",children:e.map(e=>(0,l.jsx)(ep,{entry:e,onView:t,onEdit:n,onDelete:r},e.id))})};var em=n(70569),eg=n(98599),ex=n(11273),ey=n(66156),ev=d["useId".toString()]||(()=>void 0),eb=0;function ew(e){let[t,n]=c.useState(ev());return(0,ey.N)(()=>{e||n(e=>e??String(eb++))},[e]),e||(t?`radix-${t}`:"")}var ek=n(65551),eN=n(31355),ej=n(3416),eS=n(13495),eC="focusScope.autoFocusOnMount",eM="focusScope.autoFocusOnUnmount",eA={bubbles:!1,cancelable:!0},eE=c.forwardRef((e,t)=>{let{loop:n=!1,trapped:r=!1,onMountAutoFocus:s,onUnmountAutoFocus:i,...o}=e,[a,d]=c.useState(null),h=(0,eS.c)(s),u=(0,eS.c)(i),p=c.useRef(null),f=(0,eg.s)(t,e=>d(e)),m=c.useRef({paused:!1,pause(){this.paused=!0},resume(){this.paused=!1}}).current;c.useEffect(()=>{if(r){let e=function(e){if(m.paused||!a)return;let t=e.target;a.contains(t)?p.current=t:eO(p.current,{select:!0})},t=function(e){if(m.paused||!a)return;let t=e.relatedTarget;null!==t&&(a.contains(t)||eO(p.current,{select:!0}))};document.addEventListener("focusin",e),document.addEventListener("focusout",t);let n=new MutationObserver(function(e){if(document.activeElement===document.body)for(let t of e)t.removedNodes.length>0&&eO(a)});return a&&n.observe(a,{childList:!0,subtree:!0}),()=>{document.removeEventListener("focusin",e),document.removeEventListener("focusout",t),n.disconnect()}}},[r,a,m.paused]),c.useEffect(()=>{if(a){eI.add(m);let e=document.activeElement;if(!a.contains(e)){let t=new CustomEvent(eC,eA);a.addEventListener(eC,h),a.dispatchEvent(t),t.defaultPrevented||(function(e,{select:t=!1}={}){let n=document.activeElement;for(let r of e)if(eO(r,{select:t}),document.activeElement!==n)return}(eT(a).filter(e=>"A"!==e.tagName),{select:!0}),document.activeElement===e&&eO(a))}return()=>{a.removeEventListener(eC,h),setTimeout(()=>{let t=new CustomEvent(eM,eA);a.addEventListener(eM,u),a.dispatchEvent(t),t.defaultPrevented||eO(e??document.body,{select:!0}),a.removeEventListener(eM,u),eI.remove(m)},0)}}},[a,h,u,m]);let g=c.useCallback(e=>{if(!n&&!r||m.paused)return;let t="Tab"===e.key&&!e.altKey&&!e.ctrlKey&&!e.metaKey,s=document.activeElement;if(t&&s){let t=e.currentTarget,[r,i]=function(e){let t=eT(e);return[eD(t,e),eD(t.reverse(),e)]}(t);r&&i?e.shiftKey||s!==i?e.shiftKey&&s===r&&(e.preventDefault(),n&&eO(i,{select:!0})):(e.preventDefault(),n&&eO(r,{select:!0})):s===t&&e.preventDefault()}},[n,r,m.paused]);return(0,l.jsx)(ej.sG.div,{tabIndex:-1,...o,ref:f,onKeyDown:g})});function eT(e){let t=[],n=document.createTreeWalker(e,NodeFilter.SHOW_ELEMENT,{acceptNode:e=>{let t="INPUT"===e.tagName&&"hidden"===e.type;return e.disabled||e.hidden||t?NodeFilter.FILTER_SKIP:e.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;n.nextNode();)t.push(n.currentNode);return t}function eD(e,t){for(let n of e)if(!function(e,{upTo:t}){if("hidden"===getComputedStyle(e).visibility)return!0;for(;e&&(void 0===t||e!==t);){if("none"===getComputedStyle(e).display)return!0;e=e.parentElement}return!1}(n,{upTo:t}))return n}function eO(e,{select:t=!1}={}){if(e&&e.focus){var n;let r=document.activeElement;e.focus({preventScroll:!0}),e!==r&&(n=e)instanceof HTMLInputElement&&"select"in n&&t&&e.select()}}eE.displayName="FocusScope";var eI=function(){let e=[];return{add(t){let n=e[0];t!==n&&n?.pause(),(e=eR(e,t)).unshift(t)},remove(t){e=eR(e,t),e[0]?.resume()}}}();function eR(e,t){let n=[...e],r=n.indexOf(t);return -1!==r&&n.splice(r,1),n}var eP=n(25028),ez=n(46059),e$=0;function eL(){let e=document.createElement("span");return e.setAttribute("data-radix-focus-guard",""),e.tabIndex=0,e.style.outline="none",e.style.opacity="0",e.style.position="fixed",e.style.pointerEvents="none",e}var eB=function(){return(eB=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var s in t=arguments[n])Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s]);return e}).apply(this,arguments)};function eF(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&0>t.indexOf(r)&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols)for(var s=0,r=Object.getOwnPropertySymbols(e);s<r.length;s++)0>t.indexOf(r[s])&&Object.prototype.propertyIsEnumerable.call(e,r[s])&&(n[r[s]]=e[r[s]]);return n}Object.create;Object.create;var eV=("function"==typeof SuppressedError&&SuppressedError,"right-scroll-bar-position"),e_="width-before-scroll-bar";function eq(e,t){return"function"==typeof e?e(t):e&&(e.current=t),e}var eH="undefined"!=typeof window?c.useLayoutEffect:c.useEffect,eW=new WeakMap;function eU(e){return e}var eJ=function(e){void 0===e&&(e={});var t,n,r,s,i=(t=null,void 0===n&&(n=eU),r=[],s=!1,{read:function(){if(s)throw Error("Sidecar: could not `read` from an `assigned` medium. `read` could be used only with `useMedium`.");return r.length?r[r.length-1]:null},useMedium:function(e){var t=n(e,s);return r.push(t),function(){r=r.filter(function(e){return e!==t})}},assignSyncMedium:function(e){for(s=!0;r.length;){var t=r;r=[],t.forEach(e)}r={push:function(t){return e(t)},filter:function(){return r}}},assignMedium:function(e){s=!0;var t=[];if(r.length){var n=r;r=[],n.forEach(e),t=r}var i=function(){var n=t;t=[],n.forEach(e)},o=function(){return Promise.resolve().then(i)};o(),r={push:function(e){t.push(e),o()},filter:function(e){return t=t.filter(e),r}}}});return i.options=eB({async:!0,ssr:!1},e),i}(),eK=function(){},eG=c.forwardRef(function(e,t){var n,r,s,i,o=c.useRef(null),a=c.useState({onScrollCapture:eK,onWheelCapture:eK,onTouchMoveCapture:eK}),l=a[0],d=a[1],h=e.forwardProps,u=e.children,p=e.className,f=e.removeScrollBar,m=e.enabled,g=e.shards,x=e.sideCar,y=e.noIsolation,v=e.inert,b=e.allowPinchZoom,w=e.as,k=e.gapMode,N=eF(e,["forwardProps","children","className","removeScrollBar","enabled","shards","sideCar","noIsolation","inert","allowPinchZoom","as","gapMode"]),j=(n=[o,t],r=function(e){return n.forEach(function(t){return eq(t,e)})},(s=(0,c.useState)(function(){return{value:null,callback:r,facade:{get current(){return s.value},set current(value){var e=s.value;e!==value&&(s.value=value,s.callback(value,e))}}}})[0]).callback=r,i=s.facade,eH(function(){var e=eW.get(i);if(e){var t=new Set(e),r=new Set(n),s=i.current;t.forEach(function(e){r.has(e)||eq(e,null)}),r.forEach(function(e){t.has(e)||eq(e,s)})}eW.set(i,n)},[n]),i),S=eB(eB({},N),l);return c.createElement(c.Fragment,null,m&&c.createElement(x,{sideCar:eJ,removeScrollBar:f,shards:g,noIsolation:y,inert:v,setCallbacks:d,allowPinchZoom:!!b,lockRef:o,gapMode:k}),h?c.cloneElement(c.Children.only(u),eB(eB({},S),{ref:j})):c.createElement(void 0===w?"div":w,eB({},S,{className:p,ref:j}),u))});eG.defaultProps={enabled:!0,removeScrollBar:!0,inert:!1},eG.classNames={fullWidth:e_,zeroRight:eV};var eY=function(e){var t=e.sideCar,n=eF(e,["sideCar"]);if(!t)throw Error("Sidecar: please provide `sideCar` property to import the right car");var r=t.read();if(!r)throw Error("Sidecar medium not found");return c.createElement(r,eB({},n))};eY.isSideCarExport=!0;var eX=function(){var e=0,t=null;return{add:function(r){if(0==e&&(t=function(){if(!document)return null;var e=document.createElement("style");e.type="text/css";var t=i||n.nc;return t&&e.setAttribute("nonce",t),e}())){var s,o;(s=t).styleSheet?s.styleSheet.cssText=r:s.appendChild(document.createTextNode(r)),o=t,(document.head||document.getElementsByTagName("head")[0]).appendChild(o)}e++},remove:function(){--e||!t||(t.parentNode&&t.parentNode.removeChild(t),t=null)}}},eZ=function(){var e=eX();return function(t,n){c.useEffect(function(){return e.add(t),function(){e.remove()}},[t&&n])}},eQ=function(){var e=eZ();return function(t){return e(t.styles,t.dynamic),null}},e0={left:0,top:0,right:0,gap:0},e1=function(e){return parseInt(e||"",10)||0},e2=function(e){var t=window.getComputedStyle(document.body),n=t["padding"===e?"paddingLeft":"marginLeft"],r=t["padding"===e?"paddingTop":"marginTop"],s=t["padding"===e?"paddingRight":"marginRight"];return[e1(n),e1(r),e1(s)]},e4=function(e){if(void 0===e&&(e="margin"),"undefined"==typeof window)return e0;var t=e2(e),n=document.documentElement.clientWidth,r=window.innerWidth;return{left:t[0],top:t[1],right:t[2],gap:Math.max(0,r-n+t[2]-t[0])}},e5=eQ(),e3="data-scroll-locked",e6=function(e,t,n,r){var s=e.left,i=e.top,o=e.right,a=e.gap;return void 0===n&&(n="margin"),"\n  .".concat("with-scroll-bars-hidden"," {\n   overflow: hidden ").concat(r,";\n   padding-right: ").concat(a,"px ").concat(r,";\n  }\n  body[").concat(e3,"] {\n    overflow: hidden ").concat(r,";\n    overscroll-behavior: contain;\n    ").concat([t&&"position: relative ".concat(r,";"),"margin"===n&&"\n    padding-left: ".concat(s,"px;\n    padding-top: ").concat(i,"px;\n    padding-right: ").concat(o,"px;\n    margin-left:0;\n    margin-top:0;\n    margin-right: ").concat(a,"px ").concat(r,";\n    "),"padding"===n&&"padding-right: ".concat(a,"px ").concat(r,";")].filter(Boolean).join(""),"\n  }\n  \n  .").concat(eV," {\n    right: ").concat(a,"px ").concat(r,";\n  }\n  \n  .").concat(e_," {\n    margin-right: ").concat(a,"px ").concat(r,";\n  }\n  \n  .").concat(eV," .").concat(eV," {\n    right: 0 ").concat(r,";\n  }\n  \n  .").concat(e_," .").concat(e_," {\n    margin-right: 0 ").concat(r,";\n  }\n  \n  body[").concat(e3,"] {\n    ").concat("--removed-body-scroll-bar-size",": ").concat(a,"px;\n  }\n")},e8=function(){var e=parseInt(document.body.getAttribute(e3)||"0",10);return isFinite(e)?e:0},e7=function(){c.useEffect(function(){return document.body.setAttribute(e3,(e8()+1).toString()),function(){var e=e8()-1;e<=0?document.body.removeAttribute(e3):document.body.setAttribute(e3,e.toString())}},[])},e9=function(e){var t=e.noRelative,n=e.noImportant,r=e.gapMode,s=void 0===r?"margin":r;e7();var i=c.useMemo(function(){return e4(s)},[s]);return c.createElement(e5,{styles:e6(i,!t,s,n?"":"!important")})},te=!1;if("undefined"!=typeof window)try{var tt=Object.defineProperty({},"passive",{get:function(){return te=!0,!0}});window.addEventListener("test",tt,tt),window.removeEventListener("test",tt,tt)}catch(e){te=!1}var tn=!!te&&{passive:!1},tr=function(e,t){if(!(e instanceof Element))return!1;var n=window.getComputedStyle(e);return"hidden"!==n[t]&&(n.overflowY!==n.overflowX||"TEXTAREA"===e.tagName||"visible"!==n[t])},ts=function(e,t){var n=t.ownerDocument,r=t;do{if("undefined"!=typeof ShadowRoot&&r instanceof ShadowRoot&&(r=r.host),ti(e,r)){var s=to(e,r);if(s[1]>s[2])return!0}r=r.parentNode}while(r&&r!==n.body);return!1},ti=function(e,t){return"v"===e?tr(t,"overflowY"):tr(t,"overflowX")},to=function(e,t){return"v"===e?[t.scrollTop,t.scrollHeight,t.clientHeight]:[t.scrollLeft,t.scrollWidth,t.clientWidth]},ta=function(e,t,n,r,s){var i,o=(i=window.getComputedStyle(t).direction,"h"===e&&"rtl"===i?-1:1),a=o*r,l=n.target,c=t.contains(l),d=!1,h=a>0,u=0,p=0;do{var f=to(e,l),m=f[0],g=f[1]-f[2]-o*m;(m||g)&&ti(e,l)&&(u+=g,p+=m),l=l instanceof ShadowRoot?l.host:l.parentNode}while(!c&&l!==document.body||c&&(t.contains(l)||t===l));return h&&(s&&1>Math.abs(u)||!s&&a>u)?d=!0:!h&&(s&&1>Math.abs(p)||!s&&-a>p)&&(d=!0),d},tl=function(e){return"changedTouches"in e?[e.changedTouches[0].clientX,e.changedTouches[0].clientY]:[0,0]},tc=function(e){return[e.deltaX,e.deltaY]},td=function(e){return e&&"current"in e?e.current:e},th=0,tu=[];let tp=(s=function(e){var t=c.useRef([]),n=c.useRef([0,0]),r=c.useRef(),s=c.useState(th++)[0],i=c.useState(eQ)[0],o=c.useRef(e);c.useEffect(function(){o.current=e},[e]),c.useEffect(function(){if(e.inert){document.body.classList.add("block-interactivity-".concat(s));var t=(function(e,t,n){if(n||2==arguments.length)for(var r,s=0,i=t.length;s<i;s++)!r&&s in t||(r||(r=Array.prototype.slice.call(t,0,s)),r[s]=t[s]);return e.concat(r||Array.prototype.slice.call(t))})([e.lockRef.current],(e.shards||[]).map(td),!0).filter(Boolean);return t.forEach(function(e){return e.classList.add("allow-interactivity-".concat(s))}),function(){document.body.classList.remove("block-interactivity-".concat(s)),t.forEach(function(e){return e.classList.remove("allow-interactivity-".concat(s))})}}},[e.inert,e.lockRef.current,e.shards]);var a=c.useCallback(function(e,t){if("touches"in e&&2===e.touches.length||"wheel"===e.type&&e.ctrlKey)return!o.current.allowPinchZoom;var s,i=tl(e),a=n.current,l="deltaX"in e?e.deltaX:a[0]-i[0],c="deltaY"in e?e.deltaY:a[1]-i[1],d=e.target,h=Math.abs(l)>Math.abs(c)?"h":"v";if("touches"in e&&"h"===h&&"range"===d.type)return!1;var u=ts(h,d);if(!u)return!0;if(u?s=h:(s="v"===h?"h":"v",u=ts(h,d)),!u)return!1;if(!r.current&&"changedTouches"in e&&(l||c)&&(r.current=s),!s)return!0;var p=r.current||s;return ta(p,t,e,"h"===p?l:c,!0)},[]),l=c.useCallback(function(e){if(tu.length&&tu[tu.length-1]===i){var n="deltaY"in e?tc(e):tl(e),r=t.current.filter(function(t){var r;return t.name===e.type&&(t.target===e.target||e.target===t.shadowParent)&&(r=t.delta,r[0]===n[0]&&r[1]===n[1])})[0];if(r&&r.should){e.cancelable&&e.preventDefault();return}if(!r){var s=(o.current.shards||[]).map(td).filter(Boolean).filter(function(t){return t.contains(e.target)});(s.length>0?a(e,s[0]):!o.current.noIsolation)&&e.cancelable&&e.preventDefault()}}},[]),d=c.useCallback(function(e,n,r,s){var i={name:e,delta:n,target:r,should:s,shadowParent:function(e){for(var t=null;null!==e;)e instanceof ShadowRoot&&(t=e.host,e=e.host),e=e.parentNode;return t}(r)};t.current.push(i),setTimeout(function(){t.current=t.current.filter(function(e){return e!==i})},1)},[]),h=c.useCallback(function(e){n.current=tl(e),r.current=void 0},[]),u=c.useCallback(function(t){d(t.type,tc(t),t.target,a(t,e.lockRef.current))},[]),p=c.useCallback(function(t){d(t.type,tl(t),t.target,a(t,e.lockRef.current))},[]);c.useEffect(function(){return tu.push(i),e.setCallbacks({onScrollCapture:u,onWheelCapture:u,onTouchMoveCapture:p}),document.addEventListener("wheel",l,tn),document.addEventListener("touchmove",l,tn),document.addEventListener("touchstart",h,tn),function(){tu=tu.filter(function(e){return e!==i}),document.removeEventListener("wheel",l,tn),document.removeEventListener("touchmove",l,tn),document.removeEventListener("touchstart",h,tn)}},[]);var f=e.removeScrollBar,m=e.inert;return c.createElement(c.Fragment,null,m?c.createElement(i,{styles:"\n  .block-interactivity-".concat(s," {pointer-events: none;}\n  .allow-interactivity-").concat(s," {pointer-events: all;}\n")}):null,f?c.createElement(e9,{gapMode:e.gapMode}):null)},eJ.useMedium(s),eY);var tf=c.forwardRef(function(e,t){return c.createElement(eG,eB({},e,{ref:t,sideCar:tp}))});tf.classNames=eG.classNames;var tm=function(e){return"undefined"==typeof document?null:(Array.isArray(e)?e[0]:e).ownerDocument.body},tg=new WeakMap,tx=new WeakMap,ty={},tv=0,tb=function(e){return e&&(e.host||tb(e.parentNode))},tw=function(e,t,n,r){var s=(Array.isArray(e)?e:[e]).map(function(e){if(t.contains(e))return e;var n=tb(e);return n&&t.contains(n)?n:(console.error("aria-hidden",e,"in not contained inside",t,". Doing nothing"),null)}).filter(function(e){return!!e});ty[n]||(ty[n]=new WeakMap);var i=ty[n],o=[],a=new Set,l=new Set(s),c=function(e){!e||a.has(e)||(a.add(e),c(e.parentNode))};s.forEach(c);var d=function(e){!e||l.has(e)||Array.prototype.forEach.call(e.children,function(e){if(a.has(e))d(e);else try{var t=e.getAttribute(r),s=null!==t&&"false"!==t,l=(tg.get(e)||0)+1,c=(i.get(e)||0)+1;tg.set(e,l),i.set(e,c),o.push(e),1===l&&s&&tx.set(e,!0),1===c&&e.setAttribute(n,"true"),s||e.setAttribute(r,"true")}catch(t){console.error("aria-hidden: cannot operate on ",e,t)}})};return d(t),a.clear(),tv++,function(){o.forEach(function(e){var t=tg.get(e)-1,s=i.get(e)-1;tg.set(e,t),i.set(e,s),t||(tx.has(e)||e.removeAttribute(r),tx.delete(e)),s||e.removeAttribute(n)}),--tv||(tg=new WeakMap,tg=new WeakMap,tx=new WeakMap,ty={})}},tk=function(e,t,n){void 0===n&&(n="data-aria-hidden");var r=Array.from(Array.isArray(e)?e:[e]),s=t||tm(e);return s?(r.push.apply(r,Array.from(s.querySelectorAll("[aria-live]"))),tw(r,s,n,"aria-hidden")):function(){return null}},tN=c.forwardRef((e,t)=>{let{children:n,...r}=e,s=c.Children.toArray(n),i=s.find(tC);if(i){let e=i.props.children,n=s.map(t=>t!==i?t:c.Children.count(e)>1?c.Children.only(null):c.isValidElement(e)?e.props.children:null);return(0,l.jsx)(tj,{...r,ref:t,children:c.isValidElement(e)?c.cloneElement(e,void 0,n):null})}return(0,l.jsx)(tj,{...r,ref:t,children:n})});tN.displayName="Slot";var tj=c.forwardRef((e,t)=>{let{children:n,...r}=e;if(c.isValidElement(n)){let e=function(e){let t=Object.getOwnPropertyDescriptor(e.props,"ref")?.get,n=t&&"isReactWarning"in t&&t.isReactWarning;return n?e.ref:(n=(t=Object.getOwnPropertyDescriptor(e,"ref")?.get)&&"isReactWarning"in t&&t.isReactWarning)?e.props.ref:e.props.ref||e.ref}(n),s=function(e,t){let n={...t};for(let r in t){let s=e[r],i=t[r];/^on[A-Z]/.test(r)?s&&i?n[r]=(...e)=>{i(...e),s(...e)}:s&&(n[r]=s):"style"===r?n[r]={...s,...i}:"className"===r&&(n[r]=[s,i].filter(Boolean).join(" "))}return{...e,...n}}(r,n.props);return n.type!==c.Fragment&&(s.ref=t?(0,eg.t)(t,e):e),c.cloneElement(n,s)}return c.Children.count(n)>1?c.Children.only(null):null});tj.displayName="SlotClone";var tS=({children:e})=>(0,l.jsx)(l.Fragment,{children:e});function tC(e){return c.isValidElement(e)&&e.type===tS}var tM="Dialog",[tA,tE]=(0,ex.A)(tM),[tT,tD]=tA(tM),tO=e=>{let{__scopeDialog:t,children:n,open:r,defaultOpen:s,onOpenChange:i,modal:o=!0}=e,a=c.useRef(null),d=c.useRef(null),[h=!1,u]=(0,ek.i)({prop:r,defaultProp:s,onChange:i});return(0,l.jsx)(tT,{scope:t,triggerRef:a,contentRef:d,contentId:ew(),titleId:ew(),descriptionId:ew(),open:h,onOpenChange:u,onOpenToggle:c.useCallback(()=>u(e=>!e),[u]),modal:o,children:n})};tO.displayName=tM;var tI="DialogTrigger";c.forwardRef((e,t)=>{let{__scopeDialog:n,...r}=e,s=tD(tI,n),i=(0,eg.s)(t,s.triggerRef);return(0,l.jsx)(ej.sG.button,{type:"button","aria-haspopup":"dialog","aria-expanded":s.open,"aria-controls":s.contentId,"data-state":tZ(s.open),...r,ref:i,onClick:(0,em.m)(e.onClick,s.onOpenToggle)})}).displayName=tI;var tR="DialogPortal",[tP,tz]=tA(tR,{forceMount:void 0}),t$=e=>{let{__scopeDialog:t,forceMount:n,children:r,container:s}=e,i=tD(tR,t);return(0,l.jsx)(tP,{scope:t,forceMount:n,children:c.Children.map(r,e=>(0,l.jsx)(ez.C,{present:n||i.open,children:(0,l.jsx)(eP.Z,{asChild:!0,container:s,children:e})}))})};t$.displayName=tR;var tL="DialogOverlay",tB=c.forwardRef((e,t)=>{let n=tz(tL,e.__scopeDialog),{forceMount:r=n.forceMount,...s}=e,i=tD(tL,e.__scopeDialog);return i.modal?(0,l.jsx)(ez.C,{present:r||i.open,children:(0,l.jsx)(tF,{...s,ref:t})}):null});tB.displayName=tL;var tF=c.forwardRef((e,t)=>{let{__scopeDialog:n,...r}=e,s=tD(tL,n);return(0,l.jsx)(tf,{as:tN,allowPinchZoom:!0,shards:[s.contentRef],children:(0,l.jsx)(ej.sG.div,{"data-state":tZ(s.open),...r,ref:t,style:{pointerEvents:"auto",...r.style}})})}),tV="DialogContent",t_=c.forwardRef((e,t)=>{let n=tz(tV,e.__scopeDialog),{forceMount:r=n.forceMount,...s}=e,i=tD(tV,e.__scopeDialog);return(0,l.jsx)(ez.C,{present:r||i.open,children:i.modal?(0,l.jsx)(tq,{...s,ref:t}):(0,l.jsx)(tH,{...s,ref:t})})});t_.displayName=tV;var tq=c.forwardRef((e,t)=>{let n=tD(tV,e.__scopeDialog),r=c.useRef(null),s=(0,eg.s)(t,n.contentRef,r);return c.useEffect(()=>{let e=r.current;if(e)return tk(e)},[]),(0,l.jsx)(tW,{...e,ref:s,trapFocus:n.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:(0,em.m)(e.onCloseAutoFocus,e=>{e.preventDefault(),n.triggerRef.current?.focus()}),onPointerDownOutside:(0,em.m)(e.onPointerDownOutside,e=>{let t=e.detail.originalEvent,n=0===t.button&&!0===t.ctrlKey;(2===t.button||n)&&e.preventDefault()}),onFocusOutside:(0,em.m)(e.onFocusOutside,e=>e.preventDefault())})}),tH=c.forwardRef((e,t)=>{let n=tD(tV,e.__scopeDialog),r=c.useRef(!1),s=c.useRef(!1);return(0,l.jsx)(tW,{...e,ref:t,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:t=>{e.onCloseAutoFocus?.(t),t.defaultPrevented||(r.current||n.triggerRef.current?.focus(),t.preventDefault()),r.current=!1,s.current=!1},onInteractOutside:t=>{e.onInteractOutside?.(t),t.defaultPrevented||(r.current=!0,"pointerdown"===t.detail.originalEvent.type&&(s.current=!0));let i=t.target;n.triggerRef.current?.contains(i)&&t.preventDefault(),"focusin"===t.detail.originalEvent.type&&s.current&&t.preventDefault()}})}),tW=c.forwardRef((e,t)=>{let{__scopeDialog:n,trapFocus:r,onOpenAutoFocus:s,onCloseAutoFocus:i,...o}=e,a=tD(tV,n),d=c.useRef(null),h=(0,eg.s)(t,d);return c.useEffect(()=>{let e=document.querySelectorAll("[data-radix-focus-guard]");return document.body.insertAdjacentElement("afterbegin",e[0]??eL()),document.body.insertAdjacentElement("beforeend",e[1]??eL()),e$++,()=>{1===e$&&document.querySelectorAll("[data-radix-focus-guard]").forEach(e=>e.remove()),e$--}},[]),(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(eE,{asChild:!0,loop:!0,trapped:r,onMountAutoFocus:s,onUnmountAutoFocus:i,children:(0,l.jsx)(eN.qW,{role:"dialog",id:a.contentId,"aria-describedby":a.descriptionId,"aria-labelledby":a.titleId,"data-state":tZ(a.open),...o,ref:h,onDismiss:()=>a.onOpenChange(!1)})}),(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(t2,{titleId:a.titleId}),(0,l.jsx)(t4,{contentRef:d,descriptionId:a.descriptionId})]})]})}),tU="DialogTitle",tJ=c.forwardRef((e,t)=>{let{__scopeDialog:n,...r}=e,s=tD(tU,n);return(0,l.jsx)(ej.sG.h2,{id:s.titleId,...r,ref:t})});tJ.displayName=tU;var tK="DialogDescription",tG=c.forwardRef((e,t)=>{let{__scopeDialog:n,...r}=e,s=tD(tK,n);return(0,l.jsx)(ej.sG.p,{id:s.descriptionId,...r,ref:t})});tG.displayName=tK;var tY="DialogClose",tX=c.forwardRef((e,t)=>{let{__scopeDialog:n,...r}=e,s=tD(tY,n);return(0,l.jsx)(ej.sG.button,{type:"button",...r,ref:t,onClick:(0,em.m)(e.onClick,()=>s.onOpenChange(!1))})});function tZ(e){return e?"open":"closed"}tX.displayName=tY;var tQ="DialogTitleWarning",[t0,t1]=(0,ex.q)(tQ,{contentName:tV,titleName:tU,docsSlug:"dialog"}),t2=({titleId:e})=>{let t=t1(tQ),n=`\`${t.contentName}\` requires a \`${t.titleName}\` for the component to be accessible for screen reader users.

If you want to hide the \`${t.titleName}\`, you can wrap it with our VisuallyHidden component.

For more information, see https://radix-ui.com/primitives/docs/components/${t.docsSlug}`;return c.useEffect(()=>{e&&(document.getElementById(e)||console.error(n))},[n,e]),null},t4=({contentRef:e,descriptionId:t})=>{let n=t1("DialogDescriptionWarning"),r=`Warning: Missing \`Description\` or \`aria-describedby={undefined}\` for {${n.contentName}}.`;return c.useEffect(()=>{let n=e.current?.getAttribute("aria-describedby");t&&n&&(document.getElementById(t)||console.warn(r))},[r,e,t]),null};let t5=c.forwardRef(({className:e,...t},n)=>(0,l.jsx)(tB,{ref:n,className:(0,v.cn)("fixed inset-0 z-50 bg-black/80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",e),...t}));t5.displayName=tB.displayName;let t3=c.forwardRef(({className:e,children:t,...n},r)=>(0,l.jsxs)(t$,{children:[(0,l.jsx)(t5,{}),(0,l.jsxs)(t_,{ref:r,className:(0,v.cn)("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",e),...n,children:[t,(0,l.jsxs)(tX,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[(0,l.jsx)(D.A,{className:"h-4 w-4"}),(0,l.jsx)("span",{className:"sr-only",children:"Close"})]})]})]}));t3.displayName=t_.displayName;let t6=({className:e,...t})=>(0,l.jsx)("div",{className:(0,v.cn)("flex flex-col space-y-1.5 text-center sm:text-left",e),...t});t6.displayName="DialogHeader";let t8=c.forwardRef(({className:e,...t},n)=>(0,l.jsx)(tJ,{ref:n,className:(0,v.cn)("text-lg font-semibold leading-none tracking-tight",e),...t}));t8.displayName=tJ.displayName,c.forwardRef(({className:e,...t},n)=>(0,l.jsx)(tG,{ref:n,className:(0,v.cn)("text-sm text-muted-foreground",e),...t})).displayName=tG.displayName;let t7=({isOpen:e,onClose:t,title:n,children:r,contentClassName:s,containerClassName:i})=>(0,l.jsx)(tO,{open:e,onOpenChange:e=>{e||t()},children:(0,l.jsxs)(t3,{className:(0,v.cn)("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-surface-container shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",i),children:[n?(0,l.jsx)(t6,{className:"px-6 pt-6 text-left -mb-4",children:(0,l.jsx)(t8,{className:"font-serif text-headline-sm text-surface-on",children:n})}):(0,l.jsx)(t6,{className:"sr-only",children:(0,l.jsx)(t8,{children:"Dialog"})}),(0,l.jsx)("div",{className:(0,v.cn)("text-body-md text-surface-on-variant",{"-mt-12":!n},s),children:r})]})}),t9=({isOpen:e,onClose:t,entry:n,onEdit:r})=>{if(!n)return null;let s=new Date(n.timestamp).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit",hour12:!0});return(0,l.jsxs)(t7,{isOpen:e,onClose:t,title:n.title||"Journal Entry",children:[(0,l.jsxs)("div",{className:"p-6 max-h-[70vh] overflow-y-auto",children:[(0,l.jsx)("p",{className:"text-sm text-surface-on-variant mb-4",children:s}),n.audioBase64DataUrl&&(0,l.jsxs)("div",{className:"my-4 p-4 bg-surface-container rounded-lg",children:[(0,l.jsxs)("div",{className:"flex items-center mb-2",children:[(0,l.jsx)(ed,{className:"w-5 h-5 text-primary mr-2 flex-shrink-0"}),(0,l.jsx)("p",{className:"text-label-md text-surface-on font-medium",children:"Play Dictated Audio"})]}),(0,l.jsx)("audio",{controls:!0,src:n.audioBase64DataUrl,className:"w-full h-10 rounded-md",children:"Your browser does not support the audio element."})]}),n.text.trim()&&(0,l.jsx)("div",{className:"prose prose-sm sm:prose-base dark:prose-invert max-w-none break-words",dangerouslySetInnerHTML:{__html:n.text}}),!n.text.trim()&&n.audioBase64DataUrl&&(0,l.jsx)("p",{className:"text-label-md text-surface-on-variant italic mt-2",children:"This entry primarily contains audio."})]}),(0,l.jsxs)("div",{className:"flex justify-end space-x-3 p-6 border-t border-outline-variant",children:[(0,l.jsx)(y.A,{type:"button",variant:"text",onClick:t,children:"Close"}),(0,l.jsx)(y.A,{type:"button",variant:"filled",leadingIcon:(0,l.jsx)(eh,{}),onClick:()=>{r(n),t()},children:"Edit Entry"})]})]})},ne=({record:e,onView:t,onEdit:n,onDelete:r})=>{let s=new Date(e.timestamp).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"}),i=e.data.situation.length>150?e.data.situation.substring(0,150)+"...":e.data.situation;return(0,l.jsxs)("div",{className:"bg-surface-container-low shadow-lg rounded-xl transition-all duration-300 hover:shadow-xl flex items-stretch w-full",children:[(0,l.jsxs)("div",{onClick:()=>t(e),className:"flex-grow p-5 sm:p-6 cursor-pointer","aria-label":`View record: ${e.title}`,children:[(0,l.jsx)("h3",{className:"font-serif text-title-lg text-surface-on mb-0.5 break-words",children:e.title}),(0,l.jsx)("p",{className:"text-label-md text-surface-on-variant",children:s}),(0,l.jsx)("div",{className:"text-body-md text-surface-on max-w-none mt-2 break-words",children:(0,l.jsxs)("p",{className:"italic text-surface-on-variant",children:['Situation: "',i,'"']})})]}),(0,l.jsxs)("div",{className:"flex flex-col items-center justify-center space-y-2 p-2 border-l border-outline-variant/30",children:[(0,l.jsx)(y.A,{onClick:t=>{t.stopPropagation(),n(e)},variant:"text",size:"sm",isIconOnly:!0,title:"Edit Record",className:"text-surface-on-variant hover:bg-surface-on-variant/10","aria-label":"Edit this thought record",children:(0,l.jsx)(eh,{className:"w-5 h-5"})}),(0,l.jsx)(y.A,{onClick:t=>{t.stopPropagation(),r(e.id)},variant:"text",size:"sm",isIconOnly:!0,title:"Delete Record",className:"text-error hover:bg-error-container/20","aria-label":"Delete this thought record",children:(0,l.jsx)(eu,{className:"w-5 h-5"})})]})]})},nt=({thoughtRecords:e,onNew:t,onView:n,onEdit:r,onDelete:s})=>(0,l.jsxs)("div",{className:"space-y-10 animate-in fade-in-0 duration-750 max-w-3xl w-full",children:[(0,l.jsxs)("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4",children:[(0,l.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,l.jsx)(M.A,{className:"w-8 h-8 text-primary"}),(0,l.jsx)("h2",{className:"font-serif text-headline-lg text-surface-on",children:"My Thought Records"})]}),(0,l.jsx)(y.A,{variant:"filled",size:"md",leadingIcon:(0,l.jsx)(J,{}),onClick:t,className:"w-full sm:w-auto","aria-label":"Create new thought record",children:"New Thought Record"})]}),(0,l.jsx)("p",{className:"text-body-lg text-surface-on-variant -mt-6",children:"Use this structured exercise to examine and challenge unhelpful thoughts. Track your progress by reviewing past records."}),e.length>0?(0,l.jsx)("div",{className:"space-y-6",children:e.map(e=>(0,l.jsx)(ne,{record:e,onView:n,onEdit:r,onDelete:s},e.id))}):(0,l.jsxs)("div",{className:"text-center py-12 bg-surface-container-low rounded-xl",children:[(0,l.jsx)("h3",{className:"font-serif text-headline-sm text-surface-on",children:"No Records Yet"}),(0,l.jsx)("p",{className:"mt-2 text-body-md text-surface-on-variant",children:'Click "New Thought Record" to get started.'})]})]}),nn=(0,f.A)("CircleStop",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["rect",{x:"9",y:"9",width:"6",height:"6",rx:"1",key:"1ssd4o"}]]),nr=(0,f.A)("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]),ns=(0,f.A)("ArrowRight",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]);function ni(e,[t,n]){return Math.min(n,Math.max(t,e))}var no=c.createContext(void 0);function na(e){let t=c.useContext(no);return e||t||"ltr"}function nl(e){let t=c.useRef({value:e,previous:e});return c.useMemo(()=>(t.current.value!==e&&(t.current.previous=t.current.value,t.current.value=e),t.current.previous),[e])}function nc(e){let[t,n]=c.useState(void 0);return(0,ey.N)(()=>{if(e){n({width:e.offsetWidth,height:e.offsetHeight});let t=new ResizeObserver(t=>{let r,s;if(!Array.isArray(t)||!t.length)return;let i=t[0];if("borderBoxSize"in i){let e=i.borderBoxSize,t=Array.isArray(e)?e[0]:e;r=t.inlineSize,s=t.blockSize}else r=e.offsetWidth,s=e.offsetHeight;n({width:r,height:s})});return t.observe(e,{box:"border-box"}),()=>t.unobserve(e)}n(void 0)},[e]),t}var nd=n(72031),nh=["PageUp","PageDown"],nu=["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"],np={"from-left":["Home","PageDown","ArrowDown","ArrowLeft"],"from-right":["Home","PageDown","ArrowDown","ArrowRight"],"from-bottom":["Home","PageDown","ArrowDown","ArrowLeft"],"from-top":["Home","PageDown","ArrowUp","ArrowLeft"]},nf="Slider",[nm,ng,nx]=(0,nd.N)(nf),[ny,nv]=(0,ex.A)(nf,[nx]),[nb,nw]=ny(nf),nk=c.forwardRef((e,t)=>{let{name:n,min:r=0,max:s=100,step:i=1,orientation:o="horizontal",disabled:a=!1,minStepsBetweenThumbs:d=0,defaultValue:h=[r],value:u,onValueChange:p=()=>{},onValueCommit:f=()=>{},inverted:m=!1,form:g,...x}=e,y=c.useRef(new Set),v=c.useRef(0),b="horizontal"===o,[w=[],k]=(0,ek.i)({prop:u,defaultProp:h,onChange:e=>{let t=[...y.current];t[v.current]?.focus(),p(e)}}),N=c.useRef(w);function j(e,t,{commit:n}={commit:!1}){let o=(String(i).split(".")[1]||"").length,a=ni(function(e,t){let n=Math.pow(10,t);return Math.round(e*n)/n}(Math.round((e-r)/i)*i+r,o),[r,s]);k((e=[])=>{let r=function(e=[],t,n){let r=[...e];return r[n]=t,r.sort((e,t)=>e-t)}(e,a,t);if(!function(e,t){if(t>0)return Math.min(...e.slice(0,-1).map((t,n)=>e[n+1]-t))>=t;return!0}(r,d*i))return e;{v.current=r.indexOf(a);let t=String(r)!==String(e);return t&&n&&f(r),t?r:e}})}return(0,l.jsx)(nb,{scope:e.__scopeSlider,name:n,disabled:a,min:r,max:s,valueIndexToChangeRef:v,thumbs:y.current,values:w,orientation:o,form:g,children:(0,l.jsx)(nm.Provider,{scope:e.__scopeSlider,children:(0,l.jsx)(nm.Slot,{scope:e.__scopeSlider,children:(0,l.jsx)(b?nS:nC,{"aria-disabled":a,"data-disabled":a?"":void 0,...x,ref:t,onPointerDown:(0,em.m)(x.onPointerDown,()=>{a||(N.current=w)}),min:r,max:s,inverted:m,onSlideStart:a?void 0:function(e){let t=function(e,t){if(1===e.length)return 0;let n=e.map(e=>Math.abs(e-t)),r=Math.min(...n);return n.indexOf(r)}(w,e);j(e,t)},onSlideMove:a?void 0:function(e){j(e,v.current)},onSlideEnd:a?void 0:function(){let e=N.current[v.current];w[v.current]!==e&&f(w)},onHomeKeyDown:()=>!a&&j(r,0,{commit:!0}),onEndKeyDown:()=>!a&&j(s,w.length-1,{commit:!0}),onStepKeyDown:({event:e,direction:t})=>{if(!a){let n=nh.includes(e.key)||e.shiftKey&&nu.includes(e.key),r=v.current;j(w[r]+i*(n?10:1)*t,r,{commit:!0})}}})})})})});nk.displayName=nf;var[nN,nj]=ny(nf,{startEdge:"left",endEdge:"right",size:"width",direction:1}),nS=c.forwardRef((e,t)=>{let{min:n,max:r,dir:s,inverted:i,onSlideStart:o,onSlideMove:a,onSlideEnd:d,onStepKeyDown:h,...u}=e,[p,f]=c.useState(null),m=(0,eg.s)(t,e=>f(e)),g=c.useRef(void 0),x=na(s),y="ltr"===x,v=y&&!i||!y&&i;function b(e){let t=g.current||p.getBoundingClientRect(),s=n$([0,t.width],v?[n,r]:[r,n]);return g.current=t,s(e-t.left)}return(0,l.jsx)(nN,{scope:e.__scopeSlider,startEdge:v?"left":"right",endEdge:v?"right":"left",direction:v?1:-1,size:"width",children:(0,l.jsx)(nM,{dir:x,"data-orientation":"horizontal",...u,ref:m,style:{...u.style,"--radix-slider-thumb-transform":"translateX(-50%)"},onSlideStart:e=>{let t=b(e.clientX);o?.(t)},onSlideMove:e=>{let t=b(e.clientX);a?.(t)},onSlideEnd:()=>{g.current=void 0,d?.()},onStepKeyDown:e=>{let t=np[v?"from-left":"from-right"].includes(e.key);h?.({event:e,direction:t?-1:1})}})})}),nC=c.forwardRef((e,t)=>{let{min:n,max:r,inverted:s,onSlideStart:i,onSlideMove:o,onSlideEnd:a,onStepKeyDown:d,...h}=e,u=c.useRef(null),p=(0,eg.s)(t,u),f=c.useRef(void 0),m=!s;function g(e){let t=f.current||u.current.getBoundingClientRect(),s=n$([0,t.height],m?[r,n]:[n,r]);return f.current=t,s(e-t.top)}return(0,l.jsx)(nN,{scope:e.__scopeSlider,startEdge:m?"bottom":"top",endEdge:m?"top":"bottom",size:"height",direction:m?1:-1,children:(0,l.jsx)(nM,{"data-orientation":"vertical",...h,ref:p,style:{...h.style,"--radix-slider-thumb-transform":"translateY(50%)"},onSlideStart:e=>{let t=g(e.clientY);i?.(t)},onSlideMove:e=>{let t=g(e.clientY);o?.(t)},onSlideEnd:()=>{f.current=void 0,a?.()},onStepKeyDown:e=>{let t=np[m?"from-bottom":"from-top"].includes(e.key);d?.({event:e,direction:t?-1:1})}})})}),nM=c.forwardRef((e,t)=>{let{__scopeSlider:n,onSlideStart:r,onSlideMove:s,onSlideEnd:i,onHomeKeyDown:o,onEndKeyDown:a,onStepKeyDown:c,...d}=e,h=nw(nf,n);return(0,l.jsx)(ej.sG.span,{...d,ref:t,onKeyDown:(0,em.m)(e.onKeyDown,e=>{"Home"===e.key?(o(e),e.preventDefault()):"End"===e.key?(a(e),e.preventDefault()):nh.concat(nu).includes(e.key)&&(c(e),e.preventDefault())}),onPointerDown:(0,em.m)(e.onPointerDown,e=>{let t=e.target;t.setPointerCapture(e.pointerId),e.preventDefault(),h.thumbs.has(t)?t.focus():r(e)}),onPointerMove:(0,em.m)(e.onPointerMove,e=>{e.target.hasPointerCapture(e.pointerId)&&s(e)}),onPointerUp:(0,em.m)(e.onPointerUp,e=>{let t=e.target;t.hasPointerCapture(e.pointerId)&&(t.releasePointerCapture(e.pointerId),i(e))})})}),nA="SliderTrack",nE=c.forwardRef((e,t)=>{let{__scopeSlider:n,...r}=e,s=nw(nA,n);return(0,l.jsx)(ej.sG.span,{"data-disabled":s.disabled?"":void 0,"data-orientation":s.orientation,...r,ref:t})});nE.displayName=nA;var nT="SliderRange",nD=c.forwardRef((e,t)=>{let{__scopeSlider:n,...r}=e,s=nw(nT,n),i=nj(nT,n),o=c.useRef(null),a=(0,eg.s)(t,o),d=s.values.length,h=s.values.map(e=>nz(e,s.min,s.max)),u=d>1?Math.min(...h):0,p=100-Math.max(...h);return(0,l.jsx)(ej.sG.span,{"data-orientation":s.orientation,"data-disabled":s.disabled?"":void 0,...r,ref:a,style:{...e.style,[i.startEdge]:u+"%",[i.endEdge]:p+"%"}})});nD.displayName=nT;var nO="SliderThumb",nI=c.forwardRef((e,t)=>{let n=ng(e.__scopeSlider),[r,s]=c.useState(null),i=(0,eg.s)(t,e=>s(e)),o=c.useMemo(()=>r?n().findIndex(e=>e.ref.current===r):-1,[n,r]);return(0,l.jsx)(nR,{...e,ref:i,index:o})}),nR=c.forwardRef((e,t)=>{let{__scopeSlider:n,index:r,name:s,...i}=e,o=nw(nO,n),a=nj(nO,n),[d,h]=c.useState(null),u=(0,eg.s)(t,e=>h(e)),p=!d||o.form||!!d.closest("form"),f=nc(d),m=o.values[r],g=void 0===m?0:nz(m,o.min,o.max),x=function(e,t){return t>2?`Value ${e+1} of ${t}`:2===t?["Minimum","Maximum"][e]:void 0}(r,o.values.length),y=f?.[a.size],v=y?function(e,t,n){let r=e/2,s=n$([0,50],[0,r]);return(r-s(t)*n)*n}(y,g,a.direction):0;return c.useEffect(()=>{if(d)return o.thumbs.add(d),()=>{o.thumbs.delete(d)}},[d,o.thumbs]),(0,l.jsxs)("span",{style:{transform:"var(--radix-slider-thumb-transform)",position:"absolute",[a.startEdge]:`calc(${g}% + ${v}px)`},children:[(0,l.jsx)(nm.ItemSlot,{scope:e.__scopeSlider,children:(0,l.jsx)(ej.sG.span,{role:"slider","aria-label":e["aria-label"]||x,"aria-valuemin":o.min,"aria-valuenow":m,"aria-valuemax":o.max,"aria-orientation":o.orientation,"data-orientation":o.orientation,"data-disabled":o.disabled?"":void 0,tabIndex:o.disabled?void 0:0,...i,ref:u,style:void 0===m?{display:"none"}:e.style,onFocus:(0,em.m)(e.onFocus,()=>{o.valueIndexToChangeRef.current=r})})}),p&&(0,l.jsx)(nP,{name:s??(o.name?o.name+(o.values.length>1?"[]":""):void 0),form:o.form,value:m},r)]})});nI.displayName=nO;var nP=e=>{let{value:t,...n}=e,r=c.useRef(null),s=nl(t);return c.useEffect(()=>{let e=r.current,n=Object.getOwnPropertyDescriptor(window.HTMLInputElement.prototype,"value").set;if(s!==t&&n){let r=new Event("input",{bubbles:!0});n.call(e,t),e.dispatchEvent(r)}},[s,t]),(0,l.jsx)("input",{style:{display:"none"},...n,ref:r,defaultValue:t})};function nz(e,t,n){return ni(100/(n-t)*(e-t),[0,100])}function n$(e,t){return n=>{if(e[0]===e[1]||t[0]===t[1])return t[0];let r=(t[1]-t[0])/(e[1]-e[0]);return t[0]+r*(n-e[0])}}let nL=c.forwardRef(({className:e,...t},n)=>(0,l.jsxs)(nk,{ref:n,className:(0,v.cn)("relative flex w-full touch-none select-none items-center group py-2",e),...t,children:[(0,l.jsx)(nE,{className:"relative h-2 w-full grow overflow-hidden rounded-full bg-secondary-container",children:(0,l.jsx)(nD,{className:"absolute h-full bg-primary"})}),(0,l.jsx)(nI,{className:"block h-5 w-5 rounded-full border-2 border-primary bg-background ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50"})]}));nL.displayName=nk.displayName;var nB=n(51215);function nF(e){this.content=e}nF.prototype={constructor:nF,find:function(e){for(var t=0;t<this.content.length;t+=2)if(this.content[t]===e)return t;return -1},get:function(e){var t=this.find(e);return -1==t?void 0:this.content[t+1]},update:function(e,t,n){var r=n&&n!=e?this.remove(n):this,s=r.find(e),i=r.content.slice();return -1==s?i.push(n||e,t):(i[s+1]=t,n&&(i[s]=n)),new nF(i)},remove:function(e){var t=this.find(e);if(-1==t)return this;var n=this.content.slice();return n.splice(t,2),new nF(n)},addToStart:function(e,t){return new nF([e,t].concat(this.remove(e).content))},addToEnd:function(e,t){var n=this.remove(e).content.slice();return n.push(e,t),new nF(n)},addBefore:function(e,t,n){var r=this.remove(t),s=r.content.slice(),i=r.find(e);return s.splice(-1==i?s.length:i,0,t,n),new nF(s)},forEach:function(e){for(var t=0;t<this.content.length;t+=2)e(this.content[t],this.content[t+1])},prepend:function(e){return(e=nF.from(e)).size?new nF(e.content.concat(this.subtract(e).content)):this},append:function(e){return(e=nF.from(e)).size?new nF(this.subtract(e).content.concat(e.content)):this},subtract:function(e){var t=this;e=nF.from(e);for(var n=0;n<e.content.length;n+=2)t=t.remove(e.content[n]);return t},toObject:function(){var e={};return this.forEach(function(t,n){e[t]=n}),e},get size(){return this.content.length>>1}},nF.from=function(e){if(e instanceof nF)return e;var t=[];if(e)for(var n in e)t.push(n,e[n]);return new nF(t)};class nV{constructor(e,t){if(this.content=e,this.size=t||0,null==t)for(let t=0;t<e.length;t++)this.size+=e[t].nodeSize}nodesBetween(e,t,n,r=0,s){for(let i=0,o=0;o<t;i++){let a=this.content[i],l=o+a.nodeSize;if(l>e&&!1!==n(a,r+o,s||null,i)&&a.content.size){let s=o+1;a.nodesBetween(Math.max(0,e-s),Math.min(a.content.size,t-s),n,r+s)}o=l}}descendants(e){this.nodesBetween(0,this.size,e)}textBetween(e,t,n,r){let s="",i=!0;return this.nodesBetween(e,t,(o,a)=>{let l=o.isText?o.text.slice(Math.max(e,a)-a,t-a):o.isLeaf?r?"function"==typeof r?r(o):r:o.type.spec.leafText?o.type.spec.leafText(o):"":"";o.isBlock&&(o.isLeaf&&l||o.isTextblock)&&n&&(i?i=!1:s+=n),s+=l},0),s}append(e){if(!e.size)return this;if(!this.size)return e;let t=this.lastChild,n=e.firstChild,r=this.content.slice(),s=0;for(t.isText&&t.sameMarkup(n)&&(r[r.length-1]=t.withText(t.text+n.text),s=1);s<e.content.length;s++)r.push(e.content[s]);return new nV(r,this.size+e.size)}cut(e,t=this.size){if(0==e&&t==this.size)return this;let n=[],r=0;if(t>e)for(let s=0,i=0;i<t;s++){let o=this.content[s],a=i+o.nodeSize;a>e&&((i<e||a>t)&&(o=o.isText?o.cut(Math.max(0,e-i),Math.min(o.text.length,t-i)):o.cut(Math.max(0,e-i-1),Math.min(o.content.size,t-i-1))),n.push(o),r+=o.nodeSize),i=a}return new nV(n,r)}cutByIndex(e,t){return e==t?nV.empty:0==e&&t==this.content.length?this:new nV(this.content.slice(e,t))}replaceChild(e,t){let n=this.content[e];if(n==t)return this;let r=this.content.slice(),s=this.size+t.nodeSize-n.nodeSize;return r[e]=t,new nV(r,s)}addToStart(e){return new nV([e].concat(this.content),this.size+e.nodeSize)}addToEnd(e){return new nV(this.content.concat(e),this.size+e.nodeSize)}eq(e){if(this.content.length!=e.content.length)return!1;for(let t=0;t<this.content.length;t++)if(!this.content[t].eq(e.content[t]))return!1;return!0}get firstChild(){return this.content.length?this.content[0]:null}get lastChild(){return this.content.length?this.content[this.content.length-1]:null}get childCount(){return this.content.length}child(e){let t=this.content[e];if(!t)throw RangeError("Index "+e+" out of range for "+this);return t}maybeChild(e){return this.content[e]||null}forEach(e){for(let t=0,n=0;t<this.content.length;t++){let r=this.content[t];e(r,n,t),n+=r.nodeSize}}findDiffStart(e,t=0){return function e(t,n,r){for(let s=0;;s++){if(s==t.childCount||s==n.childCount)return t.childCount==n.childCount?null:r;let i=t.child(s),o=n.child(s);if(i==o){r+=i.nodeSize;continue}if(!i.sameMarkup(o))return r;if(i.isText&&i.text!=o.text){for(let e=0;i.text[e]==o.text[e];e++)r++;return r}if(i.content.size||o.content.size){let t=e(i.content,o.content,r+1);if(null!=t)return t}r+=i.nodeSize}}(this,e,t)}findDiffEnd(e,t=this.size,n=e.size){return function e(t,n,r,s){for(let i=t.childCount,o=n.childCount;;){if(0==i||0==o)return i==o?null:{a:r,b:s};let a=t.child(--i),l=n.child(--o),c=a.nodeSize;if(a==l){r-=c,s-=c;continue}if(!a.sameMarkup(l))return{a:r,b:s};if(a.isText&&a.text!=l.text){let e=0,t=Math.min(a.text.length,l.text.length);for(;e<t&&a.text[a.text.length-e-1]==l.text[l.text.length-e-1];)e++,r--,s--;return{a:r,b:s}}if(a.content.size||l.content.size){let t=e(a.content,l.content,r-1,s-1);if(t)return t}r-=c,s-=c}}(this,e,t,n)}findIndex(e,t=-1){if(0==e)return nq(0,e);if(e==this.size)return nq(this.content.length,e);if(e>this.size||e<0)throw RangeError(`Position ${e} outside of fragment (${this})`);for(let n=0,r=0;;n++){let s=r+this.child(n).nodeSize;if(s>=e){if(s==e||t>0)return nq(n+1,s);return nq(n,r)}r=s}}toString(){return"<"+this.toStringInner()+">"}toStringInner(){return this.content.join(", ")}toJSON(){return this.content.length?this.content.map(e=>e.toJSON()):null}static fromJSON(e,t){if(!t)return nV.empty;if(!Array.isArray(t))throw RangeError("Invalid input for Fragment.fromJSON");return new nV(t.map(e.nodeFromJSON))}static fromArray(e){if(!e.length)return nV.empty;let t,n=0;for(let r=0;r<e.length;r++){let s=e[r];n+=s.nodeSize,r&&s.isText&&e[r-1].sameMarkup(s)?(t||(t=e.slice(0,r)),t[t.length-1]=s.withText(t[t.length-1].text+s.text)):t&&t.push(s)}return new nV(t||e,n)}static from(e){if(!e)return nV.empty;if(e instanceof nV)return e;if(Array.isArray(e))return this.fromArray(e);if(e.attrs)return new nV([e],e.nodeSize);throw RangeError("Can not convert "+e+" to a Fragment"+(e.nodesBetween?" (looks like multiple versions of prosemirror-model were loaded)":""))}}nV.empty=new nV([],0);let n_={index:0,offset:0};function nq(e,t){return n_.index=e,n_.offset=t,n_}function nH(e,t){if(e===t)return!0;if(!(e&&"object"==typeof e)||!(t&&"object"==typeof t))return!1;let n=Array.isArray(e);if(Array.isArray(t)!=n)return!1;if(n){if(e.length!=t.length)return!1;for(let n=0;n<e.length;n++)if(!nH(e[n],t[n]))return!1}else{for(let n in e)if(!(n in t)||!nH(e[n],t[n]))return!1;for(let n in t)if(!(n in e))return!1}return!0}class nW{constructor(e,t){this.type=e,this.attrs=t}addToSet(e){let t,n=!1;for(let r=0;r<e.length;r++){let s=e[r];if(this.eq(s))return e;if(this.type.excludes(s.type))t||(t=e.slice(0,r));else{if(s.type.excludes(this.type))return e;!n&&s.type.rank>this.type.rank&&(t||(t=e.slice(0,r)),t.push(this),n=!0),t&&t.push(s)}}return t||(t=e.slice()),n||t.push(this),t}removeFromSet(e){for(let t=0;t<e.length;t++)if(this.eq(e[t]))return e.slice(0,t).concat(e.slice(t+1));return e}isInSet(e){for(let t=0;t<e.length;t++)if(this.eq(e[t]))return!0;return!1}eq(e){return this==e||this.type==e.type&&nH(this.attrs,e.attrs)}toJSON(){let e={type:this.type.name};for(let t in this.attrs){e.attrs=this.attrs;break}return e}static fromJSON(e,t){if(!t)throw RangeError("Invalid input for Mark.fromJSON");let n=e.marks[t.type];if(!n)throw RangeError(`There is no mark type ${t.type} in this schema`);let r=n.create(t.attrs);return n.checkAttrs(r.attrs),r}static sameSet(e,t){if(e==t)return!0;if(e.length!=t.length)return!1;for(let n=0;n<e.length;n++)if(!e[n].eq(t[n]))return!1;return!0}static setFrom(e){if(!e||Array.isArray(e)&&0==e.length)return nW.none;if(e instanceof nW)return[e];let t=e.slice();return t.sort((e,t)=>e.type.rank-t.type.rank),t}}nW.none=[];class nU extends Error{}class nJ{constructor(e,t,n){this.content=e,this.openStart=t,this.openEnd=n}get size(){return this.content.size-this.openStart-this.openEnd}insertAt(e,t){let n=function e(t,n,r,s){let{index:i,offset:o}=t.findIndex(n),a=t.maybeChild(i);if(o==n||a.isText)return s&&!s.canReplace(i,i,r)?null:t.cut(0,n).append(r).append(t.cut(n));let l=e(a.content,n-o-1,r);return l&&t.replaceChild(i,a.copy(l))}(this.content,e+this.openStart,t);return n&&new nJ(n,this.openStart,this.openEnd)}removeBetween(e,t){return new nJ(function e(t,n,r){let{index:s,offset:i}=t.findIndex(n),o=t.maybeChild(s),{index:a,offset:l}=t.findIndex(r);if(i==n||o.isText){if(l!=r&&!t.child(a).isText)throw RangeError("Removing non-flat range");return t.cut(0,n).append(t.cut(r))}if(s!=a)throw RangeError("Removing non-flat range");return t.replaceChild(s,o.copy(e(o.content,n-i-1,r-i-1)))}(this.content,e+this.openStart,t+this.openStart),this.openStart,this.openEnd)}eq(e){return this.content.eq(e.content)&&this.openStart==e.openStart&&this.openEnd==e.openEnd}toString(){return this.content+"("+this.openStart+","+this.openEnd+")"}toJSON(){if(!this.content.size)return null;let e={content:this.content.toJSON()};return this.openStart>0&&(e.openStart=this.openStart),this.openEnd>0&&(e.openEnd=this.openEnd),e}static fromJSON(e,t){if(!t)return nJ.empty;let n=t.openStart||0,r=t.openEnd||0;if("number"!=typeof n||"number"!=typeof r)throw RangeError("Invalid input for Slice.fromJSON");return new nJ(nV.fromJSON(e,t.content),n,r)}static maxOpen(e,t=!0){let n=0,r=0;for(let r=e.firstChild;r&&!r.isLeaf&&(t||!r.type.spec.isolating);r=r.firstChild)n++;for(let n=e.lastChild;n&&!n.isLeaf&&(t||!n.type.spec.isolating);n=n.lastChild)r++;return new nJ(e,n,r)}}function nK(e,t){if(!t.type.compatibleContent(e.type))throw new nU("Cannot join "+t.type.name+" onto "+e.type.name)}function nG(e,t,n){let r=e.node(n);return nK(r,t.node(n)),r}function nY(e,t){let n=t.length-1;n>=0&&e.isText&&e.sameMarkup(t[n])?t[n]=e.withText(t[n].text+e.text):t.push(e)}function nX(e,t,n,r){let s=(t||e).node(n),i=0,o=t?t.index(n):s.childCount;e&&(i=e.index(n),e.depth>n?i++:e.textOffset&&(nY(e.nodeAfter,r),i++));for(let e=i;e<o;e++)nY(s.child(e),r);t&&t.depth==n&&t.textOffset&&nY(t.nodeBefore,r)}function nZ(e,t){return e.type.checkContent(t),e.copy(t)}function nQ(e,t,n){let r=[];return nX(null,e,n,r),e.depth>n&&nY(nZ(nG(e,t,n+1),nQ(e,t,n+1)),r),nX(t,null,n,r),new nV(r)}nJ.empty=new nJ(nV.empty,0,0);class n0{constructor(e,t,n){this.pos=e,this.path=t,this.parentOffset=n,this.depth=t.length/3-1}resolveDepth(e){return null==e?this.depth:e<0?this.depth+e:e}get parent(){return this.node(this.depth)}get doc(){return this.node(0)}node(e){return this.path[3*this.resolveDepth(e)]}index(e){return this.path[3*this.resolveDepth(e)+1]}indexAfter(e){return e=this.resolveDepth(e),this.index(e)+(e!=this.depth||this.textOffset?1:0)}start(e){return 0==(e=this.resolveDepth(e))?0:this.path[3*e-1]+1}end(e){return e=this.resolveDepth(e),this.start(e)+this.node(e).content.size}before(e){if(!(e=this.resolveDepth(e)))throw RangeError("There is no position before the top-level node");return e==this.depth+1?this.pos:this.path[3*e-1]}after(e){if(!(e=this.resolveDepth(e)))throw RangeError("There is no position after the top-level node");return e==this.depth+1?this.pos:this.path[3*e-1]+this.path[3*e].nodeSize}get textOffset(){return this.pos-this.path[this.path.length-1]}get nodeAfter(){let e=this.parent,t=this.index(this.depth);if(t==e.childCount)return null;let n=this.pos-this.path[this.path.length-1],r=e.child(t);return n?e.child(t).cut(n):r}get nodeBefore(){let e=this.index(this.depth),t=this.pos-this.path[this.path.length-1];return t?this.parent.child(e).cut(0,t):0==e?null:this.parent.child(e-1)}posAtIndex(e,t){t=this.resolveDepth(t);let n=this.path[3*t],r=0==t?0:this.path[3*t-1]+1;for(let t=0;t<e;t++)r+=n.child(t).nodeSize;return r}marks(){let e=this.parent,t=this.index();if(0==e.content.size)return nW.none;if(this.textOffset)return e.child(t).marks;let n=e.maybeChild(t-1),r=e.maybeChild(t);if(!n){let e=n;n=r,r=e}let s=n.marks;for(var i=0;i<s.length;i++)!1!==s[i].type.spec.inclusive||r&&s[i].isInSet(r.marks)||(s=s[i--].removeFromSet(s));return s}marksAcross(e){let t=this.parent.maybeChild(this.index());if(!t||!t.isInline)return null;let n=t.marks,r=e.parent.maybeChild(e.index());for(var s=0;s<n.length;s++)!1!==n[s].type.spec.inclusive||r&&n[s].isInSet(r.marks)||(n=n[s--].removeFromSet(n));return n}sharedDepth(e){for(let t=this.depth;t>0;t--)if(this.start(t)<=e&&this.end(t)>=e)return t;return 0}blockRange(e=this,t){if(e.pos<this.pos)return e.blockRange(this);for(let n=this.depth-(this.parent.inlineContent||this.pos==e.pos?1:0);n>=0;n--)if(e.pos<=this.end(n)&&(!t||t(this.node(n))))return new n5(this,e,n);return null}sameParent(e){return this.pos-this.parentOffset==e.pos-e.parentOffset}max(e){return e.pos>this.pos?e:this}min(e){return e.pos<this.pos?e:this}toString(){let e="";for(let t=1;t<=this.depth;t++)e+=(e?"/":"")+this.node(t).type.name+"_"+this.index(t-1);return e+":"+this.parentOffset}static resolve(e,t){if(!(t>=0&&t<=e.content.size))throw RangeError("Position "+t+" out of range");let n=[],r=0,s=t;for(let t=e;;){let{index:e,offset:i}=t.content.findIndex(s),o=s-i;if(n.push(t,e,r+i),!o||(t=t.child(e)).isText)break;s=o-1,r+=i+1}return new n0(t,n,s)}static resolveCached(e,t){let n=n4.get(e);if(n)for(let e=0;e<n.elts.length;e++){let r=n.elts[e];if(r.pos==t)return r}else n4.set(e,n=new n1);let r=n.elts[n.i]=n0.resolve(e,t);return n.i=(n.i+1)%n2,r}}class n1{constructor(){this.elts=[],this.i=0}}let n2=12,n4=new WeakMap;class n5{constructor(e,t,n){this.$from=e,this.$to=t,this.depth=n}get start(){return this.$from.before(this.depth+1)}get end(){return this.$to.after(this.depth+1)}get parent(){return this.$from.node(this.depth)}get startIndex(){return this.$from.index(this.depth)}get endIndex(){return this.$to.indexAfter(this.depth)}}let n3=Object.create(null);class n6{constructor(e,t,n,r=nW.none){this.type=e,this.attrs=t,this.marks=r,this.content=n||nV.empty}get children(){return this.content.content}get nodeSize(){return this.isLeaf?1:2+this.content.size}get childCount(){return this.content.childCount}child(e){return this.content.child(e)}maybeChild(e){return this.content.maybeChild(e)}forEach(e){this.content.forEach(e)}nodesBetween(e,t,n,r=0){this.content.nodesBetween(e,t,n,r,this)}descendants(e){this.nodesBetween(0,this.content.size,e)}get textContent(){return this.isLeaf&&this.type.spec.leafText?this.type.spec.leafText(this):this.textBetween(0,this.content.size,"")}textBetween(e,t,n,r){return this.content.textBetween(e,t,n,r)}get firstChild(){return this.content.firstChild}get lastChild(){return this.content.lastChild}eq(e){return this==e||this.sameMarkup(e)&&this.content.eq(e.content)}sameMarkup(e){return this.hasMarkup(e.type,e.attrs,e.marks)}hasMarkup(e,t,n){return this.type==e&&nH(this.attrs,t||e.defaultAttrs||n3)&&nW.sameSet(this.marks,n||nW.none)}copy(e=null){return e==this.content?this:new n6(this.type,this.attrs,e,this.marks)}mark(e){return e==this.marks?this:new n6(this.type,this.attrs,this.content,e)}cut(e,t=this.content.size){return 0==e&&t==this.content.size?this:this.copy(this.content.cut(e,t))}slice(e,t=this.content.size,n=!1){if(e==t)return nJ.empty;let r=this.resolve(e),s=this.resolve(t),i=n?0:r.sharedDepth(t),o=r.start(i);return new nJ(r.node(i).content.cut(r.pos-o,s.pos-o),r.depth-i,s.depth-i)}replace(e,t,n){var r=this.resolve(e),s=this.resolve(t);if(n.openStart>r.depth)throw new nU("Inserted content deeper than insertion position");if(r.depth-n.openStart!=s.depth-n.openEnd)throw new nU("Inconsistent open depths");return function e(t,n,r,s){let i=t.index(s),o=t.node(s);if(i==n.index(s)&&s<t.depth-r.openStart){let a=e(t,n,r,s+1);return o.copy(o.content.replaceChild(i,a))}if(!r.content.size)return nZ(o,nQ(t,n,s));if(r.openStart||r.openEnd||t.depth!=s||n.depth!=s){let{start:e,end:i}=function(e,t){let n=t.depth-e.openStart,r=t.node(n).copy(e.content);for(let e=n-1;e>=0;e--)r=t.node(e).copy(nV.from(r));return{start:r.resolveNoCache(e.openStart+n),end:r.resolveNoCache(r.content.size-e.openEnd-n)}}(r,t);return nZ(o,function e(t,n,r,s,i){let o=t.depth>i&&nG(t,n,i+1),a=s.depth>i&&nG(r,s,i+1),l=[];return nX(null,t,i,l),o&&a&&n.index(i)==r.index(i)?(nK(o,a),nY(nZ(o,e(t,n,r,s,i+1)),l)):(o&&nY(nZ(o,nQ(t,n,i+1)),l),nX(n,r,i,l),a&&nY(nZ(a,nQ(r,s,i+1)),l)),nX(s,null,i,l),new nV(l)}(t,e,i,n,s))}{let e=t.parent,s=e.content;return nZ(e,s.cut(0,t.parentOffset).append(r.content).append(s.cut(n.parentOffset)))}}(r,s,n,0)}nodeAt(e){for(let t=this;;){let{index:n,offset:r}=t.content.findIndex(e);if(!(t=t.maybeChild(n)))return null;if(r==e||t.isText)return t;e-=r+1}}childAfter(e){let{index:t,offset:n}=this.content.findIndex(e);return{node:this.content.maybeChild(t),index:t,offset:n}}childBefore(e){if(0==e)return{node:null,index:0,offset:0};let{index:t,offset:n}=this.content.findIndex(e);if(n<e)return{node:this.content.child(t),index:t,offset:n};let r=this.content.child(t-1);return{node:r,index:t-1,offset:n-r.nodeSize}}resolve(e){return n0.resolveCached(this,e)}resolveNoCache(e){return n0.resolve(this,e)}rangeHasMark(e,t,n){let r=!1;return t>e&&this.nodesBetween(e,t,e=>(n.isInSet(e.marks)&&(r=!0),!r)),r}get isBlock(){return this.type.isBlock}get isTextblock(){return this.type.isTextblock}get inlineContent(){return this.type.inlineContent}get isInline(){return this.type.isInline}get isText(){return this.type.isText}get isLeaf(){return this.type.isLeaf}get isAtom(){return this.type.isAtom}toString(){if(this.type.spec.toDebugString)return this.type.spec.toDebugString(this);let e=this.type.name;return this.content.size&&(e+="("+this.content.toStringInner()+")"),n7(this.marks,e)}contentMatchAt(e){let t=this.type.contentMatch.matchFragment(this.content,0,e);if(!t)throw Error("Called contentMatchAt on a node with invalid content");return t}canReplace(e,t,n=nV.empty,r=0,s=n.childCount){let i=this.contentMatchAt(e).matchFragment(n,r,s),o=i&&i.matchFragment(this.content,t);if(!o||!o.validEnd)return!1;for(let e=r;e<s;e++)if(!this.type.allowsMarks(n.child(e).marks))return!1;return!0}canReplaceWith(e,t,n,r){if(r&&!this.type.allowsMarks(r))return!1;let s=this.contentMatchAt(e).matchType(n),i=s&&s.matchFragment(this.content,t);return!!i&&i.validEnd}canAppend(e){return e.content.size?this.canReplace(this.childCount,this.childCount,e.content):this.type.compatibleContent(e.type)}check(){this.type.checkContent(this.content),this.type.checkAttrs(this.attrs);let e=nW.none;for(let t=0;t<this.marks.length;t++){let n=this.marks[t];n.type.checkAttrs(n.attrs),e=n.addToSet(e)}if(!nW.sameSet(e,this.marks))throw RangeError(`Invalid collection of marks for node ${this.type.name}: ${this.marks.map(e=>e.type.name)}`);this.content.forEach(e=>e.check())}toJSON(){let e={type:this.type.name};for(let t in this.attrs){e.attrs=this.attrs;break}return this.content.size&&(e.content=this.content.toJSON()),this.marks.length&&(e.marks=this.marks.map(e=>e.toJSON())),e}static fromJSON(e,t){let n;if(!t)throw RangeError("Invalid input for Node.fromJSON");if(t.marks){if(!Array.isArray(t.marks))throw RangeError("Invalid mark data for Node.fromJSON");n=t.marks.map(e.markFromJSON)}if("text"==t.type){if("string"!=typeof t.text)throw RangeError("Invalid text node in JSON");return e.text(t.text,n)}let r=nV.fromJSON(e,t.content),s=e.nodeType(t.type).create(t.attrs,r,n);return s.type.checkAttrs(s.attrs),s}}n6.prototype.text=void 0;class n8 extends n6{constructor(e,t,n,r){if(super(e,t,null,r),!n)throw RangeError("Empty text nodes are not allowed");this.text=n}toString(){return this.type.spec.toDebugString?this.type.spec.toDebugString(this):n7(this.marks,JSON.stringify(this.text))}get textContent(){return this.text}textBetween(e,t){return this.text.slice(e,t)}get nodeSize(){return this.text.length}mark(e){return e==this.marks?this:new n8(this.type,this.attrs,this.text,e)}withText(e){return e==this.text?this:new n8(this.type,this.attrs,e,this.marks)}cut(e=0,t=this.text.length){return 0==e&&t==this.text.length?this:this.withText(this.text.slice(e,t))}eq(e){return this.sameMarkup(e)&&this.text==e.text}toJSON(){let e=super.toJSON();return e.text=this.text,e}}function n7(e,t){for(let n=e.length-1;n>=0;n--)t=e[n].type.name+"("+t+")";return t}class n9{constructor(e){this.validEnd=e,this.next=[],this.wrapCache=[]}static parse(e,t){var n;let r,s=new re(e,t);if(null==s.next)return n9.empty;let i=function e(t){let n=[];do n.push(function(t){let n=[];do n.push(function(t){let n=function(t){if(t.eat("(")){let n=e(t);return t.eat(")")||t.err("Missing closing paren"),n}if(/\W/.test(t.next))t.err("Unexpected token '"+t.next+"'");else{let e=(function(e,t){let n=e.nodeTypes,r=n[t];if(r)return[r];let s=[];for(let e in n){let r=n[e];r.isInGroup(t)&&s.push(r)}return 0==s.length&&e.err("No node type or group '"+t+"' found"),s})(t,t.next).map(e=>(null==t.inline?t.inline=e.isInline:t.inline!=e.isInline&&t.err("Mixing inline and block content"),{type:"name",value:e}));return t.pos++,1==e.length?e[0]:{type:"choice",exprs:e}}}(t);for(;;)if(t.eat("+"))n={type:"plus",expr:n};else if(t.eat("*"))n={type:"star",expr:n};else if(t.eat("?"))n={type:"opt",expr:n};else if(t.eat("{"))n=function(e,t){let n=rt(e),r=n;return e.eat(",")&&(r="}"!=e.next?rt(e):-1),e.eat("}")||e.err("Unclosed braced range"),{type:"range",min:n,max:r,expr:t}}(t,n);else break;return n}(t));while(t.next&&")"!=t.next&&"|"!=t.next);return 1==n.length?n[0]:{type:"seq",exprs:n}}(t));while(t.eat("|"));return 1==n.length?n[0]:{type:"choice",exprs:n}}(s);s.next&&s.err("Unexpected trailing text");let o=(n=function(e){let t=[[]];return s(function e(t,i){if("choice"==t.type)return t.exprs.reduce((t,n)=>t.concat(e(n,i)),[]);if("seq"==t.type)for(let r=0;;r++){let o=e(t.exprs[r],i);if(r==t.exprs.length-1)return o;s(o,i=n())}else if("star"==t.type){let o=n();return r(i,o),s(e(t.expr,o),o),[r(o)]}else if("plus"==t.type){let o=n();return s(e(t.expr,i),o),s(e(t.expr,o),o),[r(o)]}else if("opt"==t.type)return[r(i)].concat(e(t.expr,i));else if("range"==t.type){let o=i;for(let r=0;r<t.min;r++){let r=n();s(e(t.expr,o),r),o=r}if(-1==t.max)s(e(t.expr,o),o);else for(let i=t.min;i<t.max;i++){let i=n();r(o,i),s(e(t.expr,o),i),o=i}return[r(o)]}else if("name"==t.type)return[r(i,void 0,t.value)];else throw Error("Unknown expr type")}(e,0),n()),t;function n(){return t.push([])-1}function r(e,n,r){let s={term:r,to:n};return t[e].push(s),s}function s(e,t){e.forEach(e=>e.to=t)}}(i),r=Object.create(null),function e(t){let s=[];t.forEach(e=>{n[e].forEach(({term:e,to:t})=>{let r;if(e){for(let t=0;t<s.length;t++)s[t][0]==e&&(r=s[t][1]);rr(n,t).forEach(t=>{r||s.push([e,r=[]]),-1==r.indexOf(t)&&r.push(t)})}})});let i=r[t.join(",")]=new n9(t.indexOf(n.length-1)>-1);for(let t=0;t<s.length;t++){let n=s[t][1].sort(rn);i.next.push({type:s[t][0],next:r[n.join(",")]||e(n)})}return i}(rr(n,0)));return function(e,t){for(let n=0,r=[e];n<r.length;n++){let e=r[n],s=!e.validEnd,i=[];for(let t=0;t<e.next.length;t++){let{type:n,next:o}=e.next[t];i.push(n.name),s&&!(n.isText||n.hasRequiredAttrs())&&(s=!1),-1==r.indexOf(o)&&r.push(o)}s&&t.err("Only non-generatable nodes ("+i.join(", ")+") in a required position (see https://prosemirror.net/docs/guide/#generatable)")}}(o,s),o}matchType(e){for(let t=0;t<this.next.length;t++)if(this.next[t].type==e)return this.next[t].next;return null}matchFragment(e,t=0,n=e.childCount){let r=this;for(let s=t;r&&s<n;s++)r=r.matchType(e.child(s).type);return r}get inlineContent(){return 0!=this.next.length&&this.next[0].type.isInline}get defaultType(){for(let e=0;e<this.next.length;e++){let{type:t}=this.next[e];if(!(t.isText||t.hasRequiredAttrs()))return t}return null}compatible(e){for(let t=0;t<this.next.length;t++)for(let n=0;n<e.next.length;n++)if(this.next[t].type==e.next[n].type)return!0;return!1}fillBefore(e,t=!1,n=0){let r=[this];return function s(i,o){let a=i.matchFragment(e,n);if(a&&(!t||a.validEnd))return nV.from(o.map(e=>e.createAndFill()));for(let e=0;e<i.next.length;e++){let{type:t,next:n}=i.next[e];if(!(t.isText||t.hasRequiredAttrs())&&-1==r.indexOf(n)){r.push(n);let e=s(n,o.concat(t));if(e)return e}}return null}(this,[])}findWrapping(e){for(let t=0;t<this.wrapCache.length;t+=2)if(this.wrapCache[t]==e)return this.wrapCache[t+1];let t=this.computeWrapping(e);return this.wrapCache.push(e,t),t}computeWrapping(e){let t=Object.create(null),n=[{match:this,type:null,via:null}];for(;n.length;){let r=n.shift(),s=r.match;if(s.matchType(e)){let e=[];for(let t=r;t.type;t=t.via)e.push(t.type);return e.reverse()}for(let e=0;e<s.next.length;e++){let{type:i,next:o}=s.next[e];i.isLeaf||i.hasRequiredAttrs()||i.name in t||r.type&&!o.validEnd||(n.push({match:i.contentMatch,type:i,via:r}),t[i.name]=!0)}}return null}get edgeCount(){return this.next.length}edge(e){if(e>=this.next.length)throw RangeError(`There's no ${e}th edge in this content match`);return this.next[e]}toString(){let e=[];return!function t(n){e.push(n);for(let r=0;r<n.next.length;r++)-1==e.indexOf(n.next[r].next)&&t(n.next[r].next)}(this),e.map((t,n)=>{let r=n+(t.validEnd?"*":" ")+" ";for(let n=0;n<t.next.length;n++)r+=(n?", ":"")+t.next[n].type.name+"->"+e.indexOf(t.next[n].next);return r}).join("\n")}}n9.empty=new n9(!0);class re{constructor(e,t){this.string=e,this.nodeTypes=t,this.inline=null,this.pos=0,this.tokens=e.split(/\s*(?=\b|\W|$)/),""==this.tokens[this.tokens.length-1]&&this.tokens.pop(),""==this.tokens[0]&&this.tokens.shift()}get next(){return this.tokens[this.pos]}eat(e){return this.next==e&&(this.pos++||!0)}err(e){throw SyntaxError(e+" (in content expression '"+this.string+"')")}}function rt(e){/\D/.test(e.next)&&e.err("Expected number, got '"+e.next+"'");let t=Number(e.next);return e.pos++,t}function rn(e,t){return t-e}function rr(e,t){let n=[];return function t(r){let s=e[r];if(1==s.length&&!s[0].term)return t(s[0].to);n.push(r);for(let e=0;e<s.length;e++){let{term:r,to:i}=s[e];r||-1!=n.indexOf(i)||t(i)}}(t),n.sort(rn)}function rs(e){let t=Object.create(null);for(let n in e){let r=e[n];if(!r.hasDefault)return null;t[n]=r.default}return t}function ri(e,t){let n=Object.create(null);for(let r in e){let s=t&&t[r];if(void 0===s){let t=e[r];if(t.hasDefault)s=t.default;else throw RangeError("No value supplied for attribute "+r)}n[r]=s}return n}function ro(e,t,n,r){for(let r in t)if(!(r in e))throw RangeError(`Unsupported attribute ${r} for ${n} of type ${r}`);for(let n in e){let r=e[n];r.validate&&r.validate(t[n])}}function ra(e,t){let n=Object.create(null);if(t)for(let r in t)n[r]=new rc(e,r,t[r]);return n}class rl{constructor(e,t,n){this.name=e,this.schema=t,this.spec=n,this.markSet=null,this.groups=n.group?n.group.split(" "):[],this.attrs=ra(e,n.attrs),this.defaultAttrs=rs(this.attrs),this.contentMatch=null,this.inlineContent=null,this.isBlock=!(n.inline||"text"==e),this.isText="text"==e}get isInline(){return!this.isBlock}get isTextblock(){return this.isBlock&&this.inlineContent}get isLeaf(){return this.contentMatch==n9.empty}get isAtom(){return this.isLeaf||!!this.spec.atom}isInGroup(e){return this.groups.indexOf(e)>-1}get whitespace(){return this.spec.whitespace||(this.spec.code?"pre":"normal")}hasRequiredAttrs(){for(let e in this.attrs)if(this.attrs[e].isRequired)return!0;return!1}compatibleContent(e){return this==e||this.contentMatch.compatible(e.contentMatch)}computeAttrs(e){return!e&&this.defaultAttrs?this.defaultAttrs:ri(this.attrs,e)}create(e=null,t,n){if(this.isText)throw Error("NodeType.create can't construct text nodes");return new n6(this,this.computeAttrs(e),nV.from(t),nW.setFrom(n))}createChecked(e=null,t,n){return t=nV.from(t),this.checkContent(t),new n6(this,this.computeAttrs(e),t,nW.setFrom(n))}createAndFill(e=null,t,n){if(e=this.computeAttrs(e),(t=nV.from(t)).size){let e=this.contentMatch.fillBefore(t);if(!e)return null;t=e.append(t)}let r=this.contentMatch.matchFragment(t),s=r&&r.fillBefore(nV.empty,!0);return s?new n6(this,e,t.append(s),nW.setFrom(n)):null}validContent(e){let t=this.contentMatch.matchFragment(e);if(!t||!t.validEnd)return!1;for(let t=0;t<e.childCount;t++)if(!this.allowsMarks(e.child(t).marks))return!1;return!0}checkContent(e){if(!this.validContent(e))throw RangeError(`Invalid content for node ${this.name}: ${e.toString().slice(0,50)}`)}checkAttrs(e){ro(this.attrs,e,"node",this.name)}allowsMarkType(e){return null==this.markSet||this.markSet.indexOf(e)>-1}allowsMarks(e){if(null==this.markSet)return!0;for(let t=0;t<e.length;t++)if(!this.allowsMarkType(e[t].type))return!1;return!0}allowedMarks(e){let t;if(null==this.markSet)return e;for(let n=0;n<e.length;n++)this.allowsMarkType(e[n].type)?t&&t.push(e[n]):t||(t=e.slice(0,n));return t?t.length?t:nW.none:e}static compile(e,t){let n=Object.create(null);e.forEach((e,r)=>n[e]=new rl(e,t,r));let r=t.spec.topNode||"doc";if(!n[r])throw RangeError("Schema is missing its top node type ('"+r+"')");if(!n.text)throw RangeError("Every schema needs a 'text' type");for(let e in n.text.attrs)throw RangeError("The text node type should not have attributes");return n}}class rc{constructor(e,t,n){this.hasDefault=Object.prototype.hasOwnProperty.call(n,"default"),this.default=n.default,this.validate="string"==typeof n.validate?function(e,t,n){let r=n.split("|");return n=>{let s=null===n?"null":typeof n;if(0>r.indexOf(s))throw RangeError(`Expected value of type ${r} for attribute ${t} on type ${e}, got ${s}`)}}(e,t,n.validate):n.validate}get isRequired(){return!this.hasDefault}}class rd{constructor(e,t,n,r){this.name=e,this.rank=t,this.schema=n,this.spec=r,this.attrs=ra(e,r.attrs),this.excluded=null;let s=rs(this.attrs);this.instance=s?new nW(this,s):null}create(e=null){return!e&&this.instance?this.instance:new nW(this,ri(this.attrs,e))}static compile(e,t){let n=Object.create(null),r=0;return e.forEach((e,s)=>n[e]=new rd(e,r++,t,s)),n}removeFromSet(e){for(var t=0;t<e.length;t++)e[t].type==this&&(e=e.slice(0,t).concat(e.slice(t+1)),t--);return e}isInSet(e){for(let t=0;t<e.length;t++)if(e[t].type==this)return e[t]}checkAttrs(e){ro(this.attrs,e,"mark",this.name)}excludes(e){return this.excluded.indexOf(e)>-1}}class rh{constructor(e){this.linebreakReplacement=null,this.cached=Object.create(null);let t=this.spec={};for(let n in e)t[n]=e[n];t.nodes=nF.from(e.nodes),t.marks=nF.from(e.marks||{}),this.nodes=rl.compile(this.spec.nodes,this),this.marks=rd.compile(this.spec.marks,this);let n=Object.create(null);for(let e in this.nodes){if(e in this.marks)throw RangeError(e+" can not be both a node and a mark");let t=this.nodes[e],r=t.spec.content||"",s=t.spec.marks;if(t.contentMatch=n[r]||(n[r]=n9.parse(r,this.nodes)),t.inlineContent=t.contentMatch.inlineContent,t.spec.linebreakReplacement){if(this.linebreakReplacement)throw RangeError("Multiple linebreak nodes defined");if(!t.isInline||!t.isLeaf)throw RangeError("Linebreak replacement nodes must be inline leaf nodes");this.linebreakReplacement=t}t.markSet="_"==s?null:s?ru(this,s.split(" ")):""!=s&&t.inlineContent?null:[]}for(let e in this.marks){let t=this.marks[e],n=t.spec.excludes;t.excluded=null==n?[t]:""==n?[]:ru(this,n.split(" "))}this.nodeFromJSON=this.nodeFromJSON.bind(this),this.markFromJSON=this.markFromJSON.bind(this),this.topNodeType=this.nodes[this.spec.topNode||"doc"],this.cached.wrappings=Object.create(null)}node(e,t=null,n,r){if("string"==typeof e)e=this.nodeType(e);else if(e instanceof rl){if(e.schema!=this)throw RangeError("Node type from different schema used ("+e.name+")")}else throw RangeError("Invalid node type: "+e);return e.createChecked(t,n,r)}text(e,t){let n=this.nodes.text;return new n8(n,n.defaultAttrs,e,nW.setFrom(t))}mark(e,t){return"string"==typeof e&&(e=this.marks[e]),e.create(t)}nodeFromJSON(e){return n6.fromJSON(this,e)}markFromJSON(e){return nW.fromJSON(this,e)}nodeType(e){let t=this.nodes[e];if(!t)throw RangeError("Unknown node type: "+e);return t}}function ru(e,t){let n=[];for(let r=0;r<t.length;r++){let s=t[r],i=e.marks[s],o=i;if(i)n.push(i);else for(let t in e.marks){let r=e.marks[t];("_"==s||r.spec.group&&r.spec.group.split(" ").indexOf(s)>-1)&&n.push(o=r)}if(!o)throw SyntaxError("Unknown mark type: '"+t[r]+"'")}return n}class rp{constructor(e,t){this.schema=e,this.rules=t,this.tags=[],this.styles=[];let n=this.matchedStyles=[];t.forEach(e=>{if(null!=e.tag)this.tags.push(e);else if(null!=e.style){let t=/[^=]*/.exec(e.style)[0];0>n.indexOf(t)&&n.push(t),this.styles.push(e)}}),this.normalizeLists=!this.tags.some(t=>{if(!/^(ul|ol)\b/.test(t.tag)||!t.node)return!1;let n=e.nodes[t.node];return n.contentMatch.matchType(n)})}parse(e,t={}){let n=new rv(this,t,!1);return n.addAll(e,nW.none,t.from,t.to),n.finish()}parseSlice(e,t={}){let n=new rv(this,t,!0);return n.addAll(e,nW.none,t.from,t.to),nJ.maxOpen(n.finish())}matchTag(e,t,n){for(let i=n?this.tags.indexOf(n)+1:0;i<this.tags.length;i++){var r,s;let n=this.tags[i];if(r=e,s=n.tag,(r.matches||r.msMatchesSelector||r.webkitMatchesSelector||r.mozMatchesSelector).call(r,s)&&(void 0===n.namespace||e.namespaceURI==n.namespace)&&(!n.context||t.matchesContext(n.context))){if(n.getAttrs){let t=n.getAttrs(e);if(!1===t)continue;n.attrs=t||void 0}return n}}}matchStyle(e,t,n,r){for(let s=r?this.styles.indexOf(r)+1:0;s<this.styles.length;s++){let r=this.styles[s],i=r.style;if(0==i.indexOf(e)&&(!r.context||n.matchesContext(r.context))&&(!(i.length>e.length)||61==i.charCodeAt(e.length)&&i.slice(e.length+1)==t)){if(r.getAttrs){let e=r.getAttrs(t);if(!1===e)continue;r.attrs=e||void 0}return r}}}static schemaRules(e){let t=[];function n(e){let n=null==e.priority?50:e.priority,r=0;for(;r<t.length;r++){let e=t[r];if((null==e.priority?50:e.priority)<n)break}t.splice(r,0,e)}for(let t in e.marks){let r=e.marks[t].spec.parseDOM;r&&r.forEach(e=>{n(e=rb(e)),e.mark||e.ignore||e.clearMark||(e.mark=t)})}for(let t in e.nodes){let r=e.nodes[t].spec.parseDOM;r&&r.forEach(e=>{n(e=rb(e)),e.node||e.ignore||e.mark||(e.node=t)})}return t}static fromSchema(e){return e.cached.domParser||(e.cached.domParser=new rp(e,rp.schemaRules(e)))}}let rf={address:!0,article:!0,aside:!0,blockquote:!0,canvas:!0,dd:!0,div:!0,dl:!0,fieldset:!0,figcaption:!0,figure:!0,footer:!0,form:!0,h1:!0,h2:!0,h3:!0,h4:!0,h5:!0,h6:!0,header:!0,hgroup:!0,hr:!0,li:!0,noscript:!0,ol:!0,output:!0,p:!0,pre:!0,section:!0,table:!0,tfoot:!0,ul:!0},rm={head:!0,noscript:!0,object:!0,script:!0,style:!0,title:!0},rg={ol:!0,ul:!0};function rx(e,t,n){return null!=t?!!t|2*("full"===t):e&&"pre"==e.whitespace?3:-5&n}class ry{constructor(e,t,n,r,s,i){this.type=e,this.attrs=t,this.marks=n,this.solid=r,this.options=i,this.content=[],this.activeMarks=nW.none,this.match=s||(4&i?null:e.contentMatch)}findWrapping(e){if(!this.match){if(!this.type)return[];let t=this.type.contentMatch.fillBefore(nV.from(e));if(t)this.match=this.type.contentMatch.matchFragment(t);else{let t=this.type.contentMatch,n;return(n=t.findWrapping(e.type))?(this.match=t,n):null}}return this.match.findWrapping(e.type)}finish(e){if(!(1&this.options)){let e=this.content[this.content.length-1],t;e&&e.isText&&(t=/[ \t\r\n\u000c]+$/.exec(e.text))&&(e.text.length==t[0].length?this.content.pop():this.content[this.content.length-1]=e.withText(e.text.slice(0,e.text.length-t[0].length)))}let t=nV.from(this.content);return!e&&this.match&&(t=t.append(this.match.fillBefore(nV.empty,!0))),this.type?this.type.create(this.attrs,t,this.marks):t}inlineContext(e){return this.type?this.type.inlineContent:this.content.length?this.content[0].isInline:e.parentNode&&!rf.hasOwnProperty(e.parentNode.nodeName.toLowerCase())}}class rv{constructor(e,t,n){this.parser=e,this.options=t,this.isOpen=n,this.open=0,this.localPreserveWS=!1;let r=t.topNode,s,i=rx(null,t.preserveWhitespace,0)|4*!!n;s=r?new ry(r.type,r.attrs,nW.none,!0,t.topMatch||r.type.contentMatch,i):n?new ry(null,null,nW.none,!0,null,i):new ry(e.schema.topNodeType,null,nW.none,!0,null,i),this.nodes=[s],this.find=t.findPositions,this.needsBlock=!1}get top(){return this.nodes[this.open]}addDOM(e,t){3==e.nodeType?this.addTextNode(e,t):1==e.nodeType&&this.addElement(e,t)}addTextNode(e,t){let n=e.nodeValue,r=this.top,s=2&r.options?"full":this.localPreserveWS||(1&r.options)>0;if("full"===s||r.inlineContext(e)||/[^ \t\r\n\u000c]/.test(n)){if(s)n="full"!==s?n.replace(/\r?\n|\r/g," "):n.replace(/\r\n?/g,"\n");else if(n=n.replace(/[ \t\r\n\u000c]+/g," "),/^[ \t\r\n\u000c]/.test(n)&&this.open==this.nodes.length-1){let t=r.content[r.content.length-1],s=e.previousSibling;(!t||s&&"BR"==s.nodeName||t.isText&&/[ \t\r\n\u000c]$/.test(t.text))&&(n=n.slice(1))}n&&this.insertNode(this.parser.schema.text(n),t,!/\S/.test(n)),this.findInText(e)}else this.findInside(e)}addElement(e,t,n){let r=this.localPreserveWS,s=this.top;("PRE"==e.tagName||/pre/.test(e.style&&e.style.whiteSpace))&&(this.localPreserveWS=!0);let i=e.nodeName.toLowerCase(),o;rg.hasOwnProperty(i)&&this.parser.normalizeLists&&function(e){for(let t=e.firstChild,n=null;t;t=t.nextSibling){let e=1==t.nodeType?t.nodeName.toLowerCase():null;e&&rg.hasOwnProperty(e)&&n?(n.appendChild(t),t=n):"li"==e?n=t:e&&(n=null)}}(e);let a=this.options.ruleFromNode&&this.options.ruleFromNode(e)||(o=this.parser.matchTag(e,this,n));e:if(a?a.ignore:rm.hasOwnProperty(i))this.findInside(e),this.ignoreFallback(e,t);else if(!a||a.skip||a.closeParent){a&&a.closeParent?this.open=Math.max(0,this.open-1):a&&a.skip.nodeType&&(e=a.skip);let n,r=this.needsBlock;if(rf.hasOwnProperty(i))s.content.length&&s.content[0].isInline&&this.open&&(this.open--,s=this.top),n=!0,s.type||(this.needsBlock=!0);else if(!e.firstChild){this.leafFallback(e,t);break e}let o=a&&a.skip?t:this.readStyles(e,t);o&&this.addAll(e,o),n&&this.sync(s),this.needsBlock=r}else{let n=this.readStyles(e,t);n&&this.addElementByRule(e,a,n,!1===a.consuming?o:void 0)}this.localPreserveWS=r}leafFallback(e,t){"BR"==e.nodeName&&this.top.type&&this.top.type.inlineContent&&this.addTextNode(e.ownerDocument.createTextNode("\n"),t)}ignoreFallback(e,t){"BR"!=e.nodeName||this.top.type&&this.top.type.inlineContent||this.findPlace(this.parser.schema.text("-"),t,!0)}readStyles(e,t){let n=e.style;if(n&&n.length)for(let e=0;e<this.parser.matchedStyles.length;e++){let r=this.parser.matchedStyles[e],s=n.getPropertyValue(r);if(s)for(let e;;){let n=this.parser.matchStyle(r,s,this,e);if(!n)break;if(n.ignore)return null;if(t=n.clearMark?t.filter(e=>!n.clearMark(e)):t.concat(this.parser.schema.marks[n.mark].create(n.attrs)),!1===n.consuming)e=n;else break}}return t}addElementByRule(e,t,n,r){let s,i;if(t.node)if((i=this.parser.schema.nodes[t.node]).isLeaf)this.insertNode(i.create(t.attrs),n,"BR"==e.nodeName)||this.leafFallback(e,n);else{let e=this.enter(i,t.attrs||null,n,t.preserveWhitespace);e&&(s=!0,n=e)}else{let e=this.parser.schema.marks[t.mark];n=n.concat(e.create(t.attrs))}let o=this.top;if(i&&i.isLeaf)this.findInside(e);else if(r)this.addElement(e,n,r);else if(t.getContent)this.findInside(e),t.getContent(e,this.parser.schema).forEach(e=>this.insertNode(e,n,!1));else{let r=e;"string"==typeof t.contentElement?r=e.querySelector(t.contentElement):"function"==typeof t.contentElement?r=t.contentElement(e):t.contentElement&&(r=t.contentElement),this.findAround(e,r,!0),this.addAll(r,n),this.findAround(e,r,!1)}s&&this.sync(o)&&this.open--}addAll(e,t,n,r){let s=n||0;for(let i=n?e.childNodes[n]:e.firstChild,o=null==r?null:e.childNodes[r];i!=o;i=i.nextSibling,++s)this.findAtPoint(e,s),this.addDOM(i,t);this.findAtPoint(e,s)}findPlace(e,t,n){let r,s;for(let t=this.open,i=0;t>=0;t--){let o=this.nodes[t],a=o.findWrapping(e);if(a&&(!r||r.length>a.length+i)&&(r=a,s=o,!a.length))break;if(o.solid){if(n)break;i+=2}}if(!r)return null;this.sync(s);for(let e=0;e<r.length;e++)t=this.enterInner(r[e],null,t,!1);return t}insertNode(e,t,n){if(e.isInline&&this.needsBlock&&!this.top.type){let e=this.textblockFromContext();e&&(t=this.enterInner(e,null,t))}let r=this.findPlace(e,t,n);if(r){this.closeExtra();let t=this.top;t.match&&(t.match=t.match.matchType(e.type));let n=nW.none;for(let s of r.concat(e.marks))(t.type?t.type.allowsMarkType(s.type):rw(s.type,e.type))&&(n=s.addToSet(n));return t.content.push(e.mark(n)),!0}return!1}enter(e,t,n,r){let s=this.findPlace(e.create(t),n,!1);return s&&(s=this.enterInner(e,t,n,!0,r)),s}enterInner(e,t,n,r=!1,s){this.closeExtra();let i=this.top;i.match=i.match&&i.match.matchType(e);let o=rx(e,s,i.options);4&i.options&&0==i.content.length&&(o|=4);let a=nW.none;return n=n.filter(t=>(i.type?!i.type.allowsMarkType(t.type):!rw(t.type,e))||(a=t.addToSet(a),!1)),this.nodes.push(new ry(e,t,a,r,null,o)),this.open++,n}closeExtra(e=!1){let t=this.nodes.length-1;if(t>this.open){for(;t>this.open;t--)this.nodes[t-1].content.push(this.nodes[t].finish(e));this.nodes.length=this.open+1}}finish(){return this.open=0,this.closeExtra(this.isOpen),this.nodes[0].finish(!!(this.isOpen||this.options.topOpen))}sync(e){for(let t=this.open;t>=0;t--)if(this.nodes[t]==e)return this.open=t,!0;else this.localPreserveWS&&(this.nodes[t].options|=1);return!1}get currentPos(){this.closeExtra();let e=0;for(let t=this.open;t>=0;t--){let n=this.nodes[t].content;for(let t=n.length-1;t>=0;t--)e+=n[t].nodeSize;t&&e++}return e}findAtPoint(e,t){if(this.find)for(let n=0;n<this.find.length;n++)this.find[n].node==e&&this.find[n].offset==t&&(this.find[n].pos=this.currentPos)}findInside(e){if(this.find)for(let t=0;t<this.find.length;t++)null==this.find[t].pos&&1==e.nodeType&&e.contains(this.find[t].node)&&(this.find[t].pos=this.currentPos)}findAround(e,t,n){if(e!=t&&this.find)for(let r=0;r<this.find.length;r++)null==this.find[r].pos&&1==e.nodeType&&e.contains(this.find[r].node)&&t.compareDocumentPosition(this.find[r].node)&(n?2:4)&&(this.find[r].pos=this.currentPos)}findInText(e){if(this.find)for(let t=0;t<this.find.length;t++)this.find[t].node==e&&(this.find[t].pos=this.currentPos-(e.nodeValue.length-this.find[t].offset))}matchesContext(e){if(e.indexOf("|")>-1)return e.split(/\s*\|\s*/).some(this.matchesContext,this);let t=e.split("/"),n=this.options.context,r=!this.isOpen&&(!n||n.parent.type==this.nodes[0].type),s=-(n?n.depth+1:0)+ +!r,i=(e,o)=>{for(;e>=0;e--){let a=t[e];if(""==a){if(e==t.length-1||0==e)continue;for(;o>=s;o--)if(i(e-1,o))return!0;return!1}{let e=o>0||0==o&&r?this.nodes[o].type:n&&o>=s?n.node(o-s).type:null;if(!e||e.name!=a&&!e.isInGroup(a))return!1;o--}}return!0};return i(t.length-1,this.open)}textblockFromContext(){let e=this.options.context;if(e)for(let t=e.depth;t>=0;t--){let n=e.node(t).contentMatchAt(e.indexAfter(t)).defaultType;if(n&&n.isTextblock&&n.defaultAttrs)return n}for(let e in this.parser.schema.nodes){let t=this.parser.schema.nodes[e];if(t.isTextblock&&t.defaultAttrs)return t}}}function rb(e){let t={};for(let n in e)t[n]=e[n];return t}function rw(e,t){let n=t.schema.nodes;for(let r in n){let s=n[r];if(!s.allowsMarkType(e))continue;let i=[],o=e=>{i.push(e);for(let n=0;n<e.edgeCount;n++){let{type:r,next:s}=e.edge(n);if(r==t||0>i.indexOf(s)&&o(s))return!0}};if(o(s.contentMatch))return!0}}class rk{constructor(e,t){this.nodes=e,this.marks=t}serializeFragment(e,t={},n){n||(n=rj(t).createDocumentFragment());let r=n,s=[];return e.forEach(e=>{if(s.length||e.marks.length){let n=0,i=0;for(;n<s.length&&i<e.marks.length;){let t=e.marks[i];if(!this.marks[t.type.name]){i++;continue}if(!t.eq(s[n][0])||!1===t.type.spec.spanning)break;n++,i++}for(;n<s.length;)r=s.pop()[1];for(;i<e.marks.length;){let n=e.marks[i++],o=this.serializeMark(n,e.isInline,t);o&&(s.push([n,r]),r.appendChild(o.dom),r=o.contentDOM||o.dom)}}r.appendChild(this.serializeNodeInner(e,t))}),n}serializeNodeInner(e,t){let{dom:n,contentDOM:r}=rC(rj(t),this.nodes[e.type.name](e),null,e.attrs);if(r){if(e.isLeaf)throw RangeError("Content hole not allowed in a leaf node spec");this.serializeFragment(e.content,t,r)}return n}serializeNode(e,t={}){let n=this.serializeNodeInner(e,t);for(let r=e.marks.length-1;r>=0;r--){let s=this.serializeMark(e.marks[r],e.isInline,t);s&&((s.contentDOM||s.dom).appendChild(n),n=s.dom)}return n}serializeMark(e,t,n={}){let r=this.marks[e.type.name];return r&&rC(rj(n),r(e,t),null,e.attrs)}static renderSpec(e,t,n=null,r){return rC(e,t,n,r)}static fromSchema(e){return e.cached.domSerializer||(e.cached.domSerializer=new rk(this.nodesFromSchema(e),this.marksFromSchema(e)))}static nodesFromSchema(e){let t=rN(e.nodes);return t.text||(t.text=e=>e.text),t}static marksFromSchema(e){return rN(e.marks)}}function rN(e){let t={};for(let n in e){let r=e[n].spec.toDOM;r&&(t[n]=r)}return t}function rj(e){return e.document||window.document}let rS=new WeakMap;function rC(e,t,n,r){let s,i,o;if("string"==typeof t)return{dom:e.createTextNode(t)};if(null!=t.nodeType)return{dom:t};if(t.dom&&null!=t.dom.nodeType)return t;let a=t[0],l;if("string"!=typeof a)throw RangeError("Invalid array passed to renderSpec");if(r&&(void 0===(i=rS.get(r))&&rS.set(r,(o=null,!function e(t){if(t&&"object"==typeof t)if(Array.isArray(t))if("string"==typeof t[0])o||(o=[]),o.push(t);else for(let n=0;n<t.length;n++)e(t[n]);else for(let n in t)e(t[n])}(r),i=o)),l=i)&&l.indexOf(t)>-1)throw RangeError("Using an array from an attribute object as a DOM spec. This may be an attempted cross site scripting attack.");let c=a.indexOf(" ");c>0&&(n=a.slice(0,c),a=a.slice(c+1));let d=n?e.createElementNS(n,a):e.createElement(a),h=t[1],u=1;if(h&&"object"==typeof h&&null==h.nodeType&&!Array.isArray(h)){for(let e in u=2,h)if(null!=h[e]){let t=e.indexOf(" ");t>0?d.setAttributeNS(e.slice(0,t),e.slice(t+1),h[e]):d.setAttribute(e,h[e])}}for(let i=u;i<t.length;i++){let o=t[i];if(0===o){if(i<t.length-1||i>u)throw RangeError("Content hole must be the only child of its parent node");return{dom:d,contentDOM:d}}{let{dom:t,contentDOM:i}=rC(e,o,n,r);if(d.appendChild(t),i){if(s)throw RangeError("Multiple content holes");s=i}}}return{dom:d,contentDOM:s}}class rM{constructor(e,t,n){this.pos=e,this.delInfo=t,this.recover=n}get deleted(){return(8&this.delInfo)>0}get deletedBefore(){return(5&this.delInfo)>0}get deletedAfter(){return(6&this.delInfo)>0}get deletedAcross(){return(4&this.delInfo)>0}}class rA{constructor(e,t=!1){if(this.ranges=e,this.inverted=t,!e.length&&rA.empty)return rA.empty}recover(e){let t=0,n=65535&e;if(!this.inverted)for(let e=0;e<n;e++)t+=this.ranges[3*e+2]-this.ranges[3*e+1];return this.ranges[3*n]+t+(e-(65535&e))/65536}mapResult(e,t=1){return this._map(e,t,!1)}map(e,t=1){return this._map(e,t,!0)}_map(e,t,n){let r=0,s=this.inverted?2:1,i=this.inverted?1:2;for(let o=0;o<this.ranges.length;o+=3){let a=this.ranges[o]-(this.inverted?r:0);if(a>e)break;let l=this.ranges[o+s],c=this.ranges[o+i],d=a+l;if(e<=d){let s=l?e==a?-1:e==d?1:t:t,i=a+r+(s<0?0:c);if(n)return i;let h=e==(t<0?a:d)?null:o/3+(e-a)*65536,u=e==a?2:e==d?1:4;return(t<0?e!=a:e!=d)&&(u|=8),new rM(i,u,h)}r+=c-l}return n?e+r:new rM(e+r,0,null)}touches(e,t){let n=0,r=65535&t,s=this.inverted?2:1,i=this.inverted?1:2;for(let t=0;t<this.ranges.length;t+=3){let o=this.ranges[t]-(this.inverted?n:0);if(o>e)break;let a=this.ranges[t+s];if(e<=o+a&&t==3*r)return!0;n+=this.ranges[t+i]-a}return!1}forEach(e){let t=this.inverted?2:1,n=this.inverted?1:2;for(let r=0,s=0;r<this.ranges.length;r+=3){let i=this.ranges[r],o=i-(this.inverted?s:0),a=i+(this.inverted?0:s),l=this.ranges[r+t],c=this.ranges[r+n];e(o,o+l,a,a+c),s+=c-l}}invert(){return new rA(this.ranges,!this.inverted)}toString(){return(this.inverted?"-":"")+JSON.stringify(this.ranges)}static offset(e){return 0==e?rA.empty:new rA(e<0?[0,-e,0]:[0,0,e])}}rA.empty=new rA([]);class rE{constructor(e,t,n=0,r=e?e.length:0){this.mirror=t,this.from=n,this.to=r,this._maps=e||[],this.ownData=!(e||t)}get maps(){return this._maps}slice(e=0,t=this.maps.length){return new rE(this._maps,this.mirror,e,t)}appendMap(e,t){this.ownData||(this._maps=this._maps.slice(),this.mirror=this.mirror&&this.mirror.slice(),this.ownData=!0),this.to=this._maps.push(e),null!=t&&this.setMirror(this._maps.length-1,t)}appendMapping(e){for(let t=0,n=this._maps.length;t<e._maps.length;t++){let r=e.getMirror(t);this.appendMap(e._maps[t],null!=r&&r<t?n+r:void 0)}}getMirror(e){if(this.mirror){for(let t=0;t<this.mirror.length;t++)if(this.mirror[t]==e)return this.mirror[t+(t%2?-1:1)]}}setMirror(e,t){this.mirror||(this.mirror=[]),this.mirror.push(e,t)}appendMappingInverted(e){for(let t=e.maps.length-1,n=this._maps.length+e._maps.length;t>=0;t--){let r=e.getMirror(t);this.appendMap(e._maps[t].invert(),null!=r&&r>t?n-r-1:void 0)}}invert(){let e=new rE;return e.appendMappingInverted(this),e}map(e,t=1){if(this.mirror)return this._map(e,t,!0);for(let n=this.from;n<this.to;n++)e=this._maps[n].map(e,t);return e}mapResult(e,t=1){return this._map(e,t,!1)}_map(e,t,n){let r=0;for(let n=this.from;n<this.to;n++){let s=this._maps[n].mapResult(e,t);if(null!=s.recover){let t=this.getMirror(n);if(null!=t&&t>n&&t<this.to){n=t,e=this._maps[t].recover(s.recover);continue}}r|=s.delInfo,e=s.pos}return n?e:new rM(e,r,null)}}let rT=Object.create(null);class rD{getMap(){return rA.empty}merge(e){return null}static fromJSON(e,t){if(!t||!t.stepType)throw RangeError("Invalid input for Step.fromJSON");let n=rT[t.stepType];if(!n)throw RangeError(`No step type ${t.stepType} defined`);return n.fromJSON(e,t)}static jsonID(e,t){if(e in rT)throw RangeError("Duplicate use of step JSON ID "+e);return rT[e]=t,t.prototype.jsonID=e,t}}class rO{constructor(e,t){this.doc=e,this.failed=t}static ok(e){return new rO(e,null)}static fail(e){return new rO(null,e)}static fromReplace(e,t,n,r){try{return rO.ok(e.replace(t,n,r))}catch(e){if(e instanceof nU)return rO.fail(e.message);throw e}}}function rI(e,t,n){let r=[];for(let s=0;s<e.childCount;s++){let i=e.child(s);i.content.size&&(i=i.copy(rI(i.content,t,i))),i.isInline&&(i=t(i,n,s)),r.push(i)}return nV.fromArray(r)}class rR extends rD{constructor(e,t,n){super(),this.from=e,this.to=t,this.mark=n}apply(e){let t=e.slice(this.from,this.to),n=e.resolve(this.from),r=n.node(n.sharedDepth(this.to)),s=new nJ(rI(t.content,(e,t)=>e.isAtom&&t.type.allowsMarkType(this.mark.type)?e.mark(this.mark.addToSet(e.marks)):e,r),t.openStart,t.openEnd);return rO.fromReplace(e,this.from,this.to,s)}invert(){return new rP(this.from,this.to,this.mark)}map(e){let t=e.mapResult(this.from,1),n=e.mapResult(this.to,-1);return t.deleted&&n.deleted||t.pos>=n.pos?null:new rR(t.pos,n.pos,this.mark)}merge(e){return e instanceof rR&&e.mark.eq(this.mark)&&this.from<=e.to&&this.to>=e.from?new rR(Math.min(this.from,e.from),Math.max(this.to,e.to),this.mark):null}toJSON(){return{stepType:"addMark",mark:this.mark.toJSON(),from:this.from,to:this.to}}static fromJSON(e,t){if("number"!=typeof t.from||"number"!=typeof t.to)throw RangeError("Invalid input for AddMarkStep.fromJSON");return new rR(t.from,t.to,e.markFromJSON(t.mark))}}rD.jsonID("addMark",rR);class rP extends rD{constructor(e,t,n){super(),this.from=e,this.to=t,this.mark=n}apply(e){let t=e.slice(this.from,this.to),n=new nJ(rI(t.content,e=>e.mark(this.mark.removeFromSet(e.marks)),e),t.openStart,t.openEnd);return rO.fromReplace(e,this.from,this.to,n)}invert(){return new rR(this.from,this.to,this.mark)}map(e){let t=e.mapResult(this.from,1),n=e.mapResult(this.to,-1);return t.deleted&&n.deleted||t.pos>=n.pos?null:new rP(t.pos,n.pos,this.mark)}merge(e){return e instanceof rP&&e.mark.eq(this.mark)&&this.from<=e.to&&this.to>=e.from?new rP(Math.min(this.from,e.from),Math.max(this.to,e.to),this.mark):null}toJSON(){return{stepType:"removeMark",mark:this.mark.toJSON(),from:this.from,to:this.to}}static fromJSON(e,t){if("number"!=typeof t.from||"number"!=typeof t.to)throw RangeError("Invalid input for RemoveMarkStep.fromJSON");return new rP(t.from,t.to,e.markFromJSON(t.mark))}}rD.jsonID("removeMark",rP);class rz extends rD{constructor(e,t){super(),this.pos=e,this.mark=t}apply(e){let t=e.nodeAt(this.pos);if(!t)return rO.fail("No node at mark step's position");let n=t.type.create(t.attrs,null,this.mark.addToSet(t.marks));return rO.fromReplace(e,this.pos,this.pos+1,new nJ(nV.from(n),0,+!t.isLeaf))}invert(e){let t=e.nodeAt(this.pos);if(t){let e=this.mark.addToSet(t.marks);if(e.length==t.marks.length){for(let n=0;n<t.marks.length;n++)if(!t.marks[n].isInSet(e))return new rz(this.pos,t.marks[n]);return new rz(this.pos,this.mark)}}return new r$(this.pos,this.mark)}map(e){let t=e.mapResult(this.pos,1);return t.deletedAfter?null:new rz(t.pos,this.mark)}toJSON(){return{stepType:"addNodeMark",pos:this.pos,mark:this.mark.toJSON()}}static fromJSON(e,t){if("number"!=typeof t.pos)throw RangeError("Invalid input for AddNodeMarkStep.fromJSON");return new rz(t.pos,e.markFromJSON(t.mark))}}rD.jsonID("addNodeMark",rz);class r$ extends rD{constructor(e,t){super(),this.pos=e,this.mark=t}apply(e){let t=e.nodeAt(this.pos);if(!t)return rO.fail("No node at mark step's position");let n=t.type.create(t.attrs,null,this.mark.removeFromSet(t.marks));return rO.fromReplace(e,this.pos,this.pos+1,new nJ(nV.from(n),0,+!t.isLeaf))}invert(e){let t=e.nodeAt(this.pos);return t&&this.mark.isInSet(t.marks)?new rz(this.pos,this.mark):this}map(e){let t=e.mapResult(this.pos,1);return t.deletedAfter?null:new r$(t.pos,this.mark)}toJSON(){return{stepType:"removeNodeMark",pos:this.pos,mark:this.mark.toJSON()}}static fromJSON(e,t){if("number"!=typeof t.pos)throw RangeError("Invalid input for RemoveNodeMarkStep.fromJSON");return new r$(t.pos,e.markFromJSON(t.mark))}}rD.jsonID("removeNodeMark",r$);class rL extends rD{constructor(e,t,n,r=!1){super(),this.from=e,this.to=t,this.slice=n,this.structure=r}apply(e){return this.structure&&rF(e,this.from,this.to)?rO.fail("Structure replace would overwrite content"):rO.fromReplace(e,this.from,this.to,this.slice)}getMap(){return new rA([this.from,this.to-this.from,this.slice.size])}invert(e){return new rL(this.from,this.from+this.slice.size,e.slice(this.from,this.to))}map(e){let t=e.mapResult(this.from,1),n=e.mapResult(this.to,-1);return t.deletedAcross&&n.deletedAcross?null:new rL(t.pos,Math.max(t.pos,n.pos),this.slice,this.structure)}merge(e){if(!(e instanceof rL)||e.structure||this.structure)return null;if(this.from+this.slice.size!=e.from||this.slice.openEnd||e.slice.openStart)if(e.to!=this.from||this.slice.openStart||e.slice.openEnd)return null;else{let t=this.slice.size+e.slice.size==0?nJ.empty:new nJ(e.slice.content.append(this.slice.content),e.slice.openStart,this.slice.openEnd);return new rL(e.from,this.to,t,this.structure)}{let t=this.slice.size+e.slice.size==0?nJ.empty:new nJ(this.slice.content.append(e.slice.content),this.slice.openStart,e.slice.openEnd);return new rL(this.from,this.to+(e.to-e.from),t,this.structure)}}toJSON(){let e={stepType:"replace",from:this.from,to:this.to};return this.slice.size&&(e.slice=this.slice.toJSON()),this.structure&&(e.structure=!0),e}static fromJSON(e,t){if("number"!=typeof t.from||"number"!=typeof t.to)throw RangeError("Invalid input for ReplaceStep.fromJSON");return new rL(t.from,t.to,nJ.fromJSON(e,t.slice),!!t.structure)}}rD.jsonID("replace",rL);class rB extends rD{constructor(e,t,n,r,s,i,o=!1){super(),this.from=e,this.to=t,this.gapFrom=n,this.gapTo=r,this.slice=s,this.insert=i,this.structure=o}apply(e){if(this.structure&&(rF(e,this.from,this.gapFrom)||rF(e,this.gapTo,this.to)))return rO.fail("Structure gap-replace would overwrite content");let t=e.slice(this.gapFrom,this.gapTo);if(t.openStart||t.openEnd)return rO.fail("Gap is not a flat range");let n=this.slice.insertAt(this.insert,t.content);return n?rO.fromReplace(e,this.from,this.to,n):rO.fail("Content does not fit in gap")}getMap(){return new rA([this.from,this.gapFrom-this.from,this.insert,this.gapTo,this.to-this.gapTo,this.slice.size-this.insert])}invert(e){let t=this.gapTo-this.gapFrom;return new rB(this.from,this.from+this.slice.size+t,this.from+this.insert,this.from+this.insert+t,e.slice(this.from,this.to).removeBetween(this.gapFrom-this.from,this.gapTo-this.from),this.gapFrom-this.from,this.structure)}map(e){let t=e.mapResult(this.from,1),n=e.mapResult(this.to,-1),r=this.from==this.gapFrom?t.pos:e.map(this.gapFrom,-1),s=this.to==this.gapTo?n.pos:e.map(this.gapTo,1);return t.deletedAcross&&n.deletedAcross||r<t.pos||s>n.pos?null:new rB(t.pos,n.pos,r,s,this.slice,this.insert,this.structure)}toJSON(){let e={stepType:"replaceAround",from:this.from,to:this.to,gapFrom:this.gapFrom,gapTo:this.gapTo,insert:this.insert};return this.slice.size&&(e.slice=this.slice.toJSON()),this.structure&&(e.structure=!0),e}static fromJSON(e,t){if("number"!=typeof t.from||"number"!=typeof t.to||"number"!=typeof t.gapFrom||"number"!=typeof t.gapTo||"number"!=typeof t.insert)throw RangeError("Invalid input for ReplaceAroundStep.fromJSON");return new rB(t.from,t.to,t.gapFrom,t.gapTo,nJ.fromJSON(e,t.slice),t.insert,!!t.structure)}}function rF(e,t,n){let r=e.resolve(t),s=n-t,i=r.depth;for(;s>0&&i>0&&r.indexAfter(i)==r.node(i).childCount;)i--,s--;if(s>0){let e=r.node(i).maybeChild(r.indexAfter(i));for(;s>0;){if(!e||e.isLeaf)return!0;e=e.firstChild,s--}}return!1}function rV(e,t,n,r=n.contentMatch,s=!0){let i=e.doc.nodeAt(t),o=[],a=t+1;for(let t=0;t<i.childCount;t++){let l=i.child(t),c=a+l.nodeSize,d=r.matchType(l.type);if(d){r=d;for(let t=0;t<l.marks.length;t++)n.allowsMarkType(l.marks[t].type)||e.step(new rP(a,c,l.marks[t]));if(s&&l.isText&&"pre"!=n.whitespace){let e,t=/\r?\n|\r/g,r;for(;e=t.exec(l.text);)r||(r=new nJ(nV.from(n.schema.text(" ",n.allowedMarks(l.marks))),0,0)),o.push(new rL(a+e.index,a+e.index+e[0].length,r))}}else o.push(new rL(a,c,nJ.empty));a=c}if(!r.validEnd){let t=r.fillBefore(nV.empty,!0);e.replace(a,a,new nJ(t,0,0))}for(let t=o.length-1;t>=0;t--)e.step(o[t])}function r_(e){let t=e.parent.content.cutByIndex(e.startIndex,e.endIndex);for(let n=e.depth;;--n){let r=e.$from.node(n),s=e.$from.index(n),i=e.$to.indexAfter(n);if(n<e.depth&&r.canReplace(s,i,t))return n;if(0==n||r.type.spec.isolating||!((0==s||r.canReplace(s,r.childCount))&&(i==r.childCount||r.canReplace(0,i))))break}return null}function rq(e,t,n=null,r=e){let s=function(e,t){let{parent:n,startIndex:r,endIndex:s}=e,i=n.contentMatchAt(r).findWrapping(t);if(!i)return null;let o=i.length?i[0]:t;return n.canReplaceWith(r,s,o)?i:null}(e,t),i=s&&function(e,t){let{parent:n,startIndex:r,endIndex:s}=e,i=n.child(r),o=t.contentMatch.findWrapping(i.type);if(!o)return null;let a=(o.length?o[o.length-1]:t).contentMatch;for(let e=r;a&&e<s;e++)a=a.matchType(n.child(e).type);return a&&a.validEnd?o:null}(r,t);return i?s.map(rH).concat({type:t,attrs:n}).concat(i.map(rH)):null}function rH(e){return{type:e,attrs:null}}function rW(e,t,n,r){t.forEach((s,i)=>{if(s.isText){let o,a=/\r?\n|\r/g;for(;o=a.exec(s.text);){let s=e.mapping.slice(r).map(n+1+i+o.index);e.replaceWith(s,s+1,t.type.schema.linebreakReplacement.create())}}})}function rU(e,t,n,r){t.forEach((s,i)=>{if(s.type==s.type.schema.linebreakReplacement){let s=e.mapping.slice(r).map(n+1+i);e.replaceWith(s,s+1,t.type.schema.text("\n"))}})}function rJ(e,t,n=1,r){let s=e.resolve(t),i=s.depth-n,o=r&&r[r.length-1]||s.parent;if(i<0||s.parent.type.spec.isolating||!s.parent.canReplace(s.index(),s.parent.childCount)||!o.type.validContent(s.parent.content.cutByIndex(s.index(),s.parent.childCount)))return!1;for(let e=s.depth-1,t=n-2;e>i;e--,t--){let n=s.node(e),i=s.index(e);if(n.type.spec.isolating)return!1;let o=n.content.cutByIndex(i,n.childCount),a=r&&r[t+1];a&&(o=o.replaceChild(0,a.type.create(a.attrs)));let l=r&&r[t]||n;if(!n.canReplace(i+1,n.childCount)||!l.type.validContent(o))return!1}let a=s.indexAfter(i),l=r&&r[0];return s.node(i).canReplaceWith(a,a,l?l.type:s.node(i+1).type)}function rK(e,t){let n=e.resolve(t),r=n.index();return rG(n.nodeBefore,n.nodeAfter)&&n.parent.canReplace(r,r+1)}function rG(e,t){return!!(e&&t&&!e.isLeaf&&function(e,t){t.content.size||e.type.compatibleContent(t.type);let n=e.contentMatchAt(e.childCount),{linebreakReplacement:r}=e.type.schema;for(let s=0;s<t.childCount;s++){let i=t.child(s),o=i.type==r?e.type.schema.nodes.text:i.type;if(!(n=n.matchType(o))||!e.type.allowsMarks(i.marks))return!1}return n.validEnd}(e,t))}function rY(e,t,n=-1){let r=e.resolve(t);for(let e=r.depth;;e--){let s,i,o=r.index(e);if(e==r.depth?(s=r.nodeBefore,i=r.nodeAfter):n>0?(s=r.node(e+1),o++,i=r.node(e).maybeChild(o)):(s=r.node(e).maybeChild(o-1),i=r.node(e+1)),s&&!s.isTextblock&&rG(s,i)&&r.node(e).canReplace(o,o+1))return t;if(0==e)break;t=n<0?r.before(e):r.after(e)}}function rX(e,t,n){let r=e.resolve(t);if(!n.content.size)return t;let s=n.content;for(let e=0;e<n.openStart;e++)s=s.firstChild.content;for(let e=1;e<=(0==n.openStart&&n.size?2:1);e++)for(let t=r.depth;t>=0;t--){let n=t==r.depth?0:r.pos<=(r.start(t+1)+r.end(t+1))/2?-1:1,i=r.index(t)+ +(n>0),o=r.node(t),a=!1;if(1==e)a=o.canReplace(i,i,s);else{let e=o.contentMatchAt(i).findWrapping(s.firstChild.type);a=e&&o.canReplaceWith(i,i,e[0])}if(a)return 0==n?r.pos:n<0?r.before(t+1):r.after(t+1)}return null}function rZ(e,t,n=t,r=nJ.empty){if(t==n&&!r.size)return null;let s=e.resolve(t),i=e.resolve(n);return rQ(s,i,r)?new rL(t,n,r):new r0(s,i,r).fit()}function rQ(e,t,n){return!n.openStart&&!n.openEnd&&e.start()==t.start()&&e.parent.canReplace(e.index(),t.index(),n.content)}rD.jsonID("replaceAround",rB);class r0{constructor(e,t,n){this.$from=e,this.$to=t,this.unplaced=n,this.frontier=[],this.placed=nV.empty;for(let t=0;t<=e.depth;t++){let n=e.node(t);this.frontier.push({type:n.type,match:n.contentMatchAt(e.indexAfter(t))})}for(let t=e.depth;t>0;t--)this.placed=nV.from(e.node(t).copy(this.placed))}get depth(){return this.frontier.length-1}fit(){for(;this.unplaced.size;){let e=this.findFittable();e?this.placeNodes(e):this.openMore()||this.dropNode()}let e=this.mustMoveInline(),t=this.placed.size-this.depth-this.$from.depth,n=this.$from,r=this.close(e<0?this.$to:n.doc.resolve(e));if(!r)return null;let s=this.placed,i=n.depth,o=r.depth;for(;i&&o&&1==s.childCount;)s=s.firstChild.content,i--,o--;let a=new nJ(s,i,o);return e>-1?new rB(n.pos,e,this.$to.pos,this.$to.end(),a,t):a.size||n.pos!=this.$to.pos?new rL(n.pos,r.pos,a):null}findFittable(){let e=this.unplaced.openStart;for(let t=this.unplaced.content,n=0,r=this.unplaced.openEnd;n<e;n++){let s=t.firstChild;if(t.childCount>1&&(r=0),s.type.spec.isolating&&r<=n){e=n;break}t=s.content}for(let t=1;t<=2;t++)for(let n=1==t?e:this.unplaced.openStart;n>=0;n--){let e,r=null,s=(n?(r=r4(this.unplaced.content,n-1).firstChild).content:this.unplaced.content).firstChild;for(let e=this.depth;e>=0;e--){let{type:i,match:o}=this.frontier[e],a,l=null;if(1==t&&(s?o.matchType(s.type)||(l=o.fillBefore(nV.from(s),!1)):r&&i.compatibleContent(r.type)))return{sliceDepth:n,frontierDepth:e,parent:r,inject:l};if(2==t&&s&&(a=o.findWrapping(s.type)))return{sliceDepth:n,frontierDepth:e,parent:r,wrap:a};if(r&&o.matchType(r.type))break}}}openMore(){let{content:e,openStart:t,openEnd:n}=this.unplaced,r=r4(e,t);return!!r.childCount&&!r.firstChild.isLeaf&&(this.unplaced=new nJ(e,t+1,Math.max(n,r.size+t>=e.size-n?t+1:0)),!0)}dropNode(){let{content:e,openStart:t,openEnd:n}=this.unplaced,r=r4(e,t);if(r.childCount<=1&&t>0){let s=e.size-t<=t+r.size;this.unplaced=new nJ(r1(e,t-1,1),t-1,s?t-1:n)}else this.unplaced=new nJ(r1(e,t,1),t,n)}placeNodes({sliceDepth:e,frontierDepth:t,parent:n,inject:r,wrap:s}){for(;this.depth>t;)this.closeFrontierNode();if(s)for(let e=0;e<s.length;e++)this.openFrontierNode(s[e]);let i=this.unplaced,o=n?n.content:i.content,a=i.openStart-e,l=0,c=[],{match:d,type:h}=this.frontier[t];if(r){for(let e=0;e<r.childCount;e++)c.push(r.child(e));d=d.matchFragment(r)}let u=o.size+e-(i.content.size-i.openEnd);for(;l<o.childCount;){let e=o.child(l),t=d.matchType(e.type);if(!t)break;(++l>1||0==a||e.content.size)&&(d=t,c.push(function e(t,n,r){if(n<=0)return t;let s=t.content;return n>1&&(s=s.replaceChild(0,e(s.firstChild,n-1,1==s.childCount?r-1:0))),n>0&&(s=t.type.contentMatch.fillBefore(s).append(s),r<=0&&(s=s.append(t.type.contentMatch.matchFragment(s).fillBefore(nV.empty,!0)))),t.copy(s)}(e.mark(h.allowedMarks(e.marks)),1==l?a:0,l==o.childCount?u:-1)))}let p=l==o.childCount;p||(u=-1),this.placed=r2(this.placed,t,nV.from(c)),this.frontier[t].match=d,p&&u<0&&n&&n.type==this.frontier[this.depth].type&&this.frontier.length>1&&this.closeFrontierNode();for(let e=0,t=o;e<u;e++){let e=t.lastChild;this.frontier.push({type:e.type,match:e.contentMatchAt(e.childCount)}),t=e.content}this.unplaced=p?0==e?nJ.empty:new nJ(r1(i.content,e-1,1),e-1,u<0?i.openEnd:e-1):new nJ(r1(i.content,e,l),i.openStart,i.openEnd)}mustMoveInline(){if(!this.$to.parent.isTextblock)return -1;let e=this.frontier[this.depth],t;if(!e.type.isTextblock||!r5(this.$to,this.$to.depth,e.type,e.match,!1)||this.$to.depth==this.depth&&(t=this.findCloseLevel(this.$to))&&t.depth==this.depth)return -1;let{depth:n}=this.$to,r=this.$to.after(n);for(;n>1&&r==this.$to.end(--n);)++r;return r}findCloseLevel(e){t:for(let t=Math.min(this.depth,e.depth);t>=0;t--){let{match:n,type:r}=this.frontier[t],s=t<e.depth&&e.end(t+1)==e.pos+(e.depth-(t+1)),i=r5(e,t,r,n,s);if(i){for(let n=t-1;n>=0;n--){let{match:t,type:r}=this.frontier[n],s=r5(e,n,r,t,!0);if(!s||s.childCount)continue t}return{depth:t,fit:i,move:s?e.doc.resolve(e.after(t+1)):e}}}}close(e){let t=this.findCloseLevel(e);if(!t)return null;for(;this.depth>t.depth;)this.closeFrontierNode();t.fit.childCount&&(this.placed=r2(this.placed,t.depth,t.fit)),e=t.move;for(let n=t.depth+1;n<=e.depth;n++){let t=e.node(n),r=t.type.contentMatch.fillBefore(t.content,!0,e.index(n));this.openFrontierNode(t.type,t.attrs,r)}return e}openFrontierNode(e,t=null,n){let r=this.frontier[this.depth];r.match=r.match.matchType(e),this.placed=r2(this.placed,this.depth,nV.from(e.create(t,n))),this.frontier.push({type:e,match:e.contentMatch})}closeFrontierNode(){let e=this.frontier.pop().match.fillBefore(nV.empty,!0);e.childCount&&(this.placed=r2(this.placed,this.frontier.length,e))}}function r1(e,t,n){return 0==t?e.cutByIndex(n,e.childCount):e.replaceChild(0,e.firstChild.copy(r1(e.firstChild.content,t-1,n)))}function r2(e,t,n){return 0==t?e.append(n):e.replaceChild(e.childCount-1,e.lastChild.copy(r2(e.lastChild.content,t-1,n)))}function r4(e,t){for(let n=0;n<t;n++)e=e.firstChild.content;return e}function r5(e,t,n,r,s){let i=e.node(t),o=s?e.indexAfter(t):e.index(t);if(o==i.childCount&&!n.compatibleContent(i.type))return null;let a=r.fillBefore(i.content,!0,o);return a&&!function(e,t,n){for(let r=n;r<t.childCount;r++)if(!e.allowsMarks(t.child(r).marks))return!0;return!1}(n,i.content,o)?a:null}function r3(e,t){let n=[],r=Math.min(e.depth,t.depth);for(let s=r;s>=0;s--){let r=e.start(s);if(r<e.pos-(e.depth-s)||t.end(s)>t.pos+(t.depth-s)||e.node(s).type.spec.isolating||t.node(s).type.spec.isolating)break;(r==t.start(s)||s==e.depth&&s==t.depth&&e.parent.inlineContent&&t.parent.inlineContent&&s&&t.start(s-1)==r-1)&&n.push(s)}return n}class r6 extends rD{constructor(e,t,n){super(),this.pos=e,this.attr=t,this.value=n}apply(e){let t=e.nodeAt(this.pos);if(!t)return rO.fail("No node at attribute step's position");let n=Object.create(null);for(let e in t.attrs)n[e]=t.attrs[e];n[this.attr]=this.value;let r=t.type.create(n,null,t.marks);return rO.fromReplace(e,this.pos,this.pos+1,new nJ(nV.from(r),0,+!t.isLeaf))}getMap(){return rA.empty}invert(e){return new r6(this.pos,this.attr,e.nodeAt(this.pos).attrs[this.attr])}map(e){let t=e.mapResult(this.pos,1);return t.deletedAfter?null:new r6(t.pos,this.attr,this.value)}toJSON(){return{stepType:"attr",pos:this.pos,attr:this.attr,value:this.value}}static fromJSON(e,t){if("number"!=typeof t.pos||"string"!=typeof t.attr)throw RangeError("Invalid input for AttrStep.fromJSON");return new r6(t.pos,t.attr,t.value)}}rD.jsonID("attr",r6);class r8 extends rD{constructor(e,t){super(),this.attr=e,this.value=t}apply(e){let t=Object.create(null);for(let n in e.attrs)t[n]=e.attrs[n];t[this.attr]=this.value;let n=e.type.create(t,e.content,e.marks);return rO.ok(n)}getMap(){return rA.empty}invert(e){return new r8(this.attr,e.attrs[this.attr])}map(e){return this}toJSON(){return{stepType:"docAttr",attr:this.attr,value:this.value}}static fromJSON(e,t){if("string"!=typeof t.attr)throw RangeError("Invalid input for DocAttrStep.fromJSON");return new r8(t.attr,t.value)}}rD.jsonID("docAttr",r8);let r7=class extends Error{};(r7=function e(t){let n=Error.call(this,t);return n.__proto__=e.prototype,n}).prototype=Object.create(Error.prototype),r7.prototype.constructor=r7,r7.prototype.name="TransformError";class r9{constructor(e){this.doc=e,this.steps=[],this.docs=[],this.mapping=new rE}get before(){return this.docs.length?this.docs[0]:this.doc}step(e){let t=this.maybeStep(e);if(t.failed)throw new r7(t.failed);return this}maybeStep(e){let t=e.apply(this.doc);return t.failed||this.addStep(e,t.doc),t}get docChanged(){return this.steps.length>0}addStep(e,t){this.docs.push(this.doc),this.steps.push(e),this.mapping.appendMap(e.getMap()),this.doc=t}replace(e,t=e,n=nJ.empty){let r=rZ(this.doc,e,t,n);return r&&this.step(r),this}replaceWith(e,t,n){return this.replace(e,t,new nJ(nV.from(n),0,0))}delete(e,t){return this.replace(e,t,nJ.empty)}insert(e,t){return this.replaceWith(e,e,t)}replaceRange(e,t,n){return!function(e,t,n,r){if(!r.size)return e.deleteRange(t,n);let s=e.doc.resolve(t),i=e.doc.resolve(n);if(rQ(s,i,r))return e.step(new rL(t,n,r));let o=r3(s,e.doc.resolve(n));0==o[o.length-1]&&o.pop();let a=-(s.depth+1);o.unshift(a);for(let e=s.depth,t=s.pos-1;e>0;e--,t--){let n=s.node(e).type.spec;if(n.defining||n.definingAsContext||n.isolating)break;o.indexOf(e)>-1?a=e:s.before(e)==t&&o.splice(1,0,-e)}let l=o.indexOf(a),c=[],d=r.openStart;for(let e=r.content,t=0;;t++){let n=e.firstChild;if(c.push(n),t==r.openStart)break;e=n.content}for(let e=d-1;e>=0;e--){var h;let t=c[e],n=(h=t.type).spec.defining||h.spec.definingForContent;if(n&&!t.sameMarkup(s.node(Math.abs(a)-1)))d=e;else if(n||!t.type.isTextblock)break}for(let t=r.openStart;t>=0;t--){let a=(t+d+1)%(r.openStart+1),h=c[a];if(h)for(let t=0;t<o.length;t++){let c=o[(t+l)%o.length],d=!0;c<0&&(d=!1,c=-c);let u=s.node(c-1),p=s.index(c-1);if(u.canReplaceWith(p,p,h.type,h.marks))return e.replace(s.before(c),d?i.after(c):n,new nJ(function e(t,n,r,s,i){if(n<r){let i=t.firstChild;t=t.replaceChild(0,i.copy(e(i.content,n+1,r,s,i)))}if(n>s){let e=i.contentMatchAt(0),n=e.fillBefore(t).append(t);t=n.append(e.matchFragment(n).fillBefore(nV.empty,!0))}return t}(r.content,0,r.openStart,a),a,r.openEnd))}}let u=e.steps.length;for(let a=o.length-1;a>=0&&(e.replace(t,n,r),!(e.steps.length>u));a--){let e=o[a];e<0||(t=s.before(e),n=i.after(e))}}(this,e,t,n),this}replaceRangeWith(e,t,n){var r=e,s=t;if(!n.isInline&&r==s&&this.doc.resolve(r).parent.content.size){let e=function(e,t,n){let r=e.resolve(t);if(r.parent.canReplaceWith(r.index(),r.index(),n))return t;if(0==r.parentOffset)for(let e=r.depth-1;e>=0;e--){let t=r.index(e);if(r.node(e).canReplaceWith(t,t,n))return r.before(e+1);if(t>0)return null}if(r.parentOffset==r.parent.content.size)for(let e=r.depth-1;e>=0;e--){let t=r.indexAfter(e);if(r.node(e).canReplaceWith(t,t,n))return r.after(e+1);if(t<r.node(e).childCount)break}return null}(this.doc,r,n.type);null!=e&&(r=s=e)}return this.replaceRange(r,s,new nJ(nV.from(n),0,0)),this}deleteRange(e,t){return!function(e,t,n){let r=e.doc.resolve(t),s=e.doc.resolve(n),i=r3(r,s);for(let t=0;t<i.length;t++){let n=i[t],o=t==i.length-1;if(o&&0==n||r.node(n).type.contentMatch.validEnd)return e.delete(r.start(n),s.end(n));if(n>0&&(o||r.node(n-1).canReplace(r.index(n-1),s.indexAfter(n-1))))return e.delete(r.before(n),s.after(n))}for(let i=1;i<=r.depth&&i<=s.depth;i++)if(t-r.start(i)==r.depth-i&&n>r.end(i)&&s.end(i)-n!=s.depth-i&&r.start(i-1)==s.start(i-1)&&r.node(i-1).canReplace(r.index(i-1),s.index(i-1)))return e.delete(r.before(i),n);e.delete(t,n)}(this,e,t),this}lift(e,t){return!function(e,t,n){let{$from:r,$to:s,depth:i}=t,o=r.before(i+1),a=s.after(i+1),l=o,c=a,d=nV.empty,h=0;for(let e=i,t=!1;e>n;e--)t||r.index(e)>0?(t=!0,d=nV.from(r.node(e).copy(d)),h++):l--;let u=nV.empty,p=0;for(let e=i,t=!1;e>n;e--)t||s.after(e+1)<s.end(e)?(t=!0,u=nV.from(s.node(e).copy(u)),p++):c++;e.step(new rB(l,c,o,a,new nJ(d.append(u),h,p),d.size-h,!0))}(this,e,t),this}join(e,t=1){return!function(e,t,n){let r=null,{linebreakReplacement:s}=e.doc.type.schema,i=e.doc.resolve(t-n),o=i.node().type;if(s&&o.inlineContent){let e="pre"==o.whitespace,t=!!o.contentMatch.matchType(s);e&&!t?r=!1:!e&&t&&(r=!0)}let a=e.steps.length;if(!1===r){let r=e.doc.resolve(t+n);rU(e,r.node(),r.before(),a)}o.inlineContent&&rV(e,t+n-1,o,i.node().contentMatchAt(i.index()),null==r);let l=e.mapping.slice(a),c=l.map(t-n);if(e.step(new rL(c,l.map(t+n,-1),nJ.empty,!0)),!0===r){let t=e.doc.resolve(c);rW(e,t.node(),t.before(),e.steps.length)}}(this,e,t),this}wrap(e,t){return!function(e,t,n){let r=nV.empty;for(let e=n.length-1;e>=0;e--){if(r.size){let t=n[e].type.contentMatch.matchFragment(r);if(!t||!t.validEnd)throw RangeError("Wrapper type given to Transform.wrap does not form valid content of its parent wrapper")}r=nV.from(n[e].type.create(n[e].attrs,r))}let s=t.start,i=t.end;e.step(new rB(s,i,s,i,new nJ(r,0,0),n.length,!0))}(this,e,t),this}setBlockType(e,t=e,n,r=null){var s=this;if(!n.isTextblock)throw RangeError("Type given to setBlockType should be a textblock");let i=s.steps.length;return s.doc.nodesBetween(e,t,(e,t)=>{var o,a,l;let c,d,h="function"==typeof r?r(e):r;if(e.isTextblock&&!e.hasMarkup(n,h)&&(o=s.doc,a=s.mapping.slice(i).map(t),l=n,d=(c=o.resolve(a)).index(),c.parent.canReplaceWith(d,d+1,l))){let r=null;if(n.schema.linebreakReplacement){let e="pre"==n.whitespace,t=!!n.contentMatch.matchType(n.schema.linebreakReplacement);e&&!t?r=!1:!e&&t&&(r=!0)}!1===r&&rU(s,e,t,i),rV(s,s.mapping.slice(i).map(t,1),n,void 0,null===r);let o=s.mapping.slice(i),a=o.map(t,1),l=o.map(t+e.nodeSize,1);return s.step(new rB(a,l,a+1,l-1,new nJ(nV.from(n.create(h,null,e.marks)),0,0),1,!0)),!0===r&&rW(s,e,t,i),!1}}),this}setNodeMarkup(e,t,n=null,r){return!function(e,t,n,r,s){let i=e.doc.nodeAt(t);if(!i)throw RangeError("No node at given position");n||(n=i.type);let o=n.create(r,null,s||i.marks);if(i.isLeaf)return e.replaceWith(t,t+i.nodeSize,o);if(!n.validContent(i.content))throw RangeError("Invalid content for node type "+n.name);e.step(new rB(t,t+i.nodeSize,t+1,t+i.nodeSize-1,new nJ(nV.from(o),0,0),1,!0))}(this,e,t,n,r),this}setNodeAttribute(e,t,n){return this.step(new r6(e,t,n)),this}setDocAttribute(e,t){return this.step(new r8(e,t)),this}addNodeMark(e,t){return this.step(new rz(e,t)),this}removeNodeMark(e,t){let n=this.doc.nodeAt(e);if(!n)throw RangeError("No node at position "+e);if(t instanceof nW)t.isInSet(n.marks)&&this.step(new r$(e,t));else{let r=n.marks,s,i=[];for(;s=t.isInSet(r);)i.push(new r$(e,s)),r=s.removeFromSet(r);for(let e=i.length-1;e>=0;e--)this.step(i[e])}return this}split(e,t=1,n){return!function(e,t,n=1,r){let s=e.doc.resolve(t),i=nV.empty,o=nV.empty;for(let e=s.depth,t=s.depth-n,a=n-1;e>t;e--,a--){i=nV.from(s.node(e).copy(i));let t=r&&r[a];o=nV.from(t?t.type.create(t.attrs,o):s.node(e).copy(o))}e.step(new rL(t,t,new nJ(i.append(o),n,n),!0))}(this,e,t,n),this}addMark(e,t,n){var r;let s,i,o,a;return r=this,o=[],a=[],r.doc.nodesBetween(e,t,(r,l,c)=>{if(!r.isInline)return;let d=r.marks;if(!n.isInSet(d)&&c.type.allowsMarkType(n.type)){let c=Math.max(l,e),h=Math.min(l+r.nodeSize,t),u=n.addToSet(d);for(let e=0;e<d.length;e++)d[e].isInSet(u)||(s&&s.to==c&&s.mark.eq(d[e])?s.to=h:o.push(s=new rP(c,h,d[e])));i&&i.to==c?i.to=h:a.push(i=new rR(c,h,n))}}),o.forEach(e=>r.step(e)),a.forEach(e=>r.step(e)),this}removeMark(e,t,n){var r;let s,i;return r=this,s=[],i=0,r.doc.nodesBetween(e,t,(r,o)=>{if(!r.isInline)return;i++;let a=null;if(n instanceof rd){let e=r.marks,t;for(;t=n.isInSet(e);)(a||(a=[])).push(t),e=t.removeFromSet(e)}else n?n.isInSet(r.marks)&&(a=[n]):a=r.marks;if(a&&a.length){let n=Math.min(o+r.nodeSize,t);for(let t=0;t<a.length;t++){let r=a[t],l;for(let e=0;e<s.length;e++){let t=s[e];t.step==i-1&&r.eq(s[e].style)&&(l=t)}l?(l.to=n,l.step=i):s.push({style:r,from:Math.max(o,e),to:n,step:i})}}}),s.forEach(e=>r.step(new rP(e.from,e.to,e.style))),this}clearIncompatible(e,t,n){return rV(this,e,t,n),this}}let se=Object.create(null);class st{constructor(e,t,n){this.$anchor=e,this.$head=t,this.ranges=n||[new sn(e.min(t),e.max(t))]}get anchor(){return this.$anchor.pos}get head(){return this.$head.pos}get from(){return this.$from.pos}get to(){return this.$to.pos}get $from(){return this.ranges[0].$from}get $to(){return this.ranges[0].$to}get empty(){let e=this.ranges;for(let t=0;t<e.length;t++)if(e[t].$from.pos!=e[t].$to.pos)return!1;return!0}content(){return this.$from.doc.slice(this.from,this.to,!0)}replace(e,t=nJ.empty){let n=t.content.lastChild,r=null;for(let e=0;e<t.openEnd;e++)r=n,n=n.lastChild;let s=e.steps.length,i=this.ranges;for(let o=0;o<i.length;o++){let{$from:a,$to:l}=i[o],c=e.mapping.slice(s);e.replaceRange(c.map(a.pos),c.map(l.pos),o?nJ.empty:t),0==o&&su(e,s,(n?n.isInline:r&&r.isTextblock)?-1:1)}}replaceWith(e,t){let n=e.steps.length,r=this.ranges;for(let s=0;s<r.length;s++){let{$from:i,$to:o}=r[s],a=e.mapping.slice(n),l=a.map(i.pos),c=a.map(o.pos);s?e.deleteRange(l,c):(e.replaceRangeWith(l,c,t),su(e,n,t.isInline?-1:1))}}static findFrom(e,t,n=!1){let r=e.parent.inlineContent?new si(e):sh(e.node(0),e.parent,e.pos,e.index(),t,n);if(r)return r;for(let r=e.depth-1;r>=0;r--){let s=t<0?sh(e.node(0),e.node(r),e.before(r+1),e.index(r),t,n):sh(e.node(0),e.node(r),e.after(r+1),e.index(r)+1,t,n);if(s)return s}return null}static near(e,t=1){return this.findFrom(e,t)||this.findFrom(e,-t)||new sc(e.node(0))}static atStart(e){return sh(e,e,0,0,1)||new sc(e)}static atEnd(e){return sh(e,e,e.content.size,e.childCount,-1)||new sc(e)}static fromJSON(e,t){if(!t||!t.type)throw RangeError("Invalid input for Selection.fromJSON");let n=se[t.type];if(!n)throw RangeError(`No selection type ${t.type} defined`);return n.fromJSON(e,t)}static jsonID(e,t){if(e in se)throw RangeError("Duplicate use of selection JSON ID "+e);return se[e]=t,t.prototype.jsonID=e,t}getBookmark(){return si.between(this.$anchor,this.$head).getBookmark()}}st.prototype.visible=!0;class sn{constructor(e,t){this.$from=e,this.$to=t}}let sr=!1;function ss(e){sr||e.parent.inlineContent||(sr=!0,console.warn("TextSelection endpoint not pointing into a node with inline content ("+e.parent.type.name+")"))}class si extends st{constructor(e,t=e){ss(e),ss(t),super(e,t)}get $cursor(){return this.$anchor.pos==this.$head.pos?this.$head:null}map(e,t){let n=e.resolve(t.map(this.head));if(!n.parent.inlineContent)return st.near(n);let r=e.resolve(t.map(this.anchor));return new si(r.parent.inlineContent?r:n,n)}replace(e,t=nJ.empty){if(super.replace(e,t),t==nJ.empty){let t=this.$from.marksAcross(this.$to);t&&e.ensureMarks(t)}}eq(e){return e instanceof si&&e.anchor==this.anchor&&e.head==this.head}getBookmark(){return new so(this.anchor,this.head)}toJSON(){return{type:"text",anchor:this.anchor,head:this.head}}static fromJSON(e,t){if("number"!=typeof t.anchor||"number"!=typeof t.head)throw RangeError("Invalid input for TextSelection.fromJSON");return new si(e.resolve(t.anchor),e.resolve(t.head))}static create(e,t,n=t){let r=e.resolve(t);return new this(r,n==t?r:e.resolve(n))}static between(e,t,n){let r=e.pos-t.pos;if((!n||r)&&(n=r>=0?1:-1),!t.parent.inlineContent){let e=st.findFrom(t,n,!0)||st.findFrom(t,-n,!0);if(!e)return st.near(t,n);t=e.$head}return e.parent.inlineContent||(0==r?e=t:(e=(st.findFrom(e,-n,!0)||st.findFrom(e,n,!0)).$anchor).pos<t.pos!=r<0&&(e=t)),new si(e,t)}}st.jsonID("text",si);class so{constructor(e,t){this.anchor=e,this.head=t}map(e){return new so(e.map(this.anchor),e.map(this.head))}resolve(e){return si.between(e.resolve(this.anchor),e.resolve(this.head))}}class sa extends st{constructor(e){let t=e.nodeAfter;super(e,e.node(0).resolve(e.pos+t.nodeSize)),this.node=t}map(e,t){let{deleted:n,pos:r}=t.mapResult(this.anchor),s=e.resolve(r);return n?st.near(s):new sa(s)}content(){return new nJ(nV.from(this.node),0,0)}eq(e){return e instanceof sa&&e.anchor==this.anchor}toJSON(){return{type:"node",anchor:this.anchor}}getBookmark(){return new sl(this.anchor)}static fromJSON(e,t){if("number"!=typeof t.anchor)throw RangeError("Invalid input for NodeSelection.fromJSON");return new sa(e.resolve(t.anchor))}static create(e,t){return new sa(e.resolve(t))}static isSelectable(e){return!e.isText&&!1!==e.type.spec.selectable}}sa.prototype.visible=!1,st.jsonID("node",sa);class sl{constructor(e){this.anchor=e}map(e){let{deleted:t,pos:n}=e.mapResult(this.anchor);return t?new so(n,n):new sl(n)}resolve(e){let t=e.resolve(this.anchor),n=t.nodeAfter;return n&&sa.isSelectable(n)?new sa(t):st.near(t)}}class sc extends st{constructor(e){super(e.resolve(0),e.resolve(e.content.size))}replace(e,t=nJ.empty){if(t==nJ.empty){e.delete(0,e.doc.content.size);let t=st.atStart(e.doc);t.eq(e.selection)||e.setSelection(t)}else super.replace(e,t)}toJSON(){return{type:"all"}}static fromJSON(e){return new sc(e)}map(e){return new sc(e)}eq(e){return e instanceof sc}getBookmark(){return sd}}st.jsonID("all",sc);let sd={map(){return this},resolve:e=>new sc(e)};function sh(e,t,n,r,s,i=!1){if(t.inlineContent)return si.create(e,n);for(let o=r-(s>0?0:1);s>0?o<t.childCount:o>=0;o+=s){let r=t.child(o);if(r.isAtom){if(!i&&sa.isSelectable(r))return sa.create(e,n-(s<0?r.nodeSize:0))}else{let t=sh(e,r,n+s,s<0?r.childCount:0,s,i);if(t)return t}n+=r.nodeSize*s}return null}function su(e,t,n){let r,s=e.steps.length-1;if(s<t)return;let i=e.steps[s];(i instanceof rL||i instanceof rB)&&(e.mapping.maps[s].forEach((e,t,n,s)=>{null==r&&(r=s)}),e.setSelection(st.near(e.doc.resolve(r),n)))}class sp extends r9{constructor(e){super(e.doc),this.curSelectionFor=0,this.updated=0,this.meta=Object.create(null),this.time=Date.now(),this.curSelection=e.selection,this.storedMarks=e.storedMarks}get selection(){return this.curSelectionFor<this.steps.length&&(this.curSelection=this.curSelection.map(this.doc,this.mapping.slice(this.curSelectionFor)),this.curSelectionFor=this.steps.length),this.curSelection}setSelection(e){if(e.$from.doc!=this.doc)throw RangeError("Selection passed to setSelection must point at the current document");return this.curSelection=e,this.curSelectionFor=this.steps.length,this.updated=(1|this.updated)&-3,this.storedMarks=null,this}get selectionSet(){return(1&this.updated)>0}setStoredMarks(e){return this.storedMarks=e,this.updated|=2,this}ensureMarks(e){return nW.sameSet(this.storedMarks||this.selection.$from.marks(),e)||this.setStoredMarks(e),this}addStoredMark(e){return this.ensureMarks(e.addToSet(this.storedMarks||this.selection.$head.marks()))}removeStoredMark(e){return this.ensureMarks(e.removeFromSet(this.storedMarks||this.selection.$head.marks()))}get storedMarksSet(){return(2&this.updated)>0}addStep(e,t){super.addStep(e,t),this.updated=-3&this.updated,this.storedMarks=null}setTime(e){return this.time=e,this}replaceSelection(e){return this.selection.replace(this,e),this}replaceSelectionWith(e,t=!0){let n=this.selection;return t&&(e=e.mark(this.storedMarks||(n.empty?n.$from.marks():n.$from.marksAcross(n.$to)||nW.none))),n.replaceWith(this,e),this}deleteSelection(){return this.selection.replace(this),this}insertText(e,t,n){let r=this.doc.type.schema;if(null==t)return e?this.replaceSelectionWith(r.text(e),!0):this.deleteSelection();{if(null==n&&(n=t),n=null==n?t:n,!e)return this.deleteRange(t,n);let s=this.storedMarks;if(!s){let e=this.doc.resolve(t);s=n==t?e.marks():e.marksAcross(this.doc.resolve(n))}return this.replaceRangeWith(t,n,r.text(e,s)),this.selection.empty||this.setSelection(st.near(this.selection.$to)),this}}setMeta(e,t){return this.meta["string"==typeof e?e:e.key]=t,this}getMeta(e){return this.meta["string"==typeof e?e:e.key]}get isGeneric(){for(let e in this.meta)return!1;return!0}scrollIntoView(){return this.updated|=4,this}get scrolledIntoView(){return(4&this.updated)>0}}function sf(e,t){return t&&e?e.bind(t):e}class sm{constructor(e,t,n){this.name=e,this.init=sf(t.init,n),this.apply=sf(t.apply,n)}}let sg=[new sm("doc",{init:e=>e.doc||e.schema.topNodeType.createAndFill(),apply:e=>e.doc}),new sm("selection",{init:(e,t)=>e.selection||st.atStart(t.doc),apply:e=>e.selection}),new sm("storedMarks",{init:e=>e.storedMarks||null,apply:(e,t,n,r)=>r.selection.$cursor?e.storedMarks:null}),new sm("scrollToSelection",{init:()=>0,apply:(e,t)=>e.scrolledIntoView?t+1:t})];class sx{constructor(e,t){this.schema=e,this.plugins=[],this.pluginsByKey=Object.create(null),this.fields=sg.slice(),t&&t.forEach(e=>{if(this.pluginsByKey[e.key])throw RangeError("Adding different instances of a keyed plugin ("+e.key+")");this.plugins.push(e),this.pluginsByKey[e.key]=e,e.spec.state&&this.fields.push(new sm(e.key,e.spec.state,e))})}}class sy{constructor(e){this.config=e}get schema(){return this.config.schema}get plugins(){return this.config.plugins}apply(e){return this.applyTransaction(e).state}filterTransaction(e,t=-1){for(let n=0;n<this.config.plugins.length;n++)if(n!=t){let t=this.config.plugins[n];if(t.spec.filterTransaction&&!t.spec.filterTransaction.call(t,e,this))return!1}return!0}applyTransaction(e){if(!this.filterTransaction(e))return{state:this,transactions:[]};let t=[e],n=this.applyInner(e),r=null;for(;;){let s=!1;for(let i=0;i<this.config.plugins.length;i++){let o=this.config.plugins[i];if(o.spec.appendTransaction){let a=r?r[i].n:0,l=r?r[i].state:this,c=a<t.length&&o.spec.appendTransaction.call(o,a?t.slice(a):t,l,n);if(c&&n.filterTransaction(c,i)){if(c.setMeta("appendedTransaction",e),!r){r=[];for(let e=0;e<this.config.plugins.length;e++)r.push(e<i?{state:n,n:t.length}:{state:this,n:0})}t.push(c),n=n.applyInner(c),s=!0}r&&(r[i]={state:n,n:t.length})}}if(!s)return{state:n,transactions:t}}}applyInner(e){if(!e.before.eq(this.doc))throw RangeError("Applying a mismatched transaction");let t=new sy(this.config),n=this.config.fields;for(let r=0;r<n.length;r++){let s=n[r];t[s.name]=s.apply(e,this[s.name],this,t)}return t}get tr(){return new sp(this)}static create(e){let t=new sx(e.doc?e.doc.type.schema:e.schema,e.plugins),n=new sy(t);for(let r=0;r<t.fields.length;r++)n[t.fields[r].name]=t.fields[r].init(e,n);return n}reconfigure(e){let t=new sx(this.schema,e.plugins),n=t.fields,r=new sy(t);for(let t=0;t<n.length;t++){let s=n[t].name;r[s]=this.hasOwnProperty(s)?this[s]:n[t].init(e,r)}return r}toJSON(e){let t={doc:this.doc.toJSON(),selection:this.selection.toJSON()};if(this.storedMarks&&(t.storedMarks=this.storedMarks.map(e=>e.toJSON())),e&&"object"==typeof e)for(let n in e){if("doc"==n||"selection"==n)throw RangeError("The JSON fields `doc` and `selection` are reserved");let r=e[n],s=r.spec.state;s&&s.toJSON&&(t[n]=s.toJSON.call(r,this[r.key]))}return t}static fromJSON(e,t,n){if(!t)throw RangeError("Invalid input for EditorState.fromJSON");if(!e.schema)throw RangeError("Required config field 'schema' missing");let r=new sx(e.schema,e.plugins),s=new sy(r);return r.fields.forEach(r=>{if("doc"==r.name)s.doc=n6.fromJSON(e.schema,t.doc);else if("selection"==r.name)s.selection=st.fromJSON(s.doc,t.selection);else if("storedMarks"==r.name)t.storedMarks&&(s.storedMarks=t.storedMarks.map(e.schema.markFromJSON));else{if(n)for(let i in n){let o=n[i],a=o.spec.state;if(o.key==r.name&&a&&a.fromJSON&&Object.prototype.hasOwnProperty.call(t,i)){s[r.name]=a.fromJSON.call(o,e,t[i],s);return}}s[r.name]=r.init(e,s)}}),s}}class sv{constructor(e){this.spec=e,this.props={},e.props&&function e(t,n,r){for(let s in t){let i=t[s];i instanceof Function?i=i.bind(n):"handleDOMEvents"==s&&(i=e(i,n,{})),r[s]=i}return r}(e.props,this,this.props),this.key=e.key?e.key.key:sw("plugin")}getState(e){return e[this.key]}}let sb=Object.create(null);function sw(e){return e in sb?e+"$"+ ++sb[e]:(sb[e]=0,e+"$")}class sk{constructor(e="key"){this.key=sw(e)}get(e){return e.config.pluginsByKey[this.key]}getState(e){return e[this.key]}}let sN=function(e){for(var t=0;;t++)if(!(e=e.previousSibling))return t},sj=function(e){let t=e.assignedSlot||e.parentNode;return t&&11==t.nodeType?t.host:t},sS=null,sC=function(e,t,n){let r=sS||(sS=document.createRange());return r.setEnd(e,null==n?e.nodeValue.length:n),r.setStart(e,t||0),r},sM=function(){sS=null},sA=function(e,t,n,r){return n&&(sT(e,t,n,r,-1)||sT(e,t,n,r,1))},sE=/^(img|br|input|textarea|hr)$/i;function sT(e,t,n,r,s){for(var i;;){if(e==n&&t==r)return!0;if(t==(s<0?0:sD(e))){let n=e.parentNode;if(!n||1!=n.nodeType||sO(e)||sE.test(e.nodeName)||"false"==e.contentEditable)return!1;t=sN(e)+(s<0?0:1),e=n}else{if(1!=e.nodeType)return!1;let n=e.childNodes[t+(s<0?-1:0)];if(1==n.nodeType&&"false"==n.contentEditable)if(null==(i=n.pmViewDesc)||!i.ignoreForSelection)return!1;else t+=s;else e=n,t=s<0?sD(e):0}}}function sD(e){return 3==e.nodeType?e.nodeValue.length:e.childNodes.length}function sO(e){let t;for(let n=e;n&&!(t=n.pmViewDesc);n=n.parentNode);return t&&t.node&&t.node.isBlock&&(t.dom==e||t.contentDOM==e)}let sI=function(e){return e.focusNode&&sA(e.focusNode,e.focusOffset,e.anchorNode,e.anchorOffset)};function sR(e,t){let n=document.createEvent("Event");return n.initEvent("keydown",!0,!0),n.keyCode=e,n.key=n.code=t,n}let sP="undefined"!=typeof navigator?navigator:null,sz="undefined"!=typeof document?document:null,s$=sP&&sP.userAgent||"",sL=/Edge\/(\d+)/.exec(s$),sB=/MSIE \d/.exec(s$),sF=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(s$),sV=!!(sB||sF||sL),s_=sB?document.documentMode:sF?+sF[1]:sL?+sL[1]:0,sq=!sV&&/gecko\/(\d+)/i.test(s$);sq&&(/Firefox\/(\d+)/.exec(s$)||[0,0])[1];let sH=!sV&&/Chrome\/(\d+)/.exec(s$),sW=!!sH,sU=sH?+sH[1]:0,sJ=!sV&&!!sP&&/Apple Computer/.test(sP.vendor),sK=sJ&&(/Mobile\/\w+/.test(s$)||!!sP&&sP.maxTouchPoints>2),sG=sK||!!sP&&/Mac/.test(sP.platform),sY=!!sP&&/Win/.test(sP.platform),sX=/Android \d/.test(s$),sZ=!!sz&&"webkitFontSmoothing"in sz.documentElement.style,sQ=sZ?+(/\bAppleWebKit\/(\d+)/.exec(navigator.userAgent)||[0,0])[1]:0;function s0(e,t){return"number"==typeof e?e:e[t]}function s1(e,t,n){let r=e.someProp("scrollThreshold")||0,s=e.someProp("scrollMargin")||5,i=e.dom.ownerDocument;for(let o=n||e.dom;o;){if(1!=o.nodeType){o=sj(o);continue}let e=o,n=e==i.body,a=n?function(e){let t=e.defaultView&&e.defaultView.visualViewport;return t?{left:0,right:t.width,top:0,bottom:t.height}:{left:0,right:e.documentElement.clientWidth,top:0,bottom:e.documentElement.clientHeight}}(i):function(e){let t=e.getBoundingClientRect(),n=t.width/e.offsetWidth||1,r=t.height/e.offsetHeight||1;return{left:t.left,right:t.left+e.clientWidth*n,top:t.top,bottom:t.top+e.clientHeight*r}}(e),l=0,c=0;if(t.top<a.top+s0(r,"top")?c=-(a.top-t.top+s0(s,"top")):t.bottom>a.bottom-s0(r,"bottom")&&(c=t.bottom-t.top>a.bottom-a.top?t.top+s0(s,"top")-a.top:t.bottom-a.bottom+s0(s,"bottom")),t.left<a.left+s0(r,"left")?l=-(a.left-t.left+s0(s,"left")):t.right>a.right-s0(r,"right")&&(l=t.right-a.right+s0(s,"right")),l||c)if(n)i.defaultView.scrollBy(l,c);else{let n=e.scrollLeft,r=e.scrollTop;c&&(e.scrollTop+=c),l&&(e.scrollLeft+=l);let s=e.scrollLeft-n,i=e.scrollTop-r;t={left:t.left-s,top:t.top-i,right:t.right-s,bottom:t.bottom-i}}let d=n?"fixed":getComputedStyle(o).position;if(/^(fixed|sticky)$/.test(d))break;o="absolute"==d?o.offsetParent:sj(o)}}function s2(e){let t=[],n=e.ownerDocument;for(let r=e;r&&(t.push({dom:r,top:r.scrollTop,left:r.scrollLeft}),e!=n);r=sj(r));return t}function s4(e,t){for(let n=0;n<e.length;n++){let{dom:r,top:s,left:i}=e[n];r.scrollTop!=s+t&&(r.scrollTop=s+t),r.scrollLeft!=i&&(r.scrollLeft=i)}}let s5=null;function s3(e,t){return e.left>=t.left-1&&e.left<=t.right+1&&e.top>=t.top-1&&e.top<=t.bottom+1}function s6(e){return e.top<e.bottom||e.left<e.right}function s8(e,t){let n=e.getClientRects();if(n.length){let e=n[t<0?0:n.length-1];if(s6(e))return e}return Array.prototype.find.call(n,s6)||e.getBoundingClientRect()}let s7=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac]/;function s9(e,t,n){let{node:r,offset:s,atom:i}=e.docView.domFromPos(t,n<0?-1:1),o=sZ||sq;if(3==r.nodeType)if(o&&(s7.test(r.nodeValue)||(n<0?!s:s==r.nodeValue.length))){let e=s8(sC(r,s,s),n);if(sq&&s&&/\s/.test(r.nodeValue[s-1])&&s<r.nodeValue.length){let t=s8(sC(r,s-1,s-1),-1);if(t.top==e.top){let n=s8(sC(r,s,s+1),-1);if(n.top!=e.top)return ie(n,n.left<t.left)}}return e}else{let e=s,t=s,i=n<0?1:-1;return n<0&&!s?(t++,i=-1):n>=0&&s==r.nodeValue.length?(e--,i=1):n<0?e--:t++,ie(s8(sC(r,e,t),i),i<0)}if(!e.state.doc.resolve(t-(i||0)).parent.inlineContent){if(null==i&&s&&(n<0||s==sD(r))){let e=r.childNodes[s-1];if(1==e.nodeType)return it(e.getBoundingClientRect(),!1)}if(null==i&&s<sD(r)){let e=r.childNodes[s];if(1==e.nodeType)return it(e.getBoundingClientRect(),!0)}return it(r.getBoundingClientRect(),n>=0)}if(null==i&&s&&(n<0||s==sD(r))){let e=r.childNodes[s-1],t=3==e.nodeType?sC(e,sD(e)-!o):1!=e.nodeType||"BR"==e.nodeName&&e.nextSibling?null:e;if(t)return ie(s8(t,1),!1)}if(null==i&&s<sD(r)){let e=r.childNodes[s];for(;e.pmViewDesc&&e.pmViewDesc.ignoreForCoords;)e=e.nextSibling;let t=e?3==e.nodeType?sC(e,0,+!o):1==e.nodeType?e:null:null;if(t)return ie(s8(t,-1),!0)}return ie(s8(3==r.nodeType?sC(r):r,-n),n>=0)}function ie(e,t){if(0==e.width)return e;let n=t?e.left:e.right;return{top:e.top,bottom:e.bottom,left:n,right:n}}function it(e,t){if(0==e.height)return e;let n=t?e.top:e.bottom;return{top:n,bottom:n,left:e.left,right:e.right}}function ir(e,t,n){let r=e.state,s=e.root.activeElement;r!=t&&e.updateState(t),s!=e.dom&&e.focus();try{return n()}finally{r!=t&&e.updateState(r),s!=e.dom&&s&&s.focus()}}let is=/[\u0590-\u08ac]/,ii=null,io=null,ia=!1;class il{constructor(e,t,n,r){this.parent=e,this.children=t,this.dom=n,this.contentDOM=r,this.dirty=0,n.pmViewDesc=this}matchesWidget(e){return!1}matchesMark(e){return!1}matchesNode(e,t,n){return!1}matchesHack(e){return!1}parseRule(){return null}stopEvent(e){return!1}get size(){let e=0;for(let t=0;t<this.children.length;t++)e+=this.children[t].size;return e}get border(){return 0}destroy(){this.parent=void 0,this.dom.pmViewDesc==this&&(this.dom.pmViewDesc=void 0);for(let e=0;e<this.children.length;e++)this.children[e].destroy()}posBeforeChild(e){for(let t=0,n=this.posAtStart;;t++){let r=this.children[t];if(r==e)return n;n+=r.size}}get posBefore(){return this.parent.posBeforeChild(this)}get posAtStart(){return this.parent?this.parent.posBeforeChild(this)+this.border:0}get posAfter(){return this.posBefore+this.size}get posAtEnd(){return this.posAtStart+this.size-2*this.border}localPosFromDOM(e,t,n){let r;if(this.contentDOM&&this.contentDOM.contains(1==e.nodeType?e:e.parentNode))if(n<0){let n,r;if(e==this.contentDOM)n=e.childNodes[t-1];else{for(;e.parentNode!=this.contentDOM;)e=e.parentNode;n=e.previousSibling}for(;n&&!((r=n.pmViewDesc)&&r.parent==this);)n=n.previousSibling;return n?this.posBeforeChild(r)+r.size:this.posAtStart}else{let n,r;if(e==this.contentDOM)n=e.childNodes[t];else{for(;e.parentNode!=this.contentDOM;)e=e.parentNode;n=e.nextSibling}for(;n&&!((r=n.pmViewDesc)&&r.parent==this);)n=n.nextSibling;return n?this.posBeforeChild(r):this.posAtEnd}if(e==this.dom&&this.contentDOM)r=t>sN(this.contentDOM);else if(this.contentDOM&&this.contentDOM!=this.dom&&this.dom.contains(this.contentDOM))r=2&e.compareDocumentPosition(this.contentDOM);else if(this.dom.firstChild){if(0==t)for(let t=e;;t=t.parentNode){if(t==this.dom){r=!1;break}if(t.previousSibling)break}if(null==r&&t==e.childNodes.length)for(let t=e;;t=t.parentNode){if(t==this.dom){r=!0;break}if(t.nextSibling)break}}return(null==r?n>0:r)?this.posAtEnd:this.posAtStart}nearestDesc(e,t=!1){for(let n=!0,r=e;r;r=r.parentNode){let s=this.getDesc(r),i;if(s&&(!t||s.node))if(!n||!(i=s.nodeDOM)||(1==i.nodeType?i.contains(1==e.nodeType?e:e.parentNode):i==e))return s;else n=!1}}getDesc(e){let t=e.pmViewDesc;for(let e=t;e;e=e.parent)if(e==this)return t}posFromDOM(e,t,n){for(let r=e;r;r=r.parentNode){let s=this.getDesc(r);if(s)return s.localPosFromDOM(e,t,n)}return -1}descAt(e){for(let t=0,n=0;t<this.children.length;t++){let r=this.children[t],s=n+r.size;if(n==e&&s!=n){for(;!r.border&&r.children.length;)for(let e=0;e<r.children.length;e++){let t=r.children[e];if(t.size){r=t;break}}return r}if(e<s)return r.descAt(e-n-r.border);n=s}}domFromPos(e,t){if(!this.contentDOM)return{node:this.dom,offset:0,atom:e+1};let n=0,r=0;for(let t=0;n<this.children.length;n++){let s=this.children[n],i=t+s.size;if(i>e||s instanceof ig){r=e-t;break}t=i}if(r)return this.children[n].domFromPos(r-this.children[n].border,t);for(let e;n&&!(e=this.children[n-1]).size&&e instanceof ic&&e.side>=0;n--);if(t<=0){let e,r=!0;for(;(e=n?this.children[n-1]:null)&&e.dom.parentNode!=this.contentDOM;n--,r=!1);return e&&t&&r&&!e.border&&!e.domAtom?e.domFromPos(e.size,t):{node:this.contentDOM,offset:e?sN(e.dom)+1:0}}{let e,r=!0;for(;(e=n<this.children.length?this.children[n]:null)&&e.dom.parentNode!=this.contentDOM;n++,r=!1);return e&&r&&!e.border&&!e.domAtom?e.domFromPos(0,t):{node:this.contentDOM,offset:e?sN(e.dom):this.contentDOM.childNodes.length}}}parseRange(e,t,n=0){if(0==this.children.length)return{node:this.contentDOM,from:e,to:t,fromOffset:0,toOffset:this.contentDOM.childNodes.length};let r=-1,s=-1;for(let i=n,o=0;;o++){let n=this.children[o],a=i+n.size;if(-1==r&&e<=a){let s=i+n.border;if(e>=s&&t<=a-n.border&&n.node&&n.contentDOM&&this.contentDOM.contains(n.contentDOM))return n.parseRange(e,t,s);e=i;for(let t=o;t>0;t--){let n=this.children[t-1];if(n.size&&n.dom.parentNode==this.contentDOM&&!n.emptyChildAt(1)){r=sN(n.dom)+1;break}e-=n.size}-1==r&&(r=0)}if(r>-1&&(a>t||o==this.children.length-1)){t=a;for(let e=o+1;e<this.children.length;e++){let n=this.children[e];if(n.size&&n.dom.parentNode==this.contentDOM&&!n.emptyChildAt(-1)){s=sN(n.dom);break}t+=n.size}-1==s&&(s=this.contentDOM.childNodes.length);break}i=a}return{node:this.contentDOM,from:e,to:t,fromOffset:r,toOffset:s}}emptyChildAt(e){if(this.border||!this.contentDOM||!this.children.length)return!1;let t=this.children[e<0?0:this.children.length-1];return 0==t.size||t.emptyChildAt(e)}domAfterPos(e){let{node:t,offset:n}=this.domFromPos(e,0);if(1!=t.nodeType||n==t.childNodes.length)throw RangeError("No node after pos "+e);return t.childNodes[n]}setSelection(e,t,n,r=!1){let s=Math.min(e,t),i=Math.max(e,t);for(let o=0,a=0;o<this.children.length;o++){let l=this.children[o],c=a+l.size;if(s>a&&i<c)return l.setSelection(e-a-l.border,t-a-l.border,n,r);a=c}let o=this.domFromPos(e,e?-1:1),a=t==e?o:this.domFromPos(t,t?-1:1),l=n.root.getSelection(),c=n.domSelectionRange(),d=!1;if((sq||sJ)&&e==t){let{node:e,offset:t}=o;if(3==e.nodeType){if((d=!!(t&&"\n"==e.nodeValue[t-1]))&&t==e.nodeValue.length)for(let t=e,n;t;t=t.parentNode){if(n=t.nextSibling){"BR"==n.nodeName&&(o=a={node:n.parentNode,offset:sN(n)+1});break}let e=t.pmViewDesc;if(e&&e.node&&e.node.isBlock)break}}else{let n=e.childNodes[t-1];d=n&&("BR"==n.nodeName||"false"==n.contentEditable)}}if(sq&&c.focusNode&&c.focusNode!=a.node&&1==c.focusNode.nodeType){let e=c.focusNode.childNodes[c.focusOffset];e&&"false"==e.contentEditable&&(r=!0)}if(!(r||d&&sJ)&&sA(o.node,o.offset,c.anchorNode,c.anchorOffset)&&sA(a.node,a.offset,c.focusNode,c.focusOffset))return;let h=!1;if((l.extend||e==t)&&!d){l.collapse(o.node,o.offset);try{e!=t&&l.extend(a.node,a.offset),h=!0}catch(e){}}if(!h){if(e>t){let e=o;o=a,a=e}let n=document.createRange();n.setEnd(a.node,a.offset),n.setStart(o.node,o.offset),l.removeAllRanges(),l.addRange(n)}}ignoreMutation(e){return!this.contentDOM&&"selection"!=e.type}get contentLost(){return this.contentDOM&&this.contentDOM!=this.dom&&!this.dom.contains(this.contentDOM)}markDirty(e,t){for(let n=0,r=0;r<this.children.length;r++){let s=this.children[r],i=n+s.size;if(n==i?e<=i&&t>=n:e<i&&t>n){let r=n+s.border,o=i-s.border;if(e>=r&&t<=o){this.dirty=e==n||t==i?2:1,e==r&&t==o&&(s.contentLost||s.dom.parentNode!=this.contentDOM)?s.dirty=3:s.markDirty(e-r,t-r);return}s.dirty=s.dom!=s.contentDOM||s.dom.parentNode!=this.contentDOM||s.children.length?3:2}n=i}this.dirty=2}markParentsDirty(){let e=1;for(let t=this.parent;t;t=t.parent,e++){let n=1==e?2:1;t.dirty<n&&(t.dirty=n)}}get domAtom(){return!1}get ignoreForCoords(){return!1}get ignoreForSelection(){return!1}isText(e){return!1}}class ic extends il{constructor(e,t,n,r){let s,i=t.type.toDOM;if("function"==typeof i&&(i=i(n,()=>s?s.parent?s.parent.posBeforeChild(s):void 0:r)),!t.type.spec.raw){if(1!=i.nodeType){let e=document.createElement("span");e.appendChild(i),i=e}i.contentEditable="false",i.classList.add("ProseMirror-widget")}super(e,[],i,null),this.widget=t,this.widget=t,s=this}matchesWidget(e){return 0==this.dirty&&e.type.eq(this.widget.type)}parseRule(){return{ignore:!0}}stopEvent(e){let t=this.widget.spec.stopEvent;return!!t&&t(e)}ignoreMutation(e){return"selection"!=e.type||this.widget.spec.ignoreSelection}destroy(){this.widget.type.destroy(this.dom),super.destroy()}get domAtom(){return!0}get ignoreForSelection(){return!!this.widget.type.spec.relaxedSide}get side(){return this.widget.type.side}}class id extends il{constructor(e,t,n,r){super(e,[],t,null),this.textDOM=n,this.text=r}get size(){return this.text.length}localPosFromDOM(e,t){return e!=this.textDOM?this.posAtStart+(t?this.size:0):this.posAtStart+t}domFromPos(e){return{node:this.textDOM,offset:e}}ignoreMutation(e){return"characterData"===e.type&&e.target.nodeValue==e.oldValue}}class ih extends il{constructor(e,t,n,r,s){super(e,[],n,r),this.mark=t,this.spec=s}static create(e,t,n,r){let s=r.nodeViews[t.type.name],i=s&&s(t,r,n);return i&&i.dom||(i=rk.renderSpec(document,t.type.spec.toDOM(t,n),null,t.attrs)),new ih(e,t,i.dom,i.contentDOM||i.dom,i)}parseRule(){return 3&this.dirty||this.mark.type.spec.reparseInView?null:{mark:this.mark.type.name,attrs:this.mark.attrs,contentElement:this.contentDOM}}matchesMark(e){return 3!=this.dirty&&this.mark.eq(e)}markDirty(e,t){if(super.markDirty(e,t),0!=this.dirty){let e=this.parent;for(;!e.node;)e=e.parent;e.dirty<this.dirty&&(e.dirty=this.dirty),this.dirty=0}}slice(e,t,n){let r=ih.create(this.parent,this.mark,!0,n),s=this.children,i=this.size;t<i&&(s=iM(s,t,i,n)),e>0&&(s=iM(s,0,e,n));for(let e=0;e<s.length;e++)s[e].parent=r;return r.children=s,r}ignoreMutation(e){return this.spec.ignoreMutation?this.spec.ignoreMutation(e):super.ignoreMutation(e)}destroy(){this.spec.destroy&&this.spec.destroy(),super.destroy()}}class iu extends il{constructor(e,t,n,r,s,i,o,a,l){super(e,[],s,i),this.node=t,this.outerDeco=n,this.innerDeco=r,this.nodeDOM=o}static create(e,t,n,r,s,i){let o=s.nodeViews[t.type.name],a,l=o&&o(t,s,()=>a?a.parent?a.parent.posBeforeChild(a):void 0:i,n,r),c=l&&l.dom,d=l&&l.contentDOM;if(t.isText)if(c){if(3!=c.nodeType)throw RangeError("Text must be rendered as a DOM text node")}else c=document.createTextNode(t.text);else if(!c){let e=rk.renderSpec(document,t.type.spec.toDOM(t),null,t.attrs);({dom:c,contentDOM:d}=e)}d||t.isText||"BR"==c.nodeName||(c.hasAttribute("contenteditable")||(c.contentEditable="false"),t.type.spec.draggable&&(c.draggable=!0));let h=c;return(c=ik(c,n,t),l)?a=new ix(e,t,n,r,c,d||null,h,l,s,i+1):t.isText?new im(e,t,n,r,c,h,s):new iu(e,t,n,r,c,d||null,h,s,i+1)}parseRule(){if(this.node.type.spec.reparseInView)return null;let e={node:this.node.type.name,attrs:this.node.attrs};if("pre"==this.node.type.whitespace&&(e.preserveWhitespace="full"),this.contentDOM)if(this.contentLost){for(let t=this.children.length-1;t>=0;t--){let n=this.children[t];if(this.dom.contains(n.dom.parentNode)){e.contentElement=n.dom.parentNode;break}}e.contentElement||(e.getContent=()=>nV.empty)}else e.contentElement=this.contentDOM;else e.getContent=()=>this.node.content;return e}matchesNode(e,t,n){return 0==this.dirty&&e.eq(this.node)&&iN(t,this.outerDeco)&&n.eq(this.innerDeco)}get size(){return this.node.nodeSize}get border(){return+!this.node.isLeaf}updateChildren(e,t){let n=this.node.inlineContent,r=t,s=e.composing?this.localCompositionInfo(e,t):null,i=s&&s.pos>-1?s:null,o=s&&s.pos<0,a=new iS(this,i&&i.node,e);(function(e,t,n,r){let s=t.locals(e),i=0;if(0==s.length){for(let n=0;n<e.childCount;n++){let o=e.child(n);r(o,s,t.forChild(i,o),n),i+=o.nodeSize}return}let o=0,a=[],l=null;for(let c=0;;){let d,h,u,p;for(;o<s.length&&s[o].to==i;){let e=s[o++];e.widget&&(d?(h||(h=[d])).push(e):d=e)}if(d)if(h){h.sort(iC);for(let e=0;e<h.length;e++)n(h[e],c,!!l)}else n(d,c,!!l);if(l)p=-1,u=l,l=null;else if(c<e.childCount)p=c,u=e.child(c++);else break;for(let e=0;e<a.length;e++)a[e].to<=i&&a.splice(e--,1);for(;o<s.length&&s[o].from<=i&&s[o].to>i;)a.push(s[o++]);let f=i+u.nodeSize;if(u.isText){let e=f;o<s.length&&s[o].from<e&&(e=s[o].from);for(let t=0;t<a.length;t++)a[t].to<e&&(e=a[t].to);e<f&&(l=u.cut(e-i),u=u.cut(0,e-i),f=e,p=-1)}else for(;o<s.length&&s[o].to<f;)o++;let m=u.isInline&&!u.isLeaf?a.filter(e=>!e.inline):a.slice();r(u,m,t.forChild(i,u),p),i=f}})(this.node,this.innerDeco,(t,s,i)=>{t.spec.marks?a.syncToMarks(t.spec.marks,n,e):t.type.side>=0&&!i&&a.syncToMarks(s==this.node.childCount?nW.none:this.node.child(s).marks,n,e),a.placeWidget(t,e,r)},(t,i,l,c)=>{let d;a.syncToMarks(t.marks,n,e),a.findNodeMatch(t,i,l,c)||o&&e.state.selection.from>r&&e.state.selection.to<r+t.nodeSize&&(d=a.findIndexWithChild(s.node))>-1&&a.updateNodeAt(t,i,l,d,e)||a.updateNextNode(t,i,l,e,c,r)||a.addNode(t,i,l,e,r),r+=t.nodeSize}),a.syncToMarks([],n,e),this.node.isTextblock&&a.addTextblockHacks(),a.destroyRest(),(a.changed||2==this.dirty)&&(i&&this.protectLocalComposition(e,i),function e(t,n,r){let s=t.firstChild,i=!1;for(let o=0;o<n.length;o++){let a=n[o],l=a.dom;if(l.parentNode==t){for(;l!=s;)s=ij(s),i=!0;s=s.nextSibling}else i=!0,t.insertBefore(l,s);if(a instanceof ih){let n=s?s.previousSibling:t.lastChild;e(a.contentDOM,a.children,r),s=n?n.nextSibling:t.firstChild}}for(;s;)s=ij(s),i=!0;i&&r.trackWrites==t&&(r.trackWrites=null)}(this.contentDOM,this.children,e),sK&&function(e){if("UL"==e.nodeName||"OL"==e.nodeName){let t=e.style.cssText;e.style.cssText=t+"; list-style: square !important",window.getComputedStyle(e).listStyle,e.style.cssText=t}}(this.dom))}localCompositionInfo(e,t){let{from:n,to:r}=e.state.selection;if(!(e.state.selection instanceof si)||n<t||r>t+this.node.content.size)return null;let s=e.input.compositionNode;if(!s||!this.dom.contains(s.parentNode))return null;if(!this.node.inlineContent)return{node:s,pos:-1,text:""};{let e=s.nodeValue,i=function(e,t,n,r){for(let s=0,i=0;s<e.childCount&&i<=r;){let o=e.child(s++),a=i;if(i+=o.nodeSize,!o.isText)continue;let l=o.text;for(;s<e.childCount;){let t=e.child(s++);if(i+=t.nodeSize,!t.isText)break;l+=t.text}if(i>=n){if(i>=r&&l.slice(r-t.length-a,r-a)==t)return r-t.length;let e=a<r?l.lastIndexOf(t,r-a-1):-1;if(e>=0&&e+t.length+a>=n)return a+e;if(n==r&&l.length>=r+t.length-a&&l.slice(r-a,r-a+t.length)==t)return r}}return -1}(this.node.content,e,n-t,r-t);return i<0?null:{node:s,pos:i,text:e}}}protectLocalComposition(e,{node:t,pos:n,text:r}){if(this.getDesc(t))return;let s=t;for(;s.parentNode!=this.contentDOM;s=s.parentNode){for(;s.previousSibling;)s.parentNode.removeChild(s.previousSibling);for(;s.nextSibling;)s.parentNode.removeChild(s.nextSibling);s.pmViewDesc&&(s.pmViewDesc=void 0)}let i=new id(this,s,t,r);e.input.compositionNodes.push(i),this.children=iM(this.children,n,n+r.length,e,i)}update(e,t,n,r){return 3!=this.dirty&&!!e.sameMarkup(this.node)&&(this.updateInner(e,t,n,r),!0)}updateInner(e,t,n,r){this.updateOuterDeco(t),this.node=e,this.innerDeco=n,this.contentDOM&&this.updateChildren(r,this.posAtStart),this.dirty=0}updateOuterDeco(e){if(iN(e,this.outerDeco))return;let t=1!=this.nodeDOM.nodeType,n=this.dom;this.dom=iw(this.dom,this.nodeDOM,ib(this.outerDeco,this.node,t),ib(e,this.node,t)),this.dom!=n&&(n.pmViewDesc=void 0,this.dom.pmViewDesc=this),this.outerDeco=e}selectNode(){1==this.nodeDOM.nodeType&&this.nodeDOM.classList.add("ProseMirror-selectednode"),(this.contentDOM||!this.node.type.spec.draggable)&&(this.dom.draggable=!0)}deselectNode(){1==this.nodeDOM.nodeType&&(this.nodeDOM.classList.remove("ProseMirror-selectednode"),(this.contentDOM||!this.node.type.spec.draggable)&&this.dom.removeAttribute("draggable"))}get domAtom(){return this.node.isAtom}}function ip(e,t,n,r,s){ik(r,t,e);let i=new iu(void 0,e,t,n,r,r,r,s,0);return i.contentDOM&&i.updateChildren(s,0),i}class im extends iu{constructor(e,t,n,r,s,i,o){super(e,t,n,r,s,null,i,o,0)}parseRule(){let e=this.nodeDOM.parentNode;for(;e&&e!=this.dom&&!e.pmIsDeco;)e=e.parentNode;return{skip:e||!0}}update(e,t,n,r){return 3!=this.dirty&&(0==this.dirty||!!this.inParent())&&!!e.sameMarkup(this.node)&&(this.updateOuterDeco(t),(0!=this.dirty||e.text!=this.node.text)&&e.text!=this.nodeDOM.nodeValue&&(this.nodeDOM.nodeValue=e.text,r.trackWrites==this.nodeDOM&&(r.trackWrites=null)),this.node=e,this.dirty=0,!0)}inParent(){let e=this.parent.contentDOM;for(let t=this.nodeDOM;t;t=t.parentNode)if(t==e)return!0;return!1}domFromPos(e){return{node:this.nodeDOM,offset:e}}localPosFromDOM(e,t,n){return e==this.nodeDOM?this.posAtStart+Math.min(t,this.node.text.length):super.localPosFromDOM(e,t,n)}ignoreMutation(e){return"characterData"!=e.type&&"selection"!=e.type}slice(e,t,n){let r=this.node.cut(e,t),s=document.createTextNode(r.text);return new im(this.parent,r,this.outerDeco,this.innerDeco,s,s,n)}markDirty(e,t){super.markDirty(e,t),this.dom!=this.nodeDOM&&(0==e||t==this.nodeDOM.nodeValue.length)&&(this.dirty=3)}get domAtom(){return!1}isText(e){return this.node.text==e}}class ig extends il{parseRule(){return{ignore:!0}}matchesHack(e){return 0==this.dirty&&this.dom.nodeName==e}get domAtom(){return!0}get ignoreForCoords(){return"IMG"==this.dom.nodeName}}class ix extends iu{constructor(e,t,n,r,s,i,o,a,l,c){super(e,t,n,r,s,i,o,l,c),this.spec=a}update(e,t,n,r){if(3==this.dirty)return!1;if(this.spec.update&&(this.node.type==e.type||this.spec.multiType)){let s=this.spec.update(e,t,n);return s&&this.updateInner(e,t,n,r),s}return(!!this.contentDOM||!!e.isLeaf)&&super.update(e,t,n,r)}selectNode(){this.spec.selectNode?this.spec.selectNode():super.selectNode()}deselectNode(){this.spec.deselectNode?this.spec.deselectNode():super.deselectNode()}setSelection(e,t,n,r){this.spec.setSelection?this.spec.setSelection(e,t,n.root):super.setSelection(e,t,n,r)}destroy(){this.spec.destroy&&this.spec.destroy(),super.destroy()}stopEvent(e){return!!this.spec.stopEvent&&this.spec.stopEvent(e)}ignoreMutation(e){return this.spec.ignoreMutation?this.spec.ignoreMutation(e):super.ignoreMutation(e)}}let iy=function(e){e&&(this.nodeName=e)};iy.prototype=Object.create(null);let iv=[new iy];function ib(e,t,n){if(0==e.length)return iv;let r=n?iv[0]:new iy,s=[r];for(let i=0;i<e.length;i++){let o=e[i].type.attrs;if(o)for(let e in o.nodeName&&s.push(r=new iy(o.nodeName)),o){let i=o[e];null!=i&&(n&&1==s.length&&s.push(r=new iy(t.isInline?"span":"div")),"class"==e?r.class=(r.class?r.class+" ":"")+i:"style"==e?r.style=(r.style?r.style+";":"")+i:"nodeName"!=e&&(r[e]=i))}}return s}function iw(e,t,n,r){if(n==iv&&r==iv)return t;let s=t;for(let t=0;t<r.length;t++){let i=r[t],o=n[t];if(t){let t;o&&o.nodeName==i.nodeName&&s!=e&&(t=s.parentNode)&&t.nodeName.toLowerCase()==i.nodeName||((t=document.createElement(i.nodeName)).pmIsDeco=!0,t.appendChild(s),o=iv[0]),s=t}!function(e,t,n){for(let r in t)"class"==r||"style"==r||"nodeName"==r||r in n||e.removeAttribute(r);for(let r in n)"class"!=r&&"style"!=r&&"nodeName"!=r&&n[r]!=t[r]&&e.setAttribute(r,n[r]);if(t.class!=n.class){let r=t.class?t.class.split(" ").filter(Boolean):[],s=n.class?n.class.split(" ").filter(Boolean):[];for(let t=0;t<r.length;t++)-1==s.indexOf(r[t])&&e.classList.remove(r[t]);for(let t=0;t<s.length;t++)-1==r.indexOf(s[t])&&e.classList.add(s[t]);0==e.classList.length&&e.removeAttribute("class")}if(t.style!=n.style){if(t.style){let n=/\s*([\w\-\xa1-\uffff]+)\s*:(?:"(?:\\.|[^"])*"|'(?:\\.|[^'])*'|\(.*?\)|[^;])*/g,r;for(;r=n.exec(t.style);)e.style.removeProperty(r[1])}n.style&&(e.style.cssText+=n.style)}}(s,o||iv[0],i)}return s}function ik(e,t,n){return iw(e,e,iv,ib(t,n,1!=e.nodeType))}function iN(e,t){if(e.length!=t.length)return!1;for(let n=0;n<e.length;n++)if(!e[n].type.eq(t[n].type))return!1;return!0}function ij(e){let t=e.nextSibling;return e.parentNode.removeChild(e),t}class iS{constructor(e,t,n){this.lock=t,this.view=n,this.index=0,this.stack=[],this.changed=!1,this.top=e,this.preMatch=function(e,t){let n=t,r=n.children.length,s=e.childCount,i=new Map,o=[];n:for(;s>0;){let a;for(;;)if(r){let e=n.children[r-1];if(e instanceof ih)n=e,r=e.children.length;else{a=e,r--;break}}else if(n==t)break n;else r=n.parent.children.indexOf(n),n=n.parent;let l=a.node;if(l){if(l!=e.child(s-1))break;--s,i.set(a,s),o.push(a)}}return{index:s,matched:i,matches:o.reverse()}}(e.node.content,e)}destroyBetween(e,t){if(e!=t){for(let n=e;n<t;n++)this.top.children[n].destroy();this.top.children.splice(e,t-e),this.changed=!0}}destroyRest(){this.destroyBetween(this.index,this.top.children.length)}syncToMarks(e,t,n){let r=0,s=this.stack.length>>1,i=Math.min(s,e.length);for(;r<i&&(r==s-1?this.top:this.stack[r+1<<1]).matchesMark(e[r])&&!1!==e[r].type.spec.spanning;)r++;for(;r<s;)this.destroyRest(),this.top.dirty=0,this.index=this.stack.pop(),this.top=this.stack.pop(),s--;for(;s<e.length;){this.stack.push(this.top,this.index+1);let r=-1;for(let t=this.index;t<Math.min(this.index+3,this.top.children.length);t++){let n=this.top.children[t];if(n.matchesMark(e[s])&&!this.isLocked(n.dom)){r=t;break}}if(r>-1)r>this.index&&(this.changed=!0,this.destroyBetween(this.index,r)),this.top=this.top.children[this.index];else{let r=ih.create(this.top,e[s],t,n);this.top.children.splice(this.index,0,r),this.top=r,this.changed=!0}this.index=0,s++}}findNodeMatch(e,t,n,r){let s=-1,i;if(r>=this.preMatch.index&&(i=this.preMatch.matches[r-this.preMatch.index]).parent==this.top&&i.matchesNode(e,t,n))s=this.top.children.indexOf(i,this.index);else for(let r=this.index,i=Math.min(this.top.children.length,r+5);r<i;r++){let i=this.top.children[r];if(i.matchesNode(e,t,n)&&!this.preMatch.matched.has(i)){s=r;break}}return!(s<0)&&(this.destroyBetween(this.index,s),this.index++,!0)}updateNodeAt(e,t,n,r,s){let i=this.top.children[r];return 3==i.dirty&&i.dom==i.contentDOM&&(i.dirty=2),!!i.update(e,t,n,s)&&(this.destroyBetween(this.index,r),this.index++,!0)}findIndexWithChild(e){for(;;){let t=e.parentNode;if(!t)return -1;if(t==this.top.contentDOM){let t=e.pmViewDesc;if(t){for(let e=this.index;e<this.top.children.length;e++)if(this.top.children[e]==t)return e}return -1}e=t}}updateNextNode(e,t,n,r,s,i){for(let o=this.index;o<this.top.children.length;o++){let a=this.top.children[o];if(a instanceof iu){let l=this.preMatch.matched.get(a);if(null!=l&&l!=s)return!1;let c=a.dom,d,h=this.isLocked(c)&&!(e.isText&&a.node&&a.node.isText&&a.nodeDOM.nodeValue==e.text&&3!=a.dirty&&iN(t,a.outerDeco));if(!h&&a.update(e,t,n,r))return this.destroyBetween(this.index,o),a.dom!=c&&(this.changed=!0),this.index++,!0;if(!h&&(d=this.recreateWrapper(a,e,t,n,r,i)))return this.destroyBetween(this.index,o),this.top.children[this.index]=d,d.contentDOM&&(d.dirty=2,d.updateChildren(r,i+1),d.dirty=0),this.changed=!0,this.index++,!0;break}}return!1}recreateWrapper(e,t,n,r,s,i){if(e.dirty||t.isAtom||!e.children.length||!e.node.content.eq(t.content)||!iN(n,e.outerDeco)||!r.eq(e.innerDeco))return null;let o=iu.create(this.top,t,n,r,s,i);if(o.contentDOM)for(let t of(o.children=e.children,e.children=[],o.children))t.parent=o;return e.destroy(),o}addNode(e,t,n,r,s){let i=iu.create(this.top,e,t,n,r,s);i.contentDOM&&i.updateChildren(r,s+1),this.top.children.splice(this.index++,0,i),this.changed=!0}placeWidget(e,t,n){let r=this.index<this.top.children.length?this.top.children[this.index]:null;if(r&&r.matchesWidget(e)&&(e==r.widget||!r.widget.type.toDOM.parentNode))this.index++;else{let r=new ic(this.top,e,t,n);this.top.children.splice(this.index++,0,r),this.changed=!0}}addTextblockHacks(){let e=this.top.children[this.index-1],t=this.top;for(;e instanceof ih;)e=(t=e).children[t.children.length-1];(!e||!(e instanceof im)||/\n$/.test(e.node.text)||this.view.requiresGeckoHackNode&&/\s$/.test(e.node.text))&&((sJ||sW)&&e&&"false"==e.dom.contentEditable&&this.addHackNode("IMG",t),this.addHackNode("BR",this.top))}addHackNode(e,t){if(t==this.top&&this.index<t.children.length&&t.children[this.index].matchesHack(e))this.index++;else{let n=document.createElement(e);"IMG"==e&&(n.className="ProseMirror-separator",n.alt=""),"BR"==e&&(n.className="ProseMirror-trailingBreak");let r=new ig(this.top,[],n,null);t!=this.top?t.children.push(r):t.children.splice(this.index++,0,r),this.changed=!0}}isLocked(e){return this.lock&&(e==this.lock||1==e.nodeType&&e.contains(this.lock.parentNode))}}function iC(e,t){return e.type.side-t.type.side}function iM(e,t,n,r,s){let i=[];for(let o=0,a=0;o<e.length;o++){let l=e[o],c=a,d=a+=l.size;c>=n||d<=t?i.push(l):(c<t&&i.push(l.slice(0,t-c,r)),s&&(i.push(s),s=void 0),d>n&&i.push(l.slice(n-c,l.size,r)))}return i}function iA(e,t=null){let n=e.domSelectionRange(),r=e.state.doc;if(!n.focusNode)return null;let s=e.docView.nearestDesc(n.focusNode),i=s&&0==s.size,o=e.docView.posFromDOM(n.focusNode,n.focusOffset,1);if(o<0)return null;let a=r.resolve(o),l,c;if(sI(n)){for(l=o;s&&!s.node;)s=s.parent;let e=s.node;if(s&&e.isAtom&&sa.isSelectable(e)&&s.parent&&!(e.isInline&&function(e,t,n){for(let r=0==t,s=t==sD(e);r||s;){if(e==n)return!0;let t=sN(e);if(!(e=e.parentNode))return!1;r=r&&0==t,s=s&&t==sD(e)}}(n.focusNode,n.focusOffset,s.dom))){let e=s.posBefore;c=new sa(o==e?a:r.resolve(e))}}else{if(n instanceof e.dom.ownerDocument.defaultView.Selection&&n.rangeCount>1){let t=o,s=o;for(let r=0;r<n.rangeCount;r++){let i=n.getRangeAt(r);t=Math.min(t,e.docView.posFromDOM(i.startContainer,i.startOffset,1)),s=Math.max(s,e.docView.posFromDOM(i.endContainer,i.endOffset,-1))}if(t<0)return null;[l,o]=s==e.state.selection.anchor?[s,t]:[t,s],a=r.resolve(o)}else l=e.docView.posFromDOM(n.anchorNode,n.anchorOffset,1);if(l<0)return null}let d=r.resolve(l);if(!c){let n="pointer"==t||e.state.selection.head<a.pos&&!i?1:-1;c=i$(e,d,a,n)}return c}function iE(e){return e.editable?e.hasFocus():iB(e)&&document.activeElement&&document.activeElement.contains(e.dom)}function iT(e,t=!1){let n=e.state.selection;if(iP(e,n),iE(e)){if(!t&&e.input.mouseDown&&e.input.mouseDown.allowDefault&&sW){let t=e.domSelectionRange(),n=e.domObserver.currentSelection;if(t.anchorNode&&n.anchorNode&&sA(t.anchorNode,t.anchorOffset,n.anchorNode,n.anchorOffset)){e.input.mouseDown.delayedSelectionSync=!0,e.domObserver.setCurSelection();return}}if(e.domObserver.disconnectSelection(),e.cursorWrapper)!function(e){let t=e.domSelection(),n=document.createRange();if(!t)return;let r=e.cursorWrapper.dom,s="IMG"==r.nodeName;s?n.setStart(r.parentNode,sN(r)+1):n.setStart(r,0),n.collapse(!0),t.removeAllRanges(),t.addRange(n),!s&&!e.state.selection.visible&&sV&&s_<=11&&(r.disabled=!0,r.disabled=!1)}(e);else{var r;let s,i,o,a,{anchor:l,head:c}=n,d,h;iD&&!(n instanceof si)&&(n.$from.parent.inlineContent||(d=iO(e,n.from)),n.empty||n.$from.parent.inlineContent||(h=iO(e,n.to))),e.docView.setSelection(l,c,e,t),iD&&(d&&iR(d),h&&iR(h)),n.visible?e.dom.classList.remove("ProseMirror-hideselection"):(e.dom.classList.add("ProseMirror-hideselection"),"onselectionchange"in document&&((s=(r=e).dom.ownerDocument).removeEventListener("selectionchange",r.input.hideSelectionGuard),o=(i=r.domSelectionRange()).anchorNode,a=i.anchorOffset,s.addEventListener("selectionchange",r.input.hideSelectionGuard=()=>{(i.anchorNode!=o||i.anchorOffset!=a)&&(s.removeEventListener("selectionchange",r.input.hideSelectionGuard),setTimeout(()=>{(!iE(r)||r.state.selection.visible)&&r.dom.classList.remove("ProseMirror-hideselection")},20))})))}e.domObserver.setCurSelection(),e.domObserver.connectSelection()}}let iD=sJ||sW&&sU<63;function iO(e,t){let{node:n,offset:r}=e.docView.domFromPos(t,0),s=r<n.childNodes.length?n.childNodes[r]:null,i=r?n.childNodes[r-1]:null;if(sJ&&s&&"false"==s.contentEditable)return iI(s);if((!s||"false"==s.contentEditable)&&(!i||"false"==i.contentEditable)){if(s)return iI(s);else if(i)return iI(i)}}function iI(e){return e.contentEditable="true",sJ&&e.draggable&&(e.draggable=!1,e.wasDraggable=!0),e}function iR(e){e.contentEditable="false",e.wasDraggable&&(e.draggable=!0,e.wasDraggable=null)}function iP(e,t){if(t instanceof sa){let n=e.docView.descAt(t.from);n!=e.lastSelectedViewDesc&&(iz(e),n&&n.selectNode(),e.lastSelectedViewDesc=n)}else iz(e)}function iz(e){e.lastSelectedViewDesc&&(e.lastSelectedViewDesc.parent&&e.lastSelectedViewDesc.deselectNode(),e.lastSelectedViewDesc=void 0)}function i$(e,t,n,r){return e.someProp("createSelectionBetween",r=>r(e,t,n))||si.between(t,n,r)}function iL(e){return(!e.editable||!!e.hasFocus())&&iB(e)}function iB(e){let t=e.domSelectionRange();if(!t.anchorNode)return!1;try{return e.dom.contains(3==t.anchorNode.nodeType?t.anchorNode.parentNode:t.anchorNode)&&(e.editable||e.dom.contains(3==t.focusNode.nodeType?t.focusNode.parentNode:t.focusNode))}catch(e){return!1}}function iF(e,t){let{$anchor:n,$head:r}=e.selection,s=t>0?n.max(r):n.min(r),i=s.parent.inlineContent?s.depth?e.doc.resolve(t>0?s.after():s.before()):null:s;return i&&st.findFrom(i,t)}function iV(e,t){return e.dispatch(e.state.tr.setSelection(t).scrollIntoView()),!0}function i_(e,t,n){let r=e.state.selection;if(r instanceof si){if(n.indexOf("s")>-1){let{$head:n}=r,s=n.textOffset?null:t<0?n.nodeBefore:n.nodeAfter;if(!s||s.isText||!s.isLeaf)return!1;let i=e.state.doc.resolve(n.pos+s.nodeSize*(t<0?-1:1));return iV(e,new si(r.$anchor,i))}else if(!r.empty)return!1;else if(e.endOfTextblock(t>0?"forward":"backward")){let n=iF(e.state,t);return!!n&&n instanceof sa&&iV(e,n)}else if(!(sG&&n.indexOf("m")>-1)){let n=r.$head,s=n.textOffset?null:t<0?n.nodeBefore:n.nodeAfter,i;if(!s||s.isText)return!1;let o=t<0?n.pos-s.nodeSize:n.pos;return!!(s.isAtom||(i=e.docView.descAt(o))&&!i.contentDOM)&&(sa.isSelectable(s)?iV(e,new sa(t<0?e.state.doc.resolve(n.pos-s.nodeSize):n)):!!sZ&&iV(e,new si(e.state.doc.resolve(t<0?o:o+s.nodeSize))))}}else{if(r instanceof sa&&r.node.isInline)return iV(e,new si(t>0?r.$to:r.$from));let n=iF(e.state,t);return!!n&&iV(e,n)}}function iq(e){return 3==e.nodeType?e.nodeValue.length:e.childNodes.length}function iH(e,t){let n=e.pmViewDesc;return n&&0==n.size&&(t<0||e.nextSibling||"BR"!=e.nodeName)}function iW(e,t){return t<0?function(e){let t=e.domSelectionRange(),n=t.focusNode,r=t.focusOffset;if(!n)return;let s,i,o=!1;for(sq&&1==n.nodeType&&r<iq(n)&&iH(n.childNodes[r],-1)&&(o=!0);;)if(r>0)if(1!=n.nodeType)break;else{let e=n.childNodes[r-1];if(iH(e,-1))s=n,i=--r;else if(3==e.nodeType)r=(n=e).nodeValue.length;else break}else if(iU(n))break;else{let t=n.previousSibling;for(;t&&iH(t,-1);)s=n.parentNode,i=sN(t),t=t.previousSibling;if(t)r=iq(n=t);else{if((n=n.parentNode)==e.dom)break;r=0}}o?iJ(e,n,r):s&&iJ(e,s,i)}(e):function(e){let t,n,r=e.domSelectionRange(),s=r.focusNode,i=r.focusOffset;if(!s)return;let o=iq(s);for(;;)if(i<o){if(1!=s.nodeType)break;if(iH(s.childNodes[i],1))t=s,n=++i;else break}else if(iU(s))break;else{let r=s.nextSibling;for(;r&&iH(r,1);)t=r.parentNode,n=sN(r)+1,r=r.nextSibling;if(r)i=0,o=iq(s=r);else{if((s=s.parentNode)==e.dom)break;i=o=0}}t&&iJ(e,t,n)}(e)}function iU(e){let t=e.pmViewDesc;return t&&t.node&&t.node.isBlock}function iJ(e,t,n){if(3!=t.nodeType){let e,r;(r=function(e,t){for(;e&&t==e.childNodes.length&&!sO(e);)t=sN(e)+1,e=e.parentNode;for(;e&&t<e.childNodes.length;){let n=e.childNodes[t];if(3==n.nodeType)return n;if(1==n.nodeType&&"false"==n.contentEditable)break;e=n,t=0}}(t,n))?(t=r,n=0):(e=function(e,t){for(;e&&!t&&!sO(e);)t=sN(e),e=e.parentNode;for(;e&&t;){let n=e.childNodes[t-1];if(3==n.nodeType)return n;if(1==n.nodeType&&"false"==n.contentEditable)break;t=(e=n).childNodes.length}}(t,n))&&(t=e,n=e.nodeValue.length)}let r=e.domSelection();if(!r)return;if(sI(r)){let e=document.createRange();e.setEnd(t,n),e.setStart(t,n),r.removeAllRanges(),r.addRange(e)}else r.extend&&r.extend(t,n);e.domObserver.setCurSelection();let{state:s}=e;setTimeout(()=>{e.state==s&&iT(e)},50)}function iK(e,t){let n=e.state.doc.resolve(t);if(!(sW||sY)&&n.parent.inlineContent){let r=e.coordsAtPos(t);if(t>n.start()){let n=e.coordsAtPos(t-1),s=(n.top+n.bottom)/2;if(s>r.top&&s<r.bottom&&Math.abs(n.left-r.left)>1)return n.left<r.left?"ltr":"rtl"}if(t<n.end()){let n=e.coordsAtPos(t+1),s=(n.top+n.bottom)/2;if(s>r.top&&s<r.bottom&&Math.abs(n.left-r.left)>1)return n.left>r.left?"ltr":"rtl"}}return"rtl"==getComputedStyle(e.dom).direction?"rtl":"ltr"}function iG(e,t,n){let r=e.state.selection;if(r instanceof si&&!r.empty||n.indexOf("s")>-1||sG&&n.indexOf("m")>-1)return!1;let{$from:s,$to:i}=r;if(!s.parent.inlineContent||e.endOfTextblock(t<0?"up":"down")){let n=iF(e.state,t);if(n&&n instanceof sa)return iV(e,n)}if(!s.parent.inlineContent){let n=t<0?s:i,o=r instanceof sc?st.near(n,t):st.findFrom(n,t);return!!o&&iV(e,o)}return!1}function iY(e,t){if(!(e.state.selection instanceof si))return!0;let{$head:n,$anchor:r,empty:s}=e.state.selection;if(!n.sameParent(r))return!0;if(!s)return!1;if(e.endOfTextblock(t>0?"forward":"backward"))return!0;let i=!n.textOffset&&(t<0?n.nodeBefore:n.nodeAfter);if(i&&!i.isText){let r=e.state.tr;return t<0?r.delete(n.pos-i.nodeSize,n.pos):r.delete(n.pos,n.pos+i.nodeSize),e.dispatch(r),!0}return!1}function iX(e,t,n){e.domObserver.stop(),t.contentEditable=n,e.domObserver.start()}function iZ(e,t){e.someProp("transformCopied",n=>{t=n(t,e)});let n=[],{content:r,openStart:s,openEnd:i}=t;for(;s>1&&i>1&&1==r.childCount&&1==r.firstChild.childCount;){s--,i--;let e=r.firstChild;n.push(e.type.name,e.attrs!=e.type.defaultAttrs?e.attrs:null),r=e.content}let o=e.someProp("clipboardSerializer")||rk.fromSchema(e.state.schema),a=i6(),l=a.createElement("div");l.appendChild(o.serializeFragment(r,{document:a}));let c=l.firstChild,d,h=0;for(;c&&1==c.nodeType&&(d=i5[c.nodeName.toLowerCase()]);){for(let e=d.length-1;e>=0;e--){let t=a.createElement(d[e]);for(;l.firstChild;)t.appendChild(l.firstChild);l.appendChild(t),h++}c=l.firstChild}return c&&1==c.nodeType&&c.setAttribute("data-pm-slice",`${s} ${i}${h?` -${h}`:""} ${JSON.stringify(n)}`),{dom:l,text:e.someProp("clipboardTextSerializer",n=>n(t,e))||t.content.textBetween(0,t.content.size,"\n\n"),slice:t}}function iQ(e,t,n,r,s){let i,o,a=s.parent.type.spec.code;if(!n&&!t)return null;let l=t&&(r||a||!n);if(l){if(e.someProp("transformPastedText",n=>{t=n(t,a||r,e)}),a)return t?new nJ(nV.from(e.state.schema.text(t.replace(/\r\n?/g,"\n"))),0,0):nJ.empty;let n=e.someProp("clipboardTextParser",n=>n(t,s,r,e));if(n)o=n;else{let n=s.marks(),{schema:r}=e.state,o=rk.fromSchema(r);i=document.createElement("div"),t.split(/(?:\r\n?|\n)+/).forEach(e=>{let t=i.appendChild(document.createElement("p"));e&&t.appendChild(o.serializeNode(r.text(e,n)))})}}else e.someProp("transformPastedHTML",t=>{n=t(n,e)}),i=function(e){var t;let n,r=/^(\s*<meta [^>]*>)*/.exec(e);r&&(e=e.slice(r[0].length));let s=i6().createElement("div"),i=/<([a-z][^>\s]+)/i.exec(e),o;if((o=i&&i5[i[1].toLowerCase()])&&(e=o.map(e=>"<"+e+">").join("")+e+o.map(e=>"</"+e+">").reverse().join("")),s.innerHTML=(t=e,(n=window.trustedTypes)?(i8||(i8=n.defaultPolicy||n.createPolicy("ProseMirrorClipboard",{createHTML:e=>e})),i8.createHTML(t)):t),o)for(let e=0;e<o.length;e++)s=s.querySelector(o[e])||s;return s}(n),sZ&&function(e){let t=e.querySelectorAll(sW?"span:not([class]):not([style])":"span.Apple-converted-space");for(let n=0;n<t.length;n++){let r=t[n];1==r.childNodes.length&&"\xa0"==r.textContent&&r.parentNode&&r.parentNode.replaceChild(e.ownerDocument.createTextNode(" "),r)}}(i);let c=i&&i.querySelector("[data-pm-slice]"),d=c&&/^(\d+) (\d+)(?: -(\d+))? (.*)/.exec(c.getAttribute("data-pm-slice")||"");if(d&&d[3])for(let e=+d[3];e>0;e--){let e=i.firstChild;for(;e&&1!=e.nodeType;)e=e.nextSibling;if(!e)break;i=e}if(o||(o=(e.someProp("clipboardParser")||e.someProp("domParser")||rp.fromSchema(e.state.schema)).parseSlice(i,{preserveWhitespace:!!(l||d),context:s,ruleFromNode:e=>"BR"!=e.nodeName||e.nextSibling||!e.parentNode||i0.test(e.parentNode.nodeName)?null:{ignore:!0}})),d)o=function(e,t){if(!e.size)return e;let n=e.content.firstChild.type.schema,r;try{r=JSON.parse(t)}catch(t){return e}let{content:s,openStart:i,openEnd:o}=e;for(let e=r.length-2;e>=0;e-=2){let t=n.nodes[r[e]];if(!t||t.hasRequiredAttrs())break;s=nV.from(t.create(r[e+1],s)),i++,o++}return new nJ(s,i,o)}(i4(o,+d[1],+d[2]),d[4]);else if((o=nJ.maxOpen(function(e,t){if(e.childCount<2)return e;for(let n=t.depth;n>=0;n--){let r=t.node(n).contentMatchAt(t.index(n)),s,i=[];if(e.forEach(e=>{if(!i)return;let t=r.findWrapping(e.type),n;if(!t)return i=null;if(n=i.length&&s.length&&function e(t,n,r,s,i){if(i<t.length&&i<n.length&&t[i]==n[i]){let o=e(t,n,r,s.lastChild,i+1);if(o)return s.copy(s.content.replaceChild(s.childCount-1,o));if(s.contentMatchAt(s.childCount).matchType(i==t.length-1?r.type:t[i+1]))return s.copy(s.content.append(nV.from(i1(r,t,i+1))))}}(t,s,e,i[i.length-1],0))i[i.length-1]=n;else{i.length&&(i[i.length-1]=function e(t,n){if(0==n)return t;let r=t.content.replaceChild(t.childCount-1,e(t.lastChild,n-1)),s=t.contentMatchAt(t.childCount).fillBefore(nV.empty,!0);return t.copy(r.append(s))}(i[i.length-1],s.length));let n=i1(e,t);i.push(n),r=r.matchType(n.type),s=t}}),i)return nV.from(i)}return e}(o.content,s),!0)).openStart||o.openEnd){let e=0,t=0;for(let t=o.content.firstChild;e<o.openStart&&!t.type.spec.isolating;e++,t=t.firstChild);for(let e=o.content.lastChild;t<o.openEnd&&!e.type.spec.isolating;t++,e=e.lastChild);o=i4(o,e,t)}return e.someProp("transformPasted",t=>{o=t(o,e)}),o}let i0=/^(a|abbr|acronym|b|cite|code|del|em|i|ins|kbd|label|output|q|ruby|s|samp|span|strong|sub|sup|time|u|tt|var)$/i;function i1(e,t,n=0){for(let r=t.length-1;r>=n;r--)e=t[r].create(null,nV.from(e));return e}function i2(e,t,n,r,s,i){let o=t<0?e.firstChild:e.lastChild,a=o.content;return e.childCount>1&&(i=0),s<r-1&&(a=i2(a,t,n,r,s+1,i)),s>=n&&(a=t<0?o.contentMatchAt(0).fillBefore(a,i<=s).append(a):a.append(o.contentMatchAt(o.childCount).fillBefore(nV.empty,!0))),e.replaceChild(t<0?0:e.childCount-1,o.copy(a))}function i4(e,t,n){return t<e.openStart&&(e=new nJ(i2(e.content,-1,t,e.openStart,0,e.openEnd),t,e.openEnd)),n<e.openEnd&&(e=new nJ(i2(e.content,1,n,e.openEnd,0,0),e.openStart,n)),e}let i5={thead:["table"],tbody:["table"],tfoot:["table"],caption:["table"],colgroup:["table"],col:["table","colgroup"],tr:["table","tbody"],td:["table","tbody","tr"],th:["table","tbody","tr"]},i3=null;function i6(){return i3||(i3=document.implementation.createHTMLDocument("title"))}let i8=null,i7={},i9={},oe={touchstart:!0,touchmove:!0};class ot{constructor(){this.shiftKey=!1,this.mouseDown=null,this.lastKeyCode=null,this.lastKeyCodeTime=0,this.lastClick={time:0,x:0,y:0,type:"",button:0},this.lastSelectionOrigin=null,this.lastSelectionTime=0,this.lastIOSEnter=0,this.lastIOSEnterFallbackTimeout=-1,this.lastFocus=0,this.lastTouch=0,this.lastChromeDelete=0,this.composing=!1,this.compositionNode=null,this.composingTimeout=-1,this.compositionNodes=[],this.compositionEndedAt=-2e8,this.compositionID=1,this.compositionPendingChanges=0,this.domChangeCount=0,this.eventHandlers=Object.create(null),this.hideSelectionGuard=null}}function on(e,t){e.input.lastSelectionOrigin=t,e.input.lastSelectionTime=Date.now()}function or(e){e.someProp("handleDOMEvents",t=>{for(let n in t)e.input.eventHandlers[n]||e.dom.addEventListener(n,e.input.eventHandlers[n]=t=>oi(e,t))})}function oi(e,t){return e.someProp("handleDOMEvents",n=>{let r=n[t.type];return!!r&&(r(e,t)||t.defaultPrevented)})}function oo(e){return{left:e.clientX,top:e.clientY}}function oa(e,t,n,r,s){if(-1==r)return!1;let i=e.state.doc.resolve(r);for(let r=i.depth+1;r>0;r--)if(e.someProp(t,t=>r>i.depth?t(e,n,i.nodeAfter,i.before(r),s,!0):t(e,n,i.node(r),i.before(r),s,!1)))return!0;return!1}function ol(e,t,n){if(e.focused||e.focus(),e.state.selection.eq(t))return;let r=e.state.tr.setSelection(t);"pointer"==n&&r.setMeta("pointer",!0),e.dispatch(r)}i9.keydown=(e,t)=>{if((e.input.shiftKey=16==t.keyCode||t.shiftKey,!oh(e,t))&&(e.input.lastKeyCode=t.keyCode,e.input.lastKeyCodeTime=Date.now(),!sX||!sW||13!=t.keyCode))if(229!=t.keyCode&&e.domObserver.forceFlush(),!sK||13!=t.keyCode||t.ctrlKey||t.altKey||t.metaKey)e.someProp("handleKeyDown",n=>n(e,t))||function(e,t){let n,r=t.keyCode,s=(n="",t.ctrlKey&&(n+="c"),t.metaKey&&(n+="m"),t.altKey&&(n+="a"),t.shiftKey&&(n+="s"),n);if(8==r||sG&&72==r&&"c"==s)return iY(e,-1)||iW(e,-1);if(46==r&&!t.shiftKey||sG&&68==r&&"c"==s)return iY(e,1)||iW(e,1);if(13==r||27==r)return!0;if(37==r||sG&&66==r&&"c"==s){let t=37==r?"ltr"==iK(e,e.state.selection.from)?-1:1:-1;return i_(e,t,s)||iW(e,t)}if(39==r||sG&&70==r&&"c"==s){let t=39==r?"ltr"==iK(e,e.state.selection.from)?1:-1:1;return i_(e,t,s)||iW(e,t)}else if(38==r||sG&&80==r&&"c"==s)return iG(e,-1,s)||iW(e,-1);else if(40==r||sG&&78==r&&"c"==s)return function(e){if(!sJ||e.state.selection.$head.parentOffset>0)return!1;let{focusNode:t,focusOffset:n}=e.domSelectionRange();if(t&&1==t.nodeType&&0==n&&t.firstChild&&"false"==t.firstChild.contentEditable){let n=t.firstChild;iX(e,n,"true"),setTimeout(()=>iX(e,n,"false"),20)}return!1}(e)||iG(e,1,s)||iW(e,1);else if(s==(sG?"m":"c")&&(66==r||73==r||89==r||90==r))return!0;return!1}(e,t)?t.preventDefault():on(e,"key");else{let t=Date.now();e.input.lastIOSEnter=t,e.input.lastIOSEnterFallbackTimeout=setTimeout(()=>{e.input.lastIOSEnter==t&&(e.someProp("handleKeyDown",t=>t(e,sR(13,"Enter"))),e.input.lastIOSEnter=0)},200)}},i9.keyup=(e,t)=>{16==t.keyCode&&(e.input.shiftKey=!1)},i9.keypress=(e,t)=>{if(oh(e,t)||!t.charCode||t.ctrlKey&&!t.altKey||sG&&t.metaKey)return;if(e.someProp("handleKeyPress",n=>n(e,t)))return void t.preventDefault();let n=e.state.selection;if(!(n instanceof si)||!n.$from.sameParent(n.$to)){let r=String.fromCharCode(t.charCode),s=()=>e.state.tr.insertText(r).scrollIntoView();/[\r\n]/.test(r)||e.someProp("handleTextInput",t=>t(e,n.$from.pos,n.$to.pos,r,s))||e.dispatch(s()),t.preventDefault()}};let oc=sG?"metaKey":"ctrlKey";i7.mousedown=(e,t)=>{e.input.shiftKey=t.shiftKey;let n=om(e),r=Date.now(),s="singleClick";r-e.input.lastClick.time<500&&function(e,t){let n=t.x-e.clientX,r=t.y-e.clientY;return n*n+r*r<100}(t,e.input.lastClick)&&!t[oc]&&e.input.lastClick.button==t.button&&("singleClick"==e.input.lastClick.type?s="doubleClick":"doubleClick"==e.input.lastClick.type&&(s="tripleClick")),e.input.lastClick={time:r,x:t.clientX,y:t.clientY,type:s,button:t.button};let i=e.posAtCoords(oo(t));i&&("singleClick"==s?(e.input.mouseDown&&e.input.mouseDown.done(),e.input.mouseDown=new od(e,i,t,!!n)):("doubleClick"==s?function(e,t,n,r){return oa(e,"handleDoubleClickOn",t,n,r)||e.someProp("handleDoubleClick",n=>n(e,t,r))}:function(e,t,n,r){return oa(e,"handleTripleClickOn",t,n,r)||e.someProp("handleTripleClick",n=>n(e,t,r))||function(e,t,n){if(0!=n.button)return!1;let r=e.state.doc;if(-1==t)return!!r.inlineContent&&(ol(e,si.create(r,0,r.content.size),"pointer"),!0);let s=r.resolve(t);for(let t=s.depth+1;t>0;t--){let n=t>s.depth?s.nodeAfter:s.node(t),i=s.before(t);if(n.inlineContent)ol(e,si.create(r,i+1,i+1+n.content.size),"pointer");else{if(!sa.isSelectable(n))continue;ol(e,sa.create(r,i),"pointer")}return!0}}(e,n,r)})(e,i.pos,i.inside,t)?t.preventDefault():on(e,"pointer"))};class od{constructor(e,t,n,r){let s,i;if(this.view=e,this.pos=t,this.event=n,this.flushed=r,this.delayedSelectionSync=!1,this.mightDrag=null,this.startDoc=e.state.doc,this.selectNode=!!n[oc],this.allowDefault=n.shiftKey,t.inside>-1)s=e.state.doc.nodeAt(t.inside),i=t.inside;else{let n=e.state.doc.resolve(t.pos);s=n.parent,i=n.depth?n.before():0}let o=r?null:n.target,a=o?e.docView.nearestDesc(o,!0):null;this.target=a&&1==a.dom.nodeType?a.dom:null;let{selection:l}=e.state;(0==n.button&&s.type.spec.draggable&&!1!==s.type.spec.selectable||l instanceof sa&&l.from<=i&&l.to>i)&&(this.mightDrag={node:s,pos:i,addAttr:!!(this.target&&!this.target.draggable),setUneditable:!!(this.target&&sq&&!this.target.hasAttribute("contentEditable"))}),this.target&&this.mightDrag&&(this.mightDrag.addAttr||this.mightDrag.setUneditable)&&(this.view.domObserver.stop(),this.mightDrag.addAttr&&(this.target.draggable=!0),this.mightDrag.setUneditable&&setTimeout(()=>{this.view.input.mouseDown==this&&this.target.setAttribute("contentEditable","false")},20),this.view.domObserver.start()),e.root.addEventListener("mouseup",this.up=this.up.bind(this)),e.root.addEventListener("mousemove",this.move=this.move.bind(this)),on(e,"pointer")}done(){this.view.root.removeEventListener("mouseup",this.up),this.view.root.removeEventListener("mousemove",this.move),this.mightDrag&&this.target&&(this.view.domObserver.stop(),this.mightDrag.addAttr&&this.target.removeAttribute("draggable"),this.mightDrag.setUneditable&&this.target.removeAttribute("contentEditable"),this.view.domObserver.start()),this.delayedSelectionSync&&setTimeout(()=>iT(this.view)),this.view.input.mouseDown=null}up(e){if(this.done(),!this.view.dom.contains(e.target))return;let t=this.pos;if(this.view.state.doc!=this.startDoc&&(t=this.view.posAtCoords(oo(e))),this.updateAllowDefault(e),this.allowDefault||!t)on(this.view,"pointer");else{var n,r,s,i;(n=this.view,r=t.pos,s=t.inside,i=this.selectNode,oa(n,"handleClickOn",r,s,e)||n.someProp("handleClick",t=>t(n,r,e))||(i?function(e,t){if(-1==t)return!1;let n=e.state.selection,r,s;n instanceof sa&&(r=n.node);let i=e.state.doc.resolve(t);for(let e=i.depth+1;e>0;e--){let t=e>i.depth?i.nodeAfter:i.node(e);if(sa.isSelectable(t)){s=r&&n.$from.depth>0&&e>=n.$from.depth&&i.before(n.$from.depth+1)==n.$from.pos?i.before(n.$from.depth):i.before(e);break}}return null!=s&&(ol(e,sa.create(e.state.doc,s),"pointer"),!0)}(n,s):function(e,t){if(-1==t)return!1;let n=e.state.doc.resolve(t),r=n.nodeAfter;return!!(r&&r.isAtom&&sa.isSelectable(r))&&(ol(e,new sa(n),"pointer"),!0)}(n,s)))?e.preventDefault():0==e.button&&(this.flushed||sJ&&this.mightDrag&&!this.mightDrag.node.isAtom||sW&&!this.view.state.selection.visible&&2>=Math.min(Math.abs(t.pos-this.view.state.selection.from),Math.abs(t.pos-this.view.state.selection.to)))?(ol(this.view,st.near(this.view.state.doc.resolve(t.pos)),"pointer"),e.preventDefault()):on(this.view,"pointer")}}move(e){this.updateAllowDefault(e),on(this.view,"pointer"),0==e.buttons&&this.done()}updateAllowDefault(e){!this.allowDefault&&(Math.abs(this.event.x-e.clientX)>4||Math.abs(this.event.y-e.clientY)>4)&&(this.allowDefault=!0)}}function oh(e,t){return!!e.composing||!!(sJ&&500>Math.abs(t.timeStamp-e.input.compositionEndedAt))&&(e.input.compositionEndedAt=-2e8,!0)}i7.touchstart=e=>{e.input.lastTouch=Date.now(),om(e),on(e,"pointer")},i7.touchmove=e=>{e.input.lastTouch=Date.now(),on(e,"pointer")},i7.contextmenu=e=>om(e);let ou=sX?5e3:-1;function op(e,t){clearTimeout(e.input.composingTimeout),t>-1&&(e.input.composingTimeout=setTimeout(()=>om(e),t))}function of(e){let t;for(e.composing&&(e.input.composing=!1,e.input.compositionEndedAt=((t=document.createEvent("Event")).initEvent("event",!0,!0),t.timeStamp));e.input.compositionNodes.length>0;)e.input.compositionNodes.pop().markParentsDirty()}function om(e,t=!1){if(!sX||!(e.domObserver.flushingSoon>=0)){if(e.domObserver.forceFlush(),of(e),t||e.docView&&e.docView.dirty){let n=iA(e),r=e.state.selection;return n&&!n.eq(r)?e.dispatch(e.state.tr.setSelection(n)):(e.markCursor||t)&&!r.$from.node(r.$from.sharedDepth(r.to)).inlineContent?e.dispatch(e.state.tr.deleteSelection()):e.updateState(e.state),!0}return!1}}i9.compositionstart=i9.compositionupdate=e=>{if(!e.composing){e.domObserver.flush();let{state:t}=e,n=t.selection.$to;if(t.selection instanceof si&&(t.storedMarks||!n.textOffset&&n.parentOffset&&n.nodeBefore.marks.some(e=>!1===e.type.spec.inclusive)))e.markCursor=e.state.storedMarks||n.marks(),om(e,!0),e.markCursor=null;else if(om(e,!t.selection.empty),sq&&t.selection.empty&&n.parentOffset&&!n.textOffset&&n.nodeBefore.marks.length){let t=e.domSelectionRange();for(let n=t.focusNode,r=t.focusOffset;n&&1==n.nodeType&&0!=r;){let t=r<0?n.lastChild:n.childNodes[r-1];if(!t)break;if(3==t.nodeType){let n=e.domSelection();n&&n.collapse(t,t.nodeValue.length);break}n=t,r=-1}}e.input.composing=!0}op(e,ou)},i9.compositionend=(e,t)=>{e.composing&&(e.input.composing=!1,e.input.compositionEndedAt=t.timeStamp,e.input.compositionPendingChanges=e.domObserver.pendingRecords().length?e.input.compositionID:0,e.input.compositionNode=null,e.input.compositionPendingChanges&&Promise.resolve().then(()=>e.domObserver.flush()),e.input.compositionID++,op(e,20))};let og=sV&&s_<15||sK&&sQ<604;function ox(e,t,n,r,s){let i=iQ(e,t,n,r,e.state.selection.$from);if(e.someProp("handlePaste",t=>t(e,s,i||nJ.empty)))return!0;if(!i)return!1;let o=0==i.openStart&&0==i.openEnd&&1==i.content.childCount?i.content.firstChild:null,a=o?e.state.tr.replaceSelectionWith(o,r):e.state.tr.replaceSelection(i);return e.dispatch(a.scrollIntoView().setMeta("paste",!0).setMeta("uiEvent","paste")),!0}function oy(e){let t=e.getData("text/plain")||e.getData("Text");if(t)return t;let n=e.getData("text/uri-list");return n?n.replace(/\r?\n/g," "):""}i7.copy=i9.cut=(e,t)=>{let n=e.state.selection,r="cut"==t.type;if(n.empty)return;let s=og?null:t.clipboardData,{dom:i,text:o}=iZ(e,n.content());s?(t.preventDefault(),s.clearData(),s.setData("text/html",i.innerHTML),s.setData("text/plain",o)):function(e,t){if(!e.dom.parentNode)return;let n=e.dom.parentNode.appendChild(document.createElement("div"));n.appendChild(t),n.style.cssText="position: fixed; left: -10000px; top: 10px";let r=getSelection(),s=document.createRange();s.selectNodeContents(t),e.dom.blur(),r.removeAllRanges(),r.addRange(s),setTimeout(()=>{n.parentNode&&n.parentNode.removeChild(n),e.focus()},50)}(e,i),r&&e.dispatch(e.state.tr.deleteSelection().scrollIntoView().setMeta("uiEvent","cut"))},i9.paste=(e,t)=>{if(e.composing&&!sX)return;let n=og?null:t.clipboardData,r=e.input.shiftKey&&45!=e.input.lastKeyCode;n&&ox(e,oy(n),n.getData("text/html"),r,t)?t.preventDefault():function(e,t){if(!e.dom.parentNode)return;let n=e.input.shiftKey||e.state.selection.$from.parent.type.spec.code,r=e.dom.parentNode.appendChild(document.createElement(n?"textarea":"div"));n||(r.contentEditable="true"),r.style.cssText="position: fixed; left: -10000px; top: 10px",r.focus();let s=e.input.shiftKey&&45!=e.input.lastKeyCode;setTimeout(()=>{e.focus(),r.parentNode&&r.parentNode.removeChild(r),n?ox(e,r.value,null,s,t):ox(e,r.textContent,r.innerHTML,s,t)},50)}(e,t)};class ov{constructor(e,t,n){this.slice=e,this.move=t,this.node=n}}let ob=sG?"altKey":"ctrlKey";function ow(e,t){let n=e.someProp("dragCopies",e=>!e(t));return null!=n?n:!t[ob]}for(let e in i7.dragstart=(e,t)=>{let n,r=e.input.mouseDown;if(r&&r.done(),!t.dataTransfer)return;let s=e.state.selection,i=s.empty?null:e.posAtCoords(oo(t));if(i&&i.pos>=s.from&&i.pos<=(s instanceof sa?s.to-1:s.to));else if(r&&r.mightDrag)n=sa.create(e.state.doc,r.mightDrag.pos);else if(t.target&&1==t.target.nodeType){let r=e.docView.nearestDesc(t.target,!0);r&&r.node.type.spec.draggable&&r!=e.docView&&(n=sa.create(e.state.doc,r.posBefore))}let o=(n||e.state.selection).content(),{dom:a,text:l,slice:c}=iZ(e,o);t.dataTransfer.files.length&&sW&&!(sU>120)||t.dataTransfer.clearData(),t.dataTransfer.setData(og?"Text":"text/html",a.innerHTML),t.dataTransfer.effectAllowed="copyMove",og||t.dataTransfer.setData("text/plain",l),e.dragging=new ov(c,ow(e,t),n)},i7.dragend=e=>{let t=e.dragging;window.setTimeout(()=>{e.dragging==t&&(e.dragging=null)},50)},i9.dragover=i9.dragenter=(e,t)=>t.preventDefault(),i9.drop=(e,t)=>{let n=e.dragging;if(e.dragging=null,!t.dataTransfer)return;let r=e.posAtCoords(oo(t));if(!r)return;let s=e.state.doc.resolve(r.pos),i=n&&n.slice;i?e.someProp("transformPasted",t=>{i=t(i,e)}):i=iQ(e,oy(t.dataTransfer),og?null:t.dataTransfer.getData("text/html"),!1,s);let o=!!(n&&ow(e,t));if(e.someProp("handleDrop",n=>n(e,t,i||nJ.empty,o)))return void t.preventDefault();if(!i)return;t.preventDefault();let a=i?rX(e.state.doc,s.pos,i):s.pos;null==a&&(a=s.pos);let l=e.state.tr;if(o){let{node:e}=n;e?e.replace(l):l.deleteSelection()}let c=l.mapping.map(a),d=0==i.openStart&&0==i.openEnd&&1==i.content.childCount,h=l.doc;if(d?l.replaceRangeWith(c,c,i.content.firstChild):l.replaceRange(c,c,i),l.doc.eq(h))return;let u=l.doc.resolve(c);if(d&&sa.isSelectable(i.content.firstChild)&&u.nodeAfter&&u.nodeAfter.sameMarkup(i.content.firstChild))l.setSelection(new sa(u));else{let t=l.mapping.map(a);l.mapping.maps[l.mapping.maps.length-1].forEach((e,n,r,s)=>t=s),l.setSelection(i$(e,u,l.doc.resolve(t)))}e.focus(),e.dispatch(l.setMeta("uiEvent","drop"))},i7.focus=e=>{e.input.lastFocus=Date.now(),e.focused||(e.domObserver.stop(),e.dom.classList.add("ProseMirror-focused"),e.domObserver.start(),e.focused=!0,setTimeout(()=>{e.docView&&e.hasFocus()&&!e.domObserver.currentSelection.eq(e.domSelectionRange())&&iT(e)},20))},i7.blur=(e,t)=>{e.focused&&(e.domObserver.stop(),e.dom.classList.remove("ProseMirror-focused"),e.domObserver.start(),t.relatedTarget&&e.dom.contains(t.relatedTarget)&&e.domObserver.currentSelection.clear(),e.focused=!1)},i7.beforeinput=(e,t)=>{if(sW&&sX&&"deleteContentBackward"==t.inputType){e.domObserver.flushSoon();let{domChangeCount:t}=e.input;setTimeout(()=>{if(e.input.domChangeCount!=t||(e.dom.blur(),e.focus(),e.someProp("handleKeyDown",t=>t(e,sR(8,"Backspace")))))return;let{$cursor:n}=e.state.selection;n&&n.pos>0&&e.dispatch(e.state.tr.delete(n.pos-1,n.pos).scrollIntoView())},50)}},i9)i7[e]=i9[e];function ok(e,t){if(e==t)return!0;for(let n in e)if(e[n]!==t[n])return!1;for(let n in t)if(!(n in e))return!1;return!0}class oN{constructor(e,t){this.toDOM=e,this.spec=t||oA,this.side=this.spec.side||0}map(e,t,n,r){let{pos:s,deleted:i}=e.mapResult(t.from+r,this.side<0?-1:1);return i?null:new oC(s-n,s-n,this)}valid(){return!0}eq(e){return this==e||e instanceof oN&&(this.spec.key&&this.spec.key==e.spec.key||this.toDOM==e.toDOM&&ok(this.spec,e.spec))}destroy(e){this.spec.destroy&&this.spec.destroy(e)}}class oj{constructor(e,t){this.attrs=e,this.spec=t||oA}map(e,t,n,r){let s=e.map(t.from+r,this.spec.inclusiveStart?-1:1)-n,i=e.map(t.to+r,this.spec.inclusiveEnd?1:-1)-n;return s>=i?null:new oC(s,i,this)}valid(e,t){return t.from<t.to}eq(e){return this==e||e instanceof oj&&ok(this.attrs,e.attrs)&&ok(this.spec,e.spec)}static is(e){return e.type instanceof oj}destroy(){}}class oS{constructor(e,t){this.attrs=e,this.spec=t||oA}map(e,t,n,r){let s=e.mapResult(t.from+r,1);if(s.deleted)return null;let i=e.mapResult(t.to+r,-1);return i.deleted||i.pos<=s.pos?null:new oC(s.pos-n,i.pos-n,this)}valid(e,t){let{index:n,offset:r}=e.content.findIndex(t.from),s;return r==t.from&&!(s=e.child(n)).isText&&r+s.nodeSize==t.to}eq(e){return this==e||e instanceof oS&&ok(this.attrs,e.attrs)&&ok(this.spec,e.spec)}destroy(){}}class oC{constructor(e,t,n){this.from=e,this.to=t,this.type=n}copy(e,t){return new oC(e,t,this.type)}eq(e,t=0){return this.type.eq(e.type)&&this.from+t==e.from&&this.to+t==e.to}map(e,t,n){return this.type.map(e,this,t,n)}static widget(e,t,n){return new oC(e,e,new oN(t,n))}static inline(e,t,n,r){return new oC(e,t,new oj(n,r))}static node(e,t,n,r){return new oC(e,t,new oS(n,r))}get spec(){return this.type.spec}get inline(){return this.type instanceof oj}get widget(){return this.type instanceof oN}}let oM=[],oA={};class oE{constructor(e,t){this.local=e.length?e:oM,this.children=t.length?t:oM}static create(e,t){return t.length?oP(t,e,0,oA):oT}find(e,t,n){let r=[];return this.findInner(null==e?0:e,null==t?1e9:t,r,0,n),r}findInner(e,t,n,r,s){for(let i=0;i<this.local.length;i++){let o=this.local[i];o.from<=t&&o.to>=e&&(!s||s(o.spec))&&n.push(o.copy(o.from+r,o.to+r))}for(let i=0;i<this.children.length;i+=3)if(this.children[i]<t&&this.children[i+1]>e){let o=this.children[i]+1;this.children[i+2].findInner(e-o,t-o,n,r+o,s)}}map(e,t,n){return this==oT||0==e.maps.length?this:this.mapInner(e,t,0,0,n||oA)}mapInner(e,t,n,r,s){let i;for(let o=0;o<this.local.length;o++){let a=this.local[o].map(e,n,r);a&&a.type.valid(t,a)?(i||(i=[])).push(a):s.onRemove&&s.onRemove(this.local[o].spec)}return this.children.length?function(e,t,n,r,s,i,o){let a=e.slice();for(let e=0,t=i;e<n.maps.length;e++){let r=0;n.maps[e].forEach((e,n,s,i)=>{let o=i-s-(n-e);for(let s=0;s<a.length;s+=3){let i=a[s+1];if(i<0||e>i+t-r)continue;let l=a[s]+t-r;n>=l?a[s+1]=e<=l?-2:-1:e>=t&&o&&(a[s]+=o,a[s+1]+=o)}r+=o}),t=n.maps[e].map(t,-1)}let l=!1;for(let t=0;t<a.length;t+=3)if(a[t+1]<0){if(-2==a[t+1]){l=!0,a[t+1]=-1;continue}let c=n.map(e[t]+i),d=c-s;if(d<0||d>=r.content.size){l=!0;continue}let h=n.map(e[t+1]+i,-1)-s,{index:u,offset:p}=r.content.findIndex(d),f=r.maybeChild(u);if(f&&p==d&&p+f.nodeSize==h){let r=a[t+2].mapInner(n,f,c+1,e[t]+i+1,o);r!=oT?(a[t]=d,a[t+1]=h,a[t+2]=r):(a[t+1]=-2,l=!0)}else l=!0}if(l){let l=oP(function(e,t,n,r,s,i,o){for(let a=0;a<e.length;a+=3)-1==e[a+1]&&function e(t,i){for(let e=0;e<t.local.length;e++){let a=t.local[e].map(r,s,i);a?n.push(a):o.onRemove&&o.onRemove(t.local[e].spec)}for(let n=0;n<t.children.length;n+=3)e(t.children[n+2],t.children[n]+i+1)}(e[a+2],t[a]+i+1);return n}(a,e,t,n,s,i,o),r,0,o);t=l.local;for(let e=0;e<a.length;e+=3)a[e+1]<0&&(a.splice(e,3),e-=3);for(let e=0,t=0;e<l.children.length;e+=3){let n=l.children[e];for(;t<a.length&&a[t]<n;)t+=3;a.splice(t,0,l.children[e],l.children[e+1],l.children[e+2])}}return new oE(t.sort(oz),a)}(this.children,i||[],e,t,n,r,s):i?new oE(i.sort(oz),oM):oT}add(e,t){return t.length?this==oT?oE.create(e,t):this.addInner(e,t,0):this}addInner(e,t,n){let r,s=0;e.forEach((e,i)=>{let o=i+n,a;if(a=oI(t,e,o)){for(r||(r=this.children.slice());s<r.length&&r[s]<i;)s+=3;r[s]==i?r[s+2]=r[s+2].addInner(e,a,o+1):r.splice(s,0,i,i+e.nodeSize,oP(a,e,o+1,oA)),s+=3}});let i=oO(s?oR(t):t,-n);for(let t=0;t<i.length;t++)i[t].type.valid(e,i[t])||i.splice(t--,1);return new oE(i.length?this.local.concat(i).sort(oz):this.local,r||this.children)}remove(e){return 0==e.length||this==oT?this:this.removeInner(e,0)}removeInner(e,t){let n=this.children,r=this.local;for(let r=0;r<n.length;r+=3){let s,i=n[r]+t,o=n[r+1]+t;for(let t=0,n;t<e.length;t++)(n=e[t])&&n.from>i&&n.to<o&&(e[t]=null,(s||(s=[])).push(n));if(!s)continue;n==this.children&&(n=this.children.slice());let a=n[r+2].removeInner(s,i+1);a!=oT?n[r+2]=a:(n.splice(r,3),r-=3)}if(r.length){for(let n=0,s;n<e.length;n++)if(s=e[n])for(let e=0;e<r.length;e++)r[e].eq(s,t)&&(r==this.local&&(r=this.local.slice()),r.splice(e--,1))}return n==this.children&&r==this.local?this:r.length||n.length?new oE(r,n):oT}forChild(e,t){let n,r;if(this==oT)return this;if(t.isLeaf)return oE.empty;for(let t=0;t<this.children.length;t+=3)if(this.children[t]>=e){this.children[t]==e&&(n=this.children[t+2]);break}let s=e+1,i=s+t.content.size;for(let e=0;e<this.local.length;e++){let t=this.local[e];if(t.from<i&&t.to>s&&t.type instanceof oj){let e=Math.max(s,t.from)-s,n=Math.min(i,t.to)-s;e<n&&(r||(r=[])).push(t.copy(e,n))}}if(r){let e=new oE(r.sort(oz),oM);return n?new oD([e,n]):e}return n||oT}eq(e){if(this==e)return!0;if(!(e instanceof oE)||this.local.length!=e.local.length||this.children.length!=e.children.length)return!1;for(let t=0;t<this.local.length;t++)if(!this.local[t].eq(e.local[t]))return!1;for(let t=0;t<this.children.length;t+=3)if(this.children[t]!=e.children[t]||this.children[t+1]!=e.children[t+1]||!this.children[t+2].eq(e.children[t+2]))return!1;return!0}locals(e){return o$(this.localsInner(e))}localsInner(e){if(this==oT)return oM;if(e.inlineContent||!this.local.some(oj.is))return this.local;let t=[];for(let e=0;e<this.local.length;e++)this.local[e].type instanceof oj||t.push(this.local[e]);return t}forEachSet(e){e(this)}}oE.empty=new oE([],[]),oE.removeOverlap=o$;let oT=oE.empty;class oD{constructor(e){this.members=e}map(e,t){let n=this.members.map(n=>n.map(e,t,oA));return oD.from(n)}forChild(e,t){if(t.isLeaf)return oE.empty;let n=[];for(let r=0;r<this.members.length;r++){let s=this.members[r].forChild(e,t);s!=oT&&(s instanceof oD?n=n.concat(s.members):n.push(s))}return oD.from(n)}eq(e){if(!(e instanceof oD)||e.members.length!=this.members.length)return!1;for(let t=0;t<this.members.length;t++)if(!this.members[t].eq(e.members[t]))return!1;return!0}locals(e){let t,n=!0;for(let r=0;r<this.members.length;r++){let s=this.members[r].localsInner(e);if(s.length)if(t){n&&(t=t.slice(),n=!1);for(let e=0;e<s.length;e++)t.push(s[e])}else t=s}return t?o$(n?t:t.sort(oz)):oM}static from(e){switch(e.length){case 0:return oT;case 1:return e[0];default:return new oD(e.every(e=>e instanceof oE)?e:e.reduce((e,t)=>e.concat(t instanceof oE?t:t.members),[]))}}forEachSet(e){for(let t=0;t<this.members.length;t++)this.members[t].forEachSet(e)}}function oO(e,t){if(!t||!e.length)return e;let n=[];for(let r=0;r<e.length;r++){let s=e[r];n.push(new oC(s.from+t,s.to+t,s.type))}return n}function oI(e,t,n){if(t.isLeaf)return null;let r=n+t.nodeSize,s=null;for(let t=0,i;t<e.length;t++)(i=e[t])&&i.from>n&&i.to<r&&((s||(s=[])).push(i),e[t]=null);return s}function oR(e){let t=[];for(let n=0;n<e.length;n++)null!=e[n]&&t.push(e[n]);return t}function oP(e,t,n,r){let s=[],i=!1;t.forEach((t,o)=>{let a=oI(e,t,o+n);if(a){i=!0;let e=oP(a,t,n+o+1,r);e!=oT&&s.push(o,o+t.nodeSize,e)}});let o=oO(i?oR(e):e,-n).sort(oz);for(let e=0;e<o.length;e++)o[e].type.valid(t,o[e])||(r.onRemove&&r.onRemove(o[e].spec),o.splice(e--,1));return o.length||s.length?new oE(o,s):oT}function oz(e,t){return e.from-t.from||e.to-t.to}function o$(e){let t=e;for(let n=0;n<t.length-1;n++){let r=t[n];if(r.from!=r.to)for(let s=n+1;s<t.length;s++){let i=t[s];if(i.from==r.from){i.to!=r.to&&(t==e&&(t=e.slice()),t[s]=i.copy(i.from,r.to),oL(t,s+1,i.copy(r.to,i.to)));continue}i.from<r.to&&(t==e&&(t=e.slice()),t[n]=r.copy(r.from,i.from),oL(t,s,r.copy(i.from,r.to)));break}}return t}function oL(e,t,n){for(;t<e.length&&oz(n,e[t])>0;)t++;e.splice(t,0,n)}function oB(e){let t=[];return e.someProp("decorations",n=>{let r=n(e.state);r&&r!=oT&&t.push(r)}),e.cursorWrapper&&t.push(oE.create(e.state.doc,[e.cursorWrapper.deco])),oD.from(t)}let oF={childList:!0,characterData:!0,characterDataOldValue:!0,attributes:!0,attributeOldValue:!0,subtree:!0},oV=sV&&s_<=11;class o_{constructor(){this.anchorNode=null,this.anchorOffset=0,this.focusNode=null,this.focusOffset=0}set(e){this.anchorNode=e.anchorNode,this.anchorOffset=e.anchorOffset,this.focusNode=e.focusNode,this.focusOffset=e.focusOffset}clear(){this.anchorNode=this.focusNode=null}eq(e){return e.anchorNode==this.anchorNode&&e.anchorOffset==this.anchorOffset&&e.focusNode==this.focusNode&&e.focusOffset==this.focusOffset}}class oq{constructor(e,t){this.view=e,this.handleDOMChange=t,this.queue=[],this.flushingSoon=-1,this.observer=null,this.currentSelection=new o_,this.onCharData=null,this.suppressingSelectionUpdates=!1,this.lastChangedTextNode=null,this.observer=window.MutationObserver&&new window.MutationObserver(e=>{for(let t=0;t<e.length;t++)this.queue.push(e[t]);sV&&s_<=11&&e.some(e=>"childList"==e.type&&e.removedNodes.length||"characterData"==e.type&&e.oldValue.length>e.target.nodeValue.length)?this.flushSoon():this.flush()}),oV&&(this.onCharData=e=>{this.queue.push({target:e.target,type:"characterData",oldValue:e.prevValue}),this.flushSoon()}),this.onSelectionChange=this.onSelectionChange.bind(this)}flushSoon(){this.flushingSoon<0&&(this.flushingSoon=window.setTimeout(()=>{this.flushingSoon=-1,this.flush()},20))}forceFlush(){this.flushingSoon>-1&&(window.clearTimeout(this.flushingSoon),this.flushingSoon=-1,this.flush())}start(){this.observer&&(this.observer.takeRecords(),this.observer.observe(this.view.dom,oF)),this.onCharData&&this.view.dom.addEventListener("DOMCharacterDataModified",this.onCharData),this.connectSelection()}stop(){if(this.observer){let e=this.observer.takeRecords();if(e.length){for(let t=0;t<e.length;t++)this.queue.push(e[t]);window.setTimeout(()=>this.flush(),20)}this.observer.disconnect()}this.onCharData&&this.view.dom.removeEventListener("DOMCharacterDataModified",this.onCharData),this.disconnectSelection()}connectSelection(){this.view.dom.ownerDocument.addEventListener("selectionchange",this.onSelectionChange)}disconnectSelection(){this.view.dom.ownerDocument.removeEventListener("selectionchange",this.onSelectionChange)}suppressSelectionUpdates(){this.suppressingSelectionUpdates=!0,setTimeout(()=>this.suppressingSelectionUpdates=!1,50)}onSelectionChange(){if(iL(this.view)){if(this.suppressingSelectionUpdates)return iT(this.view);if(sV&&s_<=11&&!this.view.state.selection.empty){let e=this.view.domSelectionRange();if(e.focusNode&&sA(e.focusNode,e.focusOffset,e.anchorNode,e.anchorOffset))return this.flushSoon()}this.flush()}}setCurSelection(){this.currentSelection.set(this.view.domSelectionRange())}ignoreSelectionChange(e){if(!e.focusNode)return!0;let t=new Set,n;for(let n=e.focusNode;n;n=sj(n))t.add(n);for(let r=e.anchorNode;r;r=sj(r))if(t.has(r)){n=r;break}let r=n&&this.view.docView.nearestDesc(n);if(r&&r.ignoreMutation({type:"selection",target:3==n.nodeType?n.parentNode:n}))return this.setCurSelection(),!0}pendingRecords(){if(this.observer)for(let e of this.observer.takeRecords())this.queue.push(e);return this.queue}flush(){var e;let{view:t}=this;if(!t.docView||this.flushingSoon>-1)return;let n=this.pendingRecords();n.length&&(this.queue=[]);let r=t.domSelectionRange(),s=!this.suppressingSelectionUpdates&&!this.currentSelection.eq(r)&&iL(t)&&!this.ignoreSelectionChange(r),i=-1,o=-1,a=!1,l=[];if(t.editable)for(let e=0;e<n.length;e++){let t=this.registerMutation(n[e],l);t&&(i=i<0?t.from:Math.min(t.from,i),o=o<0?t.to:Math.max(t.to,o),t.typeOver&&(a=!0))}if(sq&&l.length){let e=l.filter(e=>"BR"==e.nodeName);if(2==e.length){let[t,n]=e;t.parentNode&&t.parentNode.parentNode==n.parentNode?n.remove():t.remove()}else{let{focusNode:n}=this.currentSelection;for(let r of e){let e=r.parentNode;e&&"LI"==e.nodeName&&(!n||function(e,t){for(let n=t.parentNode;n&&n!=e.dom;n=n.parentNode){let t=e.docView.nearestDesc(n,!0);if(t&&t.node.isBlock)return n}return null}(t,n)!=e)&&r.remove()}}}let c=null;i<0&&s&&t.input.lastFocus>Date.now()-200&&Math.max(t.input.lastTouch,t.input.lastClick.time)<Date.now()-300&&sI(r)&&(c=iA(t))&&c.eq(st.near(t.state.doc.resolve(0),1))?(t.input.lastFocus=0,iT(t),this.currentSelection.set(r),t.scrollToSelection()):(i>-1||s)&&(i>-1&&(t.docView.markDirty(i,o),e=t,!oH.has(e)&&(oH.set(e,null),-1!==["normal","nowrap","pre-line"].indexOf(getComputedStyle(e.dom).whiteSpace))&&(e.requiresGeckoHackNode=sq,oW||(console.warn("ProseMirror expects the CSS white-space property to be set, preferably to 'pre-wrap'. It is recommended to load style/prosemirror.css from the prosemirror-view package."),oW=!0))),this.handleDOMChange(i,o,a,l),t.docView&&t.docView.dirty?t.updateState(t.state):this.currentSelection.eq(r)||iT(t),this.currentSelection.set(r))}registerMutation(e,t){if(t.indexOf(e.target)>-1)return null;let n=this.view.docView.nearestDesc(e.target);if("attributes"==e.type&&(n==this.view.docView||"contenteditable"==e.attributeName||"style"==e.attributeName&&!e.oldValue&&!e.target.getAttribute("style"))||!n||n.ignoreMutation(e))return null;if("childList"==e.type){for(let n=0;n<e.addedNodes.length;n++){let r=e.addedNodes[n];t.push(r),3==r.nodeType&&(this.lastChangedTextNode=r)}if(n.contentDOM&&n.contentDOM!=n.dom&&!n.contentDOM.contains(e.target))return{from:n.posBefore,to:n.posAfter};let r=e.previousSibling,s=e.nextSibling;if(sV&&s_<=11&&e.addedNodes.length)for(let t=0;t<e.addedNodes.length;t++){let{previousSibling:n,nextSibling:i}=e.addedNodes[t];(!n||0>Array.prototype.indexOf.call(e.addedNodes,n))&&(r=n),(!i||0>Array.prototype.indexOf.call(e.addedNodes,i))&&(s=i)}let i=r&&r.parentNode==e.target?sN(r)+1:0,o=n.localPosFromDOM(e.target,i,-1),a=s&&s.parentNode==e.target?sN(s):e.target.childNodes.length;return{from:o,to:n.localPosFromDOM(e.target,a,1)}}return"attributes"==e.type?{from:n.posAtStart-n.border,to:n.posAtEnd+n.border}:(this.lastChangedTextNode=e.target,{from:n.posAtStart,to:n.posAtEnd,typeOver:e.target.nodeValue==e.oldValue})}}let oH=new WeakMap,oW=!1;function oU(e,t){let n=t.startContainer,r=t.startOffset,s=t.endContainer,i=t.endOffset,o=e.domAtPos(e.state.selection.anchor);return sA(o.node,o.offset,s,i)&&([n,r,s,i]=[s,i,n,r]),{anchorNode:n,anchorOffset:r,focusNode:s,focusOffset:i}}function oJ(e){let t=e.pmViewDesc;if(t)return t.parseRule();if("BR"==e.nodeName&&e.parentNode){if(sJ&&/^(ul|ol)$/i.test(e.parentNode.nodeName)){let e=document.createElement("div");return e.appendChild(document.createElement("li")),{skip:e}}else if(e.parentNode.lastChild==e||sJ&&/^(tr|table)$/i.test(e.parentNode.nodeName))return{ignore:!0}}else if("IMG"==e.nodeName&&e.getAttribute("mark-placeholder"))return{ignore:!0};return null}let oK=/^(a|abbr|acronym|b|bd[io]|big|br|button|cite|code|data(list)?|del|dfn|em|i|ins|kbd|label|map|mark|meter|output|q|ruby|s|samp|small|span|strong|su[bp]|time|u|tt|var)$/i;function oG(e,t,n){return Math.max(n.anchor,n.head)>t.content.size?null:i$(e,t.resolve(n.anchor),t.resolve(n.head))}function oY(e,t,n){let r=e.depth,s=t?e.end():e.pos;for(;r>0&&(t||e.indexAfter(r)==e.node(r).childCount);)r--,s++,t=!1;if(n){let t=e.node(r).maybeChild(e.indexAfter(r));for(;t&&!t.isLeaf;)t=t.firstChild,s++}return s}function oX(e){if(2!=e.length)return!1;let t=e.charCodeAt(0),n=e.charCodeAt(1);return t>=56320&&t<=57343&&n>=55296&&n<=56319}class oZ{constructor(e,t){this._root=null,this.focused=!1,this.trackWrites=null,this.mounted=!1,this.markCursor=null,this.cursorWrapper=null,this.lastSelectedViewDesc=void 0,this.input=new ot,this.prevDirectPlugins=[],this.pluginViews=[],this.requiresGeckoHackNode=!1,this.dragging=null,this._props=t,this.state=t.state,this.directPlugins=t.plugins||[],this.directPlugins.forEach(o4),this.dispatch=this.dispatch.bind(this),this.dom=e&&e.mount||document.createElement("div"),e&&(e.appendChild?e.appendChild(this.dom):"function"==typeof e?e(this.dom):e.mount&&(this.mounted=!0)),this.editable=o1(this),o0(this),this.nodeViews=o2(this),this.docView=ip(this.state.doc,oQ(this),oB(this),this.dom,this),this.domObserver=new oq(this,(e,t,n,r)=>(function(e,t,n,r,s){let i,o,a,l,c=e.input.compositionPendingChanges||(e.composing?e.input.compositionID:0);if(e.input.compositionPendingChanges=0,t<0){let t=e.input.lastSelectionTime>Date.now()-50?e.input.lastSelectionOrigin:null,n=iA(e,t);if(n&&!e.state.selection.eq(n)){if(sW&&sX&&13===e.input.lastKeyCode&&Date.now()-100<e.input.lastKeyCodeTime&&e.someProp("handleKeyDown",t=>t(e,sR(13,"Enter"))))return;let r=e.state.tr.setSelection(n);"pointer"==t?r.setMeta("pointer",!0):"key"==t&&r.scrollIntoView(),c&&r.setMeta("composition",c),e.dispatch(r)}return}let d=e.state.doc.resolve(t),h=d.sharedDepth(n);t=d.before(h+1),n=e.state.doc.resolve(n).after(h+1);let u=e.state.selection,p=function(e,t,n){let r,{node:s,fromOffset:i,toOffset:o,from:a,to:l}=e.docView.parseRange(t,n),c=e.domSelectionRange(),d=c.anchorNode;if(d&&e.dom.contains(1==d.nodeType?d:d.parentNode)&&(r=[{node:d,offset:c.anchorOffset}],sI(c)||r.push({node:c.focusNode,offset:c.focusOffset})),sW&&8===e.input.lastKeyCode)for(let e=o;e>i;e--){let t=s.childNodes[e-1],n=t.pmViewDesc;if("BR"==t.nodeName&&!n){o=e;break}if(!n||n.size)break}let h=e.state.doc,u=e.someProp("domParser")||rp.fromSchema(e.state.schema),p=h.resolve(a),f=null,m=u.parse(s,{topNode:p.parent,topMatch:p.parent.contentMatchAt(p.index()),topOpen:!0,from:i,to:o,preserveWhitespace:"pre"!=p.parent.type.whitespace||"full",findPositions:r,ruleFromNode:oJ,context:p});if(r&&null!=r[0].pos){let e=r[0].pos,t=r[1]&&r[1].pos;null==t&&(t=e),f={anchor:e+a,head:t+a}}return{doc:m,sel:f,from:a,to:l}}(e,t,n),f=e.state.doc,m=f.slice(p.from,p.to);8===e.input.lastKeyCode&&Date.now()-100<e.input.lastKeyCodeTime?(i=e.state.selection.to,o="end"):(i=e.state.selection.from,o="start"),e.input.lastKeyCode=null;let g=function(e,t,n,r,s){let i=e.findDiffStart(t,n);if(null==i)return null;let{a:o,b:a}=e.findDiffEnd(t,n+e.size,n+t.size);if("end"==s){let e=Math.max(0,i-Math.min(o,a));r-=o+e-i}if(o<i&&e.size<t.size){let e=r<=i&&r>=o?i-r:0;(i-=e)&&i<t.size&&oX(t.textBetween(i-1,i+1))&&(i+=e?1:-1),a=i+(a-o),o=i}else if(a<i){let t=r<=i&&r>=a?i-r:0;(i-=t)&&i<e.size&&oX(e.textBetween(i-1,i+1))&&(i+=t?1:-1),o=i+(o-a),a=i}return{start:i,endA:o,endB:a}}(m.content,p.doc.content,p.from,i,o);if(g&&e.input.domChangeCount++,(sK&&e.input.lastIOSEnter>Date.now()-225||sX)&&s.some(e=>1==e.nodeType&&!oK.test(e.nodeName))&&(!g||g.endA>=g.endB)&&e.someProp("handleKeyDown",t=>t(e,sR(13,"Enter")))){e.input.lastIOSEnter=0;return}if(!g)if(r&&u instanceof si&&!u.empty&&u.$head.sameParent(u.$anchor)&&!e.composing&&!(p.sel&&p.sel.anchor!=p.sel.head))g={start:u.from,endA:u.to,endB:u.to};else{if(p.sel){let t=oG(e,e.state.doc,p.sel);if(t&&!t.eq(e.state.selection)){let n=e.state.tr.setSelection(t);c&&n.setMeta("composition",c),e.dispatch(n)}}return}e.state.selection.from<e.state.selection.to&&g.start==g.endB&&e.state.selection instanceof si&&(g.start>e.state.selection.from&&g.start<=e.state.selection.from+2&&e.state.selection.from>=p.from?g.start=e.state.selection.from:g.endA<e.state.selection.to&&g.endA>=e.state.selection.to-2&&e.state.selection.to<=p.to&&(g.endB+=e.state.selection.to-g.endA,g.endA=e.state.selection.to)),sV&&s_<=11&&g.endB==g.start+1&&g.endA==g.start&&g.start>p.from&&" \xa0"==p.doc.textBetween(g.start-p.from-1,g.start-p.from+1)&&(g.start--,g.endA--,g.endB--);let x=p.doc.resolveNoCache(g.start-p.from),y=p.doc.resolveNoCache(g.endB-p.from),v=f.resolve(g.start),b=x.sameParent(y)&&x.parent.inlineContent&&v.end()>=g.endA;if((sK&&e.input.lastIOSEnter>Date.now()-225&&(!b||s.some(e=>"DIV"==e.nodeName||"P"==e.nodeName))||!b&&x.pos<p.doc.content.size&&(!x.sameParent(y)||!x.parent.inlineContent)&&!/\S/.test(p.doc.textBetween(x.pos,y.pos,"",""))&&(a=st.findFrom(p.doc.resolve(x.pos+1),1,!0))&&a.head>x.pos)&&e.someProp("handleKeyDown",t=>t(e,sR(13,"Enter")))){e.input.lastIOSEnter=0;return}if(e.state.selection.anchor>g.start&&function(e,t,n,r,s){if(n-t<=s.pos-r.pos||oY(r,!0,!1)<s.pos)return!1;let i=e.resolve(t);if(!r.parent.isTextblock){let e=i.nodeAfter;return null!=e&&n==t+e.nodeSize}if(i.parentOffset<i.parent.content.size||!i.parent.isTextblock)return!1;let o=e.resolve(oY(i,!0,!0));return!(!o.parent.isTextblock||o.pos>n||oY(o,!0,!1)<n)&&r.parent.content.cut(r.parentOffset).eq(o.parent.content)}(f,g.start,g.endA,x,y)&&e.someProp("handleKeyDown",t=>t(e,sR(8,"Backspace")))){sX&&sW&&e.domObserver.suppressSelectionUpdates();return}sW&&g.endB==g.start&&(e.input.lastChromeDelete=Date.now()),sX&&!b&&x.start()!=y.start()&&0==y.parentOffset&&x.depth==y.depth&&p.sel&&p.sel.anchor==p.sel.head&&p.sel.head==g.endA&&(g.endB-=2,y=p.doc.resolveNoCache(g.endB-p.from),setTimeout(()=>{e.someProp("handleKeyDown",function(t){return t(e,sR(13,"Enter"))})},20));let w=g.start,k=g.endA,N=t=>{let n=t||e.state.tr.replace(w,k,p.doc.slice(g.start-p.from,g.endB-p.from));if(p.sel){let t=oG(e,n.doc,p.sel);t&&!(sW&&e.composing&&t.empty&&(g.start!=g.endB||e.input.lastChromeDelete<Date.now()-100)&&(t.head==w||t.head==n.mapping.map(k)-1)||sV&&t.empty&&t.head==w)&&n.setSelection(t)}return c&&n.setMeta("composition",c),n.scrollIntoView()};if(b){if(x.pos==y.pos){sV&&s_<=11&&0==x.parentOffset&&(e.domObserver.suppressSelectionUpdates(),setTimeout(()=>iT(e),20));let t=N(e.state.tr.delete(w,k)),n=f.resolve(g.start).marksAcross(f.resolve(g.endA));n&&t.ensureMarks(n),e.dispatch(t)}else if(g.endA==g.endB&&(l=function(e,t){let n=e.firstChild.marks,r=t.firstChild.marks,s=n,i=r,o,a,l;for(let e=0;e<r.length;e++)s=r[e].removeFromSet(s);for(let e=0;e<n.length;e++)i=n[e].removeFromSet(i);if(1==s.length&&0==i.length)a=s[0],o="add",l=e=>e.mark(a.addToSet(e.marks));else{if(0!=s.length||1!=i.length)return null;a=i[0],o="remove",l=e=>e.mark(a.removeFromSet(e.marks))}let c=[];for(let e=0;e<t.childCount;e++)c.push(l(t.child(e)));if(nV.from(c).eq(e))return{mark:a,type:o}}(x.parent.content.cut(x.parentOffset,y.parentOffset),v.parent.content.cut(v.parentOffset,g.endA-v.start())))){let t=N(e.state.tr);"add"==l.type?t.addMark(w,k,l.mark):t.removeMark(w,k,l.mark),e.dispatch(t)}else if(x.parent.child(x.index()).isText&&x.index()==y.index()-!y.textOffset){let t=x.parent.textBetween(x.parentOffset,y.parentOffset),n=()=>N(e.state.tr.insertText(t,w,k));e.someProp("handleTextInput",r=>r(e,w,k,t,n))||e.dispatch(n())}}else e.dispatch(N())})(this,e,t,n,r)),this.domObserver.start(),function(e){for(let t in i7){let n=i7[t];e.dom.addEventListener(t,e.input.eventHandlers[t]=t=>{!function(e,t){if(!t.bubbles)return!0;if(t.defaultPrevented)return!1;for(let n=t.target;n!=e.dom;n=n.parentNode)if(!n||11==n.nodeType||n.pmViewDesc&&n.pmViewDesc.stopEvent(t))return!1;return!0}(e,t)||oi(e,t)||!e.editable&&t.type in i9||n(e,t)},oe[t]?{passive:!0}:void 0)}sJ&&e.dom.addEventListener("input",()=>null),or(e)}(this),this.updatePluginViews()}get composing(){return this.input.composing}get props(){if(this._props.state!=this.state){let e=this._props;for(let t in this._props={},e)this._props[t]=e[t];this._props.state=this.state}return this._props}update(e){e.handleDOMEvents!=this._props.handleDOMEvents&&or(this);let t=this._props;this._props=e,e.plugins&&(e.plugins.forEach(o4),this.directPlugins=e.plugins),this.updateStateInner(e.state,t)}setProps(e){let t={};for(let e in this._props)t[e]=this._props[e];for(let n in t.state=this.state,e)t[n]=e[n];this.update(t)}updateState(e){this.updateStateInner(e,this._props)}updateStateInner(e,t){var n,r,s;let i=this.state,o=!1,a=!1;e.storedMarks&&this.composing&&(of(this),a=!0),this.state=e;let l=i.plugins!=e.plugins||this._props.plugins!=t.plugins;if(l||this._props.plugins!=t.plugins||this._props.nodeViews!=t.nodeViews){let e=o2(this);(function(e,t){let n=0,r=0;for(let r in e){if(e[r]!=t[r])return!0;n++}for(let e in t)r++;return n!=r})(e,this.nodeViews)&&(this.nodeViews=e,o=!0)}(l||t.handleDOMEvents!=this._props.handleDOMEvents)&&or(this),this.editable=o1(this),o0(this);let c=oB(this),d=oQ(this),h=i.plugins==e.plugins||i.doc.eq(e.doc)?e.scrollToSelection>i.scrollToSelection?"to selection":"preserve":"reset",u=o||!this.docView.matchesNode(e.doc,d,c);(u||!e.selection.eq(i.selection))&&(a=!0);let p="preserve"==h&&a&&null==this.dom.style.overflowAnchor&&function(e){let t,n,r=e.dom.getBoundingClientRect(),s=Math.max(0,r.top);for(let i=(r.left+r.right)/2,o=s+1;o<Math.min(innerHeight,r.bottom);o+=5){let r=e.root.elementFromPoint(i,o);if(!r||r==e.dom||!e.dom.contains(r))continue;let a=r.getBoundingClientRect();if(a.top>=s-20){t=r,n=a.top;break}}return{refDOM:t,refTop:n,stack:s2(e.dom)}}(this);if(a){let t,n,a;this.domObserver.stop();let l=u&&(sV||sW)&&!this.composing&&!i.selection.empty&&!e.selection.empty&&(r=i.selection,s=e.selection,a=Math.min(r.$anchor.sharedDepth(r.head),s.$anchor.sharedDepth(s.head)),r.$anchor.start(a)!=s.$anchor.start(a));if(u){let t=sW?this.trackWrites=this.domSelectionRange().focusNode:null;this.composing&&(this.input.compositionNode=function(e){let t=e.domSelectionRange();if(!t.focusNode)return null;let n=function(e,t){for(;;){if(3==e.nodeType&&t)return e;if(1==e.nodeType&&t>0){if("false"==e.contentEditable)return null;t=sD(e=e.childNodes[t-1])}else{if(!e.parentNode||sO(e))return null;t=sN(e),e=e.parentNode}}}(t.focusNode,t.focusOffset),r=function(e,t){for(;;){if(3==e.nodeType&&t<e.nodeValue.length)return e;if(1==e.nodeType&&t<e.childNodes.length){if("false"==e.contentEditable)return null;e=e.childNodes[t],t=0}else{if(!e.parentNode||sO(e))return null;t=sN(e)+1,e=e.parentNode}}}(t.focusNode,t.focusOffset);if(n&&r&&n!=r){let t=r.pmViewDesc,s=e.domObserver.lastChangedTextNode;if(n==s||r==s)return s;if(!t||!t.isText(r.nodeValue))return r;if(e.input.compositionNode==r){let e=n.pmViewDesc;if(!(!e||!e.isText(n.nodeValue)))return r}}return n||r}(this)),(o||!this.docView.update(e.doc,d,c,this))&&(this.docView.updateOuterDeco(d),this.docView.destroy(),this.docView=ip(e.doc,d,c,this.dom,this)),t&&!this.trackWrites&&(l=!0)}l||!(this.input.mouseDown&&this.domObserver.currentSelection.eq(this.domSelectionRange())&&(t=this.docView.domFromPos(this.state.selection.anchor,0),n=this.domSelectionRange(),sA(t.node,t.offset,n.anchorNode,n.anchorOffset)))?iT(this,l):(iP(this,e.selection),this.domObserver.setCurSelection()),this.domObserver.start()}this.updatePluginViews(i),(null==(n=this.dragging)?void 0:n.node)&&!i.doc.eq(e.doc)&&this.updateDraggedNode(this.dragging,i),"reset"==h?this.dom.scrollTop=0:"to selection"==h?this.scrollToSelection():p&&function({refDOM:e,refTop:t,stack:n}){let r=e?e.getBoundingClientRect().top:0;s4(n,0==r?0:r-t)}(p)}scrollToSelection(){let e=this.domSelectionRange().focusNode;if(e&&this.dom.contains(1==e.nodeType?e:e.parentNode))if(this.someProp("handleScrollToSelection",e=>e(this)));else if(this.state.selection instanceof sa){let t=this.docView.domAfterPos(this.state.selection.from);1==t.nodeType&&s1(this,t.getBoundingClientRect(),e)}else s1(this,this.coordsAtPos(this.state.selection.head,1),e)}destroyPluginViews(){let e;for(;e=this.pluginViews.pop();)e.destroy&&e.destroy()}updatePluginViews(e){if(e&&e.plugins==this.state.plugins&&this.directPlugins==this.prevDirectPlugins)for(let t=0;t<this.pluginViews.length;t++){let n=this.pluginViews[t];n.update&&n.update(this,e)}else{this.prevDirectPlugins=this.directPlugins,this.destroyPluginViews();for(let e=0;e<this.directPlugins.length;e++){let t=this.directPlugins[e];t.spec.view&&this.pluginViews.push(t.spec.view(this))}for(let e=0;e<this.state.plugins.length;e++){let t=this.state.plugins[e];t.spec.view&&this.pluginViews.push(t.spec.view(this))}}}updateDraggedNode(e,t){let n=e.node,r=-1;if(this.state.doc.nodeAt(n.from)==n.node)r=n.from;else{let e=n.from+(this.state.doc.content.size-t.doc.content.size);(e>0&&this.state.doc.nodeAt(e))==n.node&&(r=e)}this.dragging=new ov(e.slice,e.move,r<0?void 0:sa.create(this.state.doc,r))}someProp(e,t){let n=this._props&&this._props[e],r;if(null!=n&&(r=t?t(n):n))return r;for(let n=0;n<this.directPlugins.length;n++){let s=this.directPlugins[n].props[e];if(null!=s&&(r=t?t(s):s))return r}let s=this.state.plugins;if(s)for(let n=0;n<s.length;n++){let i=s[n].props[e];if(null!=i&&(r=t?t(i):i))return r}}hasFocus(){if(sV){let e=this.root.activeElement;if(e==this.dom)return!0;if(!e||!this.dom.contains(e))return!1;for(;e&&this.dom!=e&&this.dom.contains(e);){if("false"==e.contentEditable)return!1;e=e.parentElement}return!0}return this.root.activeElement==this.dom}focus(){this.domObserver.stop(),this.editable&&function(e){if(e.setActive)return e.setActive();if(s5)return e.focus(s5);let t=s2(e);e.focus(null==s5?{get preventScroll(){return s5={preventScroll:!0},!0}}:void 0),s5||(s5=!1,s4(t,0))}(this.dom),iT(this),this.domObserver.start()}get root(){let e=this._root;if(null==e){for(let e=this.dom.parentNode;e;e=e.parentNode)if(9==e.nodeType||11==e.nodeType&&e.host)return e.getSelection||(Object.getPrototypeOf(e).getSelection=()=>e.ownerDocument.getSelection()),this._root=e}return e||document}updateRoot(){this._root=null}posAtCoords(e){return function(e,t){var n;let r,s,i=e.dom.ownerDocument,o,a=0,l=function(e,t,n){if(e.caretPositionFromPoint)try{let r=e.caretPositionFromPoint(t,n);if(r)return{node:r.offsetNode,offset:Math.min(sD(r.offsetNode),r.offset)}}catch(e){}if(e.caretRangeFromPoint){let r=e.caretRangeFromPoint(t,n);if(r)return{node:r.startContainer,offset:Math.min(sD(r.startContainer),r.startOffset)}}}(i,t.left,t.top);l&&({node:o,offset:a}=l);let c=(e.root.elementFromPoint?e.root:i).elementFromPoint(t.left,t.top);if(!c||!e.dom.contains(1!=c.nodeType?c.parentNode:c)){let n=e.dom.getBoundingClientRect();if(!s3(t,n)||!(c=function e(t,n,r){let s=t.childNodes.length;if(s&&r.top<r.bottom)for(let i=Math.max(0,Math.min(s-1,Math.floor(s*(n.top-r.top)/(r.bottom-r.top))-2)),o=i;;){let r=t.childNodes[o];if(1==r.nodeType){let t=r.getClientRects();for(let s=0;s<t.length;s++){let i=t[s];if(s3(n,i))return e(r,n,i)}}if((o=(o+1)%s)==i)break}return t}(e.dom,t,n)))return null}if(sJ)for(let e=c;o&&e;e=sj(e))e.draggable&&(o=void 0);if(c=(r=(n=c).parentNode)&&/^li$/i.test(r.nodeName)&&t.left<n.getBoundingClientRect().left?r:n,o){let n;if(sq&&1==o.nodeType&&(a=Math.min(a,o.childNodes.length))<o.childNodes.length){let e=o.childNodes[a],n;"IMG"==e.nodeName&&(n=e.getBoundingClientRect()).right<=t.left&&n.bottom>t.top&&a++}sZ&&a&&1==o.nodeType&&1==(n=o.childNodes[a-1]).nodeType&&"false"==n.contentEditable&&n.getBoundingClientRect().top>=t.top&&a--,o==e.dom&&a==o.childNodes.length-1&&1==o.lastChild.nodeType&&t.top>o.lastChild.getBoundingClientRect().bottom?s=e.state.doc.content.size:(0==a||1!=o.nodeType||"BR"!=o.childNodes[a-1].nodeName)&&(s=function(e,t,n,r){let s=-1;for(let n=t,i=!1;n!=e.dom;){let t=e.docView.nearestDesc(n,!0),o;if(!t)return null;if(1==t.dom.nodeType&&(t.node.isBlock&&t.parent||!t.contentDOM)&&((o=t.dom.getBoundingClientRect()).width||o.height)&&(t.node.isBlock&&t.parent&&(!i&&o.left>r.left||o.top>r.top?s=t.posBefore:(!i&&o.right<r.left||o.bottom<r.top)&&(s=t.posAfter),i=!0),!t.contentDOM&&s<0&&!t.node.isText))return(t.node.isBlock?r.top<(o.top+o.bottom)/2:r.left<(o.left+o.right)/2)?t.posBefore:t.posAfter;n=t.dom.parentNode}return s>-1?s:e.docView.posFromDOM(t,n,-1)}(e,o,a,t))}null==s&&(s=function(e,t,n){let{node:r,offset:s}=function e(t,n){let r,s,i,o=2e8,a,l=0,c=n.top,d=n.top;for(let e=t.firstChild,h=0;e;e=e.nextSibling,h++){let t;if(1==e.nodeType)t=e.getClientRects();else{if(3!=e.nodeType)continue;t=sC(e).getClientRects()}for(let u=0;u<t.length;u++){let p=t[u];if(p.top<=c&&p.bottom>=d){c=Math.max(p.bottom,c),d=Math.min(p.top,d);let t=p.left>n.left?p.left-n.left:p.right<n.left?n.left-p.right:0;if(t<o){i=e,o=t,a=t&&3==i.nodeType?{left:p.right<n.left?p.right:p.left,top:n.top}:n,1==e.nodeType&&t&&(l=h+ +(n.left>=(p.left+p.right)/2));continue}}else p.top>n.top&&!r&&p.left<=n.left&&p.right>=n.left&&(r=e,s={left:Math.max(p.left,Math.min(p.right,n.left)),top:p.top});!i&&(n.left>=p.right&&n.top>=p.top||n.left>=p.left&&n.top>=p.bottom)&&(l=h+1)}}return(!i&&r&&(i=r,a=s,o=0),i&&3==i.nodeType)?function(e,t){let n=e.nodeValue.length,r=document.createRange();for(let s=0;s<n;s++){r.setEnd(e,s+1),r.setStart(e,s);let n=s8(r,1);if(n.top!=n.bottom&&s3(t,n))return{node:e,offset:s+ +(t.left>=(n.left+n.right)/2)}}return{node:e,offset:0}}(i,a):!i||o&&1==i.nodeType?{node:t,offset:l}:e(i,a)}(t,n),i=-1;if(1==r.nodeType&&!r.firstChild){let e=r.getBoundingClientRect();i=e.left!=e.right&&n.left>(e.left+e.right)/2?1:-1}return e.docView.posFromDOM(r,s,i)}(e,c,t));let d=e.docView.nearestDesc(c,!0);return{pos:s,inside:d?d.posAtStart-d.border:-1}}(this,e)}coordsAtPos(e,t=1){return s9(this,e,t)}domAtPos(e,t=0){return this.docView.domFromPos(e,t)}nodeDOM(e){let t=this.docView.descAt(e);return t?t.nodeDOM:null}posAtDOM(e,t,n=-1){let r=this.docView.posFromDOM(e,t,n);if(null==r)throw RangeError("DOM position not inside the editor");return r}endOfTextblock(e,t){return function(e,t,n){let r,s;return ii==t&&io==n?ia:(ii=t,io=n,ia="up"==n||"down"==n?(r=t.selection,s="up"==n?r.$from:r.$to,ir(e,t,()=>{let{node:t}=e.docView.domFromPos(s.pos,"up"==n?-1:1);for(;;){let n=e.docView.nearestDesc(t,!0);if(!n)break;if(n.node.isBlock){t=n.contentDOM||n.dom;break}t=n.dom.parentNode}let r=s9(e,s.pos,1);for(let e=t.firstChild;e;e=e.nextSibling){let t;if(1==e.nodeType)t=e.getClientRects();else{if(3!=e.nodeType)continue;t=sC(e,0,e.nodeValue.length).getClientRects()}for(let e=0;e<t.length;e++){let s=t[e];if(s.bottom>s.top+1&&("up"==n?r.top-s.top>(s.bottom-r.top)*2:s.bottom-r.bottom>(r.bottom-s.top)*2))return!1}}return!0})):function(e,t,n){let{$head:r}=t.selection;if(!r.parent.isTextblock)return!1;let s=r.parentOffset,i=s==r.parent.content.size,o=e.domSelection();return o?is.test(r.parent.textContent)&&o.modify?ir(e,t,()=>{let{focusNode:t,focusOffset:s,anchorNode:i,anchorOffset:a}=e.domSelectionRange(),l=o.caretBidiLevel;o.modify("move",n,"character");let c=r.depth?e.docView.domAfterPos(r.before()):e.dom,{focusNode:d,focusOffset:h}=e.domSelectionRange(),u=d&&!c.contains(1==d.nodeType?d:d.parentNode)||t==d&&s==h;try{o.collapse(i,a),t&&(t!=i||s!=a)&&o.extend&&o.extend(t,s)}catch(e){}return null!=l&&(o.caretBidiLevel=l),u}):"left"==n||"backward"==n?!s:i:r.pos==r.start()||r.pos==r.end()}(e,t,n))}(this,t||this.state,e)}pasteHTML(e,t){return ox(this,"",e,!1,t||new ClipboardEvent("paste"))}pasteText(e,t){return ox(this,e,null,!0,t||new ClipboardEvent("paste"))}serializeForClipboard(e){return iZ(this,e)}destroy(){if(this.docView){for(let e in this.domObserver.stop(),this.input.eventHandlers)this.dom.removeEventListener(e,this.input.eventHandlers[e]);clearTimeout(this.input.composingTimeout),clearTimeout(this.input.lastIOSEnterFallbackTimeout),this.destroyPluginViews(),this.mounted?(this.docView.update(this.state.doc,[],oB(this),this),this.dom.textContent=""):this.dom.parentNode&&this.dom.parentNode.removeChild(this.dom),this.docView.destroy(),this.docView=null,sM()}}get isDestroyed(){return null==this.docView}dispatchEvent(e){!oi(this,e)&&i7[e.type]&&(this.editable||!(e.type in i9))&&i7[e.type](this,e)}domSelectionRange(){let e=this.domSelection();return e?sJ&&11===this.root.nodeType&&function(e){let t=e.activeElement;for(;t&&t.shadowRoot;)t=t.shadowRoot.activeElement;return t}(this.dom.ownerDocument)==this.dom&&function(e,t){let n;if(t.getComposedRanges){let n=t.getComposedRanges(e.root)[0];if(n)return oU(e,n)}function r(e){e.preventDefault(),e.stopImmediatePropagation(),n=e.getTargetRanges()[0]}return e.dom.addEventListener("beforeinput",r,!0),document.execCommand("indent"),e.dom.removeEventListener("beforeinput",r,!0),n?oU(e,n):null}(this,e)||e:{focusNode:null,focusOffset:0,anchorNode:null,anchorOffset:0}}domSelection(){return this.root.getSelection()}}function oQ(e){let t=Object.create(null);return t.class="ProseMirror",t.contenteditable=String(e.editable),e.someProp("attributes",n=>{if("function"==typeof n&&(n=n(e.state)),n)for(let e in n)"class"==e?t.class+=" "+n[e]:"style"==e?t.style=(t.style?t.style+";":"")+n[e]:t[e]||"contenteditable"==e||"nodeName"==e||(t[e]=String(n[e]))}),t.translate||(t.translate="no"),[oC.node(0,e.state.doc.content.size,t)]}function o0(e){if(e.markCursor){let t=document.createElement("img");t.className="ProseMirror-separator",t.setAttribute("mark-placeholder","true"),t.setAttribute("alt",""),e.cursorWrapper={dom:t,deco:oC.widget(e.state.selection.from,t,{raw:!0,marks:e.markCursor})}}else e.cursorWrapper=null}function o1(e){return!e.someProp("editable",t=>!1===t(e.state))}function o2(e){let t=Object.create(null);function n(e){for(let n in e)Object.prototype.hasOwnProperty.call(t,n)||(t[n]=e[n])}return e.someProp("nodeViews",n),e.someProp("markViews",n),t}function o4(e){if(e.spec.state||e.spec.filterTransaction||e.spec.appendTransaction)throw RangeError("Plugins passed directly to the view must not have a state component")}oZ.prototype.dispatch=function(e){let t=this._props.dispatchTransaction;t?t.call(this,e):this.updateState(this.state.apply(e))};for(var o5={8:"Backspace",9:"Tab",10:"Enter",12:"NumLock",13:"Enter",16:"Shift",17:"Control",18:"Alt",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",44:"PrintScreen",45:"Insert",46:"Delete",59:";",61:"=",91:"Meta",92:"Meta",106:"*",107:"+",108:",",109:"-",110:".",111:"/",144:"NumLock",145:"ScrollLock",160:"Shift",161:"Shift",162:"Control",163:"Control",164:"Alt",165:"Alt",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},o3={48:")",49:"!",50:"@",51:"#",52:"$",53:"%",54:"^",55:"&",56:"*",57:"(",59:":",61:"+",173:"_",186:":",187:"+",188:"<",189:"_",190:">",191:"?",192:"~",219:"{",220:"|",221:"}",222:'"'},o6="undefined"!=typeof navigator&&/Mac/.test(navigator.platform),o8="undefined"!=typeof navigator&&/MSIE \d|Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(navigator.userAgent),o7=0;o7<10;o7++)o5[48+o7]=o5[96+o7]=String(o7);for(var o7=1;o7<=24;o7++)o5[o7+111]="F"+o7;for(var o7=65;o7<=90;o7++)o5[o7]=String.fromCharCode(o7+32),o3[o7]=String.fromCharCode(o7);for(var o9 in o5)o3.hasOwnProperty(o9)||(o3[o9]=o5[o9]);let ae="undefined"!=typeof navigator&&/Mac|iP(hone|[oa]d)/.test(navigator.platform),at="undefined"!=typeof navigator&&/Win/.test(navigator.platform);function an(e,t,n=!0){return t.altKey&&(e="Alt-"+e),t.ctrlKey&&(e="Ctrl-"+e),t.metaKey&&(e="Meta-"+e),n&&t.shiftKey&&(e="Shift-"+e),e}function ar(e){let t=function(e){let t=Object.create(null);for(let n in e)t[function(e){let t,n,r,s,i=e.split(/-(?!$)/),o=i[i.length-1];"Space"==o&&(o=" ");for(let e=0;e<i.length-1;e++){let o=i[e];if(/^(cmd|meta|m)$/i.test(o))s=!0;else if(/^a(lt)?$/i.test(o))t=!0;else if(/^(c|ctrl|control)$/i.test(o))n=!0;else if(/^s(hift)?$/i.test(o))r=!0;else if(/^mod$/i.test(o))ae?s=!0:n=!0;else throw Error("Unrecognized modifier name: "+o)}return t&&(o="Alt-"+o),n&&(o="Ctrl-"+o),s&&(o="Meta-"+o),r&&(o="Shift-"+o),o}(n)]=e[n];return t}(e);return function(e,n){var r;let s=("Esc"==(r=!(o6&&n.metaKey&&n.shiftKey&&!n.ctrlKey&&!n.altKey||o8&&n.shiftKey&&n.key&&1==n.key.length||"Unidentified"==n.key)&&n.key||(n.shiftKey?o3:o5)[n.keyCode]||n.key||"Unidentified")&&(r="Escape"),"Del"==r&&(r="Delete"),"Left"==r&&(r="ArrowLeft"),"Up"==r&&(r="ArrowUp"),"Right"==r&&(r="ArrowRight"),"Down"==r&&(r="ArrowDown"),r),i,o=t[an(s,n)];if(o&&o(e.state,e.dispatch,e))return!0;if(1==s.length&&" "!=s){if(n.shiftKey){let r=t[an(s,n,!1)];if(r&&r(e.state,e.dispatch,e))return!0}if((n.altKey||n.metaKey||n.ctrlKey)&&!(at&&n.ctrlKey&&n.altKey)&&(i=o5[n.keyCode])&&i!=s){let r=t[an(i,n)];if(r&&r(e.state,e.dispatch,e))return!0}}return!1}}let as=(e,t)=>!e.selection.empty&&(t&&t(e.tr.deleteSelection().scrollIntoView()),!0);function ai(e,t){let{$cursor:n}=e.selection;return n&&(t?t.endOfTextblock("backward",e):!(n.parentOffset>0))?n:null}let ao=(e,t,n)=>{let r=ai(e,n);if(!r)return!1;let s=au(r);if(!s){let n=r.blockRange(),s=n&&r_(n);return null!=s&&(t&&t(e.tr.lift(n,s).scrollIntoView()),!0)}let i=s.nodeBefore;if(aC(e,s,t,-1))return!0;if(0==r.parent.content.size&&(ad(i,"end")||sa.isSelectable(i)))for(let n=r.depth;;n--){let o=rZ(e.doc,r.before(n),r.after(n),nJ.empty);if(o&&o.slice.size<o.to-o.from){if(t){let n=e.tr.step(o);n.setSelection(ad(i,"end")?st.findFrom(n.doc.resolve(n.mapping.map(s.pos,-1)),-1):sa.create(n.doc,s.pos-i.nodeSize)),t(n.scrollIntoView())}return!0}if(1==n||r.node(n-1).childCount>1)break}return!!i.isAtom&&s.depth==r.depth-1&&(t&&t(e.tr.delete(s.pos-i.nodeSize,s.pos).scrollIntoView()),!0)},aa=(e,t,n)=>{let r=ai(e,n);if(!r)return!1;let s=au(r);return!!s&&ac(e,s,t)},al=(e,t,n)=>{let r=ap(e,n);if(!r)return!1;let s=ag(r);return!!s&&ac(e,s,t)};function ac(e,t,n){let r=t.nodeBefore,s=t.pos-1;for(;!r.isTextblock;s--){if(r.type.spec.isolating)return!1;let e=r.lastChild;if(!e)return!1;r=e}let i=t.nodeAfter,o=t.pos+1;for(;!i.isTextblock;o++){if(i.type.spec.isolating)return!1;let e=i.firstChild;if(!e)return!1;i=e}let a=rZ(e.doc,s,o,nJ.empty);if(!a||a.from!=s||a instanceof rL&&a.slice.size>=o-s)return!1;if(n){let t=e.tr.step(a);t.setSelection(si.create(t.doc,s)),n(t.scrollIntoView())}return!0}function ad(e,t,n=!1){for(let r=e;r;r="start"==t?r.firstChild:r.lastChild){if(r.isTextblock)return!0;if(n&&1!=r.childCount)break}return!1}let ah=(e,t,n)=>{let{$head:r,empty:s}=e.selection,i=r;if(!s)return!1;if(r.parent.isTextblock){if(n?!n.endOfTextblock("backward",e):r.parentOffset>0)return!1;i=au(r)}let o=i&&i.nodeBefore;return!!o&&!!sa.isSelectable(o)&&(t&&t(e.tr.setSelection(sa.create(e.doc,i.pos-o.nodeSize)).scrollIntoView()),!0)};function au(e){if(!e.parent.type.spec.isolating)for(let t=e.depth-1;t>=0;t--){if(e.index(t)>0)return e.doc.resolve(e.before(t+1));if(e.node(t).type.spec.isolating)break}return null}function ap(e,t){let{$cursor:n}=e.selection;return n&&(t?t.endOfTextblock("forward",e):!(n.parentOffset<n.parent.content.size))?n:null}let af=(e,t,n)=>{let r=ap(e,n);if(!r)return!1;let s=ag(r);if(!s)return!1;let i=s.nodeAfter;if(aC(e,s,t,1))return!0;if(0==r.parent.content.size&&(ad(i,"start")||sa.isSelectable(i))){let n=rZ(e.doc,r.before(),r.after(),nJ.empty);if(n&&n.slice.size<n.to-n.from){if(t){let r=e.tr.step(n);r.setSelection(ad(i,"start")?st.findFrom(r.doc.resolve(r.mapping.map(s.pos)),1):sa.create(r.doc,r.mapping.map(s.pos))),t(r.scrollIntoView())}return!0}}return!!i.isAtom&&s.depth==r.depth-1&&(t&&t(e.tr.delete(s.pos,s.pos+i.nodeSize).scrollIntoView()),!0)},am=(e,t,n)=>{let{$head:r,empty:s}=e.selection,i=r;if(!s)return!1;if(r.parent.isTextblock){if(n?!n.endOfTextblock("forward",e):r.parentOffset<r.parent.content.size)return!1;i=ag(r)}let o=i&&i.nodeAfter;return!!o&&!!sa.isSelectable(o)&&(t&&t(e.tr.setSelection(sa.create(e.doc,i.pos)).scrollIntoView()),!0)};function ag(e){if(!e.parent.type.spec.isolating)for(let t=e.depth-1;t>=0;t--){let n=e.node(t);if(e.index(t)+1<n.childCount)return e.doc.resolve(e.after(t+1));if(n.type.spec.isolating)break}return null}let ax=(e,t)=>{let n=e.selection,r=n instanceof sa,s;if(r){if(n.node.isTextblock||!rK(e.doc,n.from))return!1;s=n.from}else if(null==(s=rY(e.doc,n.from,-1)))return!1;if(t){let n=e.tr.join(s);r&&n.setSelection(sa.create(n.doc,s-e.doc.resolve(s).nodeBefore.nodeSize)),t(n.scrollIntoView())}return!0},ay=(e,t)=>{let n=e.selection,r;if(n instanceof sa){if(n.node.isTextblock||!rK(e.doc,n.to))return!1;r=n.to}else if(null==(r=rY(e.doc,n.to,1)))return!1;return t&&t(e.tr.join(r).scrollIntoView()),!0},av=(e,t)=>{let{$from:n,$to:r}=e.selection,s=n.blockRange(r),i=s&&r_(s);return null!=i&&(t&&t(e.tr.lift(s,i).scrollIntoView()),!0)},ab=(e,t)=>{let{$head:n,$anchor:r}=e.selection;return!!n.parent.type.spec.code&&!!n.sameParent(r)&&(t&&t(e.tr.insertText("\n").scrollIntoView()),!0)};function aw(e){for(let t=0;t<e.edgeCount;t++){let{type:n}=e.edge(t);if(n.isTextblock&&!n.hasRequiredAttrs())return n}return null}let ak=(e,t)=>{let{$head:n,$anchor:r}=e.selection;if(!n.parent.type.spec.code||!n.sameParent(r))return!1;let s=n.node(-1),i=n.indexAfter(-1),o=aw(s.contentMatchAt(i));if(!o||!s.canReplaceWith(i,i,o))return!1;if(t){let r=n.after(),s=e.tr.replaceWith(r,r,o.createAndFill());s.setSelection(st.near(s.doc.resolve(r),1)),t(s.scrollIntoView())}return!0},aN=(e,t)=>{let n=e.selection,{$from:r,$to:s}=n;if(n instanceof sc||r.parent.inlineContent||s.parent.inlineContent)return!1;let i=aw(s.parent.contentMatchAt(s.indexAfter()));if(!i||!i.isTextblock)return!1;if(t){let n=(!r.parentOffset&&s.index()<s.parent.childCount?r:s).pos,o=e.tr.insert(n,i.createAndFill());o.setSelection(si.create(o.doc,n+1)),t(o.scrollIntoView())}return!0},aj=(e,t)=>{let{$cursor:n}=e.selection;if(!n||n.parent.content.size)return!1;if(n.depth>1&&n.after()!=n.end(-1)){let r=n.before();if(rJ(e.doc,r))return t&&t(e.tr.split(r).scrollIntoView()),!0}let r=n.blockRange(),s=r&&r_(r);return null!=s&&(t&&t(e.tr.lift(r,s).scrollIntoView()),!0)},aS=(e,t)=>{let{$from:n,to:r}=e.selection,s,i=n.sharedDepth(r);return 0!=i&&(s=n.before(i),t&&t(e.tr.setSelection(sa.create(e.doc,s))),!0)};function aC(e,t,n,r){let s,i,o,a=t.nodeBefore,l=t.nodeAfter,c,d,h=a.type.spec.isolating||l.type.spec.isolating;if(!h&&(s=t.nodeBefore,i=t.nodeAfter,o=t.index(),s&&i&&s.type.compatibleContent(i.type)&&(!s.content.size&&t.parent.canReplace(o-1,o)?(n&&n(e.tr.delete(t.pos-s.nodeSize,t.pos).scrollIntoView()),!0):!!t.parent.canReplace(o,o+1)&&!!(i.isTextblock||rK(e.doc,t.pos))&&(n&&n(e.tr.join(t.pos).scrollIntoView()),!0))))return!0;let u=!h&&t.parent.canReplace(t.index(),t.index()+1);if(u&&(c=(d=a.contentMatchAt(a.childCount)).findWrapping(l.type))&&d.matchType(c[0]||l.type).validEnd){if(n){let r=t.pos+l.nodeSize,s=nV.empty;for(let e=c.length-1;e>=0;e--)s=nV.from(c[e].create(null,s));s=nV.from(a.copy(s));let i=e.tr.step(new rB(t.pos-1,r,t.pos,r,new nJ(s,1,0),c.length,!0)),o=i.doc.resolve(r+2*c.length);o.nodeAfter&&o.nodeAfter.type==a.type&&rK(i.doc,o.pos)&&i.join(o.pos),n(i.scrollIntoView())}return!0}let p=l.type.spec.isolating||r>0&&h?null:st.findFrom(t,1),f=p&&p.$from.blockRange(p.$to),m=f&&r_(f);if(null!=m&&m>=t.depth)return n&&n(e.tr.lift(f,m).scrollIntoView()),!0;if(u&&ad(l,"start",!0)&&ad(a,"end")){let r=a,s=[];for(;s.push(r),!r.isTextblock;)r=r.lastChild;let i=l,o=1;for(;!i.isTextblock;i=i.firstChild)o++;if(r.canReplace(r.childCount,r.childCount,i.content)){if(n){let r=nV.empty;for(let e=s.length-1;e>=0;e--)r=nV.from(s[e].copy(r));n(e.tr.step(new rB(t.pos-s.length,t.pos+l.nodeSize,t.pos+o,t.pos+l.nodeSize-o,new nJ(r,s.length,0),0,!0)).scrollIntoView())}return!0}}return!1}function aM(e){return function(t,n){let r=t.selection,s=e<0?r.$from:r.$to,i=s.depth;for(;s.node(i).isInline;){if(!i)return!1;i--}return!!s.node(i).isTextblock&&(n&&n(t.tr.setSelection(si.create(t.doc,e<0?s.start(i):s.end(i)))),!0)}}let aA=aM(-1),aE=aM(1);function aT(e,t=null){return function(n,r){let s=!1;for(let r=0;r<n.selection.ranges.length&&!s;r++){let{$from:{pos:i},$to:{pos:o}}=n.selection.ranges[r];n.doc.nodesBetween(i,o,(r,i)=>{if(s)return!1;if(!(!r.isTextblock||r.hasMarkup(e,t)))if(r.type==e)s=!0;else{let t=n.doc.resolve(i),r=t.index();s=t.parent.canReplaceWith(r,r+1,e)}})}if(!s)return!1;if(r){let s=n.tr;for(let r=0;r<n.selection.ranges.length;r++){let{$from:{pos:i},$to:{pos:o}}=n.selection.ranges[r];s.setBlockType(i,o,e,t)}r(s.scrollIntoView())}return!0}}function aD(...e){return function(t,n,r){for(let s=0;s<e.length;s++)if(e[s](t,n,r))return!0;return!1}}let aO=aD(as,ao,ah),aI=aD(as,af,am),aR={Enter:aD(ab,aN,aj,(e,t)=>{let{$from:n,$to:r}=e.selection;if(e.selection instanceof sa&&e.selection.node.isBlock)return!!n.parentOffset&&!!rJ(e.doc,n.pos)&&(t&&t(e.tr.split(n.pos).scrollIntoView()),!0);if(!n.depth)return!1;let s=[],i,o,a=!1,l=!1;for(let e=n.depth;;e--){if(n.node(e).isBlock){let t;a=n.end(e)==n.pos+(n.depth-e),l=n.start(e)==n.pos-(n.depth-e),o=aw(n.node(e-1).contentMatchAt(n.indexAfter(e-1)));s.unshift(t||(a&&o?{type:o}:null)),i=e;break}if(1==e)return!1;s.unshift(null)}let c=e.tr;(e.selection instanceof si||e.selection instanceof sc)&&c.deleteSelection();let d=c.mapping.map(n.pos),h=rJ(c.doc,d,s.length,s);if(h||(s[0]=o?{type:o}:null,h=rJ(c.doc,d,s.length,s)),!h)return!1;if(c.split(d,s.length,s),!a&&l&&n.node(i).type!=o){let e=c.mapping.map(n.before(i)),t=c.doc.resolve(e);o&&n.node(i-1).canReplaceWith(t.index(),t.index()+1,o)&&c.setNodeMarkup(c.mapping.map(n.before(i)),o)}return t&&t(c.scrollIntoView()),!0}),"Mod-Enter":ak,Backspace:aO,"Mod-Backspace":aO,"Shift-Backspace":aO,Delete:aI,"Mod-Delete":aI,"Mod-a":(e,t)=>(t&&t(e.tr.setSelection(new sc(e.doc))),!0)},aP={"Ctrl-h":aR.Backspace,"Alt-Backspace":aR["Mod-Backspace"],"Ctrl-d":aR.Delete,"Ctrl-Alt-Backspace":aR["Mod-Delete"],"Alt-Delete":aR["Mod-Delete"],"Alt-d":aR["Mod-Delete"],"Ctrl-a":aA,"Ctrl-e":aE};for(let e in aR)aP[e]=aR[e];"undefined"!=typeof navigator?/Mac|iP(hone|[oa]d)/.test(navigator.platform):"undefined"!=typeof os&&os.platform&&os.platform();let az=["ol",0],a$=["ul",0],aL=["li",0];function aB(e){let{state:t,transaction:n}=e,{selection:r}=n,{doc:s}=n,{storedMarks:i}=n;return{...t,apply:t.apply.bind(t),applyTransaction:t.applyTransaction.bind(t),plugins:t.plugins,schema:t.schema,reconfigure:t.reconfigure.bind(t),toJSON:t.toJSON.bind(t),get storedMarks(){return i},get selection(){return r},get doc(){return s},get tr(){return r=n.selection,s=n.doc,i=n.storedMarks,n}}}class aF{constructor(e){this.editor=e.editor,this.rawCommands=this.editor.extensionManager.commands,this.customState=e.state}get hasCustomState(){return!!this.customState}get state(){return this.customState||this.editor.state}get commands(){let{rawCommands:e,editor:t,state:n}=this,{view:r}=t,{tr:s}=n,i=this.buildProps(s);return Object.fromEntries(Object.entries(e).map(([e,t])=>[e,(...e)=>{let n=t(...e)(i);return s.getMeta("preventDispatch")||this.hasCustomState||r.dispatch(s),n}]))}get chain(){return()=>this.createChain()}get can(){return()=>this.createCan()}createChain(e,t=!0){let{rawCommands:n,editor:r,state:s}=this,{view:i}=r,o=[],a=!!e,l=e||s.tr,c={...Object.fromEntries(Object.entries(n).map(([e,n])=>[e,(...e)=>{let r=this.buildProps(l,t),s=n(...e)(r);return o.push(s),c}])),run:()=>(a||!t||l.getMeta("preventDispatch")||this.hasCustomState||i.dispatch(l),o.every(e=>!0===e))};return c}createCan(e){let{rawCommands:t,state:n}=this,r=e||n.tr,s=this.buildProps(r,!1);return{...Object.fromEntries(Object.entries(t).map(([e,t])=>[e,(...e)=>t(...e)({...s,dispatch:void 0})])),chain:()=>this.createChain(r,!1)}}buildProps(e,t=!0){let{rawCommands:n,editor:r,state:s}=this,{view:i}=r,o={tr:e,editor:r,view:i,state:aB({state:s,transaction:e}),dispatch:t?()=>void 0:void 0,chain:()=>this.createChain(e,t),can:()=>this.createCan(e),get commands(){return Object.fromEntries(Object.entries(n).map(([e,t])=>[e,(...e)=>t(...e)(o)]))}};return o}}class aV{constructor(){this.callbacks={}}on(e,t){return this.callbacks[e]||(this.callbacks[e]=[]),this.callbacks[e].push(t),this}emit(e,...t){let n=this.callbacks[e];return n&&n.forEach(e=>e.apply(this,t)),this}off(e,t){let n=this.callbacks[e];return n&&(t?this.callbacks[e]=n.filter(e=>e!==t):delete this.callbacks[e]),this}once(e,t){let n=(...r)=>{this.off(e,n),t.apply(this,r)};return this.on(e,n)}removeAllListeners(){this.callbacks={}}}function a_(e,t,n){return void 0===e.config[t]&&e.parent?a_(e.parent,t,n):"function"==typeof e.config[t]?e.config[t].bind({...n,parent:e.parent?a_(e.parent,t,n):null}):e.config[t]}function aq(e){let t=e.filter(e=>"extension"===e.type);return{baseExtensions:t,nodeExtensions:e.filter(e=>"node"===e.type),markExtensions:e.filter(e=>"mark"===e.type)}}function aH(e){let t=[],{nodeExtensions:n,markExtensions:r}=aq(e),s=[...n,...r],i={default:null,rendered:!0,renderHTML:null,parseHTML:null,keepOnSplit:!0,isRequired:!1};return e.forEach(e=>{let n={name:e.name,options:e.options,storage:e.storage,extensions:s},r=a_(e,"addGlobalAttributes",n);r&&r().forEach(e=>{e.types.forEach(n=>{Object.entries(e.attributes).forEach(([e,r])=>{t.push({type:n,name:e,attribute:{...i,...r}})})})})}),s.forEach(e=>{let n={name:e.name,options:e.options,storage:e.storage},r=a_(e,"addAttributes",n);r&&Object.entries(r()).forEach(([n,r])=>{let s={...i,...r};"function"==typeof(null==s?void 0:s.default)&&(s.default=s.default()),(null==s?void 0:s.isRequired)&&(null==s?void 0:s.default)===void 0&&delete s.default,t.push({type:e.name,name:n,attribute:s})})}),t}function aW(e,t){if("string"==typeof e){if(!t.nodes[e])throw Error(`There is no node type named '${e}'. Maybe you forgot to add the extension?`);return t.nodes[e]}return e}function aU(...e){return e.filter(e=>!!e).reduce((e,t)=>{let n={...e};return Object.entries(t).forEach(([e,t])=>{if(!n[e]){n[e]=t;return}if("class"===e){let r=t?String(t).split(" "):[],s=n[e]?n[e].split(" "):[],i=r.filter(e=>!s.includes(e));n[e]=[...s,...i].join(" ")}else if("style"===e){let r=t?t.split(";").map(e=>e.trim()).filter(Boolean):[],s=n[e]?n[e].split(";").map(e=>e.trim()).filter(Boolean):[],i=new Map;s.forEach(e=>{let[t,n]=e.split(":").map(e=>e.trim());i.set(t,n)}),r.forEach(e=>{let[t,n]=e.split(":").map(e=>e.trim());i.set(t,n)}),n[e]=Array.from(i.entries()).map(([e,t])=>`${e}: ${t}`).join("; ")}else n[e]=t}),n},{})}function aJ(e,t){return t.filter(t=>t.type===e.type.name).filter(e=>e.attribute.rendered).map(t=>t.attribute.renderHTML?t.attribute.renderHTML(e.attrs)||{}:{[t.name]:e.attrs[t.name]}).reduce((e,t)=>aU(e,t),{})}function aK(e){return"function"==typeof e}function aG(e,t,...n){return aK(e)?t?e.bind(t)(...n):e(...n):e}function aY(e,t){return"style"in e?e:{...e,getAttrs:n=>{let r=e.getAttrs?e.getAttrs(n):e.attrs;if(!1===r)return!1;let s=t.reduce((e,t)=>{var r;let s=t.attribute.parseHTML?t.attribute.parseHTML(n):"string"!=typeof(r=n.getAttribute(t.name))?r:r.match(/^[+-]?(?:\d*\.)?\d+$/)?Number(r):"true"===r||"false"!==r&&r;return null==s?e:{...e,[t.name]:s}},{});return{...r,...s}}}}function aX(e){return Object.fromEntries(Object.entries(e).filter(([e,t])=>!("attrs"===e&&function(e={}){return 0===Object.keys(e).length&&e.constructor===Object}(t))&&null!=t))}function aZ(e,t){var n;let r=aH(e),{nodeExtensions:s,markExtensions:i}=aq(e),o=null==(n=s.find(e=>a_(e,"topNode")))?void 0:n.name;return new rh({topNode:o,nodes:Object.fromEntries(s.map(n=>{let s=r.filter(e=>e.type===n.name),i={name:n.name,options:n.options,storage:n.storage,editor:t},o=aX({...e.reduce((e,t)=>{let r=a_(t,"extendNodeSchema",i);return{...e,...r?r(n):{}}},{}),content:aG(a_(n,"content",i)),marks:aG(a_(n,"marks",i)),group:aG(a_(n,"group",i)),inline:aG(a_(n,"inline",i)),atom:aG(a_(n,"atom",i)),selectable:aG(a_(n,"selectable",i)),draggable:aG(a_(n,"draggable",i)),code:aG(a_(n,"code",i)),whitespace:aG(a_(n,"whitespace",i)),linebreakReplacement:aG(a_(n,"linebreakReplacement",i)),defining:aG(a_(n,"defining",i)),isolating:aG(a_(n,"isolating",i)),attrs:Object.fromEntries(s.map(e=>{var t;return[e.name,{default:null==(t=null==e?void 0:e.attribute)?void 0:t.default}]}))}),a=aG(a_(n,"parseHTML",i));a&&(o.parseDOM=a.map(e=>aY(e,s)));let l=a_(n,"renderHTML",i);l&&(o.toDOM=e=>l({node:e,HTMLAttributes:aJ(e,s)}));let c=a_(n,"renderText",i);return c&&(o.toText=c),[n.name,o]})),marks:Object.fromEntries(i.map(n=>{let s=r.filter(e=>e.type===n.name),i={name:n.name,options:n.options,storage:n.storage,editor:t},o=aX({...e.reduce((e,t)=>{let r=a_(t,"extendMarkSchema",i);return{...e,...r?r(n):{}}},{}),inclusive:aG(a_(n,"inclusive",i)),excludes:aG(a_(n,"excludes",i)),group:aG(a_(n,"group",i)),spanning:aG(a_(n,"spanning",i)),code:aG(a_(n,"code",i)),attrs:Object.fromEntries(s.map(e=>{var t;return[e.name,{default:null==(t=null==e?void 0:e.attribute)?void 0:t.default}]}))}),a=aG(a_(n,"parseHTML",i));a&&(o.parseDOM=a.map(e=>aY(e,s)));let l=a_(n,"renderHTML",i);return l&&(o.toDOM=e=>l({mark:e,HTMLAttributes:aJ(e,s)})),[n.name,o]}))})}function aQ(e,t){return t.nodes[e]||t.marks[e]||null}function a0(e,t){return Array.isArray(t)?t.some(t=>("string"==typeof t?t:t.name)===e.name):t}function a1(e,t){let n=rk.fromSchema(t).serializeFragment(e),r=document.implementation.createHTMLDocument().createElement("div");return r.appendChild(n),r.innerHTML}let a2=(e,t=500)=>{let n="",r=e.parentOffset;return e.parent.nodesBetween(Math.max(0,r-t),r,(e,t,s,i)=>{var o,a;let l=(null==(a=(o=e.type.spec).toText)?void 0:a.call(o,{node:e,pos:t,parent:s,index:i}))||e.textContent||"%leaf%";n+=e.isAtom&&!e.isText?l:l.slice(0,Math.max(0,r-t))}),n};function a4(e){return"[object RegExp]"===Object.prototype.toString.call(e)}class a5{constructor(e){this.find=e.find,this.handler=e.handler}}let a3=(e,t)=>{if(a4(t))return t.exec(e);let n=t(e);if(!n)return null;let r=[n.text];return r.index=n.index,r.input=e,r.data=n.data,n.replaceWith&&(n.text.includes(n.replaceWith)||console.warn('[tiptap warn]: "inputRuleMatch.replaceWith" must be part of "inputRuleMatch.text".'),r.push(n.replaceWith)),r};function a6(e){var t;let{editor:n,from:r,to:s,text:i,rules:o,plugin:a}=e,{view:l}=n;if(l.composing)return!1;let c=l.state.doc.resolve(r);if(c.parent.type.spec.code||(null==(t=c.nodeBefore||c.nodeAfter)?void 0:t.marks.find(e=>e.type.spec.code)))return!1;let d=!1,h=a2(c)+i;return o.forEach(e=>{if(d)return;let t=a3(h,e.find);if(!t)return;let o=l.state.tr,c=aB({state:l.state,transaction:o}),u={from:r-(t[0].length-i.length),to:s},{commands:p,chain:f,can:m}=new aF({editor:n,state:c});null!==e.handler({state:c,range:u,match:t,commands:p,chain:f,can:m})&&o.steps.length&&(o.setMeta(a,{transform:o,from:r,to:s,text:i}),l.dispatch(o),d=!0)}),d}function a8(e){return"Object"===Object.prototype.toString.call(e).slice(8,-1)&&e.constructor===Object&&Object.getPrototypeOf(e)===Object.prototype}function a7(e,t){let n={...e};return a8(e)&&a8(t)&&Object.keys(t).forEach(r=>{a8(t[r])&&a8(e[r])?n[r]=a7(e[r],t[r]):n[r]=t[r]}),n}class a9{constructor(e={}){this.type="mark",this.name="mark",this.parent=null,this.child=null,this.config={name:this.name,defaultOptions:{}},this.config={...this.config,...e},this.name=this.config.name,e.defaultOptions&&Object.keys(e.defaultOptions).length>0&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${this.name}".`),this.options=this.config.defaultOptions,this.config.addOptions&&(this.options=aG(a_(this,"addOptions",{name:this.name}))),this.storage=aG(a_(this,"addStorage",{name:this.name,options:this.options}))||{}}static create(e={}){return new a9(e)}configure(e={}){let t=this.extend({...this.config,addOptions:()=>a7(this.options,e)});return t.name=this.name,t.parent=this.parent,t}extend(e={}){let t=new a9(e);return t.parent=this,this.child=t,t.name=e.name?e.name:t.parent.name,e.defaultOptions&&Object.keys(e.defaultOptions).length>0&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${t.name}".`),t.options=aG(a_(t,"addOptions",{name:t.name})),t.storage=aG(a_(t,"addStorage",{name:t.name,options:t.options})),t}static handleExit({editor:e,mark:t}){let{tr:n}=e.state,r=e.state.selection.$from;if(r.pos===r.end()){let s=r.marks();if(!s.find(e=>(null==e?void 0:e.type.name)===t.name))return!1;let i=s.find(e=>(null==e?void 0:e.type.name)===t.name);return i&&n.removeStoredMark(i),n.insertText(" ",r.pos),e.view.dispatch(n),!0}return!1}}class le{constructor(e){this.find=e.find,this.handler=e.handler}}let lt=(e,t,n)=>{if(a4(t))return[...e.matchAll(t)];let r=t(e,n);return r?r.map(t=>{let n=[t.text];return n.index=t.index,n.input=e,n.data=t.data,t.replaceWith&&(t.text.includes(t.replaceWith)||console.warn('[tiptap warn]: "pasteRuleMatch.replaceWith" must be part of "pasteRuleMatch.text".'),n.push(t.replaceWith)),n}):[]},ln=null,lr=e=>{var t;let n=new ClipboardEvent("paste",{clipboardData:new DataTransfer});return null==(t=n.clipboardData)||t.setData("text/html",e),n};class ls{constructor(e,t){this.splittableMarks=[],this.editor=t,this.extensions=ls.resolve(e),this.schema=aZ(this.extensions,t),this.setupExtensions()}static resolve(e){var t;let n=ls.sort(ls.flatten(e)),r=Array.from(new Set((t=n.map(e=>e.name)).filter((e,n)=>t.indexOf(e)!==n)));return r.length&&console.warn(`[tiptap warn]: Duplicate extension names found: [${r.map(e=>`'${e}'`).join(", ")}]. This can lead to issues.`),n}static flatten(e){return e.map(e=>{let t={name:e.name,options:e.options,storage:e.storage},n=a_(e,"addExtensions",t);return n?[e,...this.flatten(n())]:e}).flat(10)}static sort(e){return e.sort((e,t)=>{let n=a_(e,"priority")||100,r=a_(t,"priority")||100;return n>r?-1:+(n<r)})}get commands(){return this.extensions.reduce((e,t)=>{let n={name:t.name,options:t.options,storage:t.storage,editor:this.editor,type:aQ(t.name,this.schema)},r=a_(t,"addCommands",n);return r?{...e,...r()}:e},{})}get plugins(){let{editor:e}=this,t=ls.sort([...this.extensions].reverse()),n=[],r=[],s=t.map(t=>{let s={name:t.name,options:t.options,storage:t.storage,editor:e,type:aQ(t.name,this.schema)},i=[],o=a_(t,"addKeyboardShortcuts",s),a={};if("mark"===t.type&&a_(t,"exitable",s)&&(a.ArrowRight=()=>a9.handleExit({editor:e,mark:t})),o){let t=Object.fromEntries(Object.entries(o()).map(([t,n])=>[t,()=>n({editor:e})]));a={...a,...t}}let l=new sv({props:{handleKeyDown:ar(a)}});i.push(l);let c=a_(t,"addInputRules",s);a0(t,e.options.enableInputRules)&&c&&n.push(...c());let d=a_(t,"addPasteRules",s);a0(t,e.options.enablePasteRules)&&d&&r.push(...d());let h=a_(t,"addProseMirrorPlugins",s);if(h){let e=h();i.push(...e)}return i}).flat();return[function(e){let{editor:t,rules:n}=e,r=new sv({state:{init:()=>null,apply(e,s,i){let o=e.getMeta(r);if(o)return o;let a=e.getMeta("applyInputRules");return a&&setTimeout(()=>{let{text:e}=a;"string"==typeof e||(e=a1(nV.from(e),i.schema));let{from:s}=a,o=s+e.length;a6({editor:t,from:s,to:o,text:e,rules:n,plugin:r})}),e.selectionSet||e.docChanged?null:s}},props:{handleTextInput:(e,s,i,o)=>a6({editor:t,from:s,to:i,text:o,rules:n,plugin:r}),handleDOMEvents:{compositionend:e=>(setTimeout(()=>{let{$cursor:s}=e.state.selection;s&&a6({editor:t,from:s.pos,to:s.pos,text:"",rules:n,plugin:r})}),!1)},handleKeyDown(e,s){if("Enter"!==s.key)return!1;let{$cursor:i}=e.state.selection;return!!i&&a6({editor:t,from:i.pos,to:i.pos,text:"\n",rules:n,plugin:r})}},isInputRules:!0});return r}({editor:e,rules:n}),...function(e){let t,{editor:n,rules:r}=e,s=null,i=!1,o=!1,a="undefined"!=typeof ClipboardEvent?new ClipboardEvent("paste"):null;try{t="undefined"!=typeof DragEvent?new DragEvent("drop"):null}catch{t=null}let l=({state:e,from:r,to:s,rule:i,pasteEvt:o})=>{let l=e.tr;if(function(e){let{editor:t,state:n,from:r,to:s,rule:i,pasteEvent:o,dropEvent:a}=e,{commands:l,chain:c,can:d}=new aF({editor:t,state:n}),h=[];return n.doc.nodesBetween(r,s,(e,t)=>{if(!e.isTextblock||e.type.spec.code)return;let u=Math.max(r,t),p=Math.min(s,t+e.content.size);lt(e.textBetween(u-t,p-t,void 0,""),i.find,o).forEach(e=>{if(void 0===e.index)return;let t=u+e.index+1,r=t+e[0].length,s={from:n.tr.mapping.map(t),to:n.tr.mapping.map(r)},p=i.handler({state:n,range:s,match:e,commands:l,chain:c,can:d,pasteEvent:o,dropEvent:a});h.push(p)})}),h.every(e=>null!==e)}({editor:n,state:aB({state:e,transaction:l}),from:Math.max(r-1,0),to:s.b-1,rule:i,pasteEvent:o,dropEvent:t})&&l.steps.length){try{t="undefined"!=typeof DragEvent?new DragEvent("drop"):null}catch{t=null}return a="undefined"!=typeof ClipboardEvent?new ClipboardEvent("paste"):null,l}};return r.map(e=>new sv({view(e){let t=t=>{var r;(s=(null==(r=e.dom.parentElement)?void 0:r.contains(t.target))?e.dom.parentElement:null)&&(ln=n)},r=()=>{ln&&(ln=null)};return window.addEventListener("dragstart",t),window.addEventListener("dragend",r),{destroy(){window.removeEventListener("dragstart",t),window.removeEventListener("dragend",r)}}},props:{handleDOMEvents:{drop:(e,n)=>{if(o=s===e.dom.parentElement,t=n,!o){let e=ln;(null==e?void 0:e.isEditable)&&setTimeout(()=>{let t=e.state.selection;t&&e.commands.deleteRange({from:t.from,to:t.to})},10)}return!1},paste:(e,t)=>{var n;let r=null==(n=t.clipboardData)?void 0:n.getData("text/html");return a=t,i=!!(null==r?void 0:r.includes("data-pm-slice")),!1}}},appendTransaction:(t,n,r)=>{let s=t[0],c="paste"===s.getMeta("uiEvent")&&!i,d="drop"===s.getMeta("uiEvent")&&!o,h=s.getMeta("applyPasteRules"),u=!!h;if(!c&&!d&&!u)return;if(u){let{text:t}=h;"string"==typeof t||(t=a1(nV.from(t),r.schema));let{from:n}=h,s=n+t.length;return l({rule:e,state:r,from:n,to:{b:s},pasteEvt:lr(t)})}let p=n.doc.content.findDiffStart(r.doc.content),f=n.doc.content.findDiffEnd(r.doc.content);if("number"==typeof p&&f&&p!==f.b)return l({rule:e,state:r,from:p,to:f,pasteEvt:a})}}))}({editor:e,rules:r}),...s]}get attributes(){return aH(this.extensions)}get nodeViews(){let{editor:e}=this,{nodeExtensions:t}=aq(this.extensions);return Object.fromEntries(t.filter(e=>!!a_(e,"addNodeView")).map(t=>{let n=this.attributes.filter(e=>e.type===t.name),r={name:t.name,options:t.options,storage:t.storage,editor:e,type:aW(t.name,this.schema)},s=a_(t,"addNodeView",r);return s?[t.name,(r,i,o,a,l)=>{let c=aJ(r,n);return s()({node:r,view:i,getPos:o,decorations:a,innerDecorations:l,editor:e,extension:t,HTMLAttributes:c})}]:[]}))}setupExtensions(){this.extensions.forEach(e=>{var t;this.editor.extensionStorage[e.name]=e.storage;let n={name:e.name,options:e.options,storage:e.storage,editor:this.editor,type:aQ(e.name,this.schema)};"mark"===e.type&&(null==(t=aG(a_(e,"keepOnSplit",n)))||t)&&this.splittableMarks.push(e.name);let r=a_(e,"onBeforeCreate",n),s=a_(e,"onCreate",n),i=a_(e,"onUpdate",n),o=a_(e,"onSelectionUpdate",n),a=a_(e,"onTransaction",n),l=a_(e,"onFocus",n),c=a_(e,"onBlur",n),d=a_(e,"onDestroy",n);r&&this.editor.on("beforeCreate",r),s&&this.editor.on("create",s),i&&this.editor.on("update",i),o&&this.editor.on("selectionUpdate",o),a&&this.editor.on("transaction",a),l&&this.editor.on("focus",l),c&&this.editor.on("blur",c),d&&this.editor.on("destroy",d)})}}class li{constructor(e={}){this.type="extension",this.name="extension",this.parent=null,this.child=null,this.config={name:this.name,defaultOptions:{}},this.config={...this.config,...e},this.name=this.config.name,e.defaultOptions&&Object.keys(e.defaultOptions).length>0&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${this.name}".`),this.options=this.config.defaultOptions,this.config.addOptions&&(this.options=aG(a_(this,"addOptions",{name:this.name}))),this.storage=aG(a_(this,"addStorage",{name:this.name,options:this.options}))||{}}static create(e={}){return new li(e)}configure(e={}){let t=this.extend({...this.config,addOptions:()=>a7(this.options,e)});return t.name=this.name,t.parent=this.parent,t}extend(e={}){let t=new li({...this.config,...e});return t.parent=this,this.child=t,t.name=e.name?e.name:t.parent.name,e.defaultOptions&&Object.keys(e.defaultOptions).length>0&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${t.name}".`),t.options=aG(a_(t,"addOptions",{name:t.name})),t.storage=aG(a_(t,"addStorage",{name:t.name,options:t.options})),t}}function lo(e,t,n){let{from:r,to:s}=t,{blockSeparator:i="\n\n",textSerializers:o={}}=n||{},a="";return e.nodesBetween(r,s,(e,n,l,c)=>{var d;e.isBlock&&n>r&&(a+=i);let h=null==o?void 0:o[e.type.name];if(h)return l&&(a+=h({node:e,pos:n,parent:l,index:c,range:t})),!1;e.isText&&(a+=null==(d=null==e?void 0:e.text)?void 0:d.slice(Math.max(r,n)-n,s-n))}),a}function la(e){return Object.fromEntries(Object.entries(e.nodes).filter(([,e])=>e.spec.toText).map(([e,t])=>[e,t.spec.toText]))}let ll=li.create({name:"clipboardTextSerializer",addOptions:()=>({blockSeparator:void 0}),addProseMirrorPlugins(){return[new sv({key:new sk("clipboardTextSerializer"),props:{clipboardTextSerializer:()=>{let{editor:e}=this,{state:t,schema:n}=e,{doc:r,selection:s}=t,{ranges:i}=s,o=Math.min(...i.map(e=>e.$from.pos)),a=Math.max(...i.map(e=>e.$to.pos)),l=la(n);return lo(r,{from:o,to:a},{...void 0!==this.options.blockSeparator?{blockSeparator:this.options.blockSeparator}:{},textSerializers:l})}}})]}});function lc(e,t,n={strict:!0}){let r=Object.keys(t);return!r.length||r.every(r=>n.strict?t[r]===e[r]:a4(t[r])?t[r].test(e[r]):t[r]===e[r])}function ld(e,t,n={}){return e.find(e=>e.type===t&&lc(Object.fromEntries(Object.keys(n).map(t=>[t,e.attrs[t]])),n))}function lh(e,t,n={}){return!!ld(e,t,n)}function lu(e,t,n){var r;if(!e||!t)return;let s=e.parent.childAfter(e.parentOffset);if(s.node&&s.node.marks.some(e=>e.type===t)||(s=e.parent.childBefore(e.parentOffset)),!s.node||!s.node.marks.some(e=>e.type===t)||(n=n||(null==(r=s.node.marks[0])?void 0:r.attrs),!ld([...s.node.marks],t,n)))return;let i=s.index,o=e.start()+s.offset,a=i+1,l=o+s.node.nodeSize;for(;i>0&&lh([...e.parent.child(i-1).marks],t,n);)i-=1,o-=e.parent.child(i).nodeSize;for(;a<e.parent.childCount&&lh([...e.parent.child(a).marks],t,n);)l+=e.parent.child(a).nodeSize,a+=1;return{from:o,to:l}}function lp(e,t){if("string"==typeof e){if(!t.marks[e])throw Error(`There is no mark type named '${e}'. Maybe you forgot to add the extension?`);return t.marks[e]}return e}function lf(e){return e instanceof si}function lm(e=0,t=0,n=0){return Math.min(Math.max(e,t),n)}function lg(e,t=null){if(!t)return null;let n=st.atStart(e),r=st.atEnd(e);if("start"===t||!0===t)return n;if("end"===t)return r;let s=n.from,i=r.to;return"all"===t?si.create(e,lm(0,s,i),lm(e.content.size,s,i)):si.create(e,lm(t,s,i),lm(t,s,i))}function lx(){return["iPad Simulator","iPhone Simulator","iPod Simulator","iPad","iPhone","iPod"].includes(navigator.platform)||navigator.userAgent.includes("Mac")&&"ontouchend"in document}let ly=e=>{let t=e.childNodes;for(let n=t.length-1;n>=0;n-=1){let r=t[n];3===r.nodeType&&r.nodeValue&&/^(\n\s\s|\n)$/.test(r.nodeValue)?e.removeChild(r):1===r.nodeType&&ly(r)}return e};function lv(e){let t=`<body>${e}</body>`;return ly(new window.DOMParser().parseFromString(t,"text/html").body)}function lb(e,t,n){if(e instanceof n6||e instanceof nV)return e;n={slice:!0,parseOptions:{},...n};let r="object"==typeof e&&null!==e,s="string"==typeof e;if(r)try{if(Array.isArray(e)&&e.length>0)return nV.fromArray(e.map(e=>t.nodeFromJSON(e)));let r=t.nodeFromJSON(e);return n.errorOnInvalidContent&&r.check(),r}catch(r){if(n.errorOnInvalidContent)throw Error("[tiptap error]: Invalid JSON content",{cause:r});return console.warn("[tiptap warn]: Invalid content.","Passed value:",e,"Error:",r),lb("",t,n)}if(s){if(n.errorOnInvalidContent){let r=!1,s="",i=new rh({topNode:t.spec.topNode,marks:t.spec.marks,nodes:t.spec.nodes.append({__tiptap__private__unknown__catch__all__node:{content:"inline*",group:"block",parseDOM:[{tag:"*",getAttrs:e=>(r=!0,s="string"==typeof e?e:e.outerHTML,null)}]}})});if(n.slice?rp.fromSchema(i).parseSlice(lv(e),n.parseOptions):rp.fromSchema(i).parse(lv(e),n.parseOptions),n.errorOnInvalidContent&&r)throw Error("[tiptap error]: Invalid HTML content",{cause:Error(`Invalid element found: ${s}`)})}let r=rp.fromSchema(t);return n.slice?r.parseSlice(lv(e),n.parseOptions).content:r.parse(lv(e),n.parseOptions)}return lb("",t,n)}let lw=e=>!("type"in e);function lk(){return"undefined"!=typeof navigator&&/Mac/.test(navigator.platform)}function lN(e,t,n={}){let{from:r,to:s,empty:i}=e.selection,o=t?aW(t,e.schema):null,a=[];e.doc.nodesBetween(r,s,(e,t)=>{if(e.isText)return;let n=Math.max(r,t),i=Math.min(s,t+e.nodeSize);a.push({node:e,from:n,to:i})});let l=s-r,c=a.filter(e=>!o||o.name===e.node.type.name).filter(e=>lc(e.node.attrs,n,{strict:!1}));return i?!!c.length:c.reduce((e,t)=>e+t.to-t.from,0)>=l}function lj(e,t){return t.nodes[e]?"node":t.marks[e]?"mark":null}function lS(e,t){let n="string"==typeof t?[t]:t;return Object.keys(e).reduce((t,r)=>(n.includes(r)||(t[r]=e[r]),t),{})}function lC(e,t,n={},r={}){return lb(e,t,{slice:!1,parseOptions:n,errorOnInvalidContent:r.errorOnInvalidContent})}function lM(e,t){let n=lp(t,e.schema),{from:r,to:s,empty:i}=e.selection,o=[];i?(e.storedMarks&&o.push(...e.storedMarks),o.push(...e.selection.$head.marks())):e.doc.nodesBetween(r,s,e=>{o.push(...e.marks)});let a=o.find(e=>e.type.name===n.name);return a?{...a.attrs}:{}}function lA(e){return t=>(function(e,t){for(let n=e.depth;n>0;n-=1){let r=e.node(n);if(t(r))return{pos:n>0?e.before(n):0,start:e.start(n),depth:n,node:r}}})(t.$from,e)}function lE(e,t,n){let r=[];return e===t?n.resolve(e).marks().forEach(t=>{let s=lu(n.resolve(e),t.type);s&&r.push({mark:t,...s})}):n.nodesBetween(e,t,(e,t)=>{e&&(null==e?void 0:e.nodeSize)!==void 0&&r.push(...e.marks.map(n=>({from:t,to:t+e.nodeSize,mark:n})))}),r}function lT(e,t,n){return Object.fromEntries(Object.entries(n).filter(([n])=>{let r=e.find(e=>e.type===t&&e.name===n);return!!r&&r.attribute.keepOnSplit}))}function lD(e,t,n={}){let{empty:r,ranges:s}=e.selection,i=t?lp(t,e.schema):null;if(r)return!!(e.storedMarks||e.selection.$from.marks()).filter(e=>!i||i.name===e.type.name).find(e=>lc(e.attrs,n,{strict:!1}));let o=0,a=[];if(s.forEach(({$from:t,$to:n})=>{let r=t.pos,s=n.pos;e.doc.nodesBetween(r,s,(e,t)=>{if(!e.isText&&!e.marks.length)return;let n=Math.max(r,t),i=Math.min(s,t+e.nodeSize);o+=i-n,a.push(...e.marks.map(e=>({mark:e,from:n,to:i})))})}),0===o)return!1;let l=a.filter(e=>!i||i.name===e.mark.type.name).filter(e=>lc(e.mark.attrs,n,{strict:!1})).reduce((e,t)=>e+t.to-t.from,0),c=a.filter(e=>!i||e.mark.type!==i&&e.mark.type.excludes(i)).reduce((e,t)=>e+t.to-t.from,0);return(l>0?l+c:l)>=o}function lO(e,t){let{nodeExtensions:n}=aq(t),r=n.find(t=>t.name===e);if(!r)return!1;let s={name:r.name,options:r.options,storage:r.storage},i=aG(a_(r,"group",s));return"string"==typeof i&&i.split(" ").includes("list")}function lI(e,{checkChildren:t=!0,ignoreWhitespace:n=!1}={}){var r;if(n){if("hardBreak"===e.type.name)return!0;if(e.isText)return/^\s*$/m.test(null!=(r=e.text)?r:"")}if(e.isText)return!e.text;if(e.isAtom||e.isLeaf)return!1;if(0===e.content.childCount)return!0;if(t){let r=!0;return e.content.forEach(e=>{!1!==r&&(lI(e,{ignoreWhitespace:n,checkChildren:t})||(r=!1))}),r}return!1}function lR(e,t){let n=e.storedMarks||e.selection.$to.parentOffset&&e.selection.$from.marks();if(n){let r=n.filter(e=>null==t?void 0:t.includes(e.type.name));e.tr.ensureMarks(r)}}let lP=(e,t)=>{let n=lA(e=>e.type===t)(e.selection);if(!n)return!0;let r=e.doc.resolve(Math.max(0,n.pos-1)).before(n.depth);if(void 0===r)return!0;let s=e.doc.nodeAt(r);return!(n.node.type===(null==s?void 0:s.type)&&rK(e.doc,n.pos))||(e.join(n.pos),!0)},lz=(e,t)=>{let n=lA(e=>e.type===t)(e.selection);if(!n)return!0;let r=e.doc.resolve(n.start).after(n.depth);if(void 0===r)return!0;let s=e.doc.nodeAt(r);return!(n.node.type===(null==s?void 0:s.type)&&rK(e.doc,r))||(e.join(r),!0)};var l$=Object.freeze({__proto__:null,blur:()=>({editor:e,view:t})=>(requestAnimationFrame(()=>{var n;e.isDestroyed||(t.dom.blur(),null==(n=null==window?void 0:window.getSelection())||n.removeAllRanges())}),!0),clearContent:(e=!1)=>({commands:t})=>t.setContent("",e),clearNodes:()=>({state:e,tr:t,dispatch:n})=>{let{selection:r}=t,{ranges:s}=r;return!n||(s.forEach(({$from:n,$to:r})=>{e.doc.nodesBetween(n.pos,r.pos,(e,n)=>{if(e.type.isText)return;let{doc:r,mapping:s}=t,i=r.resolve(s.map(n)),o=r.resolve(s.map(n+e.nodeSize)),a=i.blockRange(o);if(!a)return;let l=r_(a);if(e.type.isTextblock){let{defaultType:e}=i.parent.contentMatchAt(i.index());t.setNodeMarkup(a.start,e)}(l||0===l)&&t.lift(a,l)})}),!0)},command:e=>t=>e(t),createParagraphNear:()=>({state:e,dispatch:t})=>aN(e,t),cut:(e,t)=>({editor:n,tr:r})=>{let{state:s}=n,i=s.doc.slice(e.from,e.to);r.deleteRange(e.from,e.to);let o=r.mapping.map(t);return r.insert(o,i.content),r.setSelection(new si(r.doc.resolve(o-1))),!0},deleteCurrentNode:()=>({tr:e,dispatch:t})=>{let{selection:n}=e,r=n.$anchor.node();if(r.content.size>0)return!1;let s=e.selection.$anchor;for(let n=s.depth;n>0;n-=1)if(s.node(n).type===r.type){if(t){let t=s.before(n),r=s.after(n);e.delete(t,r).scrollIntoView()}return!0}return!1},deleteNode:e=>({tr:t,state:n,dispatch:r})=>{let s=aW(e,n.schema),i=t.selection.$anchor;for(let e=i.depth;e>0;e-=1)if(i.node(e).type===s){if(r){let n=i.before(e),r=i.after(e);t.delete(n,r).scrollIntoView()}return!0}return!1},deleteRange:e=>({tr:t,dispatch:n})=>{let{from:r,to:s}=e;return n&&t.delete(r,s),!0},deleteSelection:()=>({state:e,dispatch:t})=>as(e,t),enter:()=>({commands:e})=>e.keyboardShortcut("Enter"),exitCode:()=>({state:e,dispatch:t})=>ak(e,t),extendMarkRange:(e,t={})=>({tr:n,state:r,dispatch:s})=>{let i=lp(e,r.schema),{doc:o,selection:a}=n,{$from:l,from:c,to:d}=a;if(s){let e=lu(l,i,t);if(e&&e.from<=c&&e.to>=d){let t=si.create(o,e.from,e.to);n.setSelection(t)}}return!0},first:e=>t=>{let n="function"==typeof e?e(t):e;for(let e=0;e<n.length;e+=1)if(n[e](t))return!0;return!1},focus:(e=null,t={})=>({editor:n,view:r,tr:s,dispatch:i})=>{t={scrollIntoView:!0,...t};let o=()=>{(lx()||"Android"===navigator.platform||/android/i.test(navigator.userAgent))&&r.dom.focus(),requestAnimationFrame(()=>{!n.isDestroyed&&(r.focus(),(null==t?void 0:t.scrollIntoView)&&n.commands.scrollIntoView())})};if(r.hasFocus()&&null===e||!1===e)return!0;if(i&&null===e&&!lf(n.state.selection))return o(),!0;let a=lg(s.doc,e)||n.state.selection,l=n.state.selection.eq(a);return i&&(l||s.setSelection(a),l&&s.storedMarks&&s.setStoredMarks(s.storedMarks),o()),!0},forEach:(e,t)=>n=>e.every((e,r)=>t(e,{...n,index:r})),insertContent:(e,t)=>({tr:n,commands:r})=>r.insertContentAt({from:n.selection.from,to:n.selection.to},e,t),insertContentAt:(e,t,n)=>({tr:r,dispatch:s,editor:i})=>{var o;if(s){let s,a;n={parseOptions:i.options.parseOptions,updateSelection:!0,applyInputRules:!1,applyPasteRules:!1,...n};let l=e=>{i.emit("contentError",{editor:i,error:e,disableCollaboration:()=>{i.storage.collaboration&&(i.storage.collaboration.isDisabled=!0)}})},c={preserveWhitespace:"full",...n.parseOptions};if(!n.errorOnInvalidContent&&!i.options.enableContentCheck&&i.options.emitContentError)try{lb(t,i.schema,{parseOptions:c,errorOnInvalidContent:!0})}catch(e){l(e)}try{s=lb(t,i.schema,{parseOptions:c,errorOnInvalidContent:null!=(o=n.errorOnInvalidContent)?o:i.options.enableContentCheck})}catch(e){return l(e),!1}let{from:d,to:h}="number"==typeof e?{from:e,to:e}:{from:e.from,to:e.to},u=!0,p=!0;if((lw(s)?s:[s]).forEach(e=>{e.check(),u=!!u&&e.isText&&0===e.marks.length,p=!!p&&e.isBlock}),d===h&&p){let{parent:e}=r.doc.resolve(d);!e.isTextblock||e.type.spec.code||e.childCount||(d-=1,h+=1)}if(u){if(Array.isArray(t))a=t.map(e=>e.text||"").join("");else if(t instanceof nV){let e="";t.forEach(t=>{t.text&&(e+=t.text)}),a=e}else a="object"==typeof t&&t&&t.text?t.text:t;r.insertText(a,d,h)}else a=s,r.replaceWith(d,h,a);n.updateSelection&&function(e,t,n){let r=e.steps.length-1;if(r<t)return;let s=e.steps[r];if(!(s instanceof rL||s instanceof rB))return;let i=e.mapping.maps[r],o=0;i.forEach((e,t,n,r)=>{0===o&&(o=r)}),e.setSelection(st.near(e.doc.resolve(o),-1))}(r,r.steps.length-1,0),n.applyInputRules&&r.setMeta("applyInputRules",{from:d,text:a}),n.applyPasteRules&&r.setMeta("applyPasteRules",{from:d,text:a})}return!0},joinBackward:()=>({state:e,dispatch:t})=>ao(e,t),joinDown:()=>({state:e,dispatch:t})=>ay(e,t),joinForward:()=>({state:e,dispatch:t})=>af(e,t),joinItemBackward:()=>({state:e,dispatch:t,tr:n})=>{try{let r=rY(e.doc,e.selection.$from.pos,-1);if(null==r)return!1;return n.join(r,2),t&&t(n),!0}catch{return!1}},joinItemForward:()=>({state:e,dispatch:t,tr:n})=>{try{let r=rY(e.doc,e.selection.$from.pos,1);if(null==r)return!1;return n.join(r,2),t&&t(n),!0}catch{return!1}},joinTextblockBackward:()=>({state:e,dispatch:t})=>aa(e,t),joinTextblockForward:()=>({state:e,dispatch:t})=>al(e,t),joinUp:()=>({state:e,dispatch:t})=>ax(e,t),keyboardShortcut:e=>({editor:t,view:n,tr:r,dispatch:s})=>{let i=(function(e){let t,n,r,s,i=e.split(/-(?!$)/),o=i[i.length-1];"Space"===o&&(o=" ");for(let e=0;e<i.length-1;e+=1){let o=i[e];if(/^(cmd|meta|m)$/i.test(o))s=!0;else if(/^a(lt)?$/i.test(o))t=!0;else if(/^(c|ctrl|control)$/i.test(o))n=!0;else if(/^s(hift)?$/i.test(o))r=!0;else if(/^mod$/i.test(o))lx()||lk()?s=!0:n=!0;else throw Error(`Unrecognized modifier name: ${o}`)}return t&&(o=`Alt-${o}`),n&&(o=`Ctrl-${o}`),s&&(o=`Meta-${o}`),r&&(o=`Shift-${o}`),o})(e).split(/-(?!$)/),o=i.find(e=>!["Alt","Ctrl","Meta","Shift"].includes(e)),a=new KeyboardEvent("keydown",{key:"Space"===o?" ":o,altKey:i.includes("Alt"),ctrlKey:i.includes("Ctrl"),metaKey:i.includes("Meta"),shiftKey:i.includes("Shift"),bubbles:!0,cancelable:!0}),l=t.captureTransaction(()=>{n.someProp("handleKeyDown",e=>e(n,a))});return null==l||l.steps.forEach(e=>{let t=e.map(r.mapping);t&&s&&r.maybeStep(t)}),!0},lift:(e,t={})=>({state:n,dispatch:r})=>{let s=aW(e,n.schema);return!!lN(n,s,t)&&av(n,r)},liftEmptyBlock:()=>({state:e,dispatch:t})=>aj(e,t),liftListItem:e=>({state:t,dispatch:n})=>(function(e){return function(t,n){let{$from:r,$to:s}=t.selection,i=r.blockRange(s,t=>t.childCount>0&&t.firstChild.type==e);return!!i&&(!n||(r.node(i.depth-1).type==e?function(e,t,n,r){let s=e.tr,i=r.end,o=r.$to.end(r.depth);i<o&&(s.step(new rB(i-1,o,i,o,new nJ(nV.from(n.create(null,r.parent.copy())),1,0),1,!0)),r=new n5(s.doc.resolve(r.$from.pos),s.doc.resolve(o),r.depth));let a=r_(r);if(null==a)return!1;s.lift(r,a);let l=s.doc.resolve(s.mapping.map(i,-1)-1);return rK(s.doc,l.pos)&&l.nodeBefore.type==l.nodeAfter.type&&s.join(l.pos),t(s.scrollIntoView()),!0}(t,n,e,i):function(e,t,n){let r=e.tr,s=n.parent;for(let e=n.end,t=n.endIndex-1,i=n.startIndex;t>i;t--)e-=s.child(t).nodeSize,r.delete(e-1,e+1);let i=r.doc.resolve(n.start),o=i.nodeAfter;if(r.mapping.map(n.end)!=n.start+i.nodeAfter.nodeSize)return!1;let a=0==n.startIndex,l=n.endIndex==s.childCount,c=i.node(-1),d=i.index(-1);if(!c.canReplace(d+ +!a,d+1,o.content.append(l?nV.empty:nV.from(s))))return!1;let h=i.pos,u=h+o.nodeSize;return r.step(new rB(h-!!a,u+ +!!l,h+1,u-1,new nJ((a?nV.empty:nV.from(s.copy(nV.empty))).append(l?nV.empty:nV.from(s.copy(nV.empty))),+!a,+!l),+!a)),t(r.scrollIntoView()),!0}(t,n,i)))}})(aW(e,t.schema))(t,n),newlineInCode:()=>({state:e,dispatch:t})=>ab(e,t),resetAttributes:(e,t)=>({tr:n,state:r,dispatch:s})=>{let i=null,o=null,a=lj("string"==typeof e?e:e.name,r.schema);return!!a&&("node"===a&&(i=aW(e,r.schema)),"mark"===a&&(o=lp(e,r.schema)),s&&n.selection.ranges.forEach(e=>{r.doc.nodesBetween(e.$from.pos,e.$to.pos,(e,r)=>{i&&i===e.type&&n.setNodeMarkup(r,void 0,lS(e.attrs,t)),o&&e.marks.length&&e.marks.forEach(s=>{o===s.type&&n.addMark(r,r+e.nodeSize,o.create(lS(s.attrs,t)))})})}),!0)},scrollIntoView:()=>({tr:e,dispatch:t})=>(t&&e.scrollIntoView(),!0),selectAll:()=>({tr:e,dispatch:t})=>{if(t){let t=new sc(e.doc);e.setSelection(t)}return!0},selectNodeBackward:()=>({state:e,dispatch:t})=>ah(e,t),selectNodeForward:()=>({state:e,dispatch:t})=>am(e,t),selectParentNode:()=>({state:e,dispatch:t})=>aS(e,t),selectTextblockEnd:()=>({state:e,dispatch:t})=>aE(e,t),selectTextblockStart:()=>({state:e,dispatch:t})=>aA(e,t),setContent:(e,t=!1,n={},r={})=>({editor:s,tr:i,dispatch:o,commands:a})=>{var l,c;let{doc:d}=i;if("full"!==n.preserveWhitespace){let a=lC(e,s.schema,n,{errorOnInvalidContent:null!=(l=r.errorOnInvalidContent)?l:s.options.enableContentCheck});return o&&i.replaceWith(0,d.content.size,a).setMeta("preventUpdate",!t),!0}return o&&i.setMeta("preventUpdate",!t),a.insertContentAt({from:0,to:d.content.size},e,{parseOptions:n,errorOnInvalidContent:null!=(c=r.errorOnInvalidContent)?c:s.options.enableContentCheck})},setMark:(e,t={})=>({tr:n,state:r,dispatch:s})=>{let{selection:i}=n,{empty:o,ranges:a}=i,l=lp(e,r.schema);if(s)if(o){let e=lM(r,l);n.addStoredMark(l.create({...e,...t}))}else a.forEach(e=>{let s=e.$from.pos,i=e.$to.pos;r.doc.nodesBetween(s,i,(e,r)=>{let o=Math.max(r,s),a=Math.min(r+e.nodeSize,i);e.marks.find(e=>e.type===l)?e.marks.forEach(e=>{l===e.type&&n.addMark(o,a,l.create({...e.attrs,...t}))}):n.addMark(o,a,l.create(t))})});return function(e,t,n){var r;let{selection:s}=t,i=null;if(lf(s)&&(i=s.$cursor),i){let t=null!=(r=e.storedMarks)?r:i.marks();return!!n.isInSet(t)||!t.some(e=>e.type.excludes(n))}let{ranges:o}=s;return o.some(({$from:t,$to:r})=>{let s=0===t.depth&&e.doc.inlineContent&&e.doc.type.allowsMarkType(n);return e.doc.nodesBetween(t.pos,r.pos,(e,t,r)=>{if(s)return!1;if(e.isInline){let t=!r||r.type.allowsMarkType(n),i=!!n.isInSet(e.marks)||!e.marks.some(e=>e.type.excludes(n));s=t&&i}return!s}),s})}(r,n,l)},setMeta:(e,t)=>({tr:n})=>(n.setMeta(e,t),!0),setNode:(e,t={})=>({state:n,dispatch:r,chain:s})=>{let i,o=aW(e,n.schema);return(n.selection.$anchor.sameParent(n.selection.$head)&&(i=n.selection.$anchor.parent.attrs),o.isTextblock)?s().command(({commands:e})=>!!aT(o,{...i,...t})(n)||e.clearNodes()).command(({state:e})=>aT(o,{...i,...t})(e,r)).run():(console.warn('[tiptap warn]: Currently "setNode()" only supports text block nodes.'),!1)},setNodeSelection:e=>({tr:t,dispatch:n})=>{if(n){let{doc:n}=t,r=lm(e,0,n.content.size),s=sa.create(n,r);t.setSelection(s)}return!0},setTextSelection:e=>({tr:t,dispatch:n})=>{if(n){let{doc:n}=t,{from:r,to:s}="number"==typeof e?{from:e,to:e}:e,i=si.atStart(n).from,o=si.atEnd(n).to,a=lm(r,i,o),l=lm(s,i,o),c=si.create(n,a,l);t.setSelection(c)}return!0},sinkListItem:e=>({state:t,dispatch:n})=>(function(e){return function(t,n){let{$from:r,$to:s}=t.selection,i=r.blockRange(s,t=>t.childCount>0&&t.firstChild.type==e);if(!i)return!1;let o=i.startIndex;if(0==o)return!1;let a=i.parent,l=a.child(o-1);if(l.type!=e)return!1;if(n){let r=l.lastChild&&l.lastChild.type==a.type,s=nV.from(r?e.create():null),o=new nJ(nV.from(e.create(null,nV.from(a.type.create(null,s)))),r?3:1,0),c=i.start,d=i.end;n(t.tr.step(new rB(c-(r?3:1),d,c,d,o,1,!0)).scrollIntoView())}return!0}})(aW(e,t.schema))(t,n),splitBlock:({keepMarks:e=!0}={})=>({tr:t,state:n,dispatch:r,editor:s})=>{let{selection:i,doc:o}=t,{$from:a,$to:l}=i,c=lT(s.extensionManager.attributes,a.node().type.name,a.node().attrs);if(i instanceof sa&&i.node.isBlock)return!!a.parentOffset&&!!rJ(o,a.pos)&&(r&&(e&&lR(n,s.extensionManager.splittableMarks),t.split(a.pos).scrollIntoView()),!0);if(!a.parent.isBlock)return!1;let d=l.parentOffset===l.parent.content.size,h=0===a.depth?void 0:function(e){for(let t=0;t<e.edgeCount;t+=1){let{type:n}=e.edge(t);if(n.isTextblock&&!n.hasRequiredAttrs())return n}return null}(a.node(-1).contentMatchAt(a.indexAfter(-1))),u=d&&h?[{type:h,attrs:c}]:void 0,p=rJ(t.doc,t.mapping.map(a.pos),1,u);if(!u&&!p&&rJ(t.doc,t.mapping.map(a.pos),1,h?[{type:h}]:void 0)&&(p=!0,u=h?[{type:h,attrs:c}]:void 0),r){if(p&&(i instanceof si&&t.deleteSelection(),t.split(t.mapping.map(a.pos),1,u),h&&!d&&!a.parentOffset&&a.parent.type!==h)){let e=t.mapping.map(a.before()),n=t.doc.resolve(e);a.node(-1).canReplaceWith(n.index(),n.index()+1,h)&&t.setNodeMarkup(t.mapping.map(a.before()),h)}e&&lR(n,s.extensionManager.splittableMarks),t.scrollIntoView()}return p},splitListItem:(e,t={})=>({tr:n,state:r,dispatch:s,editor:i})=>{var o;let a=aW(e,r.schema),{$from:l,$to:c}=r.selection,d=r.selection.node;if(d&&d.isBlock||l.depth<2||!l.sameParent(c))return!1;let h=l.node(-1);if(h.type!==a)return!1;let u=i.extensionManager.attributes;if(0===l.parent.content.size&&l.node(-1).childCount===l.indexAfter(-1)){if(2===l.depth||l.node(-3).type!==a||l.index(-2)!==l.node(-2).childCount-1)return!1;if(s){let e=nV.empty,r=l.index(-1)?1:l.index(-2)?2:3;for(let t=l.depth-r;t>=l.depth-3;t-=1)e=nV.from(l.node(t).copy(e));let s=l.indexAfter(-1)<l.node(-2).childCount?1:l.indexAfter(-2)<l.node(-3).childCount?2:3,i={...lT(u,l.node().type.name,l.node().attrs),...t},c=(null==(o=a.contentMatch.defaultType)?void 0:o.createAndFill(i))||void 0;e=e.append(nV.from(a.createAndFill(null,c)||void 0));let d=l.before(l.depth-(r-1));n.replace(d,l.after(-s),new nJ(e,4-r,0));let h=-1;n.doc.nodesBetween(d,n.doc.content.size,(e,t)=>{if(h>-1)return!1;e.isTextblock&&0===e.content.size&&(h=t+1)}),h>-1&&n.setSelection(si.near(n.doc.resolve(h))),n.scrollIntoView()}return!0}let p=c.pos===l.end()?h.contentMatchAt(0).defaultType:null,f={...lT(u,h.type.name,h.attrs),...t},m={...lT(u,l.node().type.name,l.node().attrs),...t};n.delete(l.pos,c.pos);let g=p?[{type:a,attrs:f},{type:p,attrs:m}]:[{type:a,attrs:f}];if(!rJ(n.doc,l.pos,2))return!1;if(s){let{selection:e,storedMarks:t}=r,{splittableMarks:o}=i.extensionManager,a=t||e.$to.parentOffset&&e.$from.marks();if(n.split(l.pos,2,g).scrollIntoView(),!a||!s)return!0;let c=a.filter(e=>o.includes(e.type.name));n.ensureMarks(c)}return!0},toggleList:(e,t,n,r={})=>({editor:s,tr:i,state:o,dispatch:a,chain:l,commands:c,can:d})=>{let{extensions:h,splittableMarks:u}=s.extensionManager,p=aW(e,o.schema),f=aW(t,o.schema),{selection:m,storedMarks:g}=o,{$from:x,$to:y}=m,v=x.blockRange(y),b=g||m.$to.parentOffset&&m.$from.marks();if(!v)return!1;let w=lA(e=>lO(e.type.name,h))(m);if(v.depth>=1&&w&&v.depth-w.depth<=1){if(w.node.type===p)return c.liftListItem(f);if(lO(w.node.type.name,h)&&p.validContent(w.node.content)&&a)return l().command(()=>(i.setNodeMarkup(w.pos,p),!0)).command(()=>lP(i,p)).command(()=>lz(i,p)).run()}return n&&b&&a?l().command(()=>{let e=d().wrapInList(p,r),t=b.filter(e=>u.includes(e.type.name));return i.ensureMarks(t),!!e||c.clearNodes()}).wrapInList(p,r).command(()=>lP(i,p)).command(()=>lz(i,p)).run():l().command(()=>!!d().wrapInList(p,r)||c.clearNodes()).wrapInList(p,r).command(()=>lP(i,p)).command(()=>lz(i,p)).run()},toggleMark:(e,t={},n={})=>({state:r,commands:s})=>{let{extendEmptyMarkRange:i=!1}=n,o=lp(e,r.schema);return lD(r,o,t)?s.unsetMark(o,{extendEmptyMarkRange:i}):s.setMark(o,t)},toggleNode:(e,t,n={})=>({state:r,commands:s})=>{let i,o=aW(e,r.schema),a=aW(t,r.schema),l=lN(r,o,n);return(r.selection.$anchor.sameParent(r.selection.$head)&&(i=r.selection.$anchor.parent.attrs),l)?s.setNode(a,i):s.setNode(o,{...i,...n})},toggleWrap:(e,t={})=>({state:n,commands:r})=>{let s=aW(e,n.schema);return lN(n,s,t)?r.lift(s):r.wrapIn(s,t)},undoInputRule:()=>({state:e,dispatch:t})=>{let n=e.plugins;for(let r=0;r<n.length;r+=1){let s,i=n[r];if(i.spec.isInputRules&&(s=i.getState(e))){if(t){let t=e.tr,n=s.transform;for(let e=n.steps.length-1;e>=0;e-=1)t.step(n.steps[e].invert(n.docs[e]));if(s.text){let n=t.doc.resolve(s.from).marks();t.replaceWith(s.from,s.to,e.schema.text(s.text,n))}else t.delete(s.from,s.to)}return!0}}return!1},unsetAllMarks:()=>({tr:e,dispatch:t})=>{let{selection:n}=e,{empty:r,ranges:s}=n;return!!r||(t&&s.forEach(t=>{e.removeMark(t.$from.pos,t.$to.pos)}),!0)},unsetMark:(e,t={})=>({tr:n,state:r,dispatch:s})=>{var i;let{extendEmptyMarkRange:o=!1}=t,{selection:a}=n,l=lp(e,r.schema),{$from:c,empty:d,ranges:h}=a;if(!s)return!0;if(d&&o){let{from:e,to:t}=a,r=null==(i=c.marks().find(e=>e.type===l))?void 0:i.attrs,s=lu(c,l,r);s&&(e=s.from,t=s.to),n.removeMark(e,t,l)}else h.forEach(e=>{n.removeMark(e.$from.pos,e.$to.pos,l)});return n.removeStoredMark(l),!0},updateAttributes:(e,t={})=>({tr:n,state:r,dispatch:s})=>{let i=null,o=null,a=lj("string"==typeof e?e:e.name,r.schema);return!!a&&("node"===a&&(i=aW(e,r.schema)),"mark"===a&&(o=lp(e,r.schema)),s&&n.selection.ranges.forEach(e=>{let s,a,l,c,d=e.$from.pos,h=e.$to.pos;n.selection.empty?r.doc.nodesBetween(d,h,(e,t)=>{i&&i===e.type&&(l=Math.max(t,d),c=Math.min(t+e.nodeSize,h),s=t,a=e)}):r.doc.nodesBetween(d,h,(e,r)=>{r<d&&i&&i===e.type&&(l=Math.max(r,d),c=Math.min(r+e.nodeSize,h),s=r,a=e),r>=d&&r<=h&&(i&&i===e.type&&n.setNodeMarkup(r,void 0,{...e.attrs,...t}),o&&e.marks.length&&e.marks.forEach(s=>{if(o===s.type){let i=Math.max(r,d),a=Math.min(r+e.nodeSize,h);n.addMark(i,a,o.create({...s.attrs,...t}))}}))}),a&&(void 0!==s&&n.setNodeMarkup(s,void 0,{...a.attrs,...t}),o&&a.marks.length&&a.marks.forEach(e=>{o===e.type&&n.addMark(l,c,o.create({...e.attrs,...t}))}))}),!0)},wrapIn:(e,t={})=>({state:n,dispatch:r})=>(function(e,t=null){return function(n,r){let{$from:s,$to:i}=n.selection,o=s.blockRange(i),a=o&&rq(o,e,t);return!!a&&(r&&r(n.tr.wrap(o,a).scrollIntoView()),!0)}})(aW(e,n.schema),t)(n,r),wrapInList:(e,t={})=>({state:n,dispatch:r})=>(function(e,t=null){return function(n,r){let{$from:s,$to:i}=n.selection,o=s.blockRange(i);if(!o)return!1;let a=r?n.tr:null;return!!function(e,t,n,r=null){let s=!1,i=t,o=t.$from.doc;if(t.depth>=2&&t.$from.node(t.depth-1).type.compatibleContent(n)&&0==t.startIndex){if(0==t.$from.index(t.depth-1))return!1;let e=o.resolve(t.start-2);i=new n5(e,e,t.depth),t.endIndex<t.parent.childCount&&(t=new n5(t.$from,o.resolve(t.$to.end(t.depth)),t.depth)),s=!0}let a=rq(i,n,r,t);return!!a&&(e&&function(e,t,n,r,s){let i=nV.empty;for(let e=n.length-1;e>=0;e--)i=nV.from(n[e].type.create(n[e].attrs,i));e.step(new rB(t.start-2*!!r,t.end,t.start,t.end,new nJ(i,0,0),n.length,!0));let o=0;for(let e=0;e<n.length;e++)n[e].type==s&&(o=e+1);let a=n.length-o,l=t.start+n.length-2*!!r,c=t.parent;for(let n=t.startIndex,r=t.endIndex,s=!0;n<r;n++,s=!1)!s&&rJ(e.doc,l,a)&&(e.split(l,a),l+=2*a),l+=c.child(n).nodeSize}(e,t,a,s,n),!0)}(a,o,e,t)&&(r&&r(a.scrollIntoView()),!0)}})(aW(e,n.schema),t)(n,r)});let lL=li.create({name:"commands",addCommands:()=>({...l$})}),lB=li.create({name:"drop",addProseMirrorPlugins(){return[new sv({key:new sk("tiptapDrop"),props:{handleDrop:(e,t,n,r)=>{this.editor.emit("drop",{editor:this.editor,event:t,slice:n,moved:r})}}})]}}),lF=li.create({name:"editable",addProseMirrorPlugins(){return[new sv({key:new sk("editable"),props:{editable:()=>this.editor.options.editable}})]}}),lV=new sk("focusEvents"),l_=li.create({name:"focusEvents",addProseMirrorPlugins(){let{editor:e}=this;return[new sv({key:lV,props:{handleDOMEvents:{focus:(t,n)=>{e.isFocused=!0;let r=e.state.tr.setMeta("focus",{event:n}).setMeta("addToHistory",!1);return t.dispatch(r),!1},blur:(t,n)=>{e.isFocused=!1;let r=e.state.tr.setMeta("blur",{event:n}).setMeta("addToHistory",!1);return t.dispatch(r),!1}}}})]}}),lq=li.create({name:"keymap",addKeyboardShortcuts(){let e=()=>this.editor.commands.first(({commands:e})=>[()=>e.undoInputRule(),()=>e.command(({tr:t})=>{let{selection:n,doc:r}=t,{empty:s,$anchor:i}=n,{pos:o,parent:a}=i,l=i.parent.isTextblock&&o>0?t.doc.resolve(o-1):i,c=l.parent.type.spec.isolating,d=i.pos-i.parentOffset,h=c&&1===l.parent.childCount?d===i.pos:st.atStart(r).from===o;return!!s&&!!a.type.isTextblock&&!a.textContent.length&&!!h&&(!h||"paragraph"!==i.parent.type.name)&&e.clearNodes()}),()=>e.deleteSelection(),()=>e.joinBackward(),()=>e.selectNodeBackward()]),t=()=>this.editor.commands.first(({commands:e})=>[()=>e.deleteSelection(),()=>e.deleteCurrentNode(),()=>e.joinForward(),()=>e.selectNodeForward()]),n={Enter:()=>this.editor.commands.first(({commands:e})=>[()=>e.newlineInCode(),()=>e.createParagraphNear(),()=>e.liftEmptyBlock(),()=>e.splitBlock()]),"Mod-Enter":()=>this.editor.commands.exitCode(),Backspace:e,"Mod-Backspace":e,"Shift-Backspace":e,Delete:t,"Mod-Delete":t,"Mod-a":()=>this.editor.commands.selectAll()},r={...n},s={...n,"Ctrl-h":e,"Alt-Backspace":e,"Ctrl-d":t,"Ctrl-Alt-Backspace":t,"Alt-Delete":t,"Alt-d":t,"Ctrl-a":()=>this.editor.commands.selectTextblockStart(),"Ctrl-e":()=>this.editor.commands.selectTextblockEnd()};return lx()||lk()?s:r},addProseMirrorPlugins(){return[new sv({key:new sk("clearDocument"),appendTransaction:(e,t,n)=>{if(e.some(e=>e.getMeta("composition")))return;let r=e.some(e=>e.docChanged)&&!t.doc.eq(n.doc),s=e.some(e=>e.getMeta("preventClearDocument"));if(!r||s)return;let{empty:i,from:o,to:a}=t.selection,l=st.atStart(t.doc).from,c=st.atEnd(t.doc).to;if(i||o!==l||a!==c||!lI(n.doc))return;let d=n.tr,h=aB({state:n,transaction:d}),{commands:u}=new aF({editor:this.editor,state:h});if(u.clearNodes(),d.steps.length)return d}})]}}),lH=li.create({name:"paste",addProseMirrorPlugins(){return[new sv({key:new sk("tiptapPaste"),props:{handlePaste:(e,t,n)=>{this.editor.emit("paste",{editor:this.editor,event:t,slice:n})}}})]}}),lW=li.create({name:"tabindex",addProseMirrorPlugins(){return[new sv({key:new sk("tabindex"),props:{attributes:()=>this.editor.isEditable?{tabindex:"0"}:{}}})]}});class lU{get name(){return this.node.type.name}constructor(e,t,n=!1,r=null){this.currentNode=null,this.actualDepth=null,this.isBlock=n,this.resolvedPos=e,this.editor=t,this.currentNode=r}get node(){return this.currentNode||this.resolvedPos.node()}get element(){return this.editor.view.domAtPos(this.pos).node}get depth(){var e;return null!=(e=this.actualDepth)?e:this.resolvedPos.depth}get pos(){return this.resolvedPos.pos}get content(){return this.node.content}set content(e){let t=this.from,n=this.to;if(this.isBlock){if(0===this.content.size)return void console.error(`You cant set content on a block node. Tried to set content on ${this.name} at ${this.pos}`);t=this.from+1,n=this.to-1}this.editor.commands.insertContentAt({from:t,to:n},e)}get attributes(){return this.node.attrs}get textContent(){return this.node.textContent}get size(){return this.node.nodeSize}get from(){return this.isBlock?this.pos:this.resolvedPos.start(this.resolvedPos.depth)}get range(){return{from:this.from,to:this.to}}get to(){return this.isBlock?this.pos+this.size:this.resolvedPos.end(this.resolvedPos.depth)+ +!this.node.isText}get parent(){if(0===this.depth)return null;let e=this.resolvedPos.start(this.resolvedPos.depth-1);return new lU(this.resolvedPos.doc.resolve(e),this.editor)}get before(){let e=this.resolvedPos.doc.resolve(this.from-(this.isBlock?1:2));return e.depth!==this.depth&&(e=this.resolvedPos.doc.resolve(this.from-3)),new lU(e,this.editor)}get after(){let e=this.resolvedPos.doc.resolve(this.to+(this.isBlock?2:1));return e.depth!==this.depth&&(e=this.resolvedPos.doc.resolve(this.to+3)),new lU(e,this.editor)}get children(){let e=[];return this.node.content.forEach((t,n)=>{let r=t.isBlock&&!t.isTextblock,s=t.isAtom&&!t.isText,i=this.pos+n+ +!s;if(i<0||i>this.resolvedPos.doc.nodeSize-2)return;let o=this.resolvedPos.doc.resolve(i);if(!r&&o.depth<=this.depth)return;let a=new lU(o,this.editor,r,r?t:null);r&&(a.actualDepth=this.depth+1),e.push(new lU(o,this.editor,r,r?t:null))}),e}get firstChild(){return this.children[0]||null}get lastChild(){let e=this.children;return e[e.length-1]||null}closest(e,t={}){let n=null,r=this.parent;for(;r&&!n;){if(r.node.type.name===e)if(Object.keys(t).length>0){let e=r.node.attrs,n=Object.keys(t);for(let r=0;r<n.length;r+=1){let s=n[r];if(e[s]!==t[s])break}}else n=r;r=r.parent}return n}querySelector(e,t={}){return this.querySelectorAll(e,t,!0)[0]||null}querySelectorAll(e,t={},n=!1){let r=[];if(!this.children||0===this.children.length)return r;let s=Object.keys(t);return this.children.forEach(i=>{(!n||!(r.length>0))&&(i.node.type.name===e&&s.every(e=>t[e]===i.node.attrs[e])&&r.push(i),n&&r.length>0||(r=r.concat(i.querySelectorAll(e,t,n))))}),r}setAttribute(e){let{tr:t}=this.editor.state;t.setNodeMarkup(this.from,void 0,{...this.node.attrs,...e}),this.editor.view.dispatch(t)}}let lJ=`.ProseMirror {
  position: relative;
}

.ProseMirror {
  word-wrap: break-word;
  white-space: pre-wrap;
  white-space: break-spaces;
  -webkit-font-variant-ligatures: none;
  font-variant-ligatures: none;
  font-feature-settings: "liga" 0; /* the above doesn't seem to work in Edge */
}

.ProseMirror [contenteditable="false"] {
  white-space: normal;
}

.ProseMirror [contenteditable="false"] [contenteditable="true"] {
  white-space: pre-wrap;
}

.ProseMirror pre {
  white-space: pre-wrap;
}

img.ProseMirror-separator {
  display: inline !important;
  border: none !important;
  margin: 0 !important;
  width: 0 !important;
  height: 0 !important;
}

.ProseMirror-gapcursor {
  display: none;
  pointer-events: none;
  position: absolute;
  margin: 0;
}

.ProseMirror-gapcursor:after {
  content: "";
  display: block;
  position: absolute;
  top: -2px;
  width: 20px;
  border-top: 1px solid black;
  animation: ProseMirror-cursor-blink 1.1s steps(2, start) infinite;
}

@keyframes ProseMirror-cursor-blink {
  to {
    visibility: hidden;
  }
}

.ProseMirror-hideselection *::selection {
  background: transparent;
}

.ProseMirror-hideselection *::-moz-selection {
  background: transparent;
}

.ProseMirror-hideselection * {
  caret-color: transparent;
}

.ProseMirror-focused .ProseMirror-gapcursor {
  display: block;
}

.tippy-box[data-animation=fade][data-state=hidden] {
  opacity: 0
}`;class lK extends aV{constructor(e={}){super(),this.isFocused=!1,this.isInitialized=!1,this.extensionStorage={},this.options={element:document.createElement("div"),content:"",injectCSS:!0,injectNonce:void 0,extensions:[],autofocus:!1,editable:!0,editorProps:{},parseOptions:{},coreExtensionOptions:{},enableInputRules:!0,enablePasteRules:!0,enableCoreExtensions:!0,enableContentCheck:!1,emitContentError:!1,onBeforeCreate:()=>null,onCreate:()=>null,onUpdate:()=>null,onSelectionUpdate:()=>null,onTransaction:()=>null,onFocus:()=>null,onBlur:()=>null,onDestroy:()=>null,onContentError:({error:e})=>{throw e},onPaste:()=>null,onDrop:()=>null},this.isCapturingTransaction=!1,this.capturedTransaction=null,this.setOptions(e),this.createExtensionManager(),this.createCommandManager(),this.createSchema(),this.on("beforeCreate",this.options.onBeforeCreate),this.emit("beforeCreate",{editor:this}),this.on("contentError",this.options.onContentError),this.createView(),this.injectCSS(),this.on("create",this.options.onCreate),this.on("update",this.options.onUpdate),this.on("selectionUpdate",this.options.onSelectionUpdate),this.on("transaction",this.options.onTransaction),this.on("focus",this.options.onFocus),this.on("blur",this.options.onBlur),this.on("destroy",this.options.onDestroy),this.on("drop",({event:e,slice:t,moved:n})=>this.options.onDrop(e,t,n)),this.on("paste",({event:e,slice:t})=>this.options.onPaste(e,t)),window.setTimeout(()=>{this.isDestroyed||(this.commands.focus(this.options.autofocus),this.emit("create",{editor:this}),this.isInitialized=!0)},0)}get storage(){return this.extensionStorage}get commands(){return this.commandManager.commands}chain(){return this.commandManager.chain()}can(){return this.commandManager.can()}injectCSS(){this.options.injectCSS&&document&&(this.css=function(e,t,n){let r=document.querySelector("style[data-tiptap-style]");if(null!==r)return r;let s=document.createElement("style");return t&&s.setAttribute("nonce",t),s.setAttribute("data-tiptap-style",""),s.innerHTML=e,document.getElementsByTagName("head")[0].appendChild(s),s}(lJ,this.options.injectNonce))}setOptions(e={}){this.options={...this.options,...e},this.view&&this.state&&!this.isDestroyed&&(this.options.editorProps&&this.view.setProps(this.options.editorProps),this.view.updateState(this.state))}setEditable(e,t=!0){this.setOptions({editable:e}),t&&this.emit("update",{editor:this,transaction:this.state.tr})}get isEditable(){return this.options.editable&&this.view&&this.view.editable}get state(){return this.view.state}registerPlugin(e,t){let n=aK(t)?t(e,[...this.state.plugins]):[...this.state.plugins,e],r=this.state.reconfigure({plugins:n});return this.view.updateState(r),r}unregisterPlugin(e){if(this.isDestroyed)return;let t=this.state.plugins,n=t;if([].concat(e).forEach(e=>{let t="string"==typeof e?`${e}$`:e.key;n=n.filter(e=>!e.key.startsWith(t))}),t.length===n.length)return;let r=this.state.reconfigure({plugins:n});return this.view.updateState(r),r}createExtensionManager(){var e,t;let n=[...this.options.enableCoreExtensions?[lF,ll.configure({blockSeparator:null==(t=null==(e=this.options.coreExtensionOptions)?void 0:e.clipboardTextSerializer)?void 0:t.blockSeparator}),lL,l_,lq,lW,lB,lH].filter(e=>"object"!=typeof this.options.enableCoreExtensions||!1!==this.options.enableCoreExtensions[e.name]):[],...this.options.extensions].filter(e=>["extension","node","mark"].includes(null==e?void 0:e.type));this.extensionManager=new ls(n,this)}createCommandManager(){this.commandManager=new aF({editor:this})}createSchema(){this.schema=this.extensionManager.schema}createView(){var e;let t;try{t=lC(this.options.content,this.schema,this.options.parseOptions,{errorOnInvalidContent:this.options.enableContentCheck})}catch(e){if(!(e instanceof Error)||!["[tiptap error]: Invalid JSON content","[tiptap error]: Invalid HTML content"].includes(e.message))throw e;this.emit("contentError",{editor:this,error:e,disableCollaboration:()=>{this.storage.collaboration&&(this.storage.collaboration.isDisabled=!0),this.options.extensions=this.options.extensions.filter(e=>"collaboration"!==e.name),this.createExtensionManager()}}),t=lC(this.options.content,this.schema,this.options.parseOptions,{errorOnInvalidContent:!1})}let n=lg(t,this.options.autofocus);this.view=new oZ(this.options.element,{...this.options.editorProps,attributes:{role:"textbox",...null==(e=this.options.editorProps)?void 0:e.attributes},dispatchTransaction:this.dispatchTransaction.bind(this),state:sy.create({doc:t,selection:n||void 0})});let r=this.state.reconfigure({plugins:this.extensionManager.plugins});this.view.updateState(r),this.createNodeViews(),this.prependClass(),this.view.dom.editor=this}createNodeViews(){this.view.isDestroyed||this.view.setProps({nodeViews:this.extensionManager.nodeViews})}prependClass(){this.view.dom.className=`tiptap ${this.view.dom.className}`}captureTransaction(e){this.isCapturingTransaction=!0,e(),this.isCapturingTransaction=!1;let t=this.capturedTransaction;return this.capturedTransaction=null,t}dispatchTransaction(e){if(this.view.isDestroyed)return;if(this.isCapturingTransaction){if(!this.capturedTransaction){this.capturedTransaction=e;return}e.steps.forEach(e=>{var t;return null==(t=this.capturedTransaction)?void 0:t.step(e)});return}let t=this.state.apply(e),n=!this.state.selection.eq(t.selection);this.emit("beforeTransaction",{editor:this,transaction:e,nextState:t}),this.view.updateState(t),this.emit("transaction",{editor:this,transaction:e}),n&&this.emit("selectionUpdate",{editor:this,transaction:e});let r=e.getMeta("focus"),s=e.getMeta("blur");r&&this.emit("focus",{editor:this,event:r.event,transaction:e}),s&&this.emit("blur",{editor:this,event:s.event,transaction:e}),!e.docChanged||e.getMeta("preventUpdate")||this.emit("update",{editor:this,transaction:e})}getAttributes(e){return function(e,t){let n=lj("string"==typeof t?t:t.name,e.schema);if("node"===n){let n=aW(t,e.schema),{from:r,to:s}=e.selection,i=[];e.doc.nodesBetween(r,s,e=>{i.push(e)});let o=i.reverse().find(e=>e.type.name===n.name);return o?{...o.attrs}:{}}return"mark"===n?lM(e,t):{}}(this.state,e)}isActive(e,t){let n="string"==typeof e?e:null,r="string"==typeof e?t:e;return function(e,t,n={}){if(!t)return lN(e,null,n)||lD(e,null,n);let r=lj(t,e.schema);return"node"===r?lN(e,t,n):"mark"===r&&lD(e,t,n)}(this.state,n,r)}getJSON(){return this.state.doc.toJSON()}getHTML(){return a1(this.state.doc.content,this.schema)}getText(e){let{blockSeparator:t="\n\n",textSerializers:n={}}=e||{};return function(e,t){let n={from:0,to:e.content.size};return lo(e,n,t)}(this.state.doc,{blockSeparator:t,textSerializers:{...la(this.schema),...n}})}get isEmpty(){return lI(this.state.doc)}getCharacterCount(){return console.warn('[tiptap warn]: "editor.getCharacterCount()" is deprecated. Please use "editor.storage.characterCount.characters()" instead.'),this.state.doc.content.size-2}destroy(){if(this.emit("destroy"),this.view){let e=this.view.dom;e&&e.editor&&delete e.editor,this.view.destroy()}this.removeAllListeners()}get isDestroyed(){var e;return!(null==(e=this.view)?void 0:e.docView)}$node(e,t){var n;return(null==(n=this.$doc)?void 0:n.querySelector(e,t))||null}$nodes(e,t){var n;return(null==(n=this.$doc)?void 0:n.querySelectorAll(e,t))||null}$pos(e){return new lU(this.state.doc.resolve(e),this)}get $doc(){return this.$pos(0)}}function lG(e){return new a5({find:e.find,handler:({state:t,range:n,match:r})=>{let s=aG(e.getAttributes,void 0,r);if(!1===s||null===s)return null;let{tr:i}=t,o=r[r.length-1],a=r[0];if(o){let r=a.search(/\S/),l=n.from+a.indexOf(o),c=l+o.length;if(lE(n.from,n.to,t.doc).filter(t=>t.mark.type.excluded.find(n=>n===e.type&&n!==t.mark.type)).filter(e=>e.to>l).length)return null;c<n.to&&i.delete(c,n.to),l>n.from&&i.delete(n.from+r,l);let d=n.from+r+o.length;i.addMark(n.from+r,d,e.type.create(s||{})),i.removeStoredMark(e.type)}}})}function lY(e){return new a5({find:e.find,handler:({state:t,range:n,match:r})=>{let s=t.doc.resolve(n.from),i=aG(e.getAttributes,void 0,r)||{};if(!s.node(-1).canReplaceWith(s.index(-1),s.indexAfter(-1),e.type))return null;t.tr.delete(n.from,n.to).setBlockType(n.from,n.from,e.type,i)}})}function lX(e){return new a5({find:e.find,handler:({state:t,range:n,match:r,chain:s})=>{let i=aG(e.getAttributes,void 0,r)||{},o=t.tr.delete(n.from,n.to),a=o.doc.resolve(n.from).blockRange(),l=a&&rq(a,e.type,i);if(!l)return null;if(o.wrap(a,l),e.keepMarks&&e.editor){let{selection:n,storedMarks:r}=t,{splittableMarks:s}=e.editor.extensionManager,i=r||n.$to.parentOffset&&n.$from.marks();if(i){let e=i.filter(e=>s.includes(e.type.name));o.ensureMarks(e)}}if(e.keepAttributes){let t="bulletList"===e.type.name||"orderedList"===e.type.name?"listItem":"taskList";s().updateAttributes(t,i).run()}let c=o.doc.resolve(n.from-1).nodeBefore;c&&c.type===e.type&&rK(o.doc,n.from-1)&&(!e.joinPredicate||e.joinPredicate(r,c))&&o.join(n.from-1)}})}class lZ{constructor(e={}){this.type="node",this.name="node",this.parent=null,this.child=null,this.config={name:this.name,defaultOptions:{}},this.config={...this.config,...e},this.name=this.config.name,e.defaultOptions&&Object.keys(e.defaultOptions).length>0&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${this.name}".`),this.options=this.config.defaultOptions,this.config.addOptions&&(this.options=aG(a_(this,"addOptions",{name:this.name}))),this.storage=aG(a_(this,"addStorage",{name:this.name,options:this.options}))||{}}static create(e={}){return new lZ(e)}configure(e={}){let t=this.extend({...this.config,addOptions:()=>a7(this.options,e)});return t.name=this.name,t.parent=this.parent,t}extend(e={}){let t=new lZ(e);return t.parent=this,this.child=t,t.name=e.name?e.name:t.parent.name,e.defaultOptions&&Object.keys(e.defaultOptions).length>0&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${t.name}".`),t.options=aG(a_(t,"addOptions",{name:t.name})),t.storage=aG(a_(t,"addStorage",{name:t.name,options:t.options})),t}}function lQ(e){return new le({find:e.find,handler:({state:t,range:n,match:r,pasteEvent:s})=>{let i=aG(e.getAttributes,void 0,r,s);if(!1===i||null===i)return null;let{tr:o}=t,a=r[r.length-1],l=r[0],c=n.to;if(a){let r=l.search(/\S/),s=n.from+l.indexOf(a),d=s+a.length;if(lE(n.from,n.to,t.doc).filter(t=>t.mark.type.excluded.find(n=>n===e.type&&n!==t.mark.type)).filter(e=>e.to>s).length)return null;d<n.to&&o.delete(d,n.to),s>n.from&&o.delete(n.from+r,s),c=n.from+r+a.length,o.addMark(n.from+r,c,e.type.create(i||{})),o.removeStoredMark(e.type)}}})}var l0={exports:{}},l1={};l0.exports=function(){if(o)return l1;o=1;var e="function"==typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e==1/t)||e!=e&&t!=t},t=c.useState,n=c.useEffect,r=c.useLayoutEffect,s=c.useDebugValue;function i(t){var n=t.getSnapshot;t=t.value;try{var r=n();return!e(t,r)}catch(e){return!0}}var a="undefined"==typeof window||void 0===window.document||void 0===window.document.createElement?function(e,t){return t()}:function(e,o){var a=o(),l=t({inst:{value:a,getSnapshot:o}}),c=l[0].inst,d=l[1];return r(function(){c.value=a,c.getSnapshot=o,i(c)&&d({inst:c})},[e,a,o]),n(function(){return i(c)&&d({inst:c}),e(function(){i(c)&&d({inst:c})})},[e]),s(a),a};return l1.useSyncExternalStore=void 0!==c.useSyncExternalStore?c.useSyncExternalStore:a,l1}();var l2=l0.exports;let l4=(...e)=>t=>{e.forEach(e=>{"function"==typeof e?e(t):e&&(e.current=t)})},l5=({contentComponent:e})=>{let t=l2.useSyncExternalStore(e.subscribe,e.getSnapshot,e.getServerSnapshot);return c.createElement(c.Fragment,null,Object.values(t))};class l3 extends c.Component{constructor(e){var t;super(e),this.editorContentRef=c.createRef(),this.initialized=!1,this.state={hasContentComponentInitialized:!!(null==(t=e.editor)?void 0:t.contentComponent)}}componentDidMount(){this.init()}componentDidUpdate(){this.init()}init(){let e=this.props.editor;if(e&&!e.isDestroyed&&e.options.element){if(e.contentComponent)return;let t=this.editorContentRef.current;t.append(...e.options.element.childNodes),e.setOptions({element:t}),e.contentComponent=function(){let e=new Set,t={};return{subscribe:t=>(e.add(t),()=>{e.delete(t)}),getSnapshot:()=>t,getServerSnapshot:()=>t,setRenderer(n,r){t={...t,[n]:nB.createPortal(r.reactElement,r.element,n)},e.forEach(e=>e())},removeRenderer(n){let r={...t};delete r[n],t=r,e.forEach(e=>e())}}}(),this.state.hasContentComponentInitialized||(this.unsubscribeToContentComponent=e.contentComponent.subscribe(()=>{this.setState(e=>e.hasContentComponentInitialized?e:{hasContentComponentInitialized:!0}),this.unsubscribeToContentComponent&&this.unsubscribeToContentComponent()})),e.createNodeViews(),this.initialized=!0}}componentWillUnmount(){let e=this.props.editor;if(!e||(this.initialized=!1,e.isDestroyed||e.view.setProps({nodeViews:{}}),this.unsubscribeToContentComponent&&this.unsubscribeToContentComponent(),e.contentComponent=null,!e.options.element.firstChild))return;let t=document.createElement("div");t.append(...e.options.element.childNodes),e.setOptions({element:t})}render(){let{editor:e,innerRef:t,...n}=this.props;return c.createElement(c.Fragment,null,c.createElement("div",{ref:l4(t,this.editorContentRef),...n}),(null==e?void 0:e.contentComponent)&&c.createElement(l5,{contentComponent:e.contentComponent}))}}let l6=(0,c.forwardRef)((e,t)=>{let n=c.useMemo(()=>Math.floor(0xffffffff*Math.random()).toString(),[e.editor]);return c.createElement(l3,{key:n,innerRef:t,...e})}),l8=c.memo(l6);var l7=function(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}(function e(t,n){if(t===n)return!0;if(t&&n&&"object"==typeof t&&"object"==typeof n){if(t.constructor!==n.constructor)return!1;if(Array.isArray(t)){if((r=t.length)!=n.length)return!1;for(s=r;0!=s--;)if(!e(t[s],n[s]))return!1;return!0}if(t instanceof Map&&n instanceof Map){if(t.size!==n.size)return!1;for(s of t.entries())if(!n.has(s[0]))return!1;for(s of t.entries())if(!e(s[1],n.get(s[0])))return!1;return!0}if(t instanceof Set&&n instanceof Set){if(t.size!==n.size)return!1;for(s of t.entries())if(!n.has(s[0]))return!1;return!0}if(ArrayBuffer.isView(t)&&ArrayBuffer.isView(n)){if((r=t.length)!=n.length)return!1;for(s=r;0!=s--;)if(t[s]!==n[s])return!1;return!0}if(t.constructor===RegExp)return t.source===n.source&&t.flags===n.flags;if(t.valueOf!==Object.prototype.valueOf)return t.valueOf()===n.valueOf();if(t.toString!==Object.prototype.toString)return t.toString()===n.toString();if((r=(i=Object.keys(t)).length)!==Object.keys(n).length)return!1;for(s=r;0!=s--;)if(!Object.prototype.hasOwnProperty.call(n,i[s]))return!1;for(s=r;0!=s--;){var r,s,i,o=i[s];if(("_owner"!==o||!t.$$typeof)&&!e(t[o],n[o]))return!1}return!0}return t!=t&&n!=n}),l9={exports:{}},ce={};l9.exports=function(){if(a)return ce;a=1;var e="function"==typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e==1/t)||e!=e&&t!=t},t=l2.useSyncExternalStore,n=c.useRef,r=c.useEffect,s=c.useMemo,i=c.useDebugValue;return ce.useSyncExternalStoreWithSelector=function(o,a,l,c,d){var h=n(null);if(null===h.current){var u={hasValue:!1,value:null};h.current=u}else u=h.current;var p=t(o,(h=s(function(){function t(t){if(!s){if(s=!0,n=t,t=c(t),void 0!==d&&u.hasValue){var i=u.value;if(d(i,t))return r=i}return r=t}if(i=r,e(n,t))return i;var o=c(t);return void 0!==d&&d(i,o)?i:(n=t,r=o)}var n,r,s=!1,i=void 0===l?null:l;return[function(){return t(a())},null===i?void 0:function(){return t(i())}]},[a,l,c,d]))[0],h[1]);return r(function(){u.hasValue=!0,u.value=p},[p]),i(p),p},ce}();var ct=l9.exports;let cn="undefined"!=typeof window?c.useLayoutEffect:c.useEffect;class cr{constructor(e){this.transactionNumber=0,this.lastTransactionNumber=0,this.subscribers=new Set,this.editor=e,this.lastSnapshot={editor:e,transactionNumber:0},this.getSnapshot=this.getSnapshot.bind(this),this.getServerSnapshot=this.getServerSnapshot.bind(this),this.watch=this.watch.bind(this),this.subscribe=this.subscribe.bind(this)}getSnapshot(){return this.transactionNumber===this.lastTransactionNumber||(this.lastTransactionNumber=this.transactionNumber,this.lastSnapshot={editor:this.editor,transactionNumber:this.transactionNumber}),this.lastSnapshot}getServerSnapshot(){return{editor:null,transactionNumber:0}}subscribe(e){return this.subscribers.add(e),()=>{this.subscribers.delete(e)}}watch(e){if(this.editor=e,this.editor){let e=()=>{this.transactionNumber+=1,this.subscribers.forEach(e=>e())},t=this.editor;return t.on("transaction",e),()=>{t.off("transaction",e)}}}}let cs="undefined"==typeof window,ci=cs||!!("undefined"!=typeof window&&window.next);class co{constructor(e){this.editor=null,this.subscriptions=new Set,this.isComponentMounted=!1,this.previousDeps=null,this.instanceId="",this.options=e,this.subscriptions=new Set,this.setEditor(this.getInitialEditor()),this.scheduleDestroy(),this.getEditor=this.getEditor.bind(this),this.getServerSnapshot=this.getServerSnapshot.bind(this),this.subscribe=this.subscribe.bind(this),this.refreshEditorInstance=this.refreshEditorInstance.bind(this),this.scheduleDestroy=this.scheduleDestroy.bind(this),this.onRender=this.onRender.bind(this),this.createEditor=this.createEditor.bind(this)}setEditor(e){this.editor=e,this.instanceId=Math.random().toString(36).slice(2,9),this.subscriptions.forEach(e=>e())}getInitialEditor(){return void 0===this.options.current.immediatelyRender?cs||ci?null:this.createEditor():(this.options.current.immediatelyRender,this.options.current.immediatelyRender?this.createEditor():null)}createEditor(){return new lK({...this.options.current,onBeforeCreate:(...e)=>{var t,n;return null==(n=(t=this.options.current).onBeforeCreate)?void 0:n.call(t,...e)},onBlur:(...e)=>{var t,n;return null==(n=(t=this.options.current).onBlur)?void 0:n.call(t,...e)},onCreate:(...e)=>{var t,n;return null==(n=(t=this.options.current).onCreate)?void 0:n.call(t,...e)},onDestroy:(...e)=>{var t,n;return null==(n=(t=this.options.current).onDestroy)?void 0:n.call(t,...e)},onFocus:(...e)=>{var t,n;return null==(n=(t=this.options.current).onFocus)?void 0:n.call(t,...e)},onSelectionUpdate:(...e)=>{var t,n;return null==(n=(t=this.options.current).onSelectionUpdate)?void 0:n.call(t,...e)},onTransaction:(...e)=>{var t,n;return null==(n=(t=this.options.current).onTransaction)?void 0:n.call(t,...e)},onUpdate:(...e)=>{var t,n;return null==(n=(t=this.options.current).onUpdate)?void 0:n.call(t,...e)},onContentError:(...e)=>{var t,n;return null==(n=(t=this.options.current).onContentError)?void 0:n.call(t,...e)},onDrop:(...e)=>{var t,n;return null==(n=(t=this.options.current).onDrop)?void 0:n.call(t,...e)},onPaste:(...e)=>{var t,n;return null==(n=(t=this.options.current).onPaste)?void 0:n.call(t,...e)}})}getEditor(){return this.editor}getServerSnapshot(){return null}subscribe(e){return this.subscriptions.add(e),()=>{this.subscriptions.delete(e)}}static compareOptions(e,t){return Object.keys(e).every(n=>!!["onCreate","onBeforeCreate","onDestroy","onUpdate","onTransaction","onFocus","onBlur","onSelectionUpdate","onContentError","onDrop","onPaste"].includes(n)||("extensions"===n&&e.extensions&&t.extensions?e.extensions.length===t.extensions.length&&e.extensions.every((e,n)=>{var r;return e===(null==(r=t.extensions)?void 0:r[n])}):e[n]===t[n]))}onRender(e){return()=>(this.isComponentMounted=!0,clearTimeout(this.scheduledDestructionTimeout),this.editor&&!this.editor.isDestroyed&&0===e.length?co.compareOptions(this.options.current,this.editor.options)||this.editor.setOptions({...this.options.current,editable:this.editor.isEditable}):this.refreshEditorInstance(e),()=>{this.isComponentMounted=!1,this.scheduleDestroy()})}refreshEditorInstance(e){if(this.editor&&!this.editor.isDestroyed){if(null===this.previousDeps){this.previousDeps=e;return}if(this.previousDeps.length===e.length&&this.previousDeps.every((t,n)=>t===e[n]))return}this.editor&&!this.editor.isDestroyed&&this.editor.destroy(),this.setEditor(this.createEditor()),this.previousDeps=e}scheduleDestroy(){let e=this.instanceId,t=this.editor;this.scheduledDestructionTimeout=setTimeout(()=>{if(this.isComponentMounted&&this.instanceId===e){t&&t.setOptions(this.options.current);return}t&&!t.isDestroyed&&(t.destroy(),this.instanceId===e&&this.setEditor(null))},1)}}let ca=((0,c.createContext)({editor:null}).Consumer,(0,c.createContext)({onDragStart:void 0})),cl=()=>(0,c.useContext)(ca);function cc(e){return!!("function"==typeof e&&e.prototype&&e.prototype.isReactComponent)}function cd(e){return!!("object"==typeof e&&e.$$typeof&&("Symbol(react.forward_ref)"===e.$$typeof.toString()||"react.forward_ref"===e.$$typeof.description))}c.forwardRef((e,t)=>{let{onDragStart:n}=cl(),r=e.as||"div";return c.createElement(r,{...e,ref:t,"data-node-view-wrapper":"",onDragStart:n,style:{whiteSpace:"normal",...e.style}})});class ch{constructor(e,{editor:t,props:n={},as:r="div",className:s=""}){this.ref=null,this.id=Math.floor(0xffffffff*Math.random()).toString(),this.component=e,this.editor=t,this.props=n,this.element=document.createElement(r),this.element.classList.add("react-renderer"),s&&this.element.classList.add(...s.split(" ")),this.editor.isInitialized?flushSync(()=>{this.render()}):this.render()}render(){var e;let t=this.component,n=this.props,r=this.editor,s=function(){try{if(version)return parseInt(version.split(".")[0],10)>=19}catch{}return!1}(),i=function(e){if(cc(e)||cd(e))return!0;if("object"==typeof e&&e.$$typeof&&("Symbol(react.memo)"===e.$$typeof.toString()||"react.memo"===e.$$typeof.description)){let t=e.type;if(t)return cc(t)||cd(t)}return!1}(t),o={...n};o.ref&&!(s||i)&&delete o.ref,!o.ref&&(s||i)&&(o.ref=e=>{this.ref=e}),this.reactElement=React.createElement(t,{...o}),null==(e=null==r?void 0:r.contentComponent)||e.setRenderer(this.id,this)}updateProps(e={}){this.props={...this.props,...e},this.render()}destroy(){var e;let t=this.editor;null==(e=null==t?void 0:t.contentComponent)||e.removeRenderer(this.id)}updateAttributes(e){Object.keys(e).forEach(t=>{this.element.setAttribute(t,e[t])})}}let cu=/^\s*>\s$/,cp=lZ.create({name:"blockquote",addOptions:()=>({HTMLAttributes:{}}),content:"block+",group:"block",defining:!0,parseHTML:()=>[{tag:"blockquote"}],renderHTML({HTMLAttributes:e}){return["blockquote",aU(this.options.HTMLAttributes,e),0]},addCommands(){return{setBlockquote:()=>({commands:e})=>e.wrapIn(this.name),toggleBlockquote:()=>({commands:e})=>e.toggleWrap(this.name),unsetBlockquote:()=>({commands:e})=>e.lift(this.name)}},addKeyboardShortcuts(){return{"Mod-Shift-b":()=>this.editor.commands.toggleBlockquote()}},addInputRules(){return[lX({find:cu,type:this.type})]}}),cf=/(?:^|\s)(\*\*(?!\s+\*\*)((?:[^*]+))\*\*(?!\s+\*\*))$/,cm=/(?:^|\s)(\*\*(?!\s+\*\*)((?:[^*]+))\*\*(?!\s+\*\*))/g,cg=/(?:^|\s)(__(?!\s+__)((?:[^_]+))__(?!\s+__))$/,cx=/(?:^|\s)(__(?!\s+__)((?:[^_]+))__(?!\s+__))/g,cy=a9.create({name:"bold",addOptions:()=>({HTMLAttributes:{}}),parseHTML(){return[{tag:"strong"},{tag:"b",getAttrs:e=>"normal"!==e.style.fontWeight&&null},{style:"font-weight=400",clearMark:e=>e.type.name===this.name},{style:"font-weight",getAttrs:e=>/^(bold(er)?|[5-9]\d{2,})$/.test(e)&&null}]},renderHTML({HTMLAttributes:e}){return["strong",aU(this.options.HTMLAttributes,e),0]},addCommands(){return{setBold:()=>({commands:e})=>e.setMark(this.name),toggleBold:()=>({commands:e})=>e.toggleMark(this.name),unsetBold:()=>({commands:e})=>e.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-b":()=>this.editor.commands.toggleBold(),"Mod-B":()=>this.editor.commands.toggleBold()}},addInputRules(){return[lG({find:cf,type:this.type}),lG({find:cg,type:this.type})]},addPasteRules(){return[lQ({find:cm,type:this.type}),lQ({find:cx,type:this.type})]}}),cv="textStyle",cb=/^\s*([-+*])\s$/,cw=lZ.create({name:"bulletList",addOptions:()=>({itemTypeName:"listItem",HTMLAttributes:{},keepMarks:!1,keepAttributes:!1}),group:"block list",content(){return`${this.options.itemTypeName}+`},parseHTML:()=>[{tag:"ul"}],renderHTML({HTMLAttributes:e}){return["ul",aU(this.options.HTMLAttributes,e),0]},addCommands(){return{toggleBulletList:()=>({commands:e,chain:t})=>this.options.keepAttributes?t().toggleList(this.name,this.options.itemTypeName,this.options.keepMarks).updateAttributes("listItem",this.editor.getAttributes(cv)).run():e.toggleList(this.name,this.options.itemTypeName,this.options.keepMarks)}},addKeyboardShortcuts(){return{"Mod-Shift-8":()=>this.editor.commands.toggleBulletList()}},addInputRules(){let e=lX({find:cb,type:this.type});return(this.options.keepMarks||this.options.keepAttributes)&&(e=lX({find:cb,type:this.type,keepMarks:this.options.keepMarks,keepAttributes:this.options.keepAttributes,getAttributes:()=>this.editor.getAttributes(cv),editor:this.editor})),[e]}}),ck=/(^|[^`])`([^`]+)`(?!`)/,cN=/(^|[^`])`([^`]+)`(?!`)/g,cj=a9.create({name:"code",addOptions:()=>({HTMLAttributes:{}}),excludes:"_",code:!0,exitable:!0,parseHTML:()=>[{tag:"code"}],renderHTML({HTMLAttributes:e}){return["code",aU(this.options.HTMLAttributes,e),0]},addCommands(){return{setCode:()=>({commands:e})=>e.setMark(this.name),toggleCode:()=>({commands:e})=>e.toggleMark(this.name),unsetCode:()=>({commands:e})=>e.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-e":()=>this.editor.commands.toggleCode()}},addInputRules(){return[lG({find:ck,type:this.type})]},addPasteRules(){return[lQ({find:cN,type:this.type})]}}),cS=/^```([a-z]+)?[\s\n]$/,cC=/^~~~([a-z]+)?[\s\n]$/,cM=lZ.create({name:"codeBlock",addOptions:()=>({languageClassPrefix:"language-",exitOnTripleEnter:!0,exitOnArrowDown:!0,defaultLanguage:null,HTMLAttributes:{}}),content:"text*",marks:"",group:"block",code:!0,defining:!0,addAttributes(){return{language:{default:this.options.defaultLanguage,parseHTML:e=>{var t;let{languageClassPrefix:n}=this.options,r=[...(null==(t=e.firstElementChild)?void 0:t.classList)||[]].filter(e=>e.startsWith(n)).map(e=>e.replace(n,""))[0];return r||null},rendered:!1}}},parseHTML:()=>[{tag:"pre",preserveWhitespace:"full"}],renderHTML({node:e,HTMLAttributes:t}){return["pre",aU(this.options.HTMLAttributes,t),["code",{class:e.attrs.language?this.options.languageClassPrefix+e.attrs.language:null},0]]},addCommands(){return{setCodeBlock:e=>({commands:t})=>t.setNode(this.name,e),toggleCodeBlock:e=>({commands:t})=>t.toggleNode(this.name,"paragraph",e)}},addKeyboardShortcuts(){return{"Mod-Alt-c":()=>this.editor.commands.toggleCodeBlock(),Backspace:()=>{let{empty:e,$anchor:t}=this.editor.state.selection,n=1===t.pos;return!!e&&t.parent.type.name===this.name&&(!!n||!t.parent.textContent.length)&&this.editor.commands.clearNodes()},Enter:({editor:e})=>{if(!this.options.exitOnTripleEnter)return!1;let{state:t}=e,{selection:n}=t,{$from:r,empty:s}=n;if(!s||r.parent.type!==this.type)return!1;let i=r.parentOffset===r.parent.nodeSize-2,o=r.parent.textContent.endsWith("\n\n");return!!i&&!!o&&e.chain().command(({tr:e})=>(e.delete(r.pos-2,r.pos),!0)).exitCode().run()},ArrowDown:({editor:e})=>{if(!this.options.exitOnArrowDown)return!1;let{state:t}=e,{selection:n,doc:r}=t,{$from:s,empty:i}=n;if(!i||s.parent.type!==this.type||s.parentOffset!==s.parent.nodeSize-2)return!1;let o=s.after();return void 0!==o&&(r.nodeAt(o)?e.commands.command(({tr:e})=>(e.setSelection(st.near(r.resolve(o))),!0)):e.commands.exitCode())}}},addInputRules(){return[lY({find:cS,type:this.type,getAttributes:e=>({language:e[1]})}),lY({find:cC,type:this.type,getAttributes:e=>({language:e[1]})})]},addProseMirrorPlugins(){return[new sv({key:new sk("codeBlockVSCodeHandler"),props:{handlePaste:(e,t)=>{if(!t.clipboardData||this.editor.isActive(this.type.name))return!1;let n=t.clipboardData.getData("text/plain"),r=t.clipboardData.getData("vscode-editor-data"),s=r?JSON.parse(r):void 0,i=null==s?void 0:s.mode;if(!n||!i)return!1;let{tr:o,schema:a}=e.state,l=a.text(n.replace(/\r\n?/g,"\n"));return o.replaceSelectionWith(this.type.create({language:i},l)),o.selection.$from.parent.type!==this.type&&o.setSelection(si.near(o.doc.resolve(Math.max(0,o.selection.from-2)))),o.setMeta("paste",!0),e.dispatch(o),!0}}})]}}),cA=lZ.create({name:"doc",topNode:!0,content:"block+"});class cE{constructor(e,t){var n;this.editorView=e,this.cursorPos=null,this.element=null,this.timeout=-1,this.width=null!=(n=t.width)?n:1,this.color=!1===t.color?void 0:t.color||"black",this.class=t.class,this.handlers=["dragover","dragend","drop","dragleave"].map(t=>{let n=e=>{this[t](e)};return e.dom.addEventListener(t,n),{name:t,handler:n}})}destroy(){this.handlers.forEach(({name:e,handler:t})=>this.editorView.dom.removeEventListener(e,t))}update(e,t){null!=this.cursorPos&&t.doc!=e.state.doc&&(this.cursorPos>e.state.doc.content.size?this.setCursor(null):this.updateOverlay())}setCursor(e){e!=this.cursorPos&&(this.cursorPos=e,null==e?(this.element.parentNode.removeChild(this.element),this.element=null):this.updateOverlay())}updateOverlay(){let e,t,n=this.editorView.state.doc.resolve(this.cursorPos),r=!n.parent.inlineContent,s,i=this.editorView.dom,o=i.getBoundingClientRect(),a=o.width/i.offsetWidth,l=o.height/i.offsetHeight;if(r){let e=n.nodeBefore,t=n.nodeAfter;if(e||t){let n=this.editorView.nodeDOM(this.cursorPos-(e?e.nodeSize:0));if(n){let r=n.getBoundingClientRect(),i=e?r.bottom:r.top;e&&t&&(i=(i+this.editorView.nodeDOM(this.cursorPos).getBoundingClientRect().top)/2);let o=this.width/2*l;s={left:r.left,right:r.right,top:i-o,bottom:i+o}}}}if(!s){let e=this.editorView.coordsAtPos(this.cursorPos),t=this.width/2*a;s={left:e.left-t,right:e.left+t,top:e.top,bottom:e.bottom}}let c=this.editorView.dom.offsetParent;if(!this.element&&(this.element=c.appendChild(document.createElement("div")),this.class&&(this.element.className=this.class),this.element.style.cssText="position: absolute; z-index: 50; pointer-events: none;",this.color&&(this.element.style.backgroundColor=this.color)),this.element.classList.toggle("prosemirror-dropcursor-block",r),this.element.classList.toggle("prosemirror-dropcursor-inline",!r),c&&(c!=document.body||"static"!=getComputedStyle(c).position)){let n=c.getBoundingClientRect(),r=n.width/c.offsetWidth,s=n.height/c.offsetHeight;e=n.left-c.scrollLeft*r,t=n.top-c.scrollTop*s}else e=-pageXOffset,t=-pageYOffset;this.element.style.left=(s.left-e)/a+"px",this.element.style.top=(s.top-t)/l+"px",this.element.style.width=(s.right-s.left)/a+"px",this.element.style.height=(s.bottom-s.top)/l+"px"}scheduleRemoval(e){clearTimeout(this.timeout),this.timeout=setTimeout(()=>this.setCursor(null),e)}dragover(e){if(!this.editorView.editable)return;let t=this.editorView.posAtCoords({left:e.clientX,top:e.clientY}),n=t&&t.inside>=0&&this.editorView.state.doc.nodeAt(t.inside),r=n&&n.type.spec.disableDropCursor,s="function"==typeof r?r(this.editorView,t,e):r;if(t&&!s){let e=t.pos;if(this.editorView.dragging&&this.editorView.dragging.slice){let t=rX(this.editorView.state.doc,e,this.editorView.dragging.slice);null!=t&&(e=t)}this.setCursor(e),this.scheduleRemoval(5e3)}}dragend(){this.scheduleRemoval(20)}drop(){this.scheduleRemoval(20)}dragleave(e){this.editorView.dom.contains(e.relatedTarget)||this.setCursor(null)}}let cT=li.create({name:"dropCursor",addOptions:()=>({color:"currentColor",width:1,class:void 0}),addProseMirrorPlugins(){return[function(e={}){return new sv({view:t=>new cE(t,e)})}(this.options)]}});class cD extends st{constructor(e){super(e,e)}map(e,t){let n=e.resolve(t.map(this.head));return cD.valid(n)?new cD(n):st.near(n)}content(){return nJ.empty}eq(e){return e instanceof cD&&e.head==this.head}toJSON(){return{type:"gapcursor",pos:this.head}}static fromJSON(e,t){if("number"!=typeof t.pos)throw RangeError("Invalid input for GapCursor.fromJSON");return new cD(e.resolve(t.pos))}getBookmark(){return new cO(this.anchor)}static valid(e){let t=e.parent;if(t.isTextblock||!function(e){for(let t=e.depth;t>=0;t--){let n=e.index(t),r=e.node(t);if(0==n){if(r.type.spec.isolating)return!0;continue}for(let e=r.child(n-1);;e=e.lastChild){if(0==e.childCount&&!e.inlineContent||e.isAtom||e.type.spec.isolating)return!0;if(e.inlineContent)return!1}}return!0}(e)||!function(e){for(let t=e.depth;t>=0;t--){let n=e.indexAfter(t),r=e.node(t);if(n==r.childCount){if(r.type.spec.isolating)return!0;continue}for(let e=r.child(n);;e=e.firstChild){if(0==e.childCount&&!e.inlineContent||e.isAtom||e.type.spec.isolating)return!0;if(e.inlineContent)return!1}}return!0}(e))return!1;let n=t.type.spec.allowGapCursor;if(null!=n)return n;let r=t.contentMatchAt(e.index()).defaultType;return r&&r.isTextblock}static findGapCursorFrom(e,t,n=!1){r:for(;;){if(!n&&cD.valid(e))return e;let r=e.pos,s=null;for(let n=e.depth;;n--){let i=e.node(n);if(t>0?e.indexAfter(n)<i.childCount:e.index(n)>0){s=i.child(t>0?e.indexAfter(n):e.index(n)-1);break}if(0==n)return null;r+=t;let o=e.doc.resolve(r);if(cD.valid(o))return o}for(;;){let i=t>0?s.firstChild:s.lastChild;if(!i){if(s.isAtom&&!s.isText&&!sa.isSelectable(s)){e=e.doc.resolve(r+s.nodeSize*t),n=!1;continue r}break}s=i,r+=t;let o=e.doc.resolve(r);if(cD.valid(o))return o}return null}}}cD.prototype.visible=!1,cD.findFrom=cD.findGapCursorFrom,st.jsonID("gapcursor",cD);class cO{constructor(e){this.pos=e}map(e){return new cO(e.map(this.pos))}resolve(e){let t=e.resolve(this.pos);return cD.valid(t)?new cD(t):st.near(t)}}let cI=ar({ArrowLeft:cR("horiz",-1),ArrowRight:cR("horiz",1),ArrowUp:cR("vert",-1),ArrowDown:cR("vert",1)});function cR(e,t){let n="vert"==e?t>0?"down":"up":t>0?"right":"left";return function(e,r,s){let i=e.selection,o=t>0?i.$to:i.$from,a=i.empty;if(i instanceof si){if(!s.endOfTextblock(n)||0==o.depth)return!1;a=!1,o=e.doc.resolve(t>0?o.after():o.before())}let l=cD.findGapCursorFrom(o,t,a);return!!l&&(r&&r(e.tr.setSelection(new cD(l))),!0)}}function cP(e,t,n){if(!e||!e.editable)return!1;let r=e.state.doc.resolve(t);if(!cD.valid(r))return!1;let s=e.posAtCoords({left:n.clientX,top:n.clientY});return!(s&&s.inside>-1&&sa.isSelectable(e.state.doc.nodeAt(s.inside)))&&(e.dispatch(e.state.tr.setSelection(new cD(r))),!0)}function cz(e,t){if("insertCompositionText"!=t.inputType||!(e.state.selection instanceof cD))return!1;let{$from:n}=e.state.selection,r=n.parent.contentMatchAt(n.index()).findWrapping(e.state.schema.nodes.text);if(!r)return!1;let s=nV.empty;for(let e=r.length-1;e>=0;e--)s=nV.from(r[e].createAndFill(null,s));let i=e.state.tr.replace(n.pos,n.pos,new nJ(s,0,0));return i.setSelection(si.near(i.doc.resolve(n.pos+1))),e.dispatch(i),!1}function c$(e){if(!(e.selection instanceof cD))return null;let t=document.createElement("div");return t.className="ProseMirror-gapcursor",oE.create(e.doc,[oC.widget(e.selection.head,t,{key:"gapcursor"})])}let cL=li.create({name:"gapCursor",addProseMirrorPlugins:()=>[new sv({props:{decorations:c$,createSelectionBetween:(e,t,n)=>t.pos==n.pos&&cD.valid(n)?new cD(n):null,handleClick:cP,handleKeyDown:cI,handleDOMEvents:{beforeinput:cz}}})],extendNodeSchema(e){var t;let n={name:e.name,options:e.options,storage:e.storage};return{allowGapCursor:null!=(t=aG(a_(e,"allowGapCursor",n)))?t:null}}}),cB=lZ.create({name:"hardBreak",addOptions:()=>({keepMarks:!0,HTMLAttributes:{}}),inline:!0,group:"inline",selectable:!1,linebreakReplacement:!0,parseHTML:()=>[{tag:"br"}],renderHTML({HTMLAttributes:e}){return["br",aU(this.options.HTMLAttributes,e)]},renderText:()=>"\n",addCommands(){return{setHardBreak:()=>({commands:e,chain:t,state:n,editor:r})=>e.first([()=>e.exitCode(),()=>e.command(()=>{let{selection:e,storedMarks:s}=n;if(e.$from.parent.type.spec.isolating)return!1;let{keepMarks:i}=this.options,{splittableMarks:o}=r.extensionManager,a=s||e.$to.parentOffset&&e.$from.marks();return t().insertContent({type:this.name}).command(({tr:e,dispatch:t})=>{if(t&&a&&i){let t=a.filter(e=>o.includes(e.type.name));e.ensureMarks(t)}return!0}).run()})])}},addKeyboardShortcuts(){return{"Mod-Enter":()=>this.editor.commands.setHardBreak(),"Shift-Enter":()=>this.editor.commands.setHardBreak()}}}),cF=lZ.create({name:"heading",addOptions:()=>({levels:[1,2,3,4,5,6],HTMLAttributes:{}}),content:"inline*",group:"block",defining:!0,addAttributes:()=>({level:{default:1,rendered:!1}}),parseHTML(){return this.options.levels.map(e=>({tag:`h${e}`,attrs:{level:e}}))},renderHTML({node:e,HTMLAttributes:t}){let n=this.options.levels.includes(e.attrs.level)?e.attrs.level:this.options.levels[0];return[`h${n}`,aU(this.options.HTMLAttributes,t),0]},addCommands(){return{setHeading:e=>({commands:t})=>!!this.options.levels.includes(e.level)&&t.setNode(this.name,e),toggleHeading:e=>({commands:t})=>!!this.options.levels.includes(e.level)&&t.toggleNode(this.name,"paragraph",e)}},addKeyboardShortcuts(){return this.options.levels.reduce((e,t)=>({...e,...{[`Mod-Alt-${t}`]:()=>this.editor.commands.toggleHeading({level:t})}}),{})},addInputRules(){return this.options.levels.map(e=>lY({find:RegExp(`^(#{${Math.min(...this.options.levels)},${e}})\\s$`),type:this.type,getAttributes:{level:e}}))}});var cV=function(){};cV.prototype.append=function(e){return e.length?(e=cV.from(e),!this.length&&e||e.length<200&&this.leafAppend(e)||this.length<200&&e.leafPrepend(this)||this.appendInner(e)):this},cV.prototype.prepend=function(e){return e.length?cV.from(e).append(this):this},cV.prototype.appendInner=function(e){return new cq(this,e)},cV.prototype.slice=function(e,t){return(void 0===e&&(e=0),void 0===t&&(t=this.length),e>=t)?cV.empty:this.sliceInner(Math.max(0,e),Math.min(this.length,t))},cV.prototype.get=function(e){if(!(e<0)&&!(e>=this.length))return this.getInner(e)},cV.prototype.forEach=function(e,t,n){void 0===t&&(t=0),void 0===n&&(n=this.length),t<=n?this.forEachInner(e,t,n,0):this.forEachInvertedInner(e,t,n,0)},cV.prototype.map=function(e,t,n){void 0===t&&(t=0),void 0===n&&(n=this.length);var r=[];return this.forEach(function(t,n){return r.push(e(t,n))},t,n),r},cV.from=function(e){return e instanceof cV?e:e&&e.length?new c_(e):cV.empty};var c_=function(e){function t(t){e.call(this),this.values=t}e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t;var n={length:{configurable:!0},depth:{configurable:!0}};return t.prototype.flatten=function(){return this.values},t.prototype.sliceInner=function(e,n){return 0==e&&n==this.length?this:new t(this.values.slice(e,n))},t.prototype.getInner=function(e){return this.values[e]},t.prototype.forEachInner=function(e,t,n,r){for(var s=t;s<n;s++)if(!1===e(this.values[s],r+s))return!1},t.prototype.forEachInvertedInner=function(e,t,n,r){for(var s=t-1;s>=n;s--)if(!1===e(this.values[s],r+s))return!1},t.prototype.leafAppend=function(e){if(this.length+e.length<=200)return new t(this.values.concat(e.flatten()))},t.prototype.leafPrepend=function(e){if(this.length+e.length<=200)return new t(e.flatten().concat(this.values))},n.length.get=function(){return this.values.length},n.depth.get=function(){return 0},Object.defineProperties(t.prototype,n),t}(cV);cV.empty=new c_([]);var cq=function(e){function t(t,n){e.call(this),this.left=t,this.right=n,this.length=t.length+n.length,this.depth=Math.max(t.depth,n.depth)+1}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.flatten=function(){return this.left.flatten().concat(this.right.flatten())},t.prototype.getInner=function(e){return e<this.left.length?this.left.get(e):this.right.get(e-this.left.length)},t.prototype.forEachInner=function(e,t,n,r){var s=this.left.length;if(t<s&&!1===this.left.forEachInner(e,t,Math.min(n,s),r)||n>s&&!1===this.right.forEachInner(e,Math.max(t-s,0),Math.min(this.length,n)-s,r+s))return!1},t.prototype.forEachInvertedInner=function(e,t,n,r){var s=this.left.length;if(t>s&&!1===this.right.forEachInvertedInner(e,t-s,Math.max(n,s)-s,r+s)||n<s&&!1===this.left.forEachInvertedInner(e,Math.min(t,s),n,r))return!1},t.prototype.sliceInner=function(e,t){if(0==e&&t==this.length)return this;var n=this.left.length;return t<=n?this.left.slice(e,t):e>=n?this.right.slice(e-n,t-n):this.left.slice(e,n).append(this.right.slice(0,t-n))},t.prototype.leafAppend=function(e){var n=this.right.leafAppend(e);if(n)return new t(this.left,n)},t.prototype.leafPrepend=function(e){var n=this.left.leafPrepend(e);if(n)return new t(n,this.right)},t.prototype.appendInner=function(e){return this.left.depth>=Math.max(this.right.depth,e.depth)+1?new t(this.left,new t(this.right,e)):new t(this,e)},t}(cV);class cH{constructor(e,t){this.items=e,this.eventCount=t}popEvent(e,t){let n,r,s,i;if(0==this.eventCount)return null;let o=this.items.length;for(;;o--)if(this.items.get(o-1).selection){--o;break}t&&(r=(n=this.remapping(o,this.items.length)).maps.length);let a=e.tr,l=[],c=[];return this.items.forEach((e,t)=>{if(!e.step){n||(r=(n=this.remapping(o,t+1)).maps.length),r--,c.push(e);return}if(n){c.push(new cW(e.map));let t=e.step.map(n.slice(r)),s;t&&a.maybeStep(t).doc&&(s=a.mapping.maps[a.mapping.maps.length-1],l.push(new cW(s,void 0,void 0,l.length+c.length))),r--,s&&n.appendMap(s,r)}else a.maybeStep(e.step);if(e.selection)return s=n?e.selection.map(n.slice(r)):e.selection,i=new cH(this.items.slice(0,o).append(c.reverse().concat(l)),this.eventCount-1),!1},this.items.length,0),{remaining:i,transform:a,selection:s}}addTransform(e,t,n,r){var s,i;let o,a=[],l=this.eventCount,c=this.items,d=!r&&c.length?c.get(c.length-1):null;for(let n=0;n<e.steps.length;n++){let s=e.steps[n].invert(e.docs[n]),i=new cW(e.mapping.maps[n],s,t),o;(o=d&&d.merge(i))&&(i=o,n?a.pop():c=c.slice(0,c.length-1)),a.push(i),t&&(l++,t=void 0),r||(d=i)}let h=l-n.depth;return h>cJ&&(s=c,i=h,s.forEach((e,t)=>{if(e.selection&&0==i--)return o=t,!1}),c=s.slice(o),l-=h),new cH(c.append(a),l)}remapping(e,t){let n=new rE;return this.items.forEach((t,r)=>{let s=null!=t.mirrorOffset&&r-t.mirrorOffset>=e?n.maps.length-t.mirrorOffset:void 0;n.appendMap(t.map,s)},e,t),n}addMaps(e){return 0==this.eventCount?this:new cH(this.items.append(e.map(e=>new cW(e))),this.eventCount)}rebased(e,t){if(!this.eventCount)return this;let n=[],r=Math.max(0,this.items.length-t),s=e.mapping,i=e.steps.length,o=this.eventCount;this.items.forEach(e=>{e.selection&&o--},r);let a=t;this.items.forEach(t=>{let r=s.getMirror(--a);if(null==r)return;i=Math.min(i,r);let l=s.maps[r];if(t.step){let i=e.steps[r].invert(e.docs[r]),c=t.selection&&t.selection.map(s.slice(a+1,r));c&&o++,n.push(new cW(l,i,c))}else n.push(new cW(l))},r);let l=[];for(let e=t;e<i;e++)l.push(new cW(s.maps[e]));let c=new cH(this.items.slice(0,r).append(l).append(n),o);return c.emptyItemCount()>500&&(c=c.compress(this.items.length-n.length)),c}emptyItemCount(){let e=0;return this.items.forEach(t=>{!t.step&&e++}),e}compress(e=this.items.length){let t=this.remapping(0,e),n=t.maps.length,r=[],s=0;return this.items.forEach((i,o)=>{if(o>=e)r.push(i),i.selection&&s++;else if(i.step){let e=i.step.map(t.slice(n)),o=e&&e.getMap();if(n--,o&&t.appendMap(o,n),e){let a=i.selection&&i.selection.map(t.slice(n));a&&s++;let l=new cW(o.invert(),e,a),c,d=r.length-1;(c=r.length&&r[d].merge(l))?r[d]=c:r.push(l)}}else i.map&&n--},this.items.length,0),new cH(cV.from(r.reverse()),s)}}cH.empty=new cH(cV.empty,0);class cW{constructor(e,t,n,r){this.map=e,this.step=t,this.selection=n,this.mirrorOffset=r}merge(e){if(this.step&&e.step&&!e.selection){let t=e.step.merge(this.step);if(t)return new cW(t.getMap().invert(),t,this.selection)}}}class cU{constructor(e,t,n,r,s){this.done=e,this.undone=t,this.prevRanges=n,this.prevTime=r,this.prevComposition=s}}let cJ=20;function cK(e){let t=[];for(let n=e.length-1;n>=0&&0==t.length;n--)e[n].forEach((e,n,r,s)=>t.push(r,s));return t}function cG(e,t){if(!e)return null;let n=[];for(let r=0;r<e.length;r+=2){let s=t.map(e[r],1),i=t.map(e[r+1],-1);s<=i&&n.push(s,i)}return n}let cY=!1,cX=null;function cZ(e){let t=e.plugins;if(cX!=t){cY=!1,cX=t;for(let e=0;e<t.length;e++)if(t[e].spec.historyPreserveItems){cY=!0;break}}return cY}let cQ=new sk("history"),c0=new sk("closeHistory");function c1(e,t){return(n,r)=>{let s=cQ.getState(n);if(!s||0==(e?s.undone:s.done).eventCount)return!1;if(r){let i=function(e,t,n){let r=cZ(t),s=cQ.get(t).spec.config,i=(n?e.undone:e.done).popEvent(t,r);if(!i)return null;let o=i.selection.resolve(i.transform.doc),a=(n?e.done:e.undone).addTransform(i.transform,t.selection.getBookmark(),s,r),l=new cU(n?a:i.remaining,n?i.remaining:a,null,0,-1);return i.transform.setSelection(o).setMeta(cQ,{redo:n,historyState:l})}(s,n,e);i&&r(t?i.scrollIntoView():i)}return!0}}let c2=c1(!1,!0),c4=c1(!0,!0);c1(!1,!1),c1(!0,!1);let c5=li.create({name:"history",addOptions:()=>({depth:100,newGroupDelay:500}),addCommands:()=>({undo:()=>({state:e,dispatch:t})=>c2(e,t),redo:()=>({state:e,dispatch:t})=>c4(e,t)}),addProseMirrorPlugins(){return[function(e={}){return new sv({key:cQ,state:{init:()=>new cU(cH.empty,cH.empty,null,0,-1),apply:(t,n,r)=>(function(e,t,n,r){let s=n.getMeta(cQ),i;if(s)return s.historyState;n.getMeta(c0)&&(e=new cU(e.done,e.undone,null,0,-1));let o=n.getMeta("appendedTransaction");if(0==n.steps.length)return e;if(o&&o.getMeta(cQ))if(o.getMeta(cQ).redo)return new cU(e.done.addTransform(n,void 0,r,cZ(t)),e.undone,cK(n.mapping.maps),e.prevTime,e.prevComposition);else return new cU(e.done,e.undone.addTransform(n,void 0,r,cZ(t)),null,e.prevTime,e.prevComposition);if(!1===n.getMeta("addToHistory")||o&&!1===o.getMeta("addToHistory"))if(i=n.getMeta("rebased"))return new cU(e.done.rebased(n,i),e.undone.rebased(n,i),cG(e.prevRanges,n.mapping),e.prevTime,e.prevComposition);else return new cU(e.done.addMaps(n.mapping.maps),e.undone.addMaps(n.mapping.maps),cG(e.prevRanges,n.mapping),e.prevTime,e.prevComposition);{let s=n.getMeta("composition"),i=0==e.prevTime||!o&&e.prevComposition!=s&&(e.prevTime<(n.time||0)-r.newGroupDelay||!function(e,t){if(!t)return!1;if(!e.docChanged)return!0;let n=!1;return e.mapping.maps[0].forEach((e,r)=>{for(let s=0;s<t.length;s+=2)e<=t[s+1]&&r>=t[s]&&(n=!0)}),n}(n,e.prevRanges)),a=o?cG(e.prevRanges,n.mapping):cK(n.mapping.maps);return new cU(e.done.addTransform(n,i?t.selection.getBookmark():void 0,r,cZ(t)),cH.empty,a,n.time,null==s?e.prevComposition:s)}})(n,r,t,e)},config:e={depth:e.depth||100,newGroupDelay:e.newGroupDelay||500},props:{handleDOMEvents:{beforeinput(e,t){let n=t.inputType,r="historyUndo"==n?c2:"historyRedo"==n?c4:null;return!!r&&(t.preventDefault(),r(e.state,e.dispatch))}}}})}(this.options)]},addKeyboardShortcuts(){return{"Mod-z":()=>this.editor.commands.undo(),"Shift-Mod-z":()=>this.editor.commands.redo(),"Mod-y":()=>this.editor.commands.redo(),"Mod-":()=>this.editor.commands.undo(),"Shift-Mod-":()=>this.editor.commands.redo()}}}),c3=lZ.create({name:"horizontalRule",addOptions:()=>({HTMLAttributes:{}}),group:"block",parseHTML:()=>[{tag:"hr"}],renderHTML({HTMLAttributes:e}){return["hr",aU(this.options.HTMLAttributes,e)]},addCommands(){return{setHorizontalRule:()=>({chain:e,state:t})=>{if(!function(e,t){let{selection:n}=e,{$from:r}=n;if(n instanceof sa){let e=r.index();return r.parent.canReplaceWith(e,e+1,t)}let s=r.depth;for(;s>=0;){let e=r.index(s);if(r.node(s).contentMatchAt(e).matchType(t))return!0;s-=1}return!1}(t,t.schema.nodes[this.name]))return!1;let{selection:n}=t,{$from:r,$to:s}=n,i=e();return 0===r.parentOffset?i.insertContentAt({from:Math.max(r.pos-1,0),to:s.pos},{type:this.name}):n instanceof sa?i.insertContentAt(s.pos,{type:this.name}):i.insertContent({type:this.name}),i.command(({tr:e,dispatch:t})=>{var n;if(t){let{$to:t}=e.selection,r=t.end();if(t.nodeAfter)t.nodeAfter.isTextblock?e.setSelection(si.create(e.doc,t.pos+1)):t.nodeAfter.isBlock?e.setSelection(sa.create(e.doc,t.pos)):e.setSelection(si.create(e.doc,t.pos));else{let s=null==(n=t.parent.type.contentMatch.defaultType)?void 0:n.create();s&&(e.insert(r,s),e.setSelection(si.create(e.doc,r+1)))}e.scrollIntoView()}return!0}).run()}}},addInputRules(){var e;return[new a5({find:(e={find:/^(?:---|-|___\s|\*\*\*\s)$/,type:this.type}).find,handler:({state:t,range:n,match:r})=>{let s=aG(e.getAttributes,void 0,r)||{},{tr:i}=t,o=n.from,a=n.to,l=e.type.create(s);if(r[1]){let e=o+r[0].lastIndexOf(r[1]);e>a?e=a:a=e+r[1].length;let t=r[0][r[0].length-1];i.insertText(t,o+r[0].length-1),i.replaceWith(e,a,l)}else if(r[0]){let t=e.type.isInline?o:o-1;i.insert(t,e.type.create(s)).delete(i.mapping.map(o),i.mapping.map(a))}i.scrollIntoView()}})]}}),c6=/(?:^|\s)(\*(?!\s+\*)((?:[^*]+))\*(?!\s+\*))$/,c8=/(?:^|\s)(\*(?!\s+\*)((?:[^*]+))\*(?!\s+\*))/g,c7=/(?:^|\s)(_(?!\s+_)((?:[^_]+))_(?!\s+_))$/,c9=/(?:^|\s)(_(?!\s+_)((?:[^_]+))_(?!\s+_))/g,de=a9.create({name:"italic",addOptions:()=>({HTMLAttributes:{}}),parseHTML(){return[{tag:"em"},{tag:"i",getAttrs:e=>"normal"!==e.style.fontStyle&&null},{style:"font-style=normal",clearMark:e=>e.type.name===this.name},{style:"font-style=italic"}]},renderHTML({HTMLAttributes:e}){return["em",aU(this.options.HTMLAttributes,e),0]},addCommands(){return{setItalic:()=>({commands:e})=>e.setMark(this.name),toggleItalic:()=>({commands:e})=>e.toggleMark(this.name),unsetItalic:()=>({commands:e})=>e.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-i":()=>this.editor.commands.toggleItalic(),"Mod-I":()=>this.editor.commands.toggleItalic()}},addInputRules(){return[lG({find:c6,type:this.type}),lG({find:c7,type:this.type})]},addPasteRules(){return[lQ({find:c8,type:this.type}),lQ({find:c9,type:this.type})]}}),dt=lZ.create({name:"listItem",addOptions:()=>({HTMLAttributes:{},bulletListTypeName:"bulletList",orderedListTypeName:"orderedList"}),content:"paragraph block*",defining:!0,parseHTML:()=>[{tag:"li"}],renderHTML({HTMLAttributes:e}){return["li",aU(this.options.HTMLAttributes,e),0]},addKeyboardShortcuts(){return{Enter:()=>this.editor.commands.splitListItem(this.name),Tab:()=>this.editor.commands.sinkListItem(this.name),"Shift-Tab":()=>this.editor.commands.liftListItem(this.name)}}}),dn="textStyle",dr=/^(\d+)\.\s$/,ds=lZ.create({name:"orderedList",addOptions:()=>({itemTypeName:"listItem",HTMLAttributes:{},keepMarks:!1,keepAttributes:!1}),group:"block list",content(){return`${this.options.itemTypeName}+`},addAttributes:()=>({start:{default:1,parseHTML:e=>e.hasAttribute("start")?parseInt(e.getAttribute("start")||"",10):1},type:{default:null,parseHTML:e=>e.getAttribute("type")}}),parseHTML:()=>[{tag:"ol"}],renderHTML({HTMLAttributes:e}){let{start:t,...n}=e;return 1===t?["ol",aU(this.options.HTMLAttributes,n),0]:["ol",aU(this.options.HTMLAttributes,e),0]},addCommands(){return{toggleOrderedList:()=>({commands:e,chain:t})=>this.options.keepAttributes?t().toggleList(this.name,this.options.itemTypeName,this.options.keepMarks).updateAttributes("listItem",this.editor.getAttributes(dn)).run():e.toggleList(this.name,this.options.itemTypeName,this.options.keepMarks)}},addKeyboardShortcuts(){return{"Mod-Shift-7":()=>this.editor.commands.toggleOrderedList()}},addInputRules(){let e=lX({find:dr,type:this.type,getAttributes:e=>({start:+e[1]}),joinPredicate:(e,t)=>t.childCount+t.attrs.start===+e[1]});return(this.options.keepMarks||this.options.keepAttributes)&&(e=lX({find:dr,type:this.type,keepMarks:this.options.keepMarks,keepAttributes:this.options.keepAttributes,getAttributes:e=>({start:+e[1],...this.editor.getAttributes(dn)}),joinPredicate:(e,t)=>t.childCount+t.attrs.start===+e[1],editor:this.editor})),[e]}}),di=lZ.create({name:"paragraph",priority:1e3,addOptions:()=>({HTMLAttributes:{}}),group:"block",content:"inline*",parseHTML:()=>[{tag:"p"}],renderHTML({HTMLAttributes:e}){return["p",aU(this.options.HTMLAttributes,e),0]},addCommands(){return{setParagraph:()=>({commands:e})=>e.setNode(this.name)}},addKeyboardShortcuts(){return{"Mod-Alt-0":()=>this.editor.commands.setParagraph()}}}),da=/(?:^|\s)(~~(?!\s+~~)((?:[^~]+))~~(?!\s+~~))$/,dl=/(?:^|\s)(~~(?!\s+~~)((?:[^~]+))~~(?!\s+~~))/g,dc=a9.create({name:"strike",addOptions:()=>({HTMLAttributes:{}}),parseHTML:()=>[{tag:"s"},{tag:"del"},{tag:"strike"},{style:"text-decoration",consuming:!1,getAttrs:e=>!!e.includes("line-through")&&{}}],renderHTML({HTMLAttributes:e}){return["s",aU(this.options.HTMLAttributes,e),0]},addCommands(){return{setStrike:()=>({commands:e})=>e.setMark(this.name),toggleStrike:()=>({commands:e})=>e.toggleMark(this.name),unsetStrike:()=>({commands:e})=>e.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-Shift-s":()=>this.editor.commands.toggleStrike()}},addInputRules(){return[lG({find:da,type:this.type})]},addPasteRules(){return[lQ({find:dl,type:this.type})]}}),dd=lZ.create({name:"text",group:"inline"}),dh=li.create({name:"starterKit",addExtensions(){let e=[];return!1!==this.options.bold&&e.push(cy.configure(this.options.bold)),!1!==this.options.blockquote&&e.push(cp.configure(this.options.blockquote)),!1!==this.options.bulletList&&e.push(cw.configure(this.options.bulletList)),!1!==this.options.code&&e.push(cj.configure(this.options.code)),!1!==this.options.codeBlock&&e.push(cM.configure(this.options.codeBlock)),!1!==this.options.document&&e.push(cA.configure(this.options.document)),!1!==this.options.dropcursor&&e.push(cT.configure(this.options.dropcursor)),!1!==this.options.gapcursor&&e.push(cL.configure(this.options.gapcursor)),!1!==this.options.hardBreak&&e.push(cB.configure(this.options.hardBreak)),!1!==this.options.heading&&e.push(cF.configure(this.options.heading)),!1!==this.options.history&&e.push(c5.configure(this.options.history)),!1!==this.options.horizontalRule&&e.push(c3.configure(this.options.horizontalRule)),!1!==this.options.italic&&e.push(de.configure(this.options.italic)),!1!==this.options.listItem&&e.push(dt.configure(this.options.listItem)),!1!==this.options.orderedList&&e.push(ds.configure(this.options.orderedList)),!1!==this.options.paragraph&&e.push(di.configure(this.options.paragraph)),!1!==this.options.strike&&e.push(dc.configure(this.options.strike)),!1!==this.options.text&&e.push(dd.configure(this.options.text)),e}}),du=li.create({name:"placeholder",addOptions:()=>({emptyEditorClass:"is-editor-empty",emptyNodeClass:"is-empty",placeholder:"Write something ",showOnlyWhenEditable:!0,showOnlyCurrent:!0,includeChildren:!1}),addProseMirrorPlugins(){return[new sv({key:new sk("placeholder"),props:{decorations:({doc:e,selection:t})=>{let n=this.editor.isEditable||!this.options.showOnlyWhenEditable,{anchor:r}=t,s=[];if(!n)return null;let i=this.editor.isEmpty;return e.descendants((e,t)=>{let n=r>=t&&r<=t+e.nodeSize,o=!e.isLeaf&&lI(e);if((n||!this.options.showOnlyCurrent)&&o){let r=[this.options.emptyNodeClass];i&&r.push(this.options.emptyEditorClass);let o=oC.node(t,t+e.nodeSize,{class:r.join(" "),"data-placeholder":"function"==typeof this.options.placeholder?this.options.placeholder({editor:this.editor,node:e,pos:t,hasAnchor:n}):this.options.placeholder});s.push(o)}return this.options.includeChildren}),oE.create(e,s)}}})]}}),dp=(0,f.A)("Bold",[["path",{d:"M6 12h9a4 4 0 0 1 0 8H7a1 1 0 0 1-1-1V5a1 1 0 0 1 1-1h7a4 4 0 0 1 0 8",key:"mg9rjx"}]]),df=(0,f.A)("Italic",[["line",{x1:"19",x2:"10",y1:"4",y2:"4",key:"15jd3p"}],["line",{x1:"14",x2:"5",y1:"20",y2:"20",key:"bu0au3"}],["line",{x1:"15",x2:"9",y1:"4",y2:"20",key:"uljnxc"}]]),dm=(0,f.A)("Strikethrough",[["path",{d:"M16 4H9a3 3 0 0 0-2.83 4",key:"43sutm"}],["path",{d:"M14 12a4 4 0 0 1 0 8H6",key:"nlfj13"}],["line",{x1:"4",x2:"20",y1:"12",y2:"12",key:"1e0a9i"}]]),dg=(0,f.A)("Heading1",[["path",{d:"M4 12h8",key:"17cfdx"}],["path",{d:"M4 18V6",key:"1rz3zl"}],["path",{d:"M12 18V6",key:"zqpxq5"}],["path",{d:"m17 12 3-2v8",key:"1hhhft"}]]),dx=(0,f.A)("Heading2",[["path",{d:"M4 12h8",key:"17cfdx"}],["path",{d:"M4 18V6",key:"1rz3zl"}],["path",{d:"M12 18V6",key:"zqpxq5"}],["path",{d:"M21 18h-4c0-4 4-3 4-6 0-1.5-2-2.5-4-1",key:"9jr5yi"}]]),dy=(0,f.A)("Heading3",[["path",{d:"M4 12h8",key:"17cfdx"}],["path",{d:"M4 18V6",key:"1rz3zl"}],["path",{d:"M12 18V6",key:"zqpxq5"}],["path",{d:"M17.5 10.5c1.7-1 3.5 0 3.5 1.5a2 2 0 0 1-2 2",key:"68ncm8"}],["path",{d:"M17 17.5c2 1.5 4 .3 4-1.5a2 2 0 0 0-2-2",key:"1ejuhz"}]]),dv=(0,f.A)("ListOrdered",[["path",{d:"M10 12h11",key:"6m4ad9"}],["path",{d:"M10 18h11",key:"11hvi2"}],["path",{d:"M10 6h11",key:"c7qv1k"}],["path",{d:"M4 10h2",key:"16xx2s"}],["path",{d:"M4 6h1v4",key:"cnovpq"}],["path",{d:"M6 18H4c0-1 2-2 2-3s-1-1.5-2-1",key:"m9a95d"}]]),db=(0,f.A)("Minus",[["path",{d:"M5 12h14",key:"1ays0h"}]]),dw=(0,f.A)("Undo",[["path",{d:"M3 7v6h6",key:"1v2h90"}],["path",{d:"M21 17a9 9 0 0 0-9-9 9 9 0 0 0-6 2.3L3 13",key:"1r6uu6"}]]),dk=(0,f.A)("Redo",[["path",{d:"M21 7v6h-6",key:"3ptur4"}],["path",{d:"M3 17a9 9 0 0 1 9-9 9 9 0 0 1 6 2.3l3 2.7",key:"1kgawr"}]]);var dN=globalThis?.document?c.useLayoutEffect:()=>{},dj=d[" useInsertionEffect ".trim().toString()]||dN;function dS(e,t){if("function"==typeof e)return e(t);null!=e&&(e.current=t)}Symbol("RADIX:SYNC_STATE");var dC=Symbol("radix.slottable");function dM(e){return c.isValidElement(e)&&"function"==typeof e.type&&"__radixId"in e.type&&e.type.__radixId===dC}var dA=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"].reduce((e,t)=>{let n=function(e){let t=function(e){let t=c.forwardRef((e,t)=>{let{children:n,...r}=e;if(c.isValidElement(n)){var s;let e,i,o=(s=n,(i=(e=Object.getOwnPropertyDescriptor(s.props,"ref")?.get)&&"isReactWarning"in e&&e.isReactWarning)?s.ref:(i=(e=Object.getOwnPropertyDescriptor(s,"ref")?.get)&&"isReactWarning"in e&&e.isReactWarning)?s.props.ref:s.props.ref||s.ref),a=function(e,t){let n={...t};for(let r in t){let s=e[r],i=t[r];/^on[A-Z]/.test(r)?s&&i?n[r]=(...e)=>{let t=i(...e);return s(...e),t}:s&&(n[r]=s):"style"===r?n[r]={...s,...i}:"className"===r&&(n[r]=[s,i].filter(Boolean).join(" "))}return{...e,...n}}(r,n.props);return n.type!==c.Fragment&&(a.ref=t?function(...e){return t=>{let n=!1,r=e.map(e=>{let r=dS(e,t);return n||"function"!=typeof r||(n=!0),r});if(n)return()=>{for(let t=0;t<r.length;t++){let n=r[t];"function"==typeof n?n():dS(e[t],null)}}}}(t,o):o),c.cloneElement(n,a)}return c.Children.count(n)>1?c.Children.only(null):null});return t.displayName=`${e}.SlotClone`,t}(e),n=c.forwardRef((e,n)=>{let{children:r,...s}=e,i=c.Children.toArray(r),o=i.find(dM);if(o){let e=o.props.children,r=i.map(t=>t!==o?t:c.Children.count(e)>1?c.Children.only(null):c.isValidElement(e)?e.props.children:null);return(0,l.jsx)(t,{...s,ref:n,children:c.isValidElement(e)?c.cloneElement(e,void 0,r):null})}return(0,l.jsx)(t,{...s,ref:n,children:r})});return n.displayName=`${e}.Slot`,n}(`Primitive.${t}`),r=c.forwardRef((e,r)=>{let{asChild:s,...i}=e;return"undefined"!=typeof window&&(window[Symbol.for("radix-ui")]=!0),(0,l.jsx)(s?n:t,{...i,ref:r})});return r.displayName=`Primitive.${t}`,{...e,[t]:r}},{}),dE="Toggle",dT=c.forwardRef((e,t)=>{let{pressed:n,defaultPressed:r,onPressedChange:s,...i}=e,[o,a]=function({prop:e,defaultProp:t,onChange:n=()=>{},caller:r}){let[s,i,o]=function({defaultProp:e,onChange:t}){let[n,r]=c.useState(e),s=c.useRef(n),i=c.useRef(t);return dj(()=>{i.current=t},[t]),c.useEffect(()=>{s.current!==n&&(i.current?.(n),s.current=n)},[n,s]),[n,r,i]}({defaultProp:t,onChange:n}),a=void 0!==e,l=a?e:s;{let t=c.useRef(void 0!==e);c.useEffect(()=>{let e=t.current;if(e!==a){let t=a?"controlled":"uncontrolled";console.warn(`${r} is changing from ${e?"controlled":"uncontrolled"} to ${t}. Components should not switch from controlled to uncontrolled (or vice versa). Decide between using a controlled or uncontrolled value for the lifetime of the component.`)}t.current=a},[a,r])}return[l,c.useCallback(t=>{if(a){let n="function"==typeof t?t(e):t;n!==e&&o.current?.(n)}else i(t)},[a,e,i,o])]}({prop:n,onChange:s,defaultProp:r??!1,caller:dE});return(0,l.jsx)(dA.button,{type:"button","aria-pressed":o,"data-state":o?"on":"off","data-disabled":e.disabled?"":void 0,...i,ref:t,onClick:function(e,t,{checkForDefaultPrevented:n=!0}={}){return function(r){if(e?.(r),!1===n||!r.defaultPrevented)return t?.(r)}}(e.onClick,()=>{e.disabled||a(!o)})})});dT.displayName=dE;var dD=n(24224);let dO=(0,dD.F)("inline-flex items-center justify-center rounded-md text-sm font-medium ring-offset-background transition-colors hover:bg-muted hover:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=on]:bg-accent data-[state=on]:text-accent-foreground",{variants:{variant:{default:"bg-transparent",outline:"border border-input bg-transparent hover:bg-accent hover:text-accent-foreground"},size:{default:"h-10 px-3",sm:"h-9 px-2.5",lg:"h-11 px-5"}},defaultVariants:{variant:"default",size:"default"}}),dI=c.forwardRef(({className:e,variant:t,size:n,...r},s)=>(0,l.jsx)(dT,{ref:s,className:(0,v.cn)(dO({variant:t,size:n,className:e})),...r}));function dR({editor:e}){return e?(0,l.jsxs)("div",{className:"flex flex-wrap items-center gap-1 border-b border-outline-variant p-2",children:[(0,l.jsx)(dI,{size:"sm",pressed:e.isActive("bold"),onPressedChange:()=>e.chain().focus().toggleBold().run(),"aria-label":"Toggle bold",children:(0,l.jsx)(dp,{className:"h-4 w-4"})}),(0,l.jsx)(dI,{size:"sm",pressed:e.isActive("italic"),onPressedChange:()=>e.chain().focus().toggleItalic().run(),"aria-label":"Toggle italic",children:(0,l.jsx)(df,{className:"h-4 w-4"})}),(0,l.jsx)(dI,{size:"sm",pressed:e.isActive("strike"),onPressedChange:()=>e.chain().focus().toggleStrike().run(),"aria-label":"Toggle strikethrough",children:(0,l.jsx)(dm,{className:"h-4 w-4"})}),(0,l.jsx)("div",{className:"mx-1 h-6 w-px bg-outline-variant"}),(0,l.jsx)(dI,{size:"sm",pressed:e.isActive("heading",{level:1}),onPressedChange:()=>e.chain().focus().toggleHeading({level:1}).run(),"aria-label":"Toggle heading 1",children:(0,l.jsx)(dg,{className:"h-4 w-4"})}),(0,l.jsx)(dI,{size:"sm",pressed:e.isActive("heading",{level:2}),onPressedChange:()=>e.chain().focus().toggleHeading({level:2}).run(),"aria-label":"Toggle heading 2",children:(0,l.jsx)(dx,{className:"h-4 w-4"})}),(0,l.jsx)(dI,{size:"sm",pressed:e.isActive("heading",{level:3}),onPressedChange:()=>e.chain().focus().toggleHeading({level:3}).run(),"aria-label":"Toggle heading 3",children:(0,l.jsx)(dy,{className:"h-4 w-4"})}),(0,l.jsx)("div",{className:"mx-1 h-6 w-px bg-outline-variant"}),(0,l.jsx)(dI,{size:"sm",pressed:e.isActive("bulletList"),onPressedChange:()=>e.chain().focus().toggleBulletList().run(),"aria-label":"Toggle bullet list",children:(0,l.jsx)(V,{className:"h-4 w-4"})}),(0,l.jsx)(dI,{size:"sm",pressed:e.isActive("orderedList"),onPressedChange:()=>e.chain().focus().toggleOrderedList().run(),"aria-label":"Toggle ordered list",children:(0,l.jsx)(dv,{className:"h-4 w-4"})}),(0,l.jsx)("div",{className:"mx-1 h-6 w-px bg-outline-variant"}),(0,l.jsx)(dI,{size:"sm",onPressedChange:()=>e.chain().focus().setHorizontalRule().run(),"aria-label":"Add horizontal rule",children:(0,l.jsx)(db,{className:"h-4 w-4"})}),(0,l.jsx)(dI,{size:"sm",onPressedChange:()=>e.chain().focus().undo().run(),disabled:!e.can().chain().focus().undo().run(),"aria-label":"Undo",children:(0,l.jsx)(dw,{className:"h-4 w-4"})}),(0,l.jsx)(dI,{size:"sm",onPressedChange:()=>e.chain().focus().redo().run(),disabled:!e.can().chain().focus().redo().run(),"aria-label":"Redo",children:(0,l.jsx)(dk,{className:"h-4 w-4"})})]}):null}dI.displayName=dT.displayName;let dP=[{id:"situation",title:"Situation / Trigger",prompt:"What happened? Where? When? Who with? How?",placeholder:"Describe the event or situation..."},{id:"feelings",title:"Feelings & Body Sensations",prompt:"What emotion did I feel? What did I notice in my body? Where?",placeholder:"e.g., Anxiety, tightness in chest..."},{id:"unhelpfulThoughts",title:"Unhelpful / Initial Thoughts & Images",prompt:"What went through my mind? What disturbed me? Meaning? What button is this pressing for me? Worst outcome?",placeholder:'e.g., "I\'m going to fail", image of messing up...'},{id:"evidenceAgainst",title:"Facts Against Initial Thought",prompt:"What facts counter the unhelpful thoughts? Is it opinion, not fact? Others' views?",placeholder:'e.g., "I\'ve prepared well", "I\'ve succeeded before"...'},{id:"evidenceFor",title:"Facts Supporting Initial Thought",prompt:"What facts support the unhelpful thoughts? What makes them seem true?",placeholder:'e.g., "This is a difficult task", "I made a mistake previously"...'},{id:"alternativePerspective",title:"Alternative, Balanced Perspective",prompt:"Breathe. Someone else's view? Bigger picture? Reframe? Advice to others? Proportional reaction? Importance?",placeholder:'e.g., "One mistake doesn\'t define me", "I can ask for help"...'},{id:"outcome",title:"Outcome",prompt:"Feeling now? What to do differently/more effectively? Act wisely. Most helpful action? Consequences?",placeholder:"e.g., Hopeful, plan to practice mindfulness..."}],dz={situation:"",feelings:"",feelingsRating:50,unhelpfulThoughts:"",evidenceAgainst:"",evidenceFor:"",alternativePerspective:"",outcome:"",outcomeRating:50},d$=({onSave:e,initialData:t,onClose:n,isActive:r})=>{let[s,i]=(0,c.useState)(0),[o,a]=(0,c.useState)(dz),[d,h]=(0,c.useState)(null),[u,p]=(0,c.useState)(""),f=dP[s],m=function(e={},t=[]){let n=(0,c.useRef)(e);n.current=e;let[r]=(0,c.useState)(()=>new co(n)),s=l2.useSyncExternalStore(r.subscribe,r.getEditor,r.getServerSnapshot);return(0,c.useDebugValue)(s),(0,c.useEffect)(r.onRender(t)),!function(e){var t;let[n]=(0,c.useState)(()=>new cr(e.editor)),r=ct.useSyncExternalStoreWithSelector(n.subscribe,n.getSnapshot,n.getServerSnapshot,e.selector,null!=(t=e.equalityFn)?t:l7);cn(()=>n.watch(e.editor),[e.editor,n]),(0,c.useDebugValue)(r)}({editor:s,selector:({transactionNumber:t})=>!1===e.shouldRerenderOnTransaction?null:e.immediatelyRender&&0===t?0:t+1}),s}({extensions:[dh,du.configure({placeholder:f.placeholder})],editorProps:{attributes:{class:"prose prose-sm sm:prose-base dark:prose-invert max-w-none focus:outline-none flex-grow min-h-[200px]"}},onUpdate:({editor:e})=>{let t=dP[s].id;a(n=>({...n,[t]:e.getHTML()})),d&&h(null)}},[f.placeholder]);(0,c.useEffect)(()=>{r&&(t?(a(t.data),p(t.title)):(a(dz),p(`Thought Record - ${new Date().toLocaleDateString()}`)),i(0),h(null))},[r,t]),(0,c.useEffect)(()=>{if(!m||!r)return;let e=o[f.id]||"";m.getHTML()!==e&&m.commands.setContent(e,!1),m.commands.focus();let t=document.getElementById("thought-record-form-top");t?.scrollIntoView({behavior:"smooth",block:"start"})},[s,m,r]);let{isRecording:g,startRecording:x,stopRecording:b,speechError:w,isSpeechSupported:k}=el({onTranscriptUpdate:(0,c.useCallback)((e,t)=>{t&&m&&m.chain().focus().insertContent(e.trim()+" ").run()},[m])}),N=e=>{"feelings"===f.id?a(t=>({...t,feelingsRating:e})):"outcome"===f.id&&a(t=>({...t,outcomeRating:e}))},j=e=>{g&&b(),i(e)},S=()=>{if(g&&b(),!Object.values(o).some(e=>{if("string"!=typeof e)return!1;let t=document.createElement("div");return t.innerHTML=e,""!==(t.textContent||t.innerText||"").trim()}))return void h("Please fill in at least one section before saving.");e(t?.id,o),n()},C=async()=>{k&&(g?b():(await x(),m?.commands.focus()))},M=0===s,A=s===dP.length-1,E="feelings"===f.id?o.feelingsRating:o.outcomeRating;return(0,l.jsxs)("div",{className:"flex flex-col h-full bg-surface-container overflow-hidden rounded-t-3xl md:rounded-3xl",children:[(0,l.jsxs)("div",{className:"flex flex-shrink-0 items-center justify-between p-4 pt-6 border-b border-outline-variant",children:[(0,l.jsx)("h2",{className:"font-serif text-headline-md text-surface-on",children:t?"Edit Thought Record":"New Thought Record"}),(0,l.jsx)(y.A,{onClick:()=>{g&&b(),n()},variant:"text",size:"sm",isIconOnly:!0,className:"text-surface-on-variant","aria-label":"Close form",title:"Close",children:(0,l.jsx)(D.A,{className:"h-6 w-6"})})]}),(0,l.jsxs)("div",{id:"thought-record-form-top",className:"p-6 space-y-6 flex-grow overflow-y-auto",children:[d&&(0,l.jsx)("p",{className:"text-label-md text-error p-3 bg-error-container/20 rounded-lg",children:d}),(0,l.jsxs)("div",{className:"space-y-3 pt-2",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("h3",{className:"font-serif text-title-lg text-primary",children:f.title}),(0,l.jsx)("p",{className:"text-body-md text-surface-on-variant italic mt-1.5",children:f.prompt})]}),("feelings"===f.id||"outcome"===f.id)&&(0,l.jsxs)("div",{className:"space-y-3 pt-4",children:[(0,l.jsxs)("label",{htmlFor:`${f.id}-rating`,className:"block text-sm font-medium text-surface-on-variant mb-1",children:["feelings"===f.id?"Rate Intensity (0-100)":"Re-rate Emotion",": ",(0,l.jsx)("span",{className:"font-bold text-surface-on",children:E})]}),(0,l.jsx)(nL,{id:`${f.id}-rating`,min:0,max:100,step:1,value:[E],onValueChange:e=>N(e[0]),className:"w-full","aria-label":"outcome"===f.id?"Re-rate emotion slider":"Intensity rating slider"})]}),(0,l.jsxs)("div",{className:"relative pt-2",children:[(0,l.jsxs)("div",{className:"flex flex-col bg-surface-container-low border border-outline-variant rounded-xl overflow-hidden",children:[(0,l.jsx)(dR,{editor:m}),(0,l.jsx)("div",{className:"p-4 flex-grow min-h-[250px]",children:(0,l.jsx)(l8,{editor:m})})]}),k&&(0,l.jsx)(y.A,{onClick:C,variant:g?"filled":"tonal",size:"sm",isIconOnly:!0,className:"absolute top-5 right-3","aria-label":g?"Stop Dictation":"Start Dictation",title:g?"Stop Dictation":"Start Dictation",leadingIcon:g?(0,l.jsx)(nn,{}):(0,l.jsx)(ei,{})})]}),w&&(0,l.jsx)("p",{className:"text-label-md text-error mt-1",children:w})]})]}),(0,l.jsxs)("div",{className:"flex flex-row justify-between items-center gap-3 p-6 border-t border-outline-variant",children:[(0,l.jsx)(y.A,{onClick:()=>{g&&b(),M||i(e=>e-1)},variant:"outlined",isIconOnly:!0,leadingIcon:(0,l.jsx)(nr,{}),"aria-label":"Previous step in thought record",disabled:M,className:(0,v.cn)(M&&"invisible")}),(0,l.jsx)("div",{className:"flex justify-center items-center gap-4",children:dP.map((e,t)=>(0,l.jsx)("button",{type:"button",onClick:()=>j(t),className:(0,v.cn)("w-3 h-3 rounded-full cursor-pointer transition-all duration-300",t===s?"bg-primary scale-125":t<s?"bg-primary/50":"bg-outline hover:bg-outline-variant"),"aria-label":`Go to step ${t+1}`,"aria-current":t===s?"step":void 0},`step-${t}`))}),(0,l.jsx)(y.A,{onClick:()=>{g&&b(),A?S():i(e=>e+1)},variant:"filled",isIconOnly:!0,leadingIcon:A?(0,l.jsx)(eo,{}):(0,l.jsx)(ns,{}),"aria-label":A?"Save thought record":"Next step in thought record"})]})]})},dL=[{id:"situation",title:"Situation / Trigger"},{id:"feelings",title:"Feelings & Body Sensations"},{id:"unhelpfulThoughts",title:"Unhelpful / Initial Thoughts & Images"},{id:"evidenceFor",title:"Facts Supporting Initial Thought"},{id:"evidenceAgainst",title:"Facts Against Initial Thought"},{id:"alternativePerspective",title:"Alternative, Balanced Perspective"},{id:"outcome",title:"Outcome"}],dB=({isOpen:e,onClose:t,record:n,onEdit:r})=>n?(0,l.jsxs)(t7,{isOpen:e,onClose:t,title:n.title,children:[(0,l.jsxs)("div",{className:"p-6 max-h-[70vh] overflow-y-auto",children:[(0,l.jsxs)("p",{className:"text-sm text-surface-on-variant mb-4",children:["Recorded on ",new Date(n.timestamp).toLocaleString()]}),(0,l.jsx)("div",{className:"space-y-4",children:dL.map(e=>{let t=n.data[e.id];if(!(t&&"string"==typeof t&&""!==t.replace(/<p><\/p>/g,"").trim()))return null;let r=e.title;return"feelings"===e.id&&n.data.feelingsRating?r+=` (${n.data.feelingsRating}/100)`:"outcome"===e.id&&n.data.outcomeRating&&(r+=` (${n.data.outcomeRating}/100)`),(0,l.jsxs)("div",{children:[(0,l.jsx)("h4",{className:"font-serif text-title-md text-surface-on mb-1",children:r}),(0,l.jsx)("div",{className:"prose prose-sm sm:prose-base dark:prose-invert max-w-none break-words",dangerouslySetInnerHTML:{__html:t}})]},e.id)})})]}),(0,l.jsxs)("div",{className:"flex justify-end space-x-3 p-6 border-t border-outline-variant",children:[(0,l.jsx)(y.A,{type:"button",variant:"text",onClick:t,children:"Close"}),(0,l.jsx)(y.A,{type:"button",variant:"filled",leadingIcon:(0,l.jsx)(eh,{}),onClick:()=>{r(n),t()},children:"Edit Record"})]})]}):null,dF=(0,f.A)("Smile",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 14s1.5 2 4 2 4-2 4-2",key:"1y1vjs"}],["line",{x1:"9",x2:"9.01",y1:"9",y2:"9",key:"yxxnd0"}],["line",{x1:"15",x2:"15.01",y1:"9",y2:"9",key:"1p4y9e"}]]),dV=(0,f.A)("Meh",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"8",x2:"16",y1:"15",y2:"15",key:"1xb1d9"}],["line",{x1:"9",x2:"9.01",y1:"9",y2:"9",key:"yxxnd0"}],["line",{x1:"15",x2:"15.01",y1:"9",y2:"9",key:"1p4y9e"}]]),d_=(0,f.A)("Frown",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M16 16s-1.5-2-4-2-4 2-4 2",key:"epbg0q"}],["line",{x1:"9",x2:"9.01",y1:"9",y2:"9",key:"yxxnd0"}],["line",{x1:"15",x2:"15.01",y1:"9",y2:"9",key:"1p4y9e"}]]),dq=(0,f.A)("Zap",[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]]),dH=(0,f.A)("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]),dW=(0,f.A)("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]),dU=(e,t="en-US")=>e.toLocaleDateString(t,{month:"long"}),dJ=e=>e.getFullYear(),dK=(e,t)=>{let n=new Date(e);return n.setMonth(n.getMonth()+t),n},dG=(e,t)=>{let n=new Date(e);return n.setDate(n.getDate()+t),n},dY=e=>new Date(e.getFullYear(),e.getMonth(),1),dX=e=>new Date(e.getFullYear(),e.getMonth()+1,0),dZ=(e,t=0)=>{let n=e.getDay(),r=new Date(e);return r.setDate(e.getDate()-(7*(n<t)+n-t)),r.setHours(0,0,0,0),r},dQ=(e,t=0)=>{let n=dZ(e,t),r=new Date(n);return r.setDate(n.getDate()+6),r.setHours(23,59,59,999),r},d0=(e,t)=>e.getFullYear()===t.getFullYear()&&e.getMonth()===t.getMonth()&&e.getDate()===t.getDate(),d1=(e,t)=>e.getFullYear()===t.getFullYear()&&e.getMonth()===t.getMonth(),d2=e=>{let t=e.getFullYear(),n=(e.getMonth()+1).toString().padStart(2,"0"),r=e.getDate().toString().padStart(2,"0");return`${t}-${n}-${r}`},d4=e=>{let t=e.getHours().toString().padStart(2,"0"),n=e.getMinutes().toString().padStart(2,"0");return`${t}:${n}`},d5=(e,t)=>{if(!t){let[t,n,r]=e.split("-").map(Number);return new Date(Date.UTC(t,n-1,r))}let[n,r,s]=e.split("-").map(Number),[i,o]=t.split(":").map(Number);return new Date(n,r-1,s,i,o)},d3=(e,t)=>{if(t)return d2(e);let n=e.getFullYear(),r=(e.getMonth()+1).toString().padStart(2,"0"),s=e.getDate().toString().padStart(2,"0"),i=e.getHours().toString().padStart(2,"0"),o=e.getMinutes().toString().padStart(2,"0"),a=e.getSeconds().toString().padStart(2,"0");return`${n}-${r}-${s}T${i}:${o}:${a}`},d6=e=>{if(10===e.length&&e.match(/^\d{4}-\d{2}-\d{2}$/)){let[t,n,r]=e.split("-").map(Number);return new Date(t,n-1,r)}return new Date(e)},d8=(e="en-US",t=0)=>{let n=dZ(new Date,t),r=[];for(let t=0;t<7;t++)r.push(dG(n,t).toLocaleDateString(e,{weekday:"short"}));return r},d7=(e,t=0)=>{let n=dZ(e,t),r=dQ(e,t),s=n.toLocaleDateString("en-US",{month:"short"}),i=r.toLocaleDateString("en-US",{month:"short"});return n.getFullYear()!==r.getFullYear()?`${n.toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"})} - ${r.toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"})}`:s===i?`${s} ${n.getDate()} - ${r.getDate()}, ${n.getFullYear()}`:`${s} ${n.getDate()} - ${i} ${r.getDate()}, ${n.getFullYear()}`},d9=e=>e.toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"}),he=({options:e,value:t,onChange:n,className:r=""})=>(0,l.jsx)("div",{className:`inline-flex items-center bg-surface-container-low p-1 rounded-full space-x-1 ${r}`,children:e.map(e=>(0,l.jsx)(y.A,{onClick:()=>n(e.value),variant:t===e.value?"tonal":"text",size:"md",className:`!rounded-full transition-all duration-300 ${t===e.value?"bg-secondary-container text-on-secondary-container shadow-sm":"text-surface-on-variant hover:bg-black/5"}`,"aria-pressed":t===e.value,children:e.label},e.value))}),ht=({viewMode:e,onViewChange:t,onAddEvent:n})=>(0,l.jsx)("div",{className:"flex flex-col sm:flex-row items-center justify-end gap-4 p-2 bg-surface-container rounded-xl shadow mb-6",children:(0,l.jsxs)("div",{className:"flex items-center gap-3",children:[(0,l.jsx)(he,{value:e,onChange:e=>t(e),options:[{value:"month",label:"Month"},{value:"week",label:"Week"},{value:"day",label:"Day"}]}),(0,l.jsx)(y.A,{onClick:n,variant:"filled",size:"md",leadingIcon:(0,l.jsx)(J,{}),children:"Add Event"})]})}),hn=(0,f.A)("BookOpen",[["path",{d:"M12 7v14",key:"1akyts"}],["path",{d:"M3 18a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1h5a4 4 0 0 1 4 4 4 4 0 0 1 4-4h5a1 1 0 0 1 1 1v13a1 1 0 0 1-1 1h-6a3 3 0 0 0-3 3 3 3 0 0 0-3-3z",key:"ruj8y"}]]),hr=({currentDisplayDate:e,events:t,journalEntries:n,thoughtRecords:r,onDateClick:s,onEventClick:i,onPrev:o,onNext:a,currentDateTitle:c,onViewJournalEntry:d,onViewThoughtRecord:h})=>{let u=new Date,p=dY(e),f=dX(e),m=dZ(p,0),g=dQ(f,0),x=d8("en-US",0),v=[],b=m;for(;b<=g;)v.push(new Date(b)),b=dG(b,1);let w=e=>t.filter(t=>{let n=d6(t.start),r=d6(t.end);if(t.allDay){let t=new Date(e.getFullYear(),e.getMonth(),e.getDate()),s=new Date(n.getFullYear(),n.getMonth(),n.getDate()),i=new Date(r.getFullYear(),r.getMonth(),r.getDate());return t>=s&&t<=i}return e>=n&&e<dG(r,1)}).sort((e,t)=>e.allDay===t.allDay?0:e.allDay?-1:1),k=e=>n.find(t=>d0(new Date(t.timestamp),e)),N=e=>r.find(t=>d0(new Date(t.timestamp),e));return(0,l.jsxs)("div",{className:"bg-surface-container-low shadow-lg rounded-xl overflow-hidden",children:[(0,l.jsxs)("div",{className:"flex items-center justify-between p-4 border-b border-outline-variant",children:[(0,l.jsx)("h2",{className:"font-serif text-headline-sm sm:text-headline-md text-surface-on truncate",title:c,children:c}),(0,l.jsxs)("div",{className:"flex items-center gap-1",children:[(0,l.jsx)(y.A,{onClick:o,variant:"tonal",size:"sm",isIconOnly:!0,leadingIcon:(0,l.jsx)(dH,{}),"aria-label":"Previous month"}),(0,l.jsx)(y.A,{onClick:a,variant:"tonal",size:"sm",isIconOnly:!0,leadingIcon:(0,l.jsx)(dW,{}),"aria-label":"Next month"})]})]}),(0,l.jsx)("div",{className:"grid grid-cols-7 border-b border-outline-variant",children:x.map(e=>(0,l.jsx)("div",{className:"p-2 text-center text-label-md font-medium text-surface-on-variant",children:e},e))}),(0,l.jsx)("div",{className:"grid grid-cols-7 auto-rows-[minmax(100px,_1fr)] sm:auto-rows-[minmax(140px,_1fr)] md:auto-rows-[minmax(160px,_1fr)]",children:v.map((t,n)=>{let r=d1(t,e),o=d0(t,u),a=w(t),c=k(t),p=N(t);return(0,l.jsxs)("div",{className:`p-2 sm:p-3 border border-outline-variant/30 
                          transition-colors duration-200 ease-in-out cursor-pointer group
                          ${r?"bg-surface-container-low hover:bg-surface-container":"bg-surface-container-lowest text-surface-on-variant/50 hover:bg-surface-container/50"}
                          `,onClick:()=>s(t),role:"gridcell","aria-label":`Date ${t.getDate()} ${dU(t)}`,children:[(0,l.jsxs)("div",{className:"flex justify-between items-center mb-1",children:[(0,l.jsx)("span",{className:`text-xs sm:text-sm font-medium rounded-full w-6 h-6 sm:w-7 sm:h-7 flex items-center justify-center
                  ${o?"bg-primary text-primary-foreground":r?"text-surface-on":"text-surface-on-variant/70"}
                  group-hover:text-primary`,children:t.getDate()}),(0,l.jsxs)("div",{className:"flex items-center gap-1.5",children:[c&&r&&(0,l.jsx)("button",{onClick:e=>{e.stopPropagation(),d(c)},className:"p-1 -m-1 rounded-full hover:bg-surface-container-high","aria-label":"View journal entry",children:(0,l.jsx)(hn,{className:"w-3 h-3 sm:w-4 sm:h-4 text-secondary"})}),p&&r&&(0,l.jsx)("button",{onClick:e=>{e.stopPropagation(),h(p)},className:"p-1 -m-1 rounded-full hover:bg-surface-container-high","aria-label":"View thought record",children:(0,l.jsx)(M.A,{className:"w-3 h-3 sm:w-4 sm:h-4 text-tertiary"})})]})]}),r&&(0,l.jsxs)("div",{className:"space-y-0.5 overflow-y-auto max-h-[48px] sm:max-h-[80px] md:max-h-[100px] text-xs",children:[a.slice(0,3).map(e=>(0,l.jsxs)("div",{onClick:t=>{t.stopPropagation(),i(e)},className:`px-1.5 py-0.5 rounded ${e.color||"bg-indigo-500"} text-white text-[0.6rem] sm:text-xs truncate cursor-pointer hover:opacity-80`,title:e.title,children:[e.allDay&&(0,l.jsx)("span",{className:"font-semibold",children:"All Day: "}),e.title]},e.id)),a.length>3&&(0,l.jsxs)("div",{className:"text-[0.6rem] sm:text-xs text-surface-on-variant text-center",children:["+",a.length-3," more"]})]})]},n)})})]})},hs=({currentDisplayDate:e,events:t,journalEntries:n,thoughtRecords:r,onDateClick:s,onEventClick:i,onPrev:o,onNext:a,currentDateTitle:c,onViewJournalEntry:d,onViewThoughtRecord:h})=>{let u=new Date,p=dZ(e,0),f=[];for(let e=0;e<7;e++)f.push(dG(p,e));let m=e=>t.filter(t=>{let n=d6(t.start),r=d6(t.end);if(t.allDay){let t=new Date(e.getFullYear(),e.getMonth(),e.getDate()),s=new Date(n.getFullYear(),n.getMonth(),n.getDate()),i=new Date(r.getFullYear(),r.getMonth(),r.getDate());return t>=s&&t<=i}return d0(n,e)}).sort((e,t)=>e.allDay!==t.allDay?e.allDay?-1:1:d6(e.start).getTime()-d6(t.start).getTime()),g=e=>n.find(t=>d0(new Date(t.timestamp),e)),x=e=>r.find(t=>d0(new Date(t.timestamp),e));return(0,l.jsxs)("div",{className:"space-y-4",children:[(0,l.jsxs)("div",{className:"flex items-center justify-between p-4 bg-surface-container-low shadow-lg rounded-xl",children:[(0,l.jsx)("h2",{className:"font-serif text-headline-sm sm:text-headline-md text-surface-on truncate",title:c,children:c}),(0,l.jsxs)("div",{className:"flex items-center gap-1",children:[(0,l.jsx)(y.A,{onClick:o,variant:"tonal",size:"sm",isIconOnly:!0,leadingIcon:(0,l.jsx)(dH,{}),"aria-label":"Previous week"}),(0,l.jsx)(y.A,{onClick:a,variant:"tonal",size:"sm",isIconOnly:!0,leadingIcon:(0,l.jsx)(dW,{}),"aria-label":"Next week"})]})]}),f.map((e,t)=>{let n=m(e),r=g(e),o=x(e),a=d0(e,u);return(0,l.jsxs)("div",{className:"bg-surface-container-low shadow-lg rounded-xl p-4 sm:p-5 cursor-pointer hover:bg-surface-container transition-colors",onClick:()=>s(e),role:"article","aria-labelledby":`day-header-${t}`,children:[(0,l.jsxs)("div",{id:`day-header-${t}`,className:"flex items-center justify-between mb-3",children:[(0,l.jsx)("h3",{className:`font-serif text-title-lg ${a?"text-primary":"text-surface-on"}`,children:e.toLocaleDateString("en-US",{weekday:"long",month:"short",day:"numeric"})}),(0,l.jsxs)("div",{className:"flex items-center gap-2",children:[r&&(0,l.jsx)("button",{onClick:e=>{e.stopPropagation(),d(r)},className:"p-1 -m-1 rounded-full hover:bg-surface-container-high","aria-label":"View journal entry on this day",children:(0,l.jsx)(hn,{className:"w-5 h-5 text-secondary"})}),o&&(0,l.jsx)("button",{onClick:e=>{e.stopPropagation(),h(o)},className:"p-1 -m-1 rounded-full hover:bg-surface-container-high","aria-label":"View thought record on this day",children:(0,l.jsx)(M.A,{className:"w-5 h-5 text-tertiary"})})]})]}),n.length>0?(0,l.jsx)("div",{className:"space-y-1.5",children:n.map(e=>(0,l.jsxs)("div",{onClick:t=>{t.stopPropagation(),i(e)},className:`p-2 rounded-md text-white text-sm truncate cursor-pointer hover:opacity-80 transition-opacity flex items-center gap-2 ${e.color||"bg-indigo-500"}`,title:e.title,children:[!e.allDay&&(0,l.jsx)("span",{className:"font-semibold text-xs whitespace-nowrap",children:d4(d6(e.start))}),(0,l.jsx)("span",{className:"truncate",children:e.title})]},e.id))}):(0,l.jsx)("p",{className:"text-sm text-surface-on-variant text-center py-4 italic",children:"No events scheduled."})]},t)})]})},hi=({currentDisplayDate:e,events:t,journalEntries:n,thoughtRecords:r,onEventClick:s,onAddEvent:i,onPrev:o,onNext:a,currentDateTitle:c,onViewJournalEntry:d,onViewThoughtRecord:h})=>{let u=t.filter(t=>{let n=d6(t.start),r=d6(t.end);if(t.allDay){let t=new Date(e.getFullYear(),e.getMonth(),e.getDate()),s=new Date(n.getFullYear(),n.getMonth(),n.getDate()),i=new Date(r.getFullYear(),r.getMonth(),r.getDate());return t>=s&&t<=i}return d0(n,e)}).sort((e,t)=>e.allDay!==t.allDay?e.allDay?-1:1:d6(e.start).getTime()-d6(t.start).getTime()),p=u.filter(e=>e.allDay),f=u.filter(e=>!e.allDay),m=n.filter(t=>d0(new Date(t.timestamp),e)),g=r.filter(t=>d0(new Date(t.timestamp),e));return(0,l.jsxs)("div",{className:"bg-surface-container-low shadow-lg rounded-xl p-4 sm:p-6",children:[(0,l.jsxs)("div",{className:"flex items-center justify-between pb-4 mb-4 border-b border-outline-variant",children:[(0,l.jsx)("h2",{className:"font-serif text-headline-sm sm:text-headline-md text-surface-on truncate",title:c,children:c}),(0,l.jsxs)("div",{className:"flex items-center gap-1",children:[(0,l.jsx)(y.A,{onClick:o,variant:"tonal",size:"sm",isIconOnly:!0,leadingIcon:(0,l.jsx)(dH,{}),"aria-label":"Previous day"}),(0,l.jsx)(y.A,{onClick:a,variant:"tonal",size:"sm",isIconOnly:!0,leadingIcon:(0,l.jsx)(dW,{}),"aria-label":"Next day"})]})]}),(0,l.jsxs)("div",{className:"space-y-6",children:[(m.length>0||g.length>0)&&(0,l.jsxs)("div",{className:"space-y-2",children:[(0,l.jsx)("h3",{className:"font-serif text-title-md text-surface-on",children:"Entries & Records"}),m.map(e=>(0,l.jsxs)("button",{onClick:()=>d(e),className:"w-full text-left flex items-center gap-2 p-3 bg-secondary-container/30 rounded-lg text-sm text-on-secondary-container cursor-pointer hover:bg-secondary-container/50",children:[(0,l.jsx)(hn,{className:"w-5 h-5 flex-shrink-0"}),(0,l.jsxs)("span",{className:"truncate",children:["Journal: ",e.title||`Entry from ${d4(new Date(e.timestamp))}`]})]},e.id)),g.map(e=>(0,l.jsxs)("button",{onClick:()=>h(e),className:"w-full text-left flex items-center gap-2 p-3 bg-tertiary-container/30 rounded-lg text-sm text-on-tertiary-container cursor-pointer hover:bg-tertiary-container/50",children:[(0,l.jsx)(M.A,{className:"w-5 h-5 flex-shrink-0"}),(0,l.jsxs)("span",{className:"truncate",children:["Thought Record: ",e.title]})]},e.id))]}),p.length>0&&(0,l.jsxs)("div",{className:"space-y-2",children:[(0,l.jsx)("h3",{className:"font-serif text-title-md text-surface-on",children:"All-Day Events"}),(0,l.jsx)("div",{className:"space-y-1",children:p.map(e=>(0,l.jsx)("div",{onClick:()=>s(e),className:`p-2 rounded-md text-white text-sm truncate cursor-pointer hover:opacity-80 transition-opacity ${e.color||"bg-indigo-500"}`,title:e.title,children:e.title},e.id))})]}),(0,l.jsxs)("div",{className:"space-y-4",children:[(0,l.jsx)("h3",{className:"font-serif text-title-md text-surface-on",children:f.length>0?"Scheduled Events":"No Scheduled Events"}),f.length>0?(0,l.jsx)("ul",{className:"space-y-3",children:f.map(e=>(0,l.jsxs)("li",{onClick:()=>s(e),className:"flex items-start gap-3 cursor-pointer group",children:[(0,l.jsxs)("div",{className:"text-right",children:[(0,l.jsx)("p",{className:"text-sm font-medium text-primary whitespace-nowrap",children:d4(d6(e.start))}),(0,l.jsx)("p",{className:"text-xs text-primary/80 whitespace-nowrap",children:d4(d6(e.end))})]}),(0,l.jsx)("div",{className:"w-1 h-full flex justify-center",children:(0,l.jsx)("div",{className:`w-0.5 h-full rounded-full ${e.color||"bg-indigo-500"}`})}),(0,l.jsxs)("div",{className:`flex-grow p-3 rounded-md text-white -mt-1 group-hover:opacity-80 transition-opacity ${e.color||"bg-indigo-500"}`,children:[(0,l.jsx)("p",{className:"font-bold text-sm",children:e.title}),e.description&&(0,l.jsx)("p",{className:"text-xs opacity-90",children:e.description})]})]},e.id))}):(0,l.jsx)("div",{onClick:()=>i(e),className:"text-center text-surface-on-variant py-8 cursor-pointer hover:bg-surface-container rounded-lg",children:(0,l.jsx)("p",{children:"Click here to add an event."})})]})]})]})},ho=(0,f.A)("TriangleAlert",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]),ha=[{name:"Indigo",class:"bg-indigo-500"},{name:"Teal",class:"bg-teal-500"},{name:"Amber",class:"bg-amber-500"},{name:"Rose",class:"bg-rose-600"},{name:"Sky",class:"bg-sky-500"},{name:"Lime",class:"bg-lime-500"},{name:"Violet",class:"bg-violet-500"},{name:"Fuchsia",class:"bg-fuchsia-500"}],hl=({isOpen:e,onClose:t,onSave:n,eventToEdit:r,initialDate:s})=>{let[i,o]=(0,c.useState)(""),[a,d]=(0,c.useState)(""),[h,u]=(0,c.useState)(""),[p,f]=(0,c.useState)(""),[m,g]=(0,c.useState)(""),[x,v]=(0,c.useState)(!0),[b,w]=(0,c.useState)(""),[k,N]=(0,c.useState)(ha[0].class),[j,S]=(0,c.useState)(null),C=(0,c.useRef)(null);return(0,c.useEffect)(()=>{if(e){if(S(null),r){let e=d6(r.start),t=d6(r.end);o(r.title),v(r.allDay),d(d2(e)),u(r.allDay?"00:00":d4(e)),f(d2(t)),g(r.allDay?"23:59":d4(t)),w(r.description||""),N(r.color||ha[0].class)}else{let e=s||new Date;o(""),v(!0),d(d2(e)),u("09:00"),f(d2(e)),g("10:00"),w(""),N(ha[0].class)}setTimeout(()=>C.current?.focus(),100)}},[e,r,s]),(0,l.jsx)(t7,{isOpen:e,onClose:t,title:r?"Edit Event":"Add New Event",children:(0,l.jsxs)("form",{onSubmit:e=>{let s,o;if(e.preventDefault(),S(null),!i.trim())return void S("Title is required.");if(!a)return void S("Start date is required.");if(!x&&!h)return void S("Start time is required for timed events.");if(p||f(a),!x&&!m){let e=d5(a,h);e.setHours(e.getHours()+1),g(d4(e))}if(x?(s=d5(a),o=d5(p||a)):(s=d5(a,h),o=d5(p||a,m||h)),o<s)return void S("End date/time cannot be before start date/time.");n({id:r?.id,title:i.trim(),start:d3(s,x),end:d3(o,x),allDay:x,description:b.trim()||void 0,color:k}),t()},className:"space-y-5 px-6 pb-6",children:[j&&(0,l.jsxs)("div",{className:"bg-error-container text-on-error-container p-3 rounded-lg text-sm flex items-center gap-2",role:"alert",children:[(0,l.jsx)(ho,{size:18})," ",j]}),(0,l.jsxs)("div",{children:[(0,l.jsxs)("label",{htmlFor:"eventTitle",className:"block text-sm font-medium text-surface-on-variant mb-1",children:["Event Title ",(0,l.jsx)("span",{className:"text-error",children:"*"})]}),(0,l.jsx)("input",{ref:C,type:"text",id:"eventTitle",value:i,onChange:e=>o(e.target.value),className:"w-full p-4 bg-surface-container-low border border-outline-variant hover:border-outline focus:border-primary focus:ring-1 focus:ring-primary rounded-lg text-surface-on placeholder-surface-on-variant",required:!0})]}),(0,l.jsxs)("div",{className:"flex items-center gap-4",children:[(0,l.jsxs)("div",{className:"flex-1",children:[(0,l.jsxs)("label",{htmlFor:"eventStartDate",className:"block text-sm font-medium text-surface-on-variant mb-1",children:["Start Date ",(0,l.jsx)("span",{className:"text-error",children:"*"})]}),(0,l.jsx)("input",{type:"date",id:"eventStartDate",value:a,onChange:e=>d(e.target.value),className:"w-full p-4 bg-surface-container-low border border-outline-variant hover:border-outline focus:border-primary focus:ring-1 focus:ring-primary rounded-lg text-surface-on",required:!0})]}),!x&&(0,l.jsxs)("div",{className:"flex-1",children:[(0,l.jsxs)("label",{htmlFor:"eventStartTime",className:"block text-sm font-medium text-surface-on-variant mb-1",children:["Start Time ",(0,l.jsx)("span",{className:"text-error",children:"*"})]}),(0,l.jsx)("input",{type:"time",id:"eventStartTime",value:h,onChange:e=>u(e.target.value),className:"w-full p-4 bg-surface-container-low border border-outline-variant hover:border-outline focus:border-primary focus:ring-1 focus:ring-primary rounded-lg text-surface-on",required:!x})]})]}),(0,l.jsxs)("div",{className:"flex items-center gap-4",children:[(0,l.jsxs)("div",{className:"flex-1",children:[(0,l.jsxs)("label",{htmlFor:"eventEndDate",className:"block text-sm font-medium text-surface-on-variant mb-1",children:["End Date ",(0,l.jsx)("span",{className:"text-error",children:"*"})]}),(0,l.jsx)("input",{type:"date",id:"eventEndDate",value:p,onChange:e=>f(e.target.value),min:a,className:"w-full p-4 bg-surface-container-low border border-outline-variant hover:border-outline focus:border-primary focus:ring-1 focus:ring-primary rounded-lg text-surface-on",required:!0})]}),!x&&(0,l.jsxs)("div",{className:"flex-1",children:[(0,l.jsxs)("label",{htmlFor:"eventEndTime",className:"block text-sm font-medium text-surface-on-variant mb-1",children:["End Time ",(0,l.jsx)("span",{className:"text-error",children:"*"})]}),(0,l.jsx)("input",{type:"time",id:"eventEndTime",value:m,onChange:e=>g(e.target.value),className:"w-full p-4 bg-surface-container-low border border-outline-variant hover:border-outline focus:border-primary focus:ring-1 focus:ring-primary rounded-lg text-surface-on",required:!x})]})]}),(0,l.jsxs)("div",{className:"flex items-center",children:[(0,l.jsx)("input",{type:"checkbox",id:"allDayEvent",checked:x,onChange:e=>{v(e.target.checked),e.target.checked||(h||u("09:00"),m||g("10:00"))},className:"h-4 w-4 text-primary focus:ring-primary border-outline-variant rounded"}),(0,l.jsx)("label",{htmlFor:"allDayEvent",className:"ml-2 text-sm font-medium text-surface-on",children:"All-day event"})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{htmlFor:"eventDescription",className:"block text-sm font-medium text-surface-on-variant mb-1",children:"Description (Optional)"}),(0,l.jsx)("textarea",{id:"eventDescription",value:b,onChange:e=>w(e.target.value),rows:3,className:"w-full p-4 bg-surface-container-low border border-outline-variant hover:border-outline focus:border-primary focus:ring-1 focus:ring-primary rounded-lg text-surface-on placeholder-surface-on-variant"})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"block text-sm font-medium text-surface-on-variant mb-1",children:"Event Color"}),(0,l.jsx)("div",{className:"flex flex-wrap gap-2",children:ha.map(e=>(0,l.jsx)("button",{type:"button",onClick:()=>N(e.class),className:`w-8 h-8 rounded-full ${e.class} ${k===e.class?"ring-2 ring-offset-2 ring-primary":""} transition-all focus:outline-none`,"aria-label":`Select color ${e.name}`,"aria-pressed":k===e.class},e.class))})]}),(0,l.jsxs)("div",{className:"flex justify-end space-x-3 pt-2",children:[(0,l.jsx)(y.A,{type:"button",variant:"text",onClick:t,children:"Cancel"}),(0,l.jsx)(y.A,{type:"submit",variant:"filled",leadingIcon:(0,l.jsx)(eo,{}),children:r?"Save Changes":"Add Event"})]})]})})},hc=(0,f.A)("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]),hd=(0,f.A)("AlignLeft",[["path",{d:"M15 12H3",key:"6jk70r"}],["path",{d:"M17 18H3",key:"1amg6g"}],["path",{d:"M21 6H3",key:"1jwq7v"}]]),hh=(0,f.A)("SquarePen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]]),hu=({isOpen:e,onClose:t,onEdit:n,onDelete:r,event:s})=>{if(!s)return null;let i=d6(s.start),o=d6(s.end),a=e=>e.toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric",timeZone:"UTC"}),c=e=>e.toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit",hour12:!0}),d=s.allDay&&!d0(i,o);return(0,l.jsx)(t7,{isOpen:e,onClose:t,title:s.title,children:(0,l.jsxs)("div",{className:"p-6 space-y-6",children:[(0,l.jsxs)("div",{className:"space-y-4 text-surface-on-variant",children:[(0,l.jsxs)("div",{className:"flex items-center gap-3",children:[(0,l.jsx)("div",{className:`w-4 h-4 rounded-full flex-shrink-0 ${s.color||"bg-indigo-500"}`}),(0,l.jsx)("p",{className:"text-sm font-medium text-surface-on",children:"Event Color"})]}),(0,l.jsxs)("div",{className:"flex items-center gap-3",children:[(0,l.jsx)(hc,{className:"w-5 h-5 flex-shrink-0 text-primary"}),(0,l.jsxs)("div",{children:[(0,l.jsx)("p",{className:"text-sm font-medium text-surface-on",children:"Time"}),s.allDay?(0,l.jsx)("p",{children:"All-day event"}):(0,l.jsx)("p",{children:`${c(i)} - ${c(o)}`})]})]}),(0,l.jsxs)("div",{className:"flex items-center gap-3",children:[(0,l.jsx)(C.A,{className:"w-5 h-5 flex-shrink-0 text-primary"}),(0,l.jsxs)("div",{children:[(0,l.jsx)("p",{className:"text-sm font-medium text-surface-on",children:"Date"}),(0,l.jsxs)("p",{children:[a(i),d&&` to ${a(o)}`]})]})]}),s.description&&(0,l.jsxs)("div",{className:"flex items-start gap-3",children:[(0,l.jsx)(hd,{className:"w-5 h-5 flex-shrink-0 text-primary mt-1"}),(0,l.jsxs)("div",{children:[(0,l.jsx)("p",{className:"text-sm font-medium text-surface-on",children:"Description"}),(0,l.jsx)("p",{className:"whitespace-pre-wrap break-words",children:s.description})]})]})]}),(0,l.jsxs)("div",{className:"flex justify-end space-x-3 pt-4 border-t border-outline-variant",children:[(0,l.jsx)(y.A,{type:"button",variant:"text",onClick:t,children:"Close"}),(0,l.jsx)(y.A,{type:"button",variant:"outlined",onClick:()=>{r(s.id),t()},className:"text-error border-error hover:bg-error-container/20",isIconOnly:!0,title:"Delete Event",children:(0,l.jsx)(eu,{className:"w-5 h-5"})}),(0,l.jsx)(y.A,{type:"button",variant:"filled",onClick:()=>{n(s),t()},leadingIcon:(0,l.jsx)(hh,{className:"w-5 h-5"}),children:"Edit"})]})]})})},hp=e=>dZ(new Date(e),1),hf=e=>e.toISOString().split("T")[0],hm=e=>{let t=dG(e,6),n=e.toLocaleString("en-US",{month:"short"}),r=t.toLocaleString("en-US",{month:"short"});return n===r?`${n} ${e.getDate()} - ${t.getDate()}, ${e.getFullYear()}`:`${n} ${e.getDate()} - ${r} ${t.getDate()}, ${e.getFullYear()}`},hg=e=>e.map(e=>`- [${e.completed?"x":" "}] ${e.text}`).join("\n"),hx=e=>{if(!e.trim())return[];let t=/^-?\s*\[([xX\s])\]\s*(.*)/;return e.split("\n").map((e,n)=>{let r=e.match(t);return{id:`${Date.now()}-${n}`,text:r?r[2].trim():e.trim(),completed:!!r&&"x"===r[1].toLowerCase()}}).filter(e=>e.text.length>0)},hy=[{name:"Happy",icon:(0,l.jsx)(dF,{}),colorClass:"text-green-500",darkColorClass:"dark:text-green-400"},{name:"Okay",icon:(0,l.jsx)(dV,{}),colorClass:"text-blue-500",darkColorClass:"dark:text-blue-400"},{name:"Sad",icon:(0,l.jsx)(d_,{}),colorClass:"text-red-500",darkColorClass:"dark:text-red-400"},{name:"Productive",icon:(0,l.jsx)(dq,{}),colorClass:"text-purple-500",darkColorClass:"dark:text-purple-400"},{name:"Tired",icon:(0,l.jsx)($.A,{}),colorClass:"text-gray-500",darkColorClass:"dark:text-gray-400"}],hv=({getDailyPlan:e,saveDailyPlan:t,getWeeklyPlan:n,saveWeeklyPlan:r,onSavePlanToJournal:s,events:i,journalEntries:o,thoughtRecords:a,onAddEvent:d,onUpdateEvent:h,onDeleteEvent:u,onViewJournalEntry:p,onViewThoughtRecord:f})=>{let[m,g]=(0,c.useState)("goals"),[x]=(0,c.useState)(new Date),[v,b]=(0,c.useState)(()=>hp(new Date)),w=hf(x),k=v.toISOString().split("T")[0],[N,j]=(0,c.useState)(void 0),[M,A]=(0,c.useState)([]),[E,T]=(0,c.useState)(""),[D,O]=(0,c.useState)(""),[I,R]=(0,c.useState)([]),[P,z]=(0,c.useState)(""),[$,L]=(0,c.useState)(""),F=(0,c.useRef)(null),V=(0,c.useRef)(null),_=(0,c.useRef)(null),q=(0,c.useRef)(!0),[H,W]=(0,c.useState)(new Date),[U,J]=(0,c.useState)("month"),[K,G]=(0,c.useState)(!1),[X,Z]=(0,c.useState)(null),[Q,ee]=(0,c.useState)(void 0),[et,en]=(0,c.useState)(!1),[er,es]=(0,c.useState)(null),ea=(0,c.useMemo)(()=>i,[i]),ec=(0,c.useMemo)(()=>o,[o]),ed=(0,c.useMemo)(()=>a,[a]);(0,c.useEffect)(()=>{q.current=!0;let t=e(w);j(t?.mood),A(t?.goals||[]),O(hg(t?.tasks||[]));let r=n(k);R(r?.goals||[]),L(r?.notes||"");let s=setTimeout(()=>{q.current=!1},0);return()=>clearTimeout(s)},[w,k,e,n]),(0,c.useEffect)(()=>{q.current||t({date:w,mood:N,goals:M,tasks:hx(D)})},[N,M,D,w,t]),(0,c.useEffect)(()=>{q.current||r({weekStartDate:k,goals:I,notes:$})},[I,$,k,r]);let eh=el({onTranscriptUpdate:(0,c.useCallback)((e,t)=>{t&&(O(t=>t+(t&&!t.endsWith(" ")?" ":"")+e.trim()),F.current?.focus(),setTimeout(()=>{F.current&&(F.current.selectionStart=F.current.selectionEnd=F.current.value.length)},0))},[])}),ep=()=>{E.trim()&&(A(e=>[...e,{id:Date.now().toString(),text:E.trim(),completed:!1}]),T(""),V.current?.focus())},ef=()=>{P.trim()&&(R(e=>[...e,{id:Date.now().toString(),text:P.trim(),completed:!1}]),z(""),_.current?.focus())},em=(e,t)=>{t(t=>t.map(t=>t.id===e?{...t,completed:!t.completed}:t))},eg=(e,t)=>{t(t=>t.filter(t=>t.id!==e))},ex=(0,c.useCallback)(()=>{W(e=>{switch(U){case"month":return dK(e,-1);case"week":return dG(e,-7);case"day":return dG(e,-1);default:return e}})},[U]),ey=(0,c.useCallback)(()=>{W(e=>{switch(U){case"month":return dK(e,1);case"week":return dG(e,7);case"day":return dG(e,1);default:return e}})},[U]),ev=e=>{Z(null),ee(e||new Date),G(!0)},eb=e=>{es(e),en(!0)},ew=e=>{"month"===U||"week"===U?(W(e),J("day")):ev(e)},ek=()=>{switch(U){case"month":return`${dU(H)} ${dJ(H)}`;case"week":return d7(H,0);case"day":return d9(H);default:return""}};return(0,l.jsxs)("div",{className:"space-y-10 animate-in fade-in-0 duration-1000 max-w-7xl w-full",children:[(0,l.jsxs)("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4",children:[(0,l.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,l.jsx)(C.A,{className:"w-8 h-8 text-primary"}),(0,l.jsx)("h2",{className:"font-serif text-headline-lg text-surface-on",children:"Planner & Calendar"})]}),(0,l.jsx)(he,{value:m,onChange:e=>g(e),options:[{value:"goals",label:"Goal Tracker"},{value:"calendar",label:"Calendar View"}]})]}),"goals"===m&&(0,l.jsx)("div",{className:"max-w-3xl mx-auto w-full space-y-10",children:(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)("section",{className:"bg-surface-container-low p-4 sm:p-6 lg:p-8 rounded-2xl shadow-lg hover:shadow-xl","aria-labelledby":"daily-planner-heading",children:[(0,l.jsx)("h3",{id:"daily-planner-heading",className:"font-serif text-headline-sm text-surface-on mb-1",children:"Today's Focus"}),(0,l.jsx)("p",{className:"text-body-md text-surface-on-variant mb-4",children:x.toLocaleDateString("en-US",{weekday:"long",month:"long",day:"numeric"})}),(0,l.jsxs)("div",{className:"mb-8",children:[(0,l.jsx)("h4",{className:"font-serif text-title-lg text-surface-on mb-3",children:"How are you feeling today?"}),(0,l.jsx)("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-5 gap-3",children:hy.map(e=>(0,l.jsxs)("button",{onClick:()=>j(e.name),className:`p-4 rounded-xl flex flex-col items-center justify-center space-y-2 transition-all transform hover:scale-105 ${N===e.name?"bg-primary-container text-on-primary-container ring-2 ring-primary":"bg-surface-container hover:bg-surface-container-high text-surface-on-variant"}`,"aria-pressed":N===e.name,children:[(0,l.jsx)("span",{className:`w-8 h-8 ${e.colorClass} ${e.darkColorClass}`,children:e.icon}),(0,l.jsx)("span",{className:"text-label-md font-medium",children:e.name})]},e.name))})]}),(0,l.jsxs)("div",{className:"mb-8",children:[(0,l.jsxs)("div",{className:"flex items-center mb-1",children:[(0,l.jsx)(B,{className:"w-6 h-6 text-secondary mr-2"}),(0,l.jsx)("h4",{className:"font-serif text-title-lg text-surface-on",children:"Daily Goals"})]}),(0,l.jsxs)("div",{className:"flex gap-3 my-3",children:[(0,l.jsx)("input",{ref:V,type:"text",value:E,onChange:e=>T(e.target.value),onKeyPress:e=>"Enter"===e.key&&ep(),placeholder:"Add a daily goal...",className:"flex-grow p-3 bg-surface-container border border-outline-variant rounded-xl text-body-lg","aria-label":"New daily goal"}),(0,l.jsx)(y.A,{onClick:ep,variant:"tonal",leadingIcon:(0,l.jsx)(Y,{}),"aria-label":"Add daily goal",children:"Add"})]}),M.length>0?(0,l.jsx)("ul",{className:"space-y-2 max-h-48 overflow-y-auto",children:M.map(e=>(0,l.jsxs)("li",{className:"flex items-center justify-between p-2.5 bg-surface rounded-lg",children:[(0,l.jsxs)("label",{className:"flex items-center gap-3 cursor-pointer group flex-grow mr-2",children:[(0,l.jsx)("input",{type:"checkbox",checked:e.completed,onChange:()=>em(e.id,A),className:"h-5 w-5 rounded text-secondary focus:ring-secondary"}),(0,l.jsx)("span",{className:`text-body-md group-hover:text-secondary ${e.completed?"line-through text-surface-on-variant":""}`,children:e.text})]}),(0,l.jsx)(y.A,{onClick:()=>eg(e.id,A),variant:"text",size:"sm",isIconOnly:!0,title:"Delete goal",className:"text-error hover:bg-error-container/20",children:(0,l.jsx)(eu,{className:"w-5 h-5"})})]},e.id))}):(0,l.jsx)("p",{className:"text-center text-sm text-surface-on-variant py-3",children:"No goals set for today."})]}),(0,l.jsxs)("div",{children:[(0,l.jsxs)("div",{className:"flex items-center mb-2",children:[(0,l.jsx)(S.A,{className:"w-6 h-6 text-tertiary mr-2"}),(0,l.jsx)("h4",{className:"font-serif text-title-lg text-surface-on",children:"Daily Notes & Tasks"})]}),(0,l.jsxs)("div",{className:"relative",children:[(0,l.jsx)("textarea",{ref:F,value:D,onChange:e=>O(e.target.value),placeholder:"Jot down other thoughts, to-dos... Use [ ] or [x] for tasks.",rows:8,className:"w-full p-3 bg-surface-container border border-outline-variant rounded-xl text-body-lg","aria-label":"General tasks and notes"}),eh.isSpeechSupported&&(0,l.jsx)(y.A,{onClick:()=>eh.isRecording?eh.stopRecording():eh.startRecording(),variant:eh.isRecording?"filled":"tonal",size:"sm",isIconOnly:!0,className:"absolute top-2.5 right-2.5",title:eh.isRecording?"Stop Dictation":"Start Dictation",leadingIcon:eh.isRecording?(0,l.jsx)(nn,{}):(0,l.jsx)(ei,{})})]}),eh.speechError&&(0,l.jsx)("p",{className:"text-label-md text-error mt-1 px-1",children:eh.speechError})]})]}),(0,l.jsxs)("section",{className:"bg-surface-container-low p-4 sm:p-6 lg:p-8 rounded-2xl shadow-lg hover:shadow-xl","aria-labelledby":"weekly-planner-heading",children:[(0,l.jsxs)("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-2 mb-4",children:[(0,l.jsx)("h3",{id:"weekly-planner-heading",className:"font-serif text-headline-sm text-surface-on",children:"Weekly Plan"}),(0,l.jsxs)("div",{className:"flex items-center gap-1",children:[(0,l.jsx)(y.A,{onClick:()=>b(e=>dG(e,-7)),variant:"text",size:"sm",isIconOnly:!0,"aria-label":"Previous Week",children:(0,l.jsx)(dH,{})}),(0,l.jsx)("span",{className:"text-title-sm text-surface-on-variant whitespace-nowrap",children:hm(v)}),(0,l.jsx)(y.A,{onClick:()=>b(e=>dG(e,7)),variant:"text",size:"sm",isIconOnly:!0,"aria-label":"Next Week",children:(0,l.jsx)(dW,{})})]})]}),(0,l.jsxs)("div",{className:"mb-6",children:[(0,l.jsxs)("div",{className:"flex items-center mb-1",children:[(0,l.jsx)(B,{className:"w-6 h-6 text-secondary mr-2"}),(0,l.jsx)("h4",{className:"font-serif text-title-lg text-surface-on",children:"Weekly Goals"})]}),(0,l.jsxs)("div",{className:"flex gap-3 my-3",children:[(0,l.jsx)("input",{ref:_,type:"text",value:P,onChange:e=>z(e.target.value),onKeyPress:e=>"Enter"===e.key&&ef(),placeholder:"Add a weekly goal...",className:"flex-grow p-3 bg-surface-container border border-outline-variant rounded-xl text-body-lg","aria-label":"New weekly goal"}),(0,l.jsx)(y.A,{onClick:ef,variant:"tonal",leadingIcon:(0,l.jsx)(Y,{}),"aria-label":"Add weekly goal",children:"Add"})]}),I.length>0?(0,l.jsx)("ul",{className:"space-y-2 max-h-48 overflow-y-auto",children:I.map(e=>(0,l.jsxs)("li",{className:"flex items-center justify-between p-2.5 bg-surface rounded-lg",children:[(0,l.jsxs)("label",{className:"flex items-center gap-3 cursor-pointer group flex-grow mr-2",children:[(0,l.jsx)("input",{type:"checkbox",checked:e.completed,onChange:()=>em(e.id,R),className:"h-5 w-5 rounded text-secondary focus:ring-secondary"}),(0,l.jsx)("span",{className:`text-body-md group-hover:text-secondary ${e.completed?"line-through text-surface-on-variant":""}`,children:e.text})]}),(0,l.jsx)(y.A,{onClick:()=>eg(e.id,R),variant:"text",size:"sm",isIconOnly:!0,title:"Delete goal",className:"text-error hover:bg-error-container/20",children:(0,l.jsx)(eu,{className:"w-5 h-5"})})]},e.id))}):(0,l.jsx)("p",{className:"text-center text-sm text-surface-on-variant py-3",children:"No goals set for this week."})]}),(0,l.jsxs)("div",{children:[(0,l.jsxs)("div",{className:"flex items-center mb-2",children:[(0,l.jsx)(S.A,{className:"w-6 h-6 text-tertiary mr-2"}),(0,l.jsx)("h4",{className:"font-serif text-title-lg text-surface-on",children:"Weekly Notes"})]}),(0,l.jsx)("textarea",{value:$,onChange:e=>L(e.target.value),placeholder:"General thoughts for the week...",rows:5,className:"w-full p-3 bg-surface-container border border-outline-variant rounded-xl text-body-lg","aria-label":"Weekly notes"})]})]}),(0,l.jsx)("div",{className:"mt-8 flex justify-center",children:(0,l.jsx)(y.A,{onClick:()=>{let e=`Week of ${hm(v)}

`;I.length>0&&(e+="--- Weekly Goals ---\n",I.forEach(t=>{e+=`- [${t.completed?"X":" "}] ${t.text}
`}),e+="\n"),$.trim()&&(e+="--- Weekly Notes ---\n"+$.trim()+"\n\n"),e+=`--- Today's Focus: ${x.toLocaleDateString("en-US",{weekday:"long",month:"long",day:"numeric"})} ---
`,N&&(e+=`Mood: ${N}
`),M.length>0&&M.forEach(t=>{e+=`- [${t.completed?"X":" "}] ${t.text}
`}),D.trim()&&(e+="Notes & Tasks:\n"+D.trim()+"\n"),s(e)},variant:"filled",size:"lg",leadingIcon:(0,l.jsx)(eo,{}),disabled:!(I.length>0||$.trim()||N||M.length>0||D.trim()),"aria-label":"Save current plans to journal",children:"Save Plan to Journal"})})]})}),"calendar"===m&&(0,l.jsxs)("div",{className:"space-y-8",children:[(0,l.jsx)(ht,{viewMode:U,onViewChange:e=>J(e),onAddEvent:()=>ev()}),(()=>{let e={currentDisplayDate:H,events:ea,journalEntries:ec,thoughtRecords:ed,onPrev:ex,onNext:ey,currentDateTitle:ek(),onViewJournalEntry:p,onViewThoughtRecord:f};switch(U){case"month":return(0,l.jsx)(hr,{...e,onDateClick:ew,onEventClick:eb});case"week":return(0,l.jsx)(hs,{...e,onDateClick:ew,onEventClick:eb});case"day":return(0,l.jsx)(hi,{...e,onEventClick:eb,onAddEvent:ev});default:return null}})()]}),(0,l.jsx)(hl,{isOpen:K,onClose:()=>G(!1),onSave:e=>{e.id?h(e):d(e),G(!1)},eventToEdit:X,initialDate:Q}),(0,l.jsx)(hu,{isOpen:et,onClose:()=>en(!1),event:er,onEdit:e=>{Z(e),ee(d6(e.start)),G(!0)},onDelete:u})]})},hb=({isOpen:e,onClose:t,onSave:n,initialData:r})=>{let[s,i]=(0,c.useState)(""),[o,a]=(0,c.useState)(""),[d,h]=(0,c.useState)(""),[u,p]=(0,c.useState)(""),[f,m]=(0,c.useState)(null),g=(0,c.useRef)(null);return(0,c.useEffect)(()=>{e&&(r?(i(r.name),a(r.dosage),h(r.frequency),p(r.notes||"")):(i(""),a(""),h(""),p("")),m(null),setTimeout(()=>g.current?.focus(),100))},[e,r]),(0,l.jsx)(t7,{isOpen:e,onClose:t,title:r?"Edit Medication":"Add New Medication",children:(0,l.jsxs)("form",{onSubmit:e=>{if(e.preventDefault(),!s.trim()||!o.trim()||!d.trim())return void m("Name, Dosage, and Frequency are required.");n({id:r?.id,name:s.trim(),dosage:o.trim(),frequency:d.trim(),notes:u.trim()||void 0}),t()},className:"space-y-7 p-6",children:[f&&(0,l.jsx)("div",{className:"bg-error-container text-on-error-container p-3 rounded-lg text-sm",role:"alert",children:f}),(0,l.jsxs)("div",{children:[(0,l.jsxs)("label",{htmlFor:"medName",className:"block text-sm font-medium text-surface-on-variant mb-1",children:["Medication Name ",(0,l.jsx)("span",{className:"text-error",children:"*"})]}),(0,l.jsx)("input",{ref:g,type:"text",id:"medName",value:s,onChange:e=>i(e.target.value),className:"w-full p-4 bg-surface-container-low border border-outline-variant hover:border-outline focus:border-primary focus:ring-1 focus:ring-primary rounded-lg text-surface-on placeholder-surface-on-variant",placeholder:"e.g., Ibuprofen",required:!0,"aria-required":"true"})]}),(0,l.jsxs)("div",{children:[(0,l.jsxs)("label",{htmlFor:"medDosage",className:"block text-sm font-medium text-surface-on-variant mb-1",children:["Dosage ",(0,l.jsx)("span",{className:"text-error",children:"*"})]}),(0,l.jsx)("input",{type:"text",id:"medDosage",value:o,onChange:e=>a(e.target.value),className:"w-full p-4 bg-surface-container-low border border-outline-variant hover:border-outline focus:border-primary focus:ring-1 focus:ring-primary rounded-lg text-surface-on placeholder-surface-on-variant",placeholder:"e.g., 200mg, 1 tablet",required:!0,"aria-required":"true"})]}),(0,l.jsxs)("div",{children:[(0,l.jsxs)("label",{htmlFor:"medFrequency",className:"block text-sm font-medium text-surface-on-variant mb-1",children:["Frequency ",(0,l.jsx)("span",{className:"text-error",children:"*"})]}),(0,l.jsx)("input",{type:"text",id:"medFrequency",value:d,onChange:e=>h(e.target.value),className:"w-full p-4 bg-surface-container-low border border-outline-variant hover:border-outline focus:border-primary focus:ring-1 focus:ring-primary rounded-lg text-surface-on placeholder-surface-on-variant",placeholder:"e.g., Daily, Twice a day, As needed",required:!0,"aria-required":"true"})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{htmlFor:"medNotes",className:"block text-sm font-medium text-surface-on-variant mb-1",children:"Notes (Optional)"}),(0,l.jsx)("textarea",{id:"medNotes",value:u,onChange:e=>p(e.target.value),rows:3,className:"w-full p-4 bg-surface-container-low border border-outline-variant hover:border-outline focus:border-primary focus:ring-1 focus:ring-primary rounded-lg text-surface-on placeholder-surface-on-variant",placeholder:"e.g., Take with food, For headaches"})]}),(0,l.jsxs)("div",{className:"flex justify-end space-x-3 pt-2",children:[(0,l.jsx)(y.A,{type:"button",variant:"text",onClick:t,children:"Cancel"}),(0,l.jsx)(y.A,{type:"submit",variant:"filled",leadingIcon:(0,l.jsx)(eo,{}),children:r?"Save Changes":"Add Medication"})]})]})})},hw=(0,f.A)("CircleCheckBig",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]),hk=({medication:e,onLogTaken:t,onEdit:n,onDelete:r})=>(0,l.jsxs)("div",{className:"bg-surface-container-low shadow-lg rounded-xl p-5 sm:p-6 hover:shadow-xl transition-shadow duration-300",children:[(0,l.jsxs)("div",{className:"flex justify-between items-start mb-3",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("h3",{className:"font-serif text-title-lg text-surface-on",children:e.name}),(0,l.jsxs)("p",{className:"text-body-md text-surface-on-variant",children:[e.dosage," - ",e.frequency]})]}),(0,l.jsxs)("div",{className:"flex space-x-1",children:[(0,l.jsx)(y.A,{variant:"text",size:"sm",isIconOnly:!0,title:"Edit Medication",onClick:()=>n(e),"aria-label":`Edit ${e.name}`,children:(0,l.jsx)(eh,{className:"w-5 h-5"})}),(0,l.jsx)(y.A,{variant:"text",size:"sm",isIconOnly:!0,title:"Delete Medication",onClick:()=>{r(e.id)},"aria-label":`Delete ${e.name}`,className:"text-error hover:bg-error-container/20",children:(0,l.jsx)(eu,{className:"w-5 h-5"})})]})]}),e.notes&&(0,l.jsxs)("p",{className:"text-body-sm text-surface-on-variant italic bg-surface-container p-2 rounded-md mb-3",children:["Notes: ",e.notes]}),(0,l.jsx)(y.A,{variant:"tonal",size:"md",leadingIcon:(0,l.jsx)(hw,{className:"w-5 h-5"}),onClick:()=>t(e),className:"w-full","aria-label":`Log ${e.name} as taken`,children:"Log Taken Now"})]}),hN=({logs:e})=>{if(0===e.length)return(0,l.jsx)("p",{className:"text-center text-surface-on-variant py-8 text-body-lg",children:"No medication intakes logged yet."});let t=e=>new Date(e).toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit",month:"short",day:"numeric"});return(0,l.jsx)("div",{className:"space-y-3",children:e.map(e=>(0,l.jsxs)("div",{className:"bg-surface-container-low p-4 rounded-lg shadow-sm flex items-center space-x-3",children:[(0,l.jsx)(hw,{className:"w-5 h-5 text-secondary flex-shrink-0"}),(0,l.jsxs)("div",{className:"flex-grow",children:[(0,l.jsxs)("p",{className:"text-body-md text-surface-on",children:[(0,l.jsx)("span",{className:"font-medium",children:e.medicationName})," (",e.dosage,")"]}),(0,l.jsxs)("p",{className:"text-label-sm text-surface-on-variant",children:["Logged at: ",t(e.timestamp)]})]})]},e.id))})},hj=({isOpen:e,onClose:t,onSave:n,existingMedications:r,initialData:s})=>{let[i,o]=(0,c.useState)(""),[a,d]=(0,c.useState)(new Set),[h,u]=(0,c.useState)(null),p=(0,c.useRef)(null);(0,c.useEffect)(()=>{e&&(s?(o(s.name),d(new Set(s.medicationIds))):(o(""),d(new Set)),u(null),setTimeout(()=>p.current?.focus(),100))},[e,s]);let f=e=>{d(t=>{let n=new Set(t);return n.has(e)?n.delete(e):n.add(e),n})},m=[...r].sort((e,t)=>e.name.localeCompare(t.name));return(0,l.jsx)(t7,{isOpen:e,onClose:t,title:s?"Edit Medication Bundle":"Create New Medication Bundle",children:(0,l.jsxs)("form",{onSubmit:e=>(e.preventDefault(),i.trim())?0===a.size?void u("Please select at least one medication for the bundle."):void(n({id:s?.id,name:i.trim(),medicationIds:Array.from(a)}),t()):void u("Bundle name is required."),className:"space-y-7 p-6",children:[h&&(0,l.jsx)("div",{className:"bg-error-container text-on-error-container p-3 rounded-lg text-sm",role:"alert",children:h}),(0,l.jsxs)("div",{children:[(0,l.jsxs)("label",{htmlFor:"groupName",className:"block text-sm font-medium text-surface-on-variant mb-1",children:["Bundle Name ",(0,l.jsx)("span",{className:"text-error",children:"*"})]}),(0,l.jsx)("input",{ref:p,type:"text",id:"groupName",value:i,onChange:e=>o(e.target.value),className:"w-full p-4 bg-surface-container-low border border-outline-variant hover:border-outline focus:border-primary focus:ring-1 focus:ring-primary rounded-lg text-surface-on placeholder-surface-on-variant",placeholder:"e.g., Morning Pills, Bedtime Routine",required:!0,"aria-required":"true"})]}),(0,l.jsxs)("div",{children:[(0,l.jsxs)("label",{className:"block text-sm font-medium text-surface-on-variant mb-2",children:["Select Medications for this Bundle ",(0,l.jsx)("span",{className:"text-error",children:"*"})]}),m.length>0?(0,l.jsx)("div",{className:"max-h-60 overflow-y-auto space-y-2 border border-outline-variant p-3 rounded-lg bg-surface",children:m.map(e=>(0,l.jsxs)("label",{className:"flex items-center space-x-3 p-2 rounded-md hover:bg-surface-container cursor-pointer",children:[(0,l.jsx)("input",{type:"checkbox",checked:a.has(e.id),onChange:()=>f(e.id),className:"h-5 w-5 rounded text-primary focus:ring-primary border-outline-variant"}),(0,l.jsxs)("span",{className:"text-body-md text-surface-on",children:[e.name," ",(0,l.jsxs)("span",{className:"text-sm text-surface-on-variant",children:["(",e.dosage,", ",e.frequency,")"]})]})]},e.id))}):(0,l.jsx)("p",{className:"text-sm text-surface-on-variant italic",children:"No medications available to add to a bundle. Please add medications first."})]}),(0,l.jsxs)("div",{className:"flex justify-end space-x-3 pt-2",children:[(0,l.jsx)(y.A,{type:"button",variant:"text",onClick:t,children:"Cancel"}),(0,l.jsx)(y.A,{type:"submit",variant:"filled",leadingIcon:(0,l.jsx)(eo,{}),children:s?"Save Changes":"Create Bundle"})]})]})})},hS=(0,f.A)("Package",[["path",{d:"M11 21.73a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73z",key:"1a0edw"}],["path",{d:"M12 22V12",key:"d0xqtd"}],["polyline",{points:"3.29 7 12 12 20.71 7",key:"ousv84"}],["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}]]),hC=(0,f.A)("ChevronUp",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]]),hM=(0,f.A)("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]),hA=({group:e,medications:t,onLogBundle:n,onEdit:r,onDelete:s})=>{let[i,o]=h().useState(!1),a=e.medicationIds.map(e=>t.find(t=>t.id===e)).filter(Boolean);return(0,l.jsxs)("div",{className:"bg-surface-container-low shadow-lg rounded-xl p-5 sm:p-6 hover:shadow-xl transition-shadow duration-300",children:[(0,l.jsxs)("div",{className:"flex justify-between items-start mb-3",children:[(0,l.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,l.jsx)(hS,{className:"w-6 h-6 text-secondary"}),(0,l.jsx)("h3",{className:"font-serif text-title-lg text-surface-on",children:e.name}),(0,l.jsxs)("span",{className:"text-sm text-surface-on-variant",children:["(",a.length," meds)"]})]}),(0,l.jsxs)("div",{className:"flex space-x-1",children:[(0,l.jsx)(y.A,{variant:"text",size:"sm",isIconOnly:!0,title:"Edit Bundle",onClick:()=>r(e),"aria-label":`Edit bundle ${e.name}`,children:(0,l.jsx)(eh,{className:"w-5 h-5"})}),(0,l.jsx)(y.A,{variant:"text",size:"sm",isIconOnly:!0,title:"Delete Bundle",onClick:()=>s(e.id),"aria-label":`Delete bundle ${e.name}`,className:"text-error hover:bg-error-container/20",children:(0,l.jsx)(eu,{className:"w-5 h-5"})})]})]}),a.length>0&&(0,l.jsxs)("div",{className:"mb-4",children:[(0,l.jsx)(y.A,{onClick:()=>o(!i),variant:"text",size:"sm",className:"text-xs text-surface-on-variant",trailingIcon:i?(0,l.jsx)(hC,{className:"w-4 h-4"}):(0,l.jsx)(hM,{className:"w-4 h-4"}),"aria-expanded":i,"aria-controls":`bundle-meds-${e.id}`,children:i?"Hide Medications":"Show Medications"}),i&&(0,l.jsx)("ul",{id:`bundle-meds-${e.id}`,className:"list-disc list-inside mt-2 pl-4 space-y-1 text-sm text-surface-on-variant",children:a.map(e=>(0,l.jsxs)("li",{children:[e.name," (",e.dosage,")"]},e.id))})]}),0===a.length&&(0,l.jsx)("p",{className:"text-sm text-surface-on-variant italic mb-3",children:"This bundle is empty. Edit to add medications."}),(0,l.jsx)(y.A,{variant:"filled",size:"md",leadingIcon:(0,l.jsx)(F,{className:"w-5 h-5"}),onClick:()=>n(e.id),className:"w-full","aria-label":`Log all medications in bundle ${e.name} as taken`,disabled:0===a.length,children:"Log All in Bundle Taken"})]})},hE=({medications:e,medicationLogs:t,medicationGroups:n,onAddMedication:r,onUpdateMedication:s,onDeleteMedication:i,onLogMedicationIntake:o,onClearMedicationLog:a,onAddMedicationGroup:d,onUpdateMedicationGroup:h,onDeleteMedicationGroup:u,onLogMedicationBundle:p})=>{let[f,m]=(0,c.useState)(!1),[g,x]=(0,c.useState)(null),[v,b]=(0,c.useState)(!1),[w,k]=(0,c.useState)(null),[N,j]=(0,c.useState)("medications"),S=e=>{x(e),m(!0)},C=e=>{k(e),b(!0)},M=[...t].sort((e,t)=>t.timestamp-e.timestamp),A=[...e].sort((e,t)=>t.addedTimestamp-e.addedTimestamp),T=[...n].sort((e,t)=>e.name.localeCompare(t.name));return(0,l.jsxs)("div",{className:"space-y-10 animate-in fade-in-0 duration-750 max-w-3xl w-full",children:[(0,l.jsxs)("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4",children:[(0,l.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,l.jsx)(E.A,{className:"w-8 h-8 text-primary transform rotate-90"}),(0,l.jsx)("h2",{className:"font-serif text-headline-lg text-surface-on",children:"Medication Tracker"})]}),(0,l.jsx)(y.A,{variant:"filled",size:"md",leadingIcon:(0,l.jsx)(J,{}),onClick:()=>{x(null),m(!0)},className:"w-full sm:w-auto","aria-label":"Add new medication",children:"Add New Medication"})]}),(0,l.jsx)("div",{className:"flex justify-start",children:(0,l.jsx)(he,{value:N,onChange:e=>j(e),options:[{value:"medications",label:"My Medications"},{value:"log",label:"Log"}]})}),"medications"===N&&(0,l.jsxs)("div",{className:"space-y-10",children:[(0,l.jsxs)("section",{"aria-labelledby":"medication-bundles-heading",children:[(0,l.jsxs)("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-3 mb-4",children:[(0,l.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,l.jsx)(hS,{className:"w-7 h-7 text-secondary"}),(0,l.jsx)("h3",{id:"medication-bundles-heading",className:"font-serif text-headline-sm text-surface-on",children:"My Medication Bundles"})]}),(0,l.jsx)(y.A,{variant:"tonal",size:"md",leadingIcon:(0,l.jsx)(J,{}),onClick:()=>{k(null),b(!0)},className:"w-full sm:w-auto","aria-label":"Create new medication bundle",disabled:0===e.length,children:"Create New Bundle"})]}),0===e.length&&(0,l.jsx)("p",{className:"text-sm text-center text-surface-on-variant py-4 italic",children:"Add medications first to create bundles."}),e.length>0&&0===T.length&&(0,l.jsx)("p",{className:"text-center text-surface-on-variant py-8 text-body-lg",children:'No medication bundles created yet. Click "Create New Bundle".'}),T.length>0&&(0,l.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:T.map(t=>(0,l.jsx)(hA,{group:t,medications:e,onLogBundle:p,onEdit:C,onDelete:u},t.id))})]}),(0,l.jsxs)("section",{"aria-labelledby":"medications-list-heading",className:"pt-10 border-t border-outline-variant",children:[(0,l.jsx)("h3",{id:"medications-list-heading",className:"font-serif text-headline-sm text-surface-on mb-4",children:"All Individual Medications"}),0!==A.length||f?(0,l.jsx)("div",{className:"space-y-4",children:A.map(e=>(0,l.jsx)(hk,{medication:e,onLogTaken:o,onEdit:S,onDelete:i},e.id))}):(0,l.jsx)("p",{className:"text-center text-surface-on-variant py-8 text-body-lg",children:"No medications added yet."})]})]}),"log"===N&&(0,l.jsxs)("section",{"aria-labelledby":"medication-log-heading",children:[(0,l.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,l.jsx)("h3",{id:"medication-log-heading",className:"font-serif text-headline-sm text-surface-on",children:"Medication Log"}),t.length>0&&(0,l.jsx)(y.A,{variant:"outlined",size:"sm",leadingIcon:(0,l.jsx)(eu,{className:"w-4 h-4"}),onClick:a,"aria-label":"Clear entire medication log",className:"text-error hover:bg-error-container/20 border-error",children:"Clear Log"})]}),(0,l.jsx)("div",{className:"bg-surface-container p-6 rounded-xl shadow",children:(0,l.jsx)("div",{className:"max-h-[600px] overflow-y-auto",children:(0,l.jsx)(hN,{logs:M})})})]}),(0,l.jsx)(hb,{isOpen:f,onClose:()=>m(!1),onSave:t=>{if(t.id){let n=e.find(e=>e.id===t.id);n&&s({...n,name:t.name,dosage:t.dosage,frequency:t.frequency,notes:t.notes})}else r(t)},initialData:g}),(0,l.jsx)(hj,{isOpen:v,onClose:()=>b(!1),onSave:e=>{if(e.id){let t=n.find(t=>t.id===e.id);t&&h({...t,name:e.name,medicationIds:e.medicationIds})}else d(e.name,e.medicationIds)},existingMedications:e,initialData:w})]})},hT=(0,f.A)("Heart",[["path",{d:"M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z",key:"c3ymky"}]]),hD=({className:e="w-6 h-6 text-blue-500"})=>(0,l.jsxs)("svg",{className:`animate-spin ${e}`,xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,l.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,l.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),hO=["I am capable and strong, and I face challenges with courage.","I choose to be happy and grateful today, embracing all life offers.","I am worthy of love, respect, and all good things life brings.","I embrace challenges as opportunities for profound growth and learning.","I am resilient and can overcome any obstacle with grace and determination.","I trust in my unique abilities and listen to my inner wisdom.","I attract positivity, abundance, and joy into my life effortlessly.","I am at peace with who I am, and I celebrate my journey.","I make a positive and meaningful impact on the world around me.","Every day is a new beginning, filled with endless potential and hope.","I am surrounded by love, support, and understanding.","I believe deeply in myself and my dreams, and I pursue them with passion.","I forgive myself and others, releasing the past and embracing the present.","I am a creative and resourceful being, capable of finding solutions.","I radiate confidence, self-assurance, and inner calm.","My body is healthy, my mind is brilliant, my soul is tranquil.","I am creating the life of my dreams, one step at a time.","I have the power to create change and make a difference.","I am grateful for all the blessings in my life, big and small.","I release all doubts and fears, and I step into my power.","Embracing support empowers me; seeking help is a testament to my strength and awareness.","Flexibility is my superpower; changing my mind is a sign of growth, not weakness.","Every choice I make is grounded in my rich and undeniable personal journey.","I uplift others with the same encouragement and affirmation I offer myself.","My authentic self is a truth only I can define and embody.","I am fully entitled to voice my desires and needs.","Joy is my birthright; I allow myself to feel good and embrace happiness.","I possess the innate ability to harmonize ease and effort within my life's rhythm.","I am whole and complete in this moment; others enhance my journey, they do not define it.","A sense of peace and freedom from suffering fills me.","I am engaged in fulfilling work that aligns with my purpose and well-being.","I am inherently good, and I am continuously evolving for the better.","My growth journey is unique, and I am progressing at my perfect pace.","I am cradled and sustained by the love of those around me.","My emotional state is within my control; I consciously choose happiness.","I am receptive and open to the profound messages the universe unfolds for me daily.","I am cherished and inherently worthy of all good things.","My potential transcends any current circumstances.","I am open and welcoming to the process of healing and restoration.","Optimism guides me, for each day presents a fresh beginning and new possibilities.","I reside in a state of inner peace and completeness.","My very existence is evidence of who I am and what I deserve.","My responsibility begins with myself, and I build my strength from that foundation.","I am secure and enveloped by a network of love and unwavering support.","Learning is a lifelong journey, and making mistakes is an integral, acceptable part of it.","My voice is heard, and my unique perspective holds significant value.","I am a valuable contributor and an appreciated presence.","I am well-rested, energized, and enthusiastic for the day ahead.","I am deserving of self-investment, knowing it yields abundant returns.","I belong exactly where I am, and I have every right to occupy my space fully.","With each breath, I inhale healing energy, releasing all burdens and sorrows from my heart.","I breathe in unwavering trust and exhale all traces of doubt.","My heart can be tender and compassionate, while my boundaries remain strong and clear.","I have the power to consciously choose my response to challenging situations.","Holding contrasting emotions simultaneously is a sign of deep processing and growth.","I joyfully acknowledge and celebrate the good within myself and in others.","I am worthy of respectful physical connection, on my own terms.","I deserve access to information, and equally, moments of peaceful silence.","Self-respect is my due, and I thrive in a clean and organized environment.","Love is the guiding principle behind all my actions.","I do not have to remain in challenging places; assistance and light are always available to me.","I live authentically, presenting only my true self to the world.","My worth is intrinsic; I do not depend on others to define or elevate me.","I move through life with mindful intention, balancing activity with moments of serene stillness.","I embrace change gracefully, seeing each shift as a fresh opportunity for growth.","I nurture myself with empowering words and nourishing, joyful foods.","I welcome the mysteries in my heart, trusting that answers will unfold at the perfect time.","I naturally gravitate towards what inspires me, like a plant reaching for life-giving sunlight.","I have journeyed further than I ever imagined, learning and evolving with every step.","I possess all the necessary resources and inner strength for success.","I contribute to my community and receive steadfast support from it in return.","My intuition holds a profound wisdom that transcends mere knowledge.","I open my life to abundance and cultivate a generous spirit.","I invite artistic expression and harmonious music to enrich my daily existence.","I create space in my life for delightful spontaneity and unexpected adventures.","I release attachment to what is unattainable, freeing my energy for what is truly meant for me.","I anticipate tomorrow with excitement, eager for the opportunities it holds.","I revel in my passions and celebrate the things that bring me joy.","My decisions are guided by my inner wisdom, and my growth prompts necessary adjustments.","I dedicate time to fully experience grief and sadness when they arise, allowing for natural processing.","I nourish my being with kind words and wholesome, joyful foods.","I practice deep gratitude for all that I possess and all that is yet to manifest.","I release any fears that no longer serve my highest good.","I honor and respect the natural rhythms and cycles of life's seasons.","I actively seek out the magic and wonder hidden within everyday moments.","My aim is authentic joy, not an unattainable perfection.","I welcome the profound wisdom that accompanies the journey of aging.","I communicate my true self and my needs to others with honesty and clarity.","I elevate my own joy and contribute to the happiness of those around me.","I embrace the wisdom that comes with the passage of time and experience.","I greet what is present and welcome what is yet to come with an open heart.","I grant myself permission to continuously grow and transform.","Releasing what no longer serves me creates fertile ground for new opportunities to flourish.","My body is a beautiful and worthy vessel in this very moment, at its current form.","My body deserves devoted care and the adornment of garments that make me feel beautiful.","My emotions deserve to be identified, acknowledged, and fully experienced.","My heart is open to receiving support and helpfulness, both from myself and from others.","My heart possesses its own infallible compass, guiding me true.","My life is a unique journey, not a competition or a race against anyone else.","My viewpoint is singular and holds immense significance.","My happiness does not depend on, nor should it ever cause, another's suffering.","My sensitivity is a beautiful facet of who I am, and all my feelings and emotions are valid.","My unique quirks and eccentricities are wonderfully part of me.",'The act of saying "no" is a powerful affirmation of my self-worth and boundaries.',"Rest is productive work; sometimes the greatest progress comes from stillness.","Profound growth can be found in moments of quiet reflection and stillness.","There is peace and integrity in altering my perspective when motivated by love.","I discover poetry and beauty in every aspect of life, if I only choose to look for it.","There is a rightful place for me at every table; I am deserving of inclusion.","There is a singular contribution only I can offer to the world; this is my purpose for being here.","There is immense power in quiet strength, and vulnerability in speaking loudly.","Today, I celebrate the vitality of being younger than I will ever be again.","Each new day is a precious chance to grow, learn, and expand.","When fear arises, I consciously choose to feed my trust instead.","When I align with my deepest purpose, I become infinitely courageous.","Forgiving myself is the ultimate act of liberation.","Releasing shame allows me to step more fully and beautifully into my true self.","As I connect with the earth, it reciprocates by rising to support me.","When I clearly articulate my needs, they are met abundantly.","By treating myself with the kindness and understanding I'd offer a friend, I illuminate my best qualities and allow my true radiance to shine.","While words can influence me, they do not define my essence; I already exist, whole and complete.","I embrace imperfections as unique textures in the masterpiece of my life.","My intuition is a trusted guide, leading me toward my highest good.","I am capable of navigating challenges with grace and resilience.","Every step I take is a step towards my authentic self.","I create my own opportunities through my dedication and passion.","My creativity flows freely, manifesting beauty in all I do.","I am a powerful creator of my reality, shaping my world with intention.","Inspiration finds me in unexpected places, fueling my creative spirit.","I trust my artistic vision and bring it to life with confidence.","My designs tell a story, and I am the master storyteller.","I learn from every project, refining my craft with each new challenge.","My work brings joy and value to others, reflecting my unique perspective.","I am an endless source of innovative ideas and fresh perspectives.","I celebrate my progress, no matter how small, knowing it leads to great achievements."],hI=({profileData:e,onUpdateProfile:t})=>{let[n,r]=(0,c.useState)(null),{toast:s}=(0,ee.dj)();(0,c.useEffect)(()=>{r(Math.floor(Math.random()*hO.length))},[]);let i=(0,c.useCallback)(()=>{null!==n&&r(e=>{let t=e;for(;t===e;)t=Math.floor(Math.random()*hO.length);return t})},[n]),o=(0,c.useMemo)(()=>null===n?null:hO[n],[n]),a=(0,c.useMemo)(()=>!!o&&!!e.favoriteAffirmations&&e.favoriteAffirmations.includes(o),[o,e.favoriteAffirmations]);return(0,l.jsx)("div",{className:"flex flex-col items-center justify-center min-h-[calc(100vh-10rem)] py-12 animate-in fade-in-0 duration-1000",children:(0,l.jsxs)("div",{className:"text-center p-4 sm:p-8 lg:p-12 bg-gradient-to-br from-primary-container via-secondary-container/30 to-tertiary-container/20 rounded-3xl shadow-2xl max-w-2xl w-full transform transition-all hover:scale-[1.01] duration-500",children:[(0,l.jsxs)("div",{className:"flex flex-col items-center mb-6",children:[(0,l.jsx)(A.A,{className:"w-16 h-16 text-primary mb-3"}),(0,l.jsx)("h2",{className:"font-serif text-headline-lg text-on-primary-container",children:"Your Daily Affirmation"}),(0,l.jsx)("p",{className:"text-body-lg text-on-primary-container/80 mt-1",children:"Embrace positivity and empower your day."})]}),(0,l.jsx)("div",{className:"my-10 p-6 bg-surface/80 rounded-2xl min-h-[150px] flex items-center justify-center",role:"region","aria-live":"polite","aria-atomic":"true",children:o?(0,l.jsxs)("p",{className:"font-serif text-headline-md sm:text-display-sm text-surface-on leading-tight",children:['"',o,'"']}):(0,l.jsxs)("div",{className:"flex flex-col items-center justify-center text-surface-on-variant",children:[(0,l.jsx)(hD,{className:"w-8 h-8 text-primary"}),(0,l.jsx)("p",{className:"mt-2 text-sm",children:"Finding your inspiration..."})]})}),(0,l.jsxs)("div",{className:"flex flex-col sm:flex-row justify-center items-center gap-4 mt-8",children:[(0,l.jsx)(y.A,{onClick:i,variant:"filled",size:"lg",leadingIcon:(0,l.jsx)(U,{}),"aria-label":"Show another affirmation",disabled:null===o,children:"Show Another"}),(0,l.jsx)(y.A,{variant:"tonal",size:"lg",leadingIcon:(0,l.jsx)(hT,{className:a?"fill-current":""}),onClick:()=>{let n;if(!o)return;let r=e.favoriteAffirmations||[];a?(n=r.filter(e=>e!==o),s({title:"Removed from Favorites"})):(n=[...r,o],s({title:"Added to Favorites!"})),t({...e,favoriteAffirmations:n})},disabled:null===o,"aria-label":a?"Remove from favorites":"Favorite this affirmation",children:a?"Favorited":"Favorite"})]})]})})},hR=(0,f.A)("Palette",[["circle",{cx:"13.5",cy:"6.5",r:".5",fill:"currentColor",key:"1okk4w"}],["circle",{cx:"17.5",cy:"10.5",r:".5",fill:"currentColor",key:"f64h9f"}],["circle",{cx:"8.5",cy:"7.5",r:".5",fill:"currentColor",key:"fotxhn"}],["circle",{cx:"6.5",cy:"12.5",r:".5",fill:"currentColor",key:"qy21gx"}],["path",{d:"M12 2C6.5 2 2 6.5 2 12s4.5 10 10 10c.926 0 1.648-.746 1.648-1.688 0-.437-.18-.835-.437-1.125-.29-.289-.438-.652-.438-1.125a1.64 1.64 0 0 1 1.668-1.668h1.996c3.051 0 5.555-2.503 5.555-5.554C21.965 6.012 17.461 2 12 2z",key:"12rzf8"}]]),hP=(0,f.A)("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]),hz=(0,f.A)("Layers",[["path",{d:"M12.83 2.18a2 2 0 0 0-1.66 0L2.6 6.08a1 1 0 0 0 0 1.83l8.58 3.91a2 2 0 0 0 1.66 0l8.58-3.9a1 1 0 0 0 0-1.83z",key:"zw3jo"}],["path",{d:"M2 12a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 12",key:"1wduqc"}],["path",{d:"M2 17a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 17",key:"kqbvx6"}]]),h$=(0,f.A)("Server",[["rect",{width:"20",height:"8",x:"2",y:"2",rx:"2",ry:"2",key:"ngkwjq"}],["rect",{width:"20",height:"8",x:"2",y:"14",rx:"2",ry:"2",key:"iecqi9"}],["line",{x1:"6",x2:"6.01",y1:"6",y2:"6",key:"16zg32"}],["line",{x1:"6",x2:"6.01",y1:"18",y2:"18",key:"nzw8ys"}]]),hL=(0,f.A)("CloudDownload",[["path",{d:"M12 13v8l-4-4",key:"1f5nwf"}],["path",{d:"m12 21 4-4",key:"1lfcce"}],["path",{d:"M4.393 15.269A7 7 0 1 1 15.71 8h1.79a4.5 4.5 0 0 1 2.436 8.284",key:"ui1hmy"}]]),hB=(0,f.A)("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]),hF=["Adventurous","Ambition","Artistic Ability","Assertiveness","Athleticism","Bravery","Common Sense","Confidence","Cooperation","Creativity","Curiosity","Discipline","Empathy","Enthusiasm","Fairness","Flexibility","Forgiveness","Gratitude","Honesty","Humor","Independence","Intelligence","Kindness","Leadership","Logic","Love","Love of Learning","Mindedness","Modesty","Optimism","Patience","Persistence","Self-Control","Social Awareness","Spirituality","Wisdom"];var hV="Switch",[h_,hq]=(0,ex.A)(hV),[hH,hW]=h_(hV),hU=c.forwardRef((e,t)=>{let{__scopeSwitch:n,name:r,checked:s,defaultChecked:i,required:o,disabled:a,value:d="on",onCheckedChange:h,form:u,...p}=e,[f,m]=c.useState(null),g=(0,eg.s)(t,e=>m(e)),x=c.useRef(!1),y=!f||u||!!f.closest("form"),[v=!1,b]=(0,ek.i)({prop:s,defaultProp:i,onChange:h});return(0,l.jsxs)(hH,{scope:n,checked:v,disabled:a,children:[(0,l.jsx)(ej.sG.button,{type:"button",role:"switch","aria-checked":v,"aria-required":o,"data-state":hY(v),"data-disabled":a?"":void 0,disabled:a,value:d,...p,ref:g,onClick:(0,em.m)(e.onClick,e=>{b(e=>!e),y&&(x.current=e.isPropagationStopped(),x.current||e.stopPropagation())})}),y&&(0,l.jsx)(hG,{control:f,bubbles:!x.current,name:r,value:d,checked:v,required:o,disabled:a,form:u,style:{transform:"translateX(-100%)"}})]})});hU.displayName=hV;var hJ="SwitchThumb",hK=c.forwardRef((e,t)=>{let{__scopeSwitch:n,...r}=e,s=hW(hJ,n);return(0,l.jsx)(ej.sG.span,{"data-state":hY(s.checked),"data-disabled":s.disabled?"":void 0,...r,ref:t})});hK.displayName=hJ;var hG=e=>{let{control:t,checked:n,bubbles:r=!0,...s}=e,i=c.useRef(null),o=nl(n),a=nc(t);return c.useEffect(()=>{let e=i.current,t=Object.getOwnPropertyDescriptor(window.HTMLInputElement.prototype,"checked").set;if(o!==n&&t){let s=new Event("click",{bubbles:r});t.call(e,n),e.dispatchEvent(s)}},[o,n,r]),(0,l.jsx)("input",{type:"checkbox","aria-hidden":!0,defaultChecked:n,...s,tabIndex:-1,ref:i,style:{...e.style,...a,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})};function hY(e){return e?"checked":"unchecked"}let hX=c.forwardRef(({className:e,...t},n)=>(0,l.jsx)(hU,{className:(0,v.cn)("peer inline-flex h-6 w-11 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=unchecked]:bg-input",e),...t,ref:n,children:(0,l.jsx)(hK,{className:(0,v.cn)("pointer-events-none block h-5 w-5 rounded-full bg-background shadow-lg ring-0 transition-transform data-[state=checked]:translate-x-5 data-[state=unchecked]:translate-x-0")})}));hX.displayName=hU.displayName;let hZ=c.forwardRef(({className:e,...t},n)=>(0,l.jsx)("div",{ref:n,className:(0,v.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",e),...t}));hZ.displayName="Card";let hQ=c.forwardRef(({className:e,...t},n)=>(0,l.jsx)("div",{ref:n,className:(0,v.cn)("flex flex-col space-y-1.5 p-6",e),...t}));hQ.displayName="CardHeader";let h0=c.forwardRef(({className:e,...t},n)=>(0,l.jsx)("div",{ref:n,className:(0,v.cn)("text-2xl font-semibold leading-none tracking-tight",e),...t}));h0.displayName="CardTitle";let h1=c.forwardRef(({className:e,...t},n)=>(0,l.jsx)("div",{ref:n,className:(0,v.cn)("text-sm text-muted-foreground",e),...t}));h1.displayName="CardDescription";let h2=c.forwardRef(({className:e,...t},n)=>(0,l.jsx)("div",{ref:n,className:(0,v.cn)("p-6 pt-0",e),...t}));h2.displayName="CardContent",c.forwardRef(({className:e,...t},n)=>(0,l.jsx)("div",{ref:n,className:(0,v.cn)("flex items-center p-6 pt-0",e),...t})).displayName="CardFooter";let h4=(0,dD.F)("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function h5({className:e,variant:t,...n}){return(0,l.jsx)("div",{className:(0,v.cn)(h4({variant:t}),e),...n})}let h3=()=>{let[e,t]=(0,c.useState)(null);(0,c.useEffect)(()=>{let e=e=>{e.preventDefault(),t(e)};window.addEventListener("beforeinstallprompt",e);let n=()=>{t(null)};return window.addEventListener("appinstalled",n),()=>{window.removeEventListener("beforeinstallprompt",e),window.removeEventListener("appinstalled",n)}},[]);let n=(0,c.useCallback)(async()=>{e&&(await e.prompt(),t(null))},[e]);return{installPrompt:e,handleInstallClick:n}},h6={planner:{label:"Planner Widget",description:"Shows today's goals and progress."},affirmations:{label:"Affirmations Widget",description:"Displays your favorite affirmations."},medication:{label:"Medication Widget",description:"Tracks medication counts and bundles."},copingMechanisms:{label:"Coping Strategies Widget",description:"Displays one of your quick strategies."}},h8=[{name:"echo",label:"Echo",bgColor:"hsl(205 75% 45%)",textColor:"hsl(0 0% 100%)"},{name:"forest",label:"Forest",bgColor:"hsl(110 35% 45%)",textColor:"hsl(110 35% 98%)"},{name:"buttercup",label:"Buttercup",bgColor:"hsl(45 80% 60%)",textColor:"hsl(45 25% 15%)"},{name:"sunset",label:"Sunset",bgColor:"hsl(20 80% 45%)",textColor:"hsl(20 80% 98%)"}],h7=({profileData:e,onUpdateProfile:t,currentTheme:n,currentPalette:r,onToggleTheme:s,onChangePalette:i,onDownloadJournal:o,onShowDriveInfo:a,onClearJournal:d,onClearPlanner:h,onClearMedication:u,onClearAllData:p,onNavigateToView:f,onReOnboard:g})=>{let[x,b]=(0,c.useState)(""),[w,k]=(0,c.useState)([]),[N,j]=(0,c.useState)([]),[S,C]=(0,c.useState)({}),[M,A]=(0,c.useState)([]),[E,T]=(0,c.useState)(""),[D,O]=(0,c.useState)(!0),[I,R]=(0,c.useState)(!1),{installPrompt:P,handleInstallClick:L}=h3();(0,c.useEffect)(()=>{b(e.name||""),k(e.strengths||[]),j(e.copingMechanisms||[]),C(e.dashboardWidgets||{}),A(e.favoriteAffirmations||[]),O(!0)},[e]);let B=(0,c.useCallback)(()=>{O(!1)},[]);(0,c.useEffect)(()=>{x!==e.name||JSON.stringify(w.sort())!==JSON.stringify(e.strengths?.sort()||[])||JSON.stringify(N)!==JSON.stringify(e.copingMechanisms)||JSON.stringify(S)!==JSON.stringify(e.dashboardWidgets)||JSON.stringify(M)!==JSON.stringify(e.favoriteAffirmations)?B():O(!0)},[x,w,N,S,M,e,B]);let F=e=>{k(t=>t.includes(e)?t.filter(t=>t!==e):[...t,e])},V=e=>{A(t=>t.filter(t=>t!==e))},_=e=>C(t=>({...t,[e]:!t[e]}));return(0,l.jsxs)("div",{className:"space-y-10 animate-in fade-in-0 duration-750 max-w-4xl w-full",children:[(0,l.jsxs)("div",{className:"flex items-center justify-between",children:[(0,l.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,l.jsx)(m,{className:"w-8 h-8 text-primary"}),(0,l.jsx)("h2",{className:"font-serif text-headline-lg text-surface-on",children:"Profile & Settings"})]}),(0,l.jsx)(y.A,{onClick:()=>{t({name:x.trim(),strengths:w,copingMechanisms:N,dashboardWidgets:S,favoriteAffirmations:M}),O(!0)},variant:"filled",size:"md",leadingIcon:(0,l.jsx)(eo,{}),disabled:D,children:D?"Saved":"Save Changes"})]}),(0,l.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[(0,l.jsxs)(hZ,{className:"bg-surface-container-low shadow-lg border-none",children:[(0,l.jsx)(hQ,{children:(0,l.jsxs)(h0,{className:"flex items-center gap-2",children:[(0,l.jsx)(m,{className:"w-5 h-5"})," Personal Information"]})}),(0,l.jsxs)(h2,{className:"space-y-4",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{htmlFor:"userName",className:"block text-sm font-medium text-surface-on-variant mb-1",children:"Your Name"}),(0,l.jsx)("input",{id:"userName",type:"text",value:x,onChange:e=>b(e.target.value),placeholder:"What should we call you?",className:"w-full p-4 bg-surface-container border border-outline-variant hover:border-outline focus:border-primary focus:ring-1 focus:ring-primary rounded-xl text-surface-on placeholder-surface-on-variant"})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("p",{className:"block text-sm font-medium text-surface-on-variant mb-1",children:"Account"}),(0,l.jsx)("p",{className:"w-full p-4 bg-surface border border-outline-variant rounded-xl text-surface-on-variant truncate",children:"Guest Mode"})]})]})]}),(0,l.jsxs)(hZ,{className:"bg-surface-container-low shadow-lg border-none",children:[(0,l.jsx)(hQ,{children:(0,l.jsxs)(h0,{className:"flex items-center gap-2",children:[(0,l.jsx)(hR,{className:"w-5 h-5"})," Appearance"]})}),(0,l.jsxs)(h2,{className:"space-y-4",children:[(0,l.jsxs)("div",{className:"flex items-center justify-between p-3 bg-surface rounded-lg",children:[(0,l.jsx)("h4",{className:"font-medium text-surface-on",children:"Theme"}),(0,l.jsxs)(y.A,{variant:"tonal",size:"sm",leadingIcon:"light"===n?(0,l.jsx)($.A,{}):(0,l.jsx)(z.A,{}),onClick:s,children:["Switch to ","light"===n?"Dark":"Light"]})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("h4",{className:"font-medium text-surface-on mb-3",children:"Color Palette"}),(0,l.jsx)("div",{className:"flex flex-wrap gap-2",children:h8.map(e=>(0,l.jsxs)("button",{onClick:()=>i(e.name),style:{backgroundColor:e.bgColor,color:e.textColor},className:(0,v.cn)("inline-flex items-center justify-center gap-1.5 whitespace-nowrap rounded-full text-xs font-medium px-4 h-8 transition-all","hover:brightness-110 active:brightness-90 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background",r===e.name&&"ring-2 ring-offset-2 ring-ring"),children:[(0,l.jsx)("span",{children:e.label}),r===e.name&&(0,l.jsx)(hP,{className:"w-4 h-4"})]},e.name))})]})]})]})]}),(0,l.jsxs)(hZ,{className:"bg-surface-container-low shadow-lg border-none",children:[(0,l.jsxs)(hQ,{children:[(0,l.jsxs)("div",{className:"flex justify-between items-center",children:[(0,l.jsxs)(h0,{className:"flex items-center gap-2",children:[(0,l.jsx)(hT,{className:"w-5 h-5"})," My Strengths"]}),!I&&(0,l.jsx)(y.A,{variant:"tonal",size:"sm",onClick:()=>R(!0),children:"Edit"})]}),!I&&(0,l.jsx)(h1,{children:'A reminder of your best qualities. Click "Edit" to update.'})]}),(0,l.jsx)(h2,{children:I?(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("p",{className:"text-body-md text-surface-on-variant mb-4",children:"Select the qualities that resonate with you."}),(0,l.jsx)("div",{className:"flex flex-wrap gap-2",children:hF.map(e=>{let t=w.includes(e);return(0,l.jsx)("button",{onClick:()=>F(e),className:`px-3 py-1.5 rounded-full text-sm font-medium transition-all duration-200 border ${t?"bg-secondary-container border-secondary-container text-on-secondary-container":"bg-surface border-outline-variant hover:border-outline text-surface-on-variant"}`,children:(0,l.jsxs)("div",{className:"flex items-center gap-1.5",children:[e,t&&(0,l.jsx)(hP,{className:"w-4 h-4"})]})},e)})}),(0,l.jsxs)("div",{className:"flex justify-end gap-2 mt-6",children:[(0,l.jsx)(y.A,{variant:"text",onClick:()=>{R(!1),k(e.strengths||[])},children:"Cancel"}),(0,l.jsx)(y.A,{variant:"tonal",onClick:()=>R(!1),children:"Done"})]})]}):(0,l.jsx)("div",{className:"flex flex-wrap gap-2",children:w.length>0?w.map(e=>(0,l.jsx)(h5,{variant:"secondary",className:"text-base px-3 py-1 bg-secondary-container text-on-secondary-container border-transparent",children:e},e)):(0,l.jsx)("p",{className:"text-body-md text-surface-on-variant italic",children:'No strengths selected yet. Click "Edit" to add some.'})})})]}),(0,l.jsxs)(hZ,{className:"bg-surface-container-low shadow-lg border-none",children:[(0,l.jsxs)(hQ,{children:[(0,l.jsxs)(h0,{className:"flex items-center gap-2",children:[(0,l.jsx)(hT,{className:"w-5 h-5 text-yellow-500"})," My Affirmations"]}),(0,l.jsx)(h1,{children:"Manage your list of custom and favorite affirmations."})]}),(0,l.jsx)(h2,{children:M.length>0?(0,l.jsx)("ul",{className:"space-y-2 max-h-60 overflow-y-auto",children:M.map((e,t)=>(0,l.jsxs)("li",{className:"flex items-center justify-between p-3 bg-surface rounded-lg",children:[(0,l.jsxs)("p",{className:"text-body-md text-surface-on flex-grow mr-2",children:['"',e,'"']}),(0,l.jsx)(y.A,{variant:"text",size:"sm",isIconOnly:!0,title:"Remove affirmation",className:"text-error hover:bg-error-container/20",onClick:()=>V(e),children:(0,l.jsx)(eu,{className:"w-5 h-5"})})]},t))}):(0,l.jsx)("p",{className:"text-body-md text-surface-on-variant italic",children:"No affirmations favorited yet. Find some on the Affirmations page!"})})]}),(0,l.jsxs)(hZ,{className:"bg-surface-container-low shadow-lg border-none",children:[(0,l.jsxs)(hQ,{children:[(0,l.jsxs)(h0,{className:"flex items-center gap-2",children:[(0,l.jsx)(hz,{className:"w-5 h-5"})," Dashboard Customization"]}),(0,l.jsx)(h1,{children:"Choose which widgets appear on your dashboard."})]}),(0,l.jsx)(h2,{className:"space-y-3",children:Object.entries(h6).map(([e,t])=>(0,l.jsxs)("div",{className:"flex items-center justify-between p-3 bg-surface rounded-lg",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("h4",{className:"font-medium text-surface-on",children:t.label}),(0,l.jsx)("p",{className:"text-sm text-surface-on-variant",children:t.description})]}),(0,l.jsx)(hX,{checked:!!S[e],onCheckedChange:()=>_(e),"aria-label":`Toggle ${t.label} widget`})]},e))})]}),(0,l.jsxs)(hZ,{className:"bg-surface-container-low shadow-lg border-none",children:[(0,l.jsx)(hQ,{children:(0,l.jsxs)(h0,{className:"flex items-center gap-2",children:[(0,l.jsx)(h$,{className:"w-5 h-5"})," Data & Information"]})}),(0,l.jsxs)(h2,{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-3",children:[P&&(0,l.jsx)(y.A,{variant:"filled",size:"md",leadingIcon:(0,l.jsx)(hL,{}),onClick:L,children:"Install App"}),(0,l.jsx)(y.A,{variant:"tonal",size:"md",leadingIcon:(0,l.jsx)(hB,{}),onClick:o,children:"Export Journal"}),(0,l.jsx)(y.A,{variant:"tonal",size:"md",leadingIcon:(0,l.jsx)(hz,{}),onClick:()=>f("designSystem"),children:"View Design System"})]})]}),(0,l.jsxs)(hZ,{className:"bg-surface-container-low shadow-lg border-none",children:[(0,l.jsxs)(hQ,{children:[(0,l.jsxs)(h0,{className:"flex items-center gap-2",children:[(0,l.jsx)(ho,{className:"w-5 h-5 text-error"})," Danger Zone"]}),(0,l.jsx)(h1,{className:"!text-error/80",children:"These actions are irreversible. Please be certain before proceeding."})]}),(0,l.jsxs)(h2,{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,l.jsxs)("div",{className:"p-4 bg-surface rounded-lg border border-outline-variant space-y-2",children:[(0,l.jsx)("h4",{className:"font-medium text-surface-on",children:"Clear Journal & Planner"}),(0,l.jsx)("p",{className:"text-sm text-surface-on-variant",children:"Permanently delete all entries, records, and plans."}),(0,l.jsxs)("div",{className:"flex gap-2 pt-2",children:[(0,l.jsx)(y.A,{variant:"outlined",size:"sm",onClick:d,className:"text-error hover:bg-error-container/20 border-error",children:"Journal"}),(0,l.jsx)(y.A,{variant:"outlined",size:"sm",onClick:h,className:"text-error hover:bg-error-container/20 border-error",children:"Planner"})]})]}),(0,l.jsxs)("div",{className:"p-4 bg-surface rounded-lg border border-outline-variant space-y-2",children:[(0,l.jsx)("h4",{className:"font-medium text-surface-on",children:"Clear Medication Data"}),(0,l.jsx)("p",{className:"text-sm text-surface-on-variant",children:"Permanently delete all meds, bundles, and logs."}),(0,l.jsx)(y.A,{variant:"outlined",size:"sm",onClick:u,className:"text-error hover:bg-error-container/20 border-error mt-6",children:"Clear Meds"})]}),(0,l.jsxs)("div",{className:"md:col-span-2 p-4 bg-error-container/40 rounded-lg mt-4 flex flex-col sm:flex-row justify-between items-start sm:items-center gap-3",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("h4",{className:"font-bold text-on-error-container",children:"Clear All Application Data"}),(0,l.jsx)("p",{className:"text-sm text-on-error-container/80",children:"Permanently delete EVERYTHING. This cannot be undone."})]}),(0,l.jsx)(y.A,{variant:"filled",size:"sm",onClick:p,leadingIcon:(0,l.jsx)(eu,{}),className:"!bg-error !text-on-error shrink-0",children:"Clear All Data"})]})]})]}),(0,l.jsx)("div",{className:"text-center pt-6 border-t border-outline-variant",children:(0,l.jsx)(y.A,{variant:"text",size:"sm",leadingIcon:(0,l.jsx)(U,{}),onClick:g,children:"Re-run Onboarding (for testing)"})})]})},h9=(0,f.A)("Wind",[["path",{d:"M12.8 19.6A2 2 0 1 0 14 16H2",key:"148xed"}],["path",{d:"M17.5 8a2.5 2.5 0 1 1 2 4H2",key:"1u4tom"}],["path",{d:"M9.8 4.4A2 2 0 1 1 11 8H2",key:"75valh"}]]),ue=(0,f.A)("BrainCircuit",[["path",{d:"M12 5a3 3 0 1 0-5.997.125 4 4 0 0 0-2.526 5.77 4 4 0 0 0 .556 6.588A4 4 0 1 0 12 18Z",key:"l5xja"}],["path",{d:"M9 13a4.5 4.5 0 0 0 3-4",key:"10igwf"}],["path",{d:"M6.003 5.125A3 3 0 0 0 6.401 6.5",key:"105sqy"}],["path",{d:"M3.477 10.896a4 4 0 0 1 .585-.396",key:"ql3yin"}],["path",{d:"M6 18a4 4 0 0 1-1.967-.516",key:"2e4loj"}],["path",{d:"M12 13h4",key:"1ku699"}],["path",{d:"M12 18h6a2 2 0 0 1 2 2v1",key:"105ag5"}],["path",{d:"M12 8h8",key:"1lhi5i"}],["path",{d:"M16 8V5a2 2 0 0 1 2-2",key:"u6izg6"}],["circle",{cx:"16",cy:"13",r:".5",key:"ry7gng"}],["circle",{cx:"18",cy:"3",r:".5",key:"1aiba7"}],["circle",{cx:"20",cy:"21",r:".5",key:"yhc1fs"}],["circle",{cx:"20",cy:"8",r:".5",key:"1e43v0"}]]),ut=(0,f.A)("ListChecks",[["path",{d:"m3 17 2 2 4-4",key:"1jhpwq"}],["path",{d:"m3 7 2 2 4-4",key:"1obspn"}],["path",{d:"M13 6h8",key:"15sg57"}],["path",{d:"M13 12h8",key:"h98zly"}],["path",{d:"M13 18h8",key:"oe0vm4"}]]),un=(0,f.A)("Waves",[["path",{d:"M2 6c.6.5 1.2 1 2.5 1C7 7 7 5 9.5 5c2.6 0 2.4 2 5 2 2.5 0 2.5-2 5-2 1.3 0 1.9.5 2.5 1",key:"knzxuh"}],["path",{d:"M2 12c.6.5 1.2 1 2.5 1 2.5 0 2.5-2 5-2 2.6 0 2.4 2 5 2 2.5 0 2.5-2 5-2 1.3 0 1.9.5 2.5 1",key:"2jd2cc"}],["path",{d:"M2 18c.6.5 1.2 1 2.5 1 2.5 0 2.5-2 5-2 2.6 0 2.4 2 5 2 2.5 0 2.5-2 5-2 1.3 0 1.9.5 2.5 1",key:"rd2r6e"}]]),ur=[{id:"rain-exercise",text:"Practice the RAIN mindfulness exercise"},{id:"grounding-54321",text:"Use the 5-4-3-2-1 grounding technique"},{id:"distress-accepts",text:"Use ACCEPTS for distress tolerance"},{id:"urge-surfing",text:'Practice "Urge Surfing"'},{id:"categories-exercise",text:"Use the Categories distraction technique"}],us=({title:e,description:t,icon:n,view:r,onNavigate:s})=>(0,l.jsxs)("div",{className:"bg-surface rounded-lg shadow-sm hover:shadow-md transition-shadow p-6 flex flex-col",children:[(0,l.jsxs)("div",{className:"flex items-start gap-4",children:[(0,l.jsx)("div",{className:"text-primary mt-1",children:n}),(0,l.jsxs)("div",{className:"flex-grow",children:[(0,l.jsx)("h4",{className:"text-title-lg font-medium text-surface-on",children:e}),(0,l.jsx)("p",{className:"text-body-md text-surface-on-variant mt-1 mb-4",children:t})]})]}),(0,l.jsx)(y.A,{variant:"tonal",size:"md",onClick:()=>s(r),className:"mt-auto self-start",trailingIcon:(0,l.jsx)(ns,{}),children:"Learn More"})]}),ui=({id:e,title:t,icon:n,isAdded:r,onAdd:s,children:i,className:o})=>(0,l.jsxs)(hZ,{className:(0,v.cn)("bg-surface-container-low shadow-sm border-outline-variant flex flex-col",o),children:[(0,l.jsx)(hQ,{children:(0,l.jsxs)("div",{className:"flex justify-between items-start gap-4",children:[(0,l.jsxs)("div",{className:"flex items-center gap-3",children:[(0,l.jsx)("div",{className:"text-primary",children:n}),(0,l.jsx)(h0,{className:"font-serif text-title-lg text-surface-on",children:t})]}),(0,l.jsx)(y.A,{variant:r?"tonal":"outlined",size:"sm",leadingIcon:r?(0,l.jsx)(hP,{className:"w-4 h-4"}):(0,l.jsx)(Y,{className:"w-4 h-4"}),onClick:s,disabled:r,"aria-label":r?`Added ${t} to your strategies`:`Add ${t} to your strategies`,children:r?"Added":"Add"})]})}),(0,l.jsx)(h2,{className:"text-body-md text-surface-on-variant flex-grow",children:i})]}),uo=({onNavigateToView:e,onAddCopingMechanism:t,userCopingMechanisms:n})=>{let r=e=>n.some(t=>t.id===e);return(0,l.jsxs)("div",{className:"space-y-10 animate-in fade-in-0 duration-750 max-w-4xl",children:[(0,l.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,l.jsx)(T,{className:"w-8 h-8 text-primary"}),(0,l.jsx)("h2",{className:"font-serif text-headline-lg text-surface-on",children:"Resources"})]}),(0,l.jsx)("p",{className:"text-body-lg text-surface-on-variant",children:"Explore these guides to better understand the concepts behind the tools in this app and find support when you need it."}),(0,l.jsxs)("div",{className:"space-y-8",children:[(0,l.jsxs)("section",{className:"space-y-6",children:[(0,l.jsx)("h3",{className:"font-serif text-headline-sm text-surface-on",children:"Mindfulness & Coping Techniques"}),(0,l.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 items-start",children:[(0,l.jsxs)(ui,{id:"rain-exercise",title:"RAIN Mindfulness Exercise",icon:(0,l.jsx)(h9,{className:"w-6 h-6"}),isAdded:r("rain-exercise"),onAdd:()=>t(ur[0]),children:[(0,l.jsx)("p",{className:"mb-4 text-sm",children:"Mindfulness is a state of nonjudgmental awareness of whats happening in the present moment. RAIN is a mindfulness practice that will help you focus on the present and cope with uncomfortable thoughts and emotions."}),(0,l.jsxs)("div",{className:"mb-4 p-3 bg-surface rounded-lg border border-outline-variant",children:[(0,l.jsx)("h5",{className:"font-semibold text-primary",children:"Prepare"}),(0,l.jsx)("p",{className:"text-sm",children:"Sit or lie down in a comfortable position. Close your eyes or let your gaze soften. Take three slow, deep breaths."})]}),(0,l.jsxs)("div",{className:"space-y-4",children:[(0,l.jsxs)("div",{className:"flex gap-4",children:[(0,l.jsx)("div",{className:"font-bold text-4xl text-primary",children:"R"}),(0,l.jsxs)("div",{children:[(0,l.jsx)("h5",{className:"font-semibold text-surface-on",children:"Recognize"}),(0,l.jsx)("p",{className:"text-sm",children:"Let yourself feel at ease in the present moment. Slowly take in your surroundings. Recognize your thoughts, feelings, and physical sensations. Name your feelings out loud or silently to yourself."})]})]}),(0,l.jsxs)("div",{className:"flex gap-4",children:[(0,l.jsx)("div",{className:"font-bold text-4xl text-primary",children:"A"}),(0,l.jsxs)("div",{children:[(0,l.jsx)("h5",{className:"font-semibold text-surface-on",children:"Allow"}),(0,l.jsx)("p",{className:"text-sm",children:'Observe your experience as if watching a movie. Let your thoughts, feelings, and sensations come and go as they are. Let go of any judgmentit is okay to feel however you are feeling. You may tell yourself, "This is how it is right now."'})]})]}),(0,l.jsxs)("div",{className:"flex gap-4",children:[(0,l.jsx)("div",{className:"font-bold text-4xl text-primary",children:"I"}),(0,l.jsxs)("div",{children:[(0,l.jsx)("h5",{className:"font-semibold text-surface-on",children:"Investigate"}),(0,l.jsx)("p",{className:"text-sm",children:"What words are going through your mind? What emotions are you feeling, and where are they coming from? How are these feelings experienced in your body? Sense the most vulnerable part of yourself and reflect on what it needs, such as acceptance, forgiveness, love, or belonging."})]})]}),(0,l.jsxs)("div",{className:"flex gap-4",children:[(0,l.jsx)("div",{className:"font-bold text-4xl text-primary",children:"N"}),(0,l.jsxs)("div",{children:[(0,l.jsx)("h5",{className:"font-semibold text-surface-on",children:"Nurture"}),(0,l.jsx)("p",{className:"text-sm",children:'Be kind toward your experience. Give yourself a comforting message, such as "I love you," "you are okay," or anything else you need. Think of a friend, family member, pet, or spiritual figure, and imagine their love flowing to you. Let in healing and compassion until you feel calm and centered.'})]})]})]}),(0,l.jsxs)("div",{className:"mt-4 p-3 bg-surface rounded-lg border border-outline-variant",children:[(0,l.jsx)("h5",{className:"font-semibold text-primary",children:"Conclude"}),(0,l.jsx)("p",{className:"text-sm",children:"Take three slow, deep breaths. Continue to be mindful and kind to yourself throughout your day."})]})]}),(0,l.jsxs)("div",{className:"flex flex-col gap-6",children:[(0,l.jsxs)(ui,{id:"grounding-54321",title:"5-4-3-2-1 Grounding",icon:(0,l.jsx)(ue,{className:"w-6 h-6"}),isAdded:r("grounding-54321"),onAdd:()=>t(ur[1]),children:[(0,l.jsx)("p",{className:"mb-4",children:"Use your five senses to bring yourself back to the present moment."}),(0,l.jsxs)("ul",{className:"list-disc pl-5 space-y-1 text-sm",children:[(0,l.jsxs)("li",{children:[(0,l.jsx)("strong",{children:"5"})," things you can see."]}),(0,l.jsxs)("li",{children:[(0,l.jsx)("strong",{children:"4"})," things you can feel."]}),(0,l.jsxs)("li",{children:[(0,l.jsx)("strong",{children:"3"})," things you can hear."]}),(0,l.jsxs)("li",{children:[(0,l.jsx)("strong",{children:"2"})," things you can smell."]}),(0,l.jsxs)("li",{children:[(0,l.jsx)("strong",{children:"1"})," thing you can taste."]})]})]}),(0,l.jsxs)(ui,{id:"distress-accepts",title:"ACCEPTS Technique",icon:(0,l.jsx)(hT,{className:"w-6 h-6"}),isAdded:r("distress-accepts"),onAdd:()=>t(ur[2]),children:[(0,l.jsx)("p",{className:"mb-4",children:"An acronym for distracting yourself from distressing emotions until they pass."}),(0,l.jsxs)("ul",{className:"list-disc pl-5 space-y-1 text-sm",children:[(0,l.jsxs)("li",{children:[(0,l.jsx)("strong",{children:"A"}),"ctivities"]}),(0,l.jsxs)("li",{children:[(0,l.jsx)("strong",{children:"C"}),"ontributing"]}),(0,l.jsxs)("li",{children:[(0,l.jsx)("strong",{children:"C"}),"omparisons"]}),(0,l.jsxs)("li",{children:[(0,l.jsx)("strong",{children:"E"}),"motions"]}),(0,l.jsxs)("li",{children:[(0,l.jsx)("strong",{children:"P"}),"ushing Away"]}),(0,l.jsxs)("li",{children:[(0,l.jsx)("strong",{children:"T"}),"houghts"]}),(0,l.jsxs)("li",{children:[(0,l.jsx)("strong",{children:"S"}),"ensations"]})]})]}),(0,l.jsxs)(ui,{id:"categories-exercise",title:"Categories",icon:(0,l.jsx)(ut,{className:"w-6 h-6"}),isAdded:r("categories-exercise"),onAdd:()=>t(ur[4]),children:[(0,l.jsx)("p",{className:"mb-4",children:"A simple distraction technique to shift your focus away from distressing thoughts."}),(0,l.jsxs)("ol",{className:"list-decimal pl-5 space-y-2 text-sm",children:[(0,l.jsx)("li",{children:"Pick a broad category (e.g., animals, countries, car models, fruits, breakfast cereals)."}),(0,l.jsx)("li",{children:"Mentally list as many items from that category as you can."}),(0,l.jsx)("li",{children:"Try to visualize each item as you name it."}),(0,l.jsx)("li",{children:"If you get stuck, simply choose a new category and begin again."})]})]})]}),(0,l.jsxs)(ui,{id:"urge-surfing",title:"Urge Surfing",icon:(0,l.jsx)(un,{className:"w-6 h-6"}),isAdded:r("urge-surfing"),onAdd:()=>t(ur[3]),className:"md:col-span-2",children:[(0,l.jsx)("p",{className:"mb-4",children:"A technique for managing your unwanted behaviors. Rather than giving in to an urge, you will ride it out, like a surfer riding a wave. After a short time, the urge will pass on its own."}),(0,l.jsx)("h4",{className:"font-semibold text-surface-on mb-2",children:"How to Practice"}),(0,l.jsxs)("ol",{className:"list-decimal pl-5 space-y-2 text-sm mb-4",children:[(0,l.jsx)("li",{children:"Acknowledge you are having an urge."}),(0,l.jsxs)("li",{children:["Notice your thoughts and feelings without trying to change or suppress them.",(0,l.jsx)("em",{className:"block text-xs text-surface-on-variant/80 pl-2 border-l-2 border-outline ml-2 mt-1",children:"Note: It is normal to feel some discomfort during an urge."})]}),(0,l.jsxs)("li",{children:["Remind yourself...",(0,l.jsxs)("ul",{className:"list-disc pl-5 mt-1 space-y-1",children:[(0,l.jsx)("li",{children:"It's okay to have urges. They're natural reactions to addictions and habits."}),(0,l.jsx)("li",{children:"Some discomfort is okay. I don't have to change it."}),(0,l.jsx)("li",{children:'An urge is a feeling, not a "must." I can have this feeling and choose not to act.'}),(0,l.jsx)("li",{children:"An urge is temporary. Like any other feeling, it will pass on its own."})]})]})]}),(0,l.jsx)("h4",{className:"font-semibold text-surface-on mb-2",children:"Other Skills"}),(0,l.jsxs)("div",{className:"space-y-2 text-sm mb-6",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("h5",{className:"font-medium text-surface-on",children:"Managing Triggers"}),(0,l.jsx)("p",{children:"Use coping skills to reduce the power of triggers. Know your triggers ahead of time, and have a strategy or skill prepared for each one."})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("h5",{className:"font-medium text-surface-on",children:"Delay & Distraction"}),(0,l.jsx)("p",{children:"Do something to take your mind off the urge. Every minute you delay increases the chance of the urge weakening on its own."})]})]}),(0,l.jsxs)("div",{className:"relative mt-4",children:[(0,l.jsx)("div",{className:"h-48 w-full rounded-lg bg-surface border border-outline-variant"}),(0,l.jsxs)("div",{className:"absolute inset-0 grid grid-cols-4 grid-rows-2 gap-x-2 p-2 sm:p-4 text-xs",children:[(0,l.jsxs)("div",{className:"col-start-1 row-start-2 p-2 bg-surface-container/80 rounded-lg text-center shadow-md",children:[(0,l.jsx)("p",{className:"font-bold text-primary",children:"Trigger"}),(0,l.jsx)("p",{className:"text-surface-on-variant text-[10px] leading-tight",children:"An urge is triggered by a person, place, thought, feeling, or something else."})]}),(0,l.jsxs)("div",{className:"col-start-2 row-start-1 p-2 bg-surface-container/80 rounded-lg text-center shadow-md",children:[(0,l.jsx)("p",{className:"font-bold text-primary",children:"Rise"}),(0,l.jsx)("p",{className:"text-surface-on-variant text-[10px] leading-tight",children:"The urge becomes more intense. This may happen gradually or very suddenly."})]}),(0,l.jsxs)("div",{className:"col-start-3 row-start-1 p-2 bg-surface-container/80 rounded-lg text-center shadow-md",children:[(0,l.jsx)("p",{className:"font-bold text-primary",children:"Peak"}),(0,l.jsx)("p",{className:"text-surface-on-variant text-[10px] leading-tight",children:"The urge reaches its most intense point. It may feel as if the urge will never go away."})]}),(0,l.jsxs)("div",{className:"col-start-4 row-start-2 p-2 bg-surface-container/80 rounded-lg text-center shadow-md",children:[(0,l.jsx)("p",{className:"font-bold text-primary",children:"Fall"}),(0,l.jsx)("p",{className:"text-surface-on-variant text-[10px] leading-tight",children:"The urge loses intensity and eventually fades away."})]})]})]})]})]}),(0,l.jsxs)(hZ,{className:"bg-surface-container-low shadow-sm border-outline-variant",children:[(0,l.jsx)(hQ,{children:(0,l.jsxs)(h0,{className:"font-serif text-title-lg text-surface-on flex items-center gap-2",children:[(0,l.jsx)(ue,{})," The Wise Mind"]})}),(0,l.jsxs)(h2,{className:"space-y-4",children:[(0,l.jsx)("p",{className:"text-body-md text-surface-on-variant",children:"Your mind has three states: The reasonable mind, the emotional mind, and the wise mind. Everyone possesses each of these states, but most people gravitate toward a specific one most of the time."}),(0,l.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,l.jsxs)("div",{className:"p-4 bg-surface rounded-lg border-l-4 border-red-400",children:[(0,l.jsx)("h4",{className:"font-semibold text-surface-on",children:"Emotional Mind"}),(0,l.jsx)("p",{className:"text-sm text-surface-on-variant mt-1",children:"Used when feelings control a persons thoughts and behavior. They might act impulsively with little regard for consequences."})]}),(0,l.jsxs)("div",{className:"p-4 bg-surface rounded-lg border-l-4 border-purple-400",children:[(0,l.jsx)("h4",{className:"font-semibold text-surface-on",children:"Wise Mind"}),(0,l.jsx)("p",{className:"text-sm text-surface-on-variant mt-1",children:"Refers to a balance between the reasonable and emotional halves. They are able to recognize and respect their feelings, while responding to them in a rational manner."})]}),(0,l.jsxs)("div",{className:"p-4 bg-surface rounded-lg border-l-4 border-blue-400",children:[(0,l.jsx)("h4",{className:"font-semibold text-surface-on",children:"Reasonable Mind"}),(0,l.jsx)("p",{className:"text-sm text-surface-on-variant mt-1",children:"A person uses their Reasonable mind when they approach a situation intellectually. They plan and make decisions based on fact."})]})]})]})]})]}),(0,l.jsxs)("section",{className:"bg-surface-container-low p-6 sm:p-8 rounded-2xl shadow-lg",children:[(0,l.jsx)("h3",{className:"font-serif text-headline-sm text-surface-on mb-4",children:"Guides & Information"}),(0,l.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,l.jsx)(us,{title:"Understanding CBT",description:"Learn about Cognitive Behavioral Therapy and how the Thought Record tool can help you challenge and reframe unhelpful thoughts.",icon:(0,l.jsx)(ue,{className:"w-7 h-7"}),view:"understanding-cbt",onNavigate:e}),(0,l.jsx)(us,{title:"Crisis Support",description:"If you are in a crisis or need immediate support, please use these resources. You are not alone.",icon:(0,l.jsx)(ho,{className:"w-7 h-7 text-error"}),view:"crisis-support",onNavigate:e})]})]})]}),(0,l.jsx)("p",{className:"text-label-md text-center text-surface-on-variant pt-4",children:"The content in this app is for informational purposes only and is not a substitute for professional medical advice, diagnosis, or treatment."})]})};var ua="Checkbox",[ul,uc]=(0,ex.A)(ua),[ud,uh]=ul(ua),uu=c.forwardRef((e,t)=>{let{__scopeCheckbox:n,name:r,checked:s,defaultChecked:i,required:o,disabled:a,value:d="on",onCheckedChange:h,form:u,...p}=e,[f,m]=c.useState(null),g=(0,eg.s)(t,e=>m(e)),x=c.useRef(!1),y=!f||u||!!f.closest("form"),[v=!1,b]=(0,ek.i)({prop:s,defaultProp:i,onChange:h}),w=c.useRef(v);return c.useEffect(()=>{let e=f?.form;if(e){let t=()=>b(w.current);return e.addEventListener("reset",t),()=>e.removeEventListener("reset",t)}},[f,b]),(0,l.jsxs)(ud,{scope:n,state:v,disabled:a,children:[(0,l.jsx)(ej.sG.button,{type:"button",role:"checkbox","aria-checked":ug(v)?"mixed":v,"aria-required":o,"data-state":ux(v),"data-disabled":a?"":void 0,disabled:a,value:d,...p,ref:g,onKeyDown:(0,em.m)(e.onKeyDown,e=>{"Enter"===e.key&&e.preventDefault()}),onClick:(0,em.m)(e.onClick,e=>{b(e=>!!ug(e)||!e),y&&(x.current=e.isPropagationStopped(),x.current||e.stopPropagation())})}),y&&(0,l.jsx)(um,{control:f,bubbles:!x.current,name:r,value:d,checked:v,required:o,disabled:a,form:u,style:{transform:"translateX(-100%)"},defaultChecked:!ug(i)&&i})]})});uu.displayName=ua;var up="CheckboxIndicator",uf=c.forwardRef((e,t)=>{let{__scopeCheckbox:n,forceMount:r,...s}=e,i=uh(up,n);return(0,l.jsx)(ez.C,{present:r||ug(i.state)||!0===i.state,children:(0,l.jsx)(ej.sG.span,{"data-state":ux(i.state),"data-disabled":i.disabled?"":void 0,...s,ref:t,style:{pointerEvents:"none",...e.style}})})});uf.displayName=up;var um=e=>{let{control:t,checked:n,bubbles:r=!0,defaultChecked:s,...i}=e,o=c.useRef(null),a=nl(n),d=nc(t);c.useEffect(()=>{let e=o.current,t=Object.getOwnPropertyDescriptor(window.HTMLInputElement.prototype,"checked").set;if(a!==n&&t){let s=new Event("click",{bubbles:r});e.indeterminate=ug(n),t.call(e,!ug(n)&&n),e.dispatchEvent(s)}},[a,n,r]);let h=c.useRef(!ug(n)&&n);return(0,l.jsx)("input",{type:"checkbox","aria-hidden":!0,defaultChecked:s??h.current,...i,tabIndex:-1,ref:o,style:{...e.style,...d,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})};function ug(e){return"indeterminate"===e}function ux(e){return ug(e)?"indeterminate":e?"checked":"unchecked"}let uy=c.forwardRef(({className:e,...t},n)=>(0,l.jsx)(uu,{ref:n,className:(0,v.cn)("peer h-4 w-4 shrink-0 rounded-sm border border-primary ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground",e),...t,children:(0,l.jsx)(uf,{className:(0,v.cn)("flex items-center justify-center text-current"),children:(0,l.jsx)(hP,{className:"h-4 w-4"})})}));uy.displayName=uu.displayName;let uv=(0,f.A)("Type",[["polyline",{points:"4 7 4 4 20 4 20 7",key:"1nosan"}],["line",{x1:"9",x2:"15",y1:"20",y2:"20",key:"swin9y"}],["line",{x1:"12",x2:"12",y1:"4",y2:"20",key:"1tx1rr"}]]),ub=(0,f.A)("ToyBrick",[["rect",{width:"18",height:"12",x:"3",y:"8",rx:"1",key:"158fvp"}],["path",{d:"M10 8V5c0-.6-.4-1-1-1H6a1 1 0 0 0-1 1v3",key:"s0042v"}],["path",{d:"M19 8V5c0-.6-.4-1-1-1h-3a1 1 0 0 0-1 1v3",key:"9wmeh2"}]]);var uw=c.forwardRef((e,t)=>(0,l.jsx)(ej.sG.label,{...e,ref:t,onMouseDown:t=>{t.target.closest("button, input, select, textarea")||(e.onMouseDown?.(t),!t.defaultPrevented&&t.detail>1&&t.preventDefault())}}));uw.displayName="Label";let uk=(0,dD.F)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),uN=c.forwardRef(({className:e,...t},n)=>(0,l.jsx)(uw,{ref:n,className:(0,v.cn)(uk(),e),...t}));uN.displayName=uw.displayName;let uj=[{name:"echo",label:"Echo",bgColor:"hsl(205 75% 45%)",textColor:"hsl(0 0% 100%)"},{name:"forest",label:"Forest",bgColor:"hsl(110 35% 45%)",textColor:"hsl(110 35% 98%)"},{name:"buttercup",label:"Buttercup",bgColor:"hsl(45 80% 60%)",textColor:"hsl(45 25% 15%)"},{name:"sunset",label:"Sunset",bgColor:"hsl(20 80% 45%)",textColor:"hsl(20 80% 98%)"}],uS=[{name:"Primary",colors:[{name:"Primary",var:"hsl(var(--primary))",text:"hsl(var(--primary-foreground))"},{name:"Primary Container",var:"hsl(var(--primary-container))",text:"hsl(var(--on-primary-container))"}]},{name:"Secondary",colors:[{name:"Secondary",var:"hsl(var(--secondary))",text:"hsl(var(--secondary-foreground))"},{name:"Secondary Container",var:"hsl(var(--secondary-container))",text:"hsl(var(--on-secondary-container))"}]},{name:"Tertiary",colors:[{name:"Tertiary",var:"hsl(var(--tertiary))",text:"hsl(var(--on-tertiary))"},{name:"Tertiary Container",var:"hsl(var(--tertiary-container))",text:"hsl(var(--on-tertiary-container))"}]},{name:"Surface",colors:[{name:"Background",var:"hsl(var(--background))",text:"hsl(var(--foreground))"},{name:"Surface",var:"hsl(var(--surface))",text:"hsl(var(--on-surface))"},{name:"Surface Variant",var:"hsl(var(--surface-variant))",text:"hsl(var(--on-surface-variant))"},{name:"Surface Container Low",var:"hsl(var(--surface-container-low))",text:"hsl(var(--on-surface))"},{name:"Surface Container",var:"hsl(var(--surface-container))",text:"hsl(var(--on-surface))"},{name:"Surface Container High",var:"hsl(var(--surface-container-high))",text:"hsl(var(--on-surface))"}]},{name:"Utility",colors:[{name:"Error Container",var:"hsl(var(--error-container))",text:"hsl(var(--on-error-container))"},{name:"Outline",var:"hsl(var(--outline))",text:"hsl(var(--background))",border:!0},{name:"Outline Variant",var:"hsl(var(--outline-variant))",text:"hsl(var(--background))",border:!0}]}],uC=[{name:"Display Large",class:"font-serif text-display-lg"},{name:"Display Medium",class:"font-serif text-display-md"},{name:"Display Small",class:"font-serif text-display-sm"},{name:"Headline Large",class:"font-serif text-headline-lg"},{name:"Headline Medium",class:"font-serif text-headline-md"},{name:"Headline Small",class:"font-serif text-headline-sm"},{name:"Title Large",class:"font-serif text-title-lg"},{name:"Title Medium",class:"font-serif text-title-md"},{name:"Title Small",class:"font-serif text-title-sm"},{name:"Body Large",class:"text-body-lg"},{name:"Body Medium",class:"text-body-md"},{name:"Body Small",class:"text-body-sm"},{name:"Label Large",class:"text-label-lg"},{name:"Label Medium",class:"text-label-md"},{name:"Label Small",class:"text-label-sm"}],uM=({currentPalette:e,onChangePalette:t})=>{let[n,r]=h().useState([50]),[s,i]=h().useState(!1);return(0,l.jsxs)("div",{className:"space-y-12 animate-in fade-in-0 duration-750 max-w-5xl w-full",children:[(0,l.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,l.jsx)(hz,{className:"w-8 h-8 text-primary"}),(0,l.jsx)("h2",{className:"font-serif text-headline-lg text-surface-on",children:"Design System"})]}),(0,l.jsxs)("section",{"aria-labelledby":"colors-heading",className:"space-y-6",children:[(0,l.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,l.jsx)(hR,{className:"w-7 h-7 text-secondary"}),(0,l.jsx)("h3",{id:"colors-heading",className:"font-serif text-headline-md text-surface-on",children:"Color Palette"})]}),(0,l.jsxs)("div",{className:"bg-surface-container-low p-6 rounded-lg shadow-sm",children:[(0,l.jsx)("h4",{className:"text-title-md font-medium text-surface-on mb-3",children:"Live Theme Selector"}),(0,l.jsx)("p",{className:"text-body-md text-surface-on-variant mb-4",children:"Select a palette to see it applied to this page and the entire app instantly."}),(0,l.jsx)("div",{className:"flex flex-wrap gap-3",children:uj.map(n=>(0,l.jsxs)("button",{onClick:()=>t(n.name),style:{backgroundColor:n.bgColor,color:n.textColor},className:(0,v.cn)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-full text-sm font-medium px-6 h-10 transition-all duration-200","hover:brightness-110 active:brightness-90 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background",e===n.name&&"ring-2 ring-offset-2 ring-ring ring-offset-background"),"aria-pressed":e===n.name,children:[(0,l.jsx)("span",{children:n.label}),e===n.name&&(0,l.jsx)(hP,{className:"w-5 h-5"})]},n.name))})]}),uS.map(e=>(0,l.jsxs)("div",{children:[(0,l.jsx)("h4",{className:"font-serif text-title-lg text-surface-on-variant mb-3",children:e.name}),(0,l.jsx)("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-4",children:e.colors.map(e=>(0,l.jsxs)("div",{style:{backgroundColor:e.var,color:e.text,borderColor:e.border?"hsl(var(--outline))":"transparent"},className:"p-4 rounded-lg shadow-sm border",children:[(0,l.jsx)("p",{className:"font-medium text-sm",children:e.name}),(0,l.jsx)("p",{className:"text-xs opacity-80",children:e.var})]},e.name))})]},e.name))]}),(0,l.jsxs)("section",{"aria-labelledby":"typography-heading",className:"space-y-6",children:[(0,l.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,l.jsx)(uv,{className:"w-7 h-7 text-secondary"}),(0,l.jsx)("h3",{id:"typography-heading",className:"font-serif text-headline-md text-surface-on",children:"Typography"})]}),(0,l.jsx)("div",{className:"bg-surface-container-low p-6 rounded-lg shadow-sm space-y-4",children:uC.map(e=>(0,l.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-baseline gap-x-6",children:[(0,l.jsx)("p",{className:"text-sm text-surface-on-variant w-40 shrink-0",children:e.name}),(0,l.jsx)("p",{className:(0,v.cn)("text-surface-on truncate",e.class),children:"The five boxing wizards jump quickly."})]},e.name))})]}),(0,l.jsxs)("section",{"aria-labelledby":"components-heading",className:"space-y-6",children:[(0,l.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,l.jsx)(ub,{className:"w-7 h-7 text-secondary"}),(0,l.jsx)("h3",{id:"components-heading",className:"font-serif text-headline-md text-surface-on",children:"Components"})]}),(0,l.jsxs)("div",{className:"space-y-8",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("h4",{className:"font-serif text-title-lg text-surface-on-variant mb-3",children:"Action Buttons"}),(0,l.jsxs)("div",{className:"bg-surface-container-low p-6 rounded-lg shadow-sm flex flex-wrap items-center justify-center gap-4",children:[(0,l.jsx)(y.A,{variant:"filled",children:"Filled Button"}),(0,l.jsx)(y.A,{variant:"tonal",children:"Tonal Button"}),(0,l.jsx)(y.A,{variant:"outlined",children:"Outlined Button"}),(0,l.jsx)(y.A,{variant:"text",children:"Text Button"}),(0,l.jsx)(y.A,{variant:"elevated",children:"Elevated Button"})]})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("h4",{className:"font-serif text-title-lg text-surface-on-variant mb-3",children:"Inputs & Controls"}),(0,l.jsxs)("div",{className:"bg-surface-container-low p-6 rounded-lg shadow-sm grid grid-cols-1 md:grid-cols-2 gap-8 items-center",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)(uN,{htmlFor:"ds-input",children:"Text Input"}),(0,l.jsx)(Q,{id:"ds-input",type:"text",placeholder:"Type something...",className:"mt-1"})]}),(0,l.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,l.jsx)(uy,{id:"ds-checkbox",checked:s,onCheckedChange:e=>i(!!e)}),(0,l.jsx)(uN,{htmlFor:"ds-checkbox",children:"Checkbox"})]}),(0,l.jsxs)("div",{className:"md:col-span-2",children:[(0,l.jsx)(uN,{htmlFor:"ds-slider",children:"Slider"}),(0,l.jsx)(nL,{id:"ds-slider",value:[n[0]],onValueChange:r,max:100,step:1,className:"mt-2"})]})]})]})]})]})]})};var uA=n(56377),uE="Collapsible",[uT,uD]=(0,ex.A)(uE),[uO,uI]=uT(uE),uR=c.forwardRef((e,t)=>{let{__scopeCollapsible:n,open:r,defaultOpen:s,disabled:i,onOpenChange:o,...a}=e,[d=!1,h]=(0,ek.i)({prop:r,defaultProp:s,onChange:o});return(0,l.jsx)(uO,{scope:n,disabled:i,contentId:ew(),open:d,onOpenToggle:c.useCallback(()=>h(e=>!e),[h]),children:(0,l.jsx)(ej.sG.div,{"data-state":uF(d),"data-disabled":i?"":void 0,...a,ref:t})})});uR.displayName=uE;var uP="CollapsibleTrigger",uz=c.forwardRef((e,t)=>{let{__scopeCollapsible:n,...r}=e,s=uI(uP,n);return(0,l.jsx)(ej.sG.button,{type:"button","aria-controls":s.contentId,"aria-expanded":s.open||!1,"data-state":uF(s.open),"data-disabled":s.disabled?"":void 0,disabled:s.disabled,...r,ref:t,onClick:(0,em.m)(e.onClick,s.onOpenToggle)})});uz.displayName=uP;var u$="CollapsibleContent",uL=c.forwardRef((e,t)=>{let{forceMount:n,...r}=e,s=uI(u$,e.__scopeCollapsible);return(0,l.jsx)(ez.C,{present:n||s.open,children:({present:e})=>(0,l.jsx)(uB,{...r,ref:t,present:e})})});uL.displayName=u$;var uB=c.forwardRef((e,t)=>{let{__scopeCollapsible:n,present:r,children:s,...i}=e,o=uI(u$,n),[a,d]=c.useState(r),h=c.useRef(null),u=(0,eg.s)(t,h),p=c.useRef(0),f=p.current,m=c.useRef(0),g=m.current,x=o.open||a,y=c.useRef(x),v=c.useRef(void 0);return c.useEffect(()=>{let e=requestAnimationFrame(()=>y.current=!1);return()=>cancelAnimationFrame(e)},[]),(0,ey.N)(()=>{let e=h.current;if(e){v.current=v.current||{transitionDuration:e.style.transitionDuration,animationName:e.style.animationName},e.style.transitionDuration="0s",e.style.animationName="none";let t=e.getBoundingClientRect();p.current=t.height,m.current=t.width,y.current||(e.style.transitionDuration=v.current.transitionDuration,e.style.animationName=v.current.animationName),d(r)}},[o.open,r]),(0,l.jsx)(ej.sG.div,{"data-state":uF(o.open),"data-disabled":o.disabled?"":void 0,id:o.contentId,hidden:!x,...i,ref:u,style:{"--radix-collapsible-content-height":f?`${f}px`:void 0,"--radix-collapsible-content-width":g?`${g}px`:void 0,...e.style},children:x&&s})});function uF(e){return e?"open":"closed"}var uV="Accordion",u_=["Home","End","ArrowDown","ArrowUp","ArrowLeft","ArrowRight"],[uq,uH,uW]=(0,nd.N)(uV),[uU,uJ]=(0,ex.A)(uV,[uW,uD]),uK=uD(),uG=c.forwardRef((e,t)=>{let{type:n,...r}=e;return(0,l.jsx)(uq.Provider,{scope:e.__scopeAccordion,children:"multiple"===n?(0,l.jsx)(u1,{...r,ref:t}):(0,l.jsx)(u0,{...r,ref:t})})});uG.displayName=uV;var[uY,uX]=uU(uV),[uZ,uQ]=uU(uV,{collapsible:!1}),u0=c.forwardRef((e,t)=>{let{value:n,defaultValue:r,onValueChange:s=()=>{},collapsible:i=!1,...o}=e,[a,d]=(0,ek.i)({prop:n,defaultProp:r,onChange:s});return(0,l.jsx)(uY,{scope:e.__scopeAccordion,value:a?[a]:[],onItemOpen:d,onItemClose:c.useCallback(()=>i&&d(""),[i,d]),children:(0,l.jsx)(uZ,{scope:e.__scopeAccordion,collapsible:i,children:(0,l.jsx)(u5,{...o,ref:t})})})}),u1=c.forwardRef((e,t)=>{let{value:n,defaultValue:r,onValueChange:s=()=>{},...i}=e,[o=[],a]=(0,ek.i)({prop:n,defaultProp:r,onChange:s}),d=c.useCallback(e=>a((t=[])=>[...t,e]),[a]),h=c.useCallback(e=>a((t=[])=>t.filter(t=>t!==e)),[a]);return(0,l.jsx)(uY,{scope:e.__scopeAccordion,value:o,onItemOpen:d,onItemClose:h,children:(0,l.jsx)(uZ,{scope:e.__scopeAccordion,collapsible:!0,children:(0,l.jsx)(u5,{...i,ref:t})})})}),[u2,u4]=uU(uV),u5=c.forwardRef((e,t)=>{let{__scopeAccordion:n,disabled:r,dir:s,orientation:i="vertical",...o}=e,a=c.useRef(null),d=(0,eg.s)(a,t),h=uH(n),u="ltr"===na(s),p=(0,em.m)(e.onKeyDown,e=>{if(!u_.includes(e.key))return;let t=e.target,n=h().filter(e=>!e.ref.current?.disabled),r=n.findIndex(e=>e.ref.current===t),s=n.length;if(-1===r)return;e.preventDefault();let o=r,a=s-1,l=()=>{(o=r+1)>a&&(o=0)},c=()=>{(o=r-1)<0&&(o=a)};switch(e.key){case"Home":o=0;break;case"End":o=a;break;case"ArrowRight":"horizontal"===i&&(u?l():c());break;case"ArrowDown":"vertical"===i&&l();break;case"ArrowLeft":"horizontal"===i&&(u?c():l());break;case"ArrowUp":"vertical"===i&&c()}let d=o%s;n[d].ref.current?.focus()});return(0,l.jsx)(u2,{scope:n,disabled:r,direction:s,orientation:i,children:(0,l.jsx)(uq.Slot,{scope:n,children:(0,l.jsx)(ej.sG.div,{...o,"data-orientation":i,ref:d,onKeyDown:r?void 0:p})})})}),u3="AccordionItem",[u6,u8]=uU(u3),u7=c.forwardRef((e,t)=>{let{__scopeAccordion:n,value:r,...s}=e,i=u4(u3,n),o=uX(u3,n),a=uK(n),c=ew(),d=r&&o.value.includes(r)||!1,h=i.disabled||e.disabled;return(0,l.jsx)(u6,{scope:n,open:d,disabled:h,triggerId:c,children:(0,l.jsx)(uR,{"data-orientation":i.orientation,"data-state":pi(d),...a,...s,ref:t,disabled:h,open:d,onOpenChange:e=>{e?o.onItemOpen(r):o.onItemClose(r)}})})});u7.displayName=u3;var u9="AccordionHeader",pe=c.forwardRef((e,t)=>{let{__scopeAccordion:n,...r}=e,s=u4(uV,n),i=u8(u9,n);return(0,l.jsx)(ej.sG.h3,{"data-orientation":s.orientation,"data-state":pi(i.open),"data-disabled":i.disabled?"":void 0,...r,ref:t})});pe.displayName=u9;var pt="AccordionTrigger",pn=c.forwardRef((e,t)=>{let{__scopeAccordion:n,...r}=e,s=u4(uV,n),i=u8(pt,n),o=uQ(pt,n),a=uK(n);return(0,l.jsx)(uq.ItemSlot,{scope:n,children:(0,l.jsx)(uz,{"aria-disabled":i.open&&!o.collapsible||void 0,"data-orientation":s.orientation,id:i.triggerId,...a,...r,ref:t})})});pn.displayName=pt;var pr="AccordionContent",ps=c.forwardRef((e,t)=>{let{__scopeAccordion:n,...r}=e,s=u4(uV,n),i=u8(pr,n),o=uK(n);return(0,l.jsx)(uL,{role:"region","aria-labelledby":i.triggerId,"data-orientation":s.orientation,...o,...r,ref:t,style:{"--radix-accordion-content-height":"var(--radix-collapsible-content-height)","--radix-accordion-content-width":"var(--radix-collapsible-content-width)",...e.style}})});function pi(e){return e?"open":"closed"}ps.displayName=pr;let po=c.forwardRef(({className:e,...t},n)=>(0,l.jsx)(u7,{ref:n,className:(0,v.cn)("border-b",e),...t}));po.displayName="AccordionItem";let pa=c.forwardRef(({className:e,children:t,...n},r)=>(0,l.jsx)(pe,{className:"flex",children:(0,l.jsxs)(pn,{ref:r,className:(0,v.cn)("flex flex-1 items-center justify-between py-4 font-medium transition-all hover:underline [&[data-state=open]>svg]:rotate-180",e),...n,children:[t,(0,l.jsx)(hM,{className:"h-4 w-4 shrink-0 transition-transform duration-200"})]})}));pa.displayName=pn.displayName;let pl=c.forwardRef(({className:e,children:t,...n},r)=>(0,l.jsx)(ps,{ref:r,className:"overflow-hidden text-sm transition-all data-[state=closed]:animate-accordion-up data-[state=open]:animate-accordion-down",...n,children:(0,l.jsx)("div",{className:(0,v.cn)("pb-4 pt-0",e),children:t})}));pl.displayName=ps.displayName;let pc=({onNavigateBack:e})=>(0,l.jsxs)("div",{className:"space-y-8 animate-in fade-in-0 duration-750 max-w-3xl w-full",children:[(0,l.jsx)(y.A,{onClick:e,variant:"text",size:"sm",leadingIcon:(0,l.jsx)(nr,{}),className:"mb-4",children:"Back to Resources"}),(0,l.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,l.jsx)(ue,{className:"w-8 h-8 text-primary"}),(0,l.jsx)("h2",{className:"font-serif text-headline-lg text-surface-on",children:"Understanding CBT"})]}),(0,l.jsxs)(hZ,{className:"bg-surface-container-low shadow-sm border-outline-variant",children:[(0,l.jsx)(hQ,{children:(0,l.jsx)(h0,{className:"font-serif text-title-lg text-surface-on",children:"The Cognitive Model"})}),(0,l.jsxs)(h2,{className:"space-y-4",children:[(0,l.jsx)("p",{className:"text-body-md text-surface-on-variant",children:"Cognitive behavioral therapy (usually referred to as CBT) is based upon the idea that how you think determines how you feel and how you behave."}),(0,l.jsx)("div",{className:"text-center font-semibold text-lg text-surface-on",children:"Thoughts  Emotions  Behaviors"}),(0,l.jsxs)("div",{className:"space-y-2 text-body-md text-surface-on-variant",children:[(0,l.jsxs)("p",{children:[(0,l.jsx)("strong",{children:"1. Something happens."})," It could be anything."]}),(0,l.jsxs)("p",{children:[(0,l.jsx)("strong",{children:"2. You have thoughts"})," about what has just occurred."]}),(0,l.jsxs)("p",{children:[(0,l.jsx)("strong",{children:"3. You experience emotions"})," based upon your thoughts."]}),(0,l.jsxs)("p",{children:[(0,l.jsx)("strong",{children:"4. You respond"})," to your thoughts and feelings with behaviors."]})]}),(0,l.jsxs)("div",{className:"bg-surface p-4 rounded-lg border border-outline-variant",children:[(0,l.jsx)("h4",{className:"font-semibold text-surface-on mb-2",children:"Example:"}),(0,l.jsxs)("p",{className:"text-surface-on-variant",children:[(0,l.jsx)("strong",{children:"Situation:"})," A stranger scowls at you while passing you on the street."]}),(0,l.jsxs)("p",{className:"text-surface-on-variant",children:[(0,l.jsx)("strong",{children:"You think:"})," I mustve done something wrong Im so awkward."]}),(0,l.jsxs)("p",{className:"text-surface-on-variant",children:[(0,l.jsx)("strong",{children:"You feel:"})," Embarrassed and upset with yourself."]}),(0,l.jsxs)("p",{className:"text-surface-on-variant",children:[(0,l.jsx)("strong",{children:"Your behavior:"})," You apologize to the stranger and replay the situation over and over in your head."]})]}),(0,l.jsx)("p",{className:"text-body-md text-surface-on-variant",children:"The stranger couldve been scowling for any number of reasons. Unfortunately, irrational or not, these thoughts still affect how we feel, and how we behave. Consider a different response:"}),(0,l.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,l.jsxs)("div",{className:"bg-surface p-4 rounded-lg",children:[(0,l.jsxs)("p",{children:[(0,l.jsx)("strong",{children:"Thought:"})," What a jerk!"]}),(0,l.jsxs)("p",{children:[(0,l.jsx)("strong",{children:"Emotion:"})," Angry"]}),(0,l.jsxs)("p",{children:[(0,l.jsx)("strong",{children:"Behavior:"})," Shouts: Whats your problem?!"]})]}),(0,l.jsxs)("div",{className:"bg-surface p-4 rounded-lg",children:[(0,l.jsxs)("p",{children:[(0,l.jsx)("strong",{children:"Thought:"})," He must be having a bad day"]}),(0,l.jsxs)("p",{children:[(0,l.jsx)("strong",{children:"Emotion:"})," Neutral"]}),(0,l.jsxs)("p",{children:[(0,l.jsx)("strong",{children:"Behavior:"})," Walks away and forgets the incident."]})]})]}),(0,l.jsx)("p",{className:"text-body-md text-surface-on-variant !mt-6",children:"Using the cognitive model, you will learn to identify your own patterns of thoughts, emotions, and behaviors. Once you become aware of your own irrational thoughts, you will learn to change them."})]})]}),(0,l.jsxs)(hZ,{className:"bg-surface-container-low shadow-sm border-outline-variant",children:[(0,l.jsx)(hQ,{children:(0,l.jsx)(h0,{className:"font-serif text-title-lg text-surface-on",children:"Thinking Errors"})}),(0,l.jsxs)(h2,{className:"space-y-2",children:[(0,l.jsxs)("div",{className:"p-3 bg-surface rounded-lg",children:[(0,l.jsx)("h4",{className:"font-semibold text-primary",children:"Ignoring the Good"}),(0,l.jsx)("p",{className:"text-sm text-surface-on-variant",children:"You pay more attention to bad things, and ignore when something good happens."})]}),(0,l.jsxs)("div",{className:"p-3 bg-surface rounded-lg",children:[(0,l.jsx)("h4",{className:"font-semibold text-primary",children:"Blowing Things Up"}),(0,l.jsx)("p",{className:"text-sm text-surface-on-variant",children:"Making a really big deal out of something small, or making something a little bit bad seem like the worst thing ever."})]}),(0,l.jsxs)("div",{className:"p-3 bg-surface rounded-lg",children:[(0,l.jsx)("h4",{className:"font-semibold text-primary",children:"Fortune Telling"}),(0,l.jsx)("p",{className:"text-sm text-surface-on-variant",children:"Thinking you know what will happen in the future, and that it will be bad."})]})]})]}),(0,l.jsxs)(hZ,{className:"bg-surface-container-low shadow-sm border-outline-variant",children:[(0,l.jsx)(hQ,{children:(0,l.jsx)(h0,{className:"font-serif text-title-lg text-surface-on",children:"Core Beliefs"})}),(0,l.jsxs)(h2,{className:"space-y-4",children:[(0,l.jsx)("p",{className:"text-body-md text-surface-on-variant",children:"Core beliefs are the deeply held beliefs that influence how we interpret our experiences. Think of core beliefs like a pair of sunglasses. Everyone has a different shade that causes them to see things differently."}),(0,l.jsxs)("div",{className:"my-4 flex flex-col md:flex-row items-center justify-center gap-2 text-center",children:[(0,l.jsx)("div",{className:"p-3 bg-surface rounded-lg",children:(0,l.jsx)("strong",{children:"Situation"})}),(0,l.jsx)("div",{className:"text-primary font-bold text-2xl",children:""}),(0,l.jsx)("div",{className:"p-3 bg-surface rounded-lg",children:(0,l.jsx)("strong",{children:"Core Belief"})}),(0,l.jsx)("div",{className:"text-primary font-bold text-2xl",children:""}),(0,l.jsx)("div",{className:"p-3 bg-surface rounded-lg",children:(0,l.jsx)("strong",{children:"Consequence"})})]}),(0,l.jsx)("p",{className:"text-body-md text-surface-on-variant",children:"Many people have negative core beliefs that cause harmful consequences. To begin challenging them, you first need to identify them. Here are some common examples:"}),(0,l.jsx)("div",{className:"columns-2 sm:columns-3 gap-4 text-sm text-surface-on-variant bg-surface p-4 rounded-lg",children:(0,l.jsxs)("ul",{className:"list-disc list-inside space-y-1",children:[(0,l.jsx)("li",{children:"Im unlovable"}),(0,l.jsx)("li",{children:"Im Stupid"}),(0,l.jsx)("li",{children:"Im boring"}),(0,l.jsx)("li",{children:"Im not good enough"}),(0,l.jsx)("li",{children:"Im ugly"}),(0,l.jsx)("li",{children:"Im worthless"}),(0,l.jsx)("li",{children:"Im a bad person"}),(0,l.jsx)("li",{children:"Im abnormal"}),(0,l.jsx)("li",{children:"Im undeserving"})]})}),(0,l.jsxs)("div",{className:"mt-4",children:[(0,l.jsx)("h4",{className:"font-semibold text-surface-on",children:"What is one of your negative beliefs?"}),(0,l.jsx)("p",{className:"text-sm text-surface-on-variant mb-2",children:"List three pieces of evidence contrary to your negative core belief:"}),(0,l.jsxs)("ol",{className:"list-decimal list-inside space-y-1 pl-5",children:[(0,l.jsx)("li",{children:"__________________________________"}),(0,l.jsx)("li",{children:"__________________________________"}),(0,l.jsx)("li",{children:"__________________________________"})]})]})]})]}),(0,l.jsxs)(hZ,{className:"bg-surface-container-low shadow-sm border-outline-variant",children:[(0,l.jsx)(hQ,{children:(0,l.jsx)(h0,{className:"font-serif text-title-lg text-surface-on",children:"DEAR MAN: Effective Communication"})}),(0,l.jsxs)(h2,{children:[(0,l.jsx)("p",{className:"text-body-md text-surface-on-variant mb-4",children:"The acronym DEAR MAN outlines a strategy for communicating effectively to express your wants and needs respectfully."}),(0,l.jsxs)(uG,{type:"single",collapsible:!0,className:"w-full space-y-2",children:[(0,l.jsxs)(po,{value:"d",className:"bg-surface rounded-lg",children:[(0,l.jsx)(pa,{className:"p-4 text-left font-semibold text-primary",children:"D - Describe"}),(0,l.jsxs)(pl,{className:"px-4 pb-4",children:["Clearly and concisely describe the facts of the situation, without any judgment. ",(0,l.jsx)("br",{}),(0,l.jsx)("em",{children:"e.g., You have asked me to work late 3 days this week."})]})]}),(0,l.jsxs)(po,{value:"e",className:"bg-surface rounded-lg",children:[(0,l.jsx)(pa,{className:"p-4 text-left font-semibold text-primary",children:"E - Express"}),(0,l.jsxs)(pl,{className:"px-4 pb-4",children:["Use I statements to express your emotions. ",(0,l.jsx)("br",{}),(0,l.jsx)("em",{children:"e.g., I feel overwhelmed by the extra work Ive been given."})]})]}),(0,l.jsxs)(po,{value:"a1",className:"bg-surface rounded-lg",children:[(0,l.jsx)(pa,{className:"p-4 text-left font-semibold text-primary",children:"A - Assert"}),(0,l.jsxs)(pl,{className:"px-4 pb-4",children:["Clearly state what you want or need. Be specific. ",(0,l.jsx)("br",{}),(0,l.jsx)("em",{children:"e.g., I need to resume my regular 40-hour work week."})]})]}),(0,l.jsxs)(po,{value:"r",className:"bg-surface rounded-lg",children:[(0,l.jsx)(pa,{className:"p-4 text-left font-semibold text-primary",children:"R - Reinforce"}),(0,l.jsx)(pl,{className:"px-4 pb-4",children:"Reward the other person if they respond well to you. Smiling, saying thank you, and other kind gestures work well."})]}),(0,l.jsxs)(po,{value:"m",className:"bg-surface rounded-lg",children:[(0,l.jsx)(pa,{className:"p-4 text-left font-semibold text-primary",children:"M - Mindfulness"}),(0,l.jsxs)(pl,{className:"px-4 pb-4",children:["Being mindful of your goal means not getting sidetracked by other issues. ",(0,l.jsx)("br",{}),(0,l.jsx)("em",{children:"e.g., I would like to resolve the overtime issue before talking about the upcoming project."})]})]}),(0,l.jsxs)(po,{value:"a2",className:"bg-surface rounded-lg",children:[(0,l.jsx)(pa,{className:"p-4 text-left font-semibold text-primary",children:"A - Appear confident"}),(0,l.jsx)(pl,{className:"px-4 pb-4",children:"Use body language to show confidence, even if you dont feel it. Stand up straight, make appropriate eye contact, and speak clearly."})]}),(0,l.jsxs)(po,{value:"n",className:"bg-surface rounded-lg",children:[(0,l.jsx)(pa,{className:"p-4 text-left font-semibold text-primary",children:"N - Negotiate"}),(0,l.jsxs)(pl,{className:"px-4 pb-4",children:["Know the limits of what you are willing to accept, but be willing to compromise within them. ",(0,l.jsx)("br",{}),(0,l.jsx)("em",{children:"e.g., Ill finish the extra work this week, but I wont be able to manage the same amount of work next week."})]})]})]})]})]})]}),pd=(0,f.A)("Phone",[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}]]),ph=(0,f.A)("ExternalLink",[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]]),pu=({onNavigateBack:e})=>(0,l.jsxs)("div",{className:"space-y-8 animate-in fade-in-0 duration-750 max-w-3xl w-full",children:[(0,l.jsx)(y.A,{onClick:e,variant:"text",size:"sm",leadingIcon:(0,l.jsx)(nr,{}),className:"mb-4",children:"Back to Resources"}),(0,l.jsxs)("div",{className:"bg-error-container/40 p-6 sm:p-8 rounded-2xl shadow-lg",children:[(0,l.jsxs)("div",{className:"flex flex-col sm:flex-row items-start sm:items-center gap-4 mb-4",children:[(0,l.jsx)(ho,{className:"w-10 h-10 sm:w-12 sm:h-12 text-error flex-shrink-0"}),(0,l.jsxs)("div",{children:[(0,l.jsx)("h2",{className:"font-serif text-headline-md sm:text-headline-lg text-on-error-container",children:"Immediate Support"}),(0,l.jsx)("p",{className:"text-body-lg text-on-error-container/80 mt-1",children:"If you are in a crisis or any other person may be in danger, please use these resources."})]})]}),(0,l.jsxs)("div",{className:"space-y-4 text-left",children:[(0,l.jsxs)("a",{href:"tel:988",className:"block w-full text-left p-4 bg-surface rounded-lg hover:bg-surface-container transition-colors",children:[(0,l.jsxs)("h3",{className:"font-bold text-title-lg text-surface-on flex items-center gap-2",children:[(0,l.jsx)(pd,{className:"w-5 h-5"})," Call or Text 988"]}),(0,l.jsx)("p",{className:"text-surface-on-variant",children:"The 988 Suicide & Crisis Lifeline provides 24/7, free, and confidential support."})]}),(0,l.jsxs)("a",{href:"https://www.crisistextline.org/",target:"_blank",rel:"noopener noreferrer",className:"block w-full text-left p-4 bg-surface rounded-lg hover:bg-surface-container transition-colors",children:[(0,l.jsxs)("h3",{className:"font-bold text-title-lg text-surface-on flex items-center gap-2",children:["Crisis Text Line ",(0,l.jsx)(ph,{className:"w-4 h-4"})]}),(0,l.jsx)("p",{className:"text-surface-on-variant",children:"Text HOME to 741741 from anywhere in the US, anytime, about any type of crisis."})]}),(0,l.jsxs)("a",{href:"tel:911",className:"block w-full text-left p-4 bg-surface rounded-lg hover:bg-surface-container transition-colors",children:[(0,l.jsxs)("h3",{className:"font-bold text-title-lg text-surface-on flex items-center gap-2",children:[(0,l.jsx)(pd,{className:"w-5 h-5"})," Call 911"]}),(0,l.jsx)("p",{className:"text-surface-on-variant",children:"For any immediate life-threatening emergency, please call 911."})]})]}),(0,l.jsx)("p",{className:"text-label-md text-on-error-container/80 text-center mt-8",children:"Your safety is important. This application is a tool for self-reflection and is not a substitute for professional medical advice, diagnosis, or treatment."})]})]}),pp=({onOnboardingComplete:e})=>{let[t,n]=(0,c.useState)(0),[r,s]=(0,c.useState)(""),[i,o]=(0,c.useState)([]),[a,d]=(0,c.useState)([]),h=e=>{o(t=>t.includes(e)?t.filter(t=>t!==e):[...t,e])},u=e=>{d(t=>t.some(t=>t.id===e.id)?t.filter(t=>t.id!==e.id):[...t,e])},p=()=>{(1!==t||r.trim())&&n(e=>e+1)},f=()=>{e({name:r.trim(),strengths:i,copingMechanisms:a,dashboardWidgets:{planner:!0,medication:!0,copingMechanisms:!0}})};return(0,l.jsx)("div",{className:"min-h-screen bg-surface flex items-center justify-center p-4",children:(0,l.jsx)(X.N,{mode:"wait",children:(()=>{switch(t){case 0:return(0,l.jsxs)(Z.P.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"text-center",children:[(0,l.jsx)(x.A,{className:"w-24 h-24 text-primary mx-auto mb-6"}),(0,l.jsx)("h1",{className:"font-serif text-display-md text-surface-on",children:"Welcome to Echo"}),(0,l.jsx)("p",{className:"text-body-lg text-surface-on-variant mt-4 max-w-xl mx-auto",children:"A calm, introspective space to organize your thoughts, track your well-being, and reflect on your daily life."}),(0,l.jsx)(y.A,{onClick:p,size:"lg",className:"mt-10",trailingIcon:(0,l.jsx)(ns,{}),children:"Get Started"})]},0);case 1:return(0,l.jsxs)(Z.P.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"text-center w-full max-w-md",children:[(0,l.jsx)("h1",{className:"font-serif text-headline-lg text-surface-on",children:"What should we call you?"}),(0,l.jsx)("input",{type:"text",value:r,onChange:e=>s(e.target.value),placeholder:"Enter your name",className:"mt-8 w-full p-4 bg-surface-container border border-outline-variant hover:border-outline focus:border-primary focus:ring-1 focus:ring-primary rounded-xl text-surface-on placeholder-surface-on-variant text-center text-xl",autoFocus:!0,onKeyPress:e=>"Enter"===e.key&&p()}),(0,l.jsx)(y.A,{onClick:p,size:"lg",className:"mt-8",disabled:!r.trim(),children:"Next"})]},1);case 2:return(0,l.jsxs)(Z.P.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"text-center w-full max-w-3xl",children:[(0,l.jsxs)("h1",{className:"font-serif text-headline-lg text-surface-on",children:["Let's celebrate your strengths, ",r,"."]}),(0,l.jsx)("p",{className:"text-body-md text-surface-on-variant mt-2 mb-8",children:"What are some of your best qualities? Select a few that resonate with you."}),(0,l.jsx)("div",{className:"flex flex-wrap gap-3 justify-center",children:hF.map(e=>{let t=i.includes(e);return(0,l.jsx)("button",{onClick:()=>h(e),className:`px-4 py-2 rounded-full text-sm font-medium transition-all duration-200 border-2 ${t?"bg-primary border-primary text-primary-foreground":"bg-surface-container border-outline-variant hover:border-outline text-surface-on-variant"}`,children:(0,l.jsxs)("div",{className:"flex items-center gap-2",children:[e,t&&(0,l.jsx)(hP,{className:"w-4 h-4"})]})},e)})}),(0,l.jsx)(y.A,{onClick:p,size:"lg",className:"mt-10",children:"Continue"})]},2);case 3:return(0,l.jsxs)(Z.P.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"text-center w-full max-w-3xl",children:[(0,l.jsx)("h1",{className:"font-serif text-headline-lg text-surface-on",children:"Select a few starting coping strategies."}),(0,l.jsx)("p",{className:"text-body-md text-surface-on-variant mt-2 mb-8",children:"You can always change these later in your profile."}),(0,l.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:ur.map(e=>{let t=a.some(t=>t.id===e.id);return(0,l.jsx)("button",{onClick:()=>u(e),className:`p-4 rounded-lg text-left transition-all duration-200 border-2 ${t?"bg-primary-container border-primary":"bg-surface-container border-outline-variant hover:border-outline"}`,children:(0,l.jsxs)("div",{className:"flex justify-between items-center",children:[(0,l.jsx)("span",{className:`font-medium ${t?"text-on-primary-container":"text-surface-on"}`,children:e.text}),t&&(0,l.jsx)(hP,{className:`w-5 h-5 ${t?"text-primary":"text-transparent"}`})]})},e.id)})}),(0,l.jsx)(y.A,{onClick:p,size:"lg",className:"mt-8",children:"Continue"})]},3);case 4:return(0,l.jsxs)(Z.P.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"text-center",children:[(0,l.jsx)("div",{className:"w-24 h-24 rounded-full bg-green-500/20 flex items-center justify-center mx-auto mb-6",children:(0,l.jsx)(hP,{className:"w-16 h-16 text-green-500"})}),(0,l.jsxs)("h1",{className:"font-serif text-display-sm text-surface-on",children:["You're all set, ",r,"!"]}),(0,l.jsx)("p",{className:"text-body-lg text-surface-on-variant mt-4",children:"Your personal wellness dashboard is ready."}),(0,l.jsx)(y.A,{onClick:f,size:"lg",className:"mt-10",children:"Enter Echo"})]},4);default:return null}})()})})},pf=()=>{let[e,t]=(0,c.useState)([]),[n,r]=(0,c.useState)([]),[s,i]=(0,c.useState)({}),[o,a]=(0,c.useState)({}),[d,h]=(0,c.useState)([]),[f,m]=(0,c.useState)([]),[g,x]=(0,c.useState)([]),[y,b]=(0,c.useState)([]),[w,k]=(0,c.useState)(null),[j,S]=(0,c.useState)(null),{toast:C}=(0,ee.dj)(),[M,A]=(0,c.useState)(null),[E,T]=(0,c.useState)(null),[D,O]=(0,c.useState)(null),[I,P]=(0,c.useState)(null),[z,$]=(0,c.useState)(!1),[L,B]=(0,c.useState)("dashboard"),[F,V]=(0,c.useState)(null),[_,q]=(0,c.useState)(null),[H,W]=(0,c.useState)(!1);!function(){let[e,t]=c.useState(void 0);c.useEffect(()=>{let e=window.matchMedia("(max-width: 767px)"),n=()=>{t(window.innerWidth<768)};return e.addEventListener("change",n),t(window.innerWidth<768),()=>e.removeEventListener("change",n)},[])}();let[U,J]=(0,c.useState)(!1),G=["dashboard","journal","journal-new","journal-edit","thoughtRecord","thoughtRecord-new","thoughtRecord-edit","planner","medication","affirmations","profile","resources","designSystem","understanding-cbt","crisis-support"],Y=e=>G.includes(e),X=(0,c.useCallback)(()=>W(!1),[]),Z=(0,c.useCallback)(e=>{window.location.hash=e},[]);(0,c.useEffect)(()=>{let e=()=>{let e=window.location.hash.substring(1);B(Y(e)?e:"dashboard"),X()};return e(),Y(window.location.hash.substring(1))||window.history.replaceState(null,"",`${window.location.pathname}#dashboard`),window.addEventListener("hashchange",e,!1),()=>{window.removeEventListener("hashchange",e,!1)}},[X]),(0,c.useEffect)(()=>{V(localStorage.getItem(u.CA)||"light"),q((0,p.EQ)()),t((0,p.Xs)().sort((e,t)=>t.timestamp-e.timestamp)),r((0,p.wF)().sort((e,t)=>t.timestamp-e.timestamp)),k((0,p.oW)()),b((0,p.yh)()),h((0,p.lB)()),x((0,p.ME)()),m((0,p.ls)()),i((0,p.WZ)()),a((0,p.mT)()),J(!0)},[]),(0,c.useEffect)(()=>{if(null===F||null===_||!U)return;let e=document.documentElement;e.classList.remove("theme-echo","theme-forest","theme-buttercup","theme-sunset"),e.classList.add(`theme-${_}`),e.classList.toggle("dark","dark"===F),localStorage.setItem(u.CA,F),(0,p.hy)(_)},[F,_,U]),(0,c.useEffect)(()=>{U&&(0,p.Ge)(e)},[e,U]),(0,c.useEffect)(()=>{U&&(0,p.FW)(n)},[n,U]),(0,c.useEffect)(()=>{U&&(0,p.fe)(s)},[s,U]),(0,c.useEffect)(()=>{U&&(0,p.FC)(o)},[o,U]),(0,c.useEffect)(()=>{U&&(0,p._6)(d)},[d,U]),(0,c.useEffect)(()=>{U&&(0,p.mg)(f)},[f,U]),(0,c.useEffect)(()=>{U&&(0,p.Np)(g)},[g,U]),(0,c.useEffect)(()=>{U&&(0,p.XW)(y)},[y,U]),(0,c.useEffect)(()=>{U&&w&&(0,p.XH)(w)},[w,U]);let Q=(0,c.useCallback)(()=>{V(e=>"light"===e?"dark":"light")},[]),et=(0,c.useCallback)(e=>{q(e)},[]);(0,c.useCallback)((e,t)=>{let n=e.createScriptProcessor(4096,1,1),r=0,s=0,i=0,o=0,a=0,l=0,c=0,d=0;return n.onaudioprocess=e=>{let n=e.outputBuffer.getChannelData(0);for(let e=0;e<4096;e++){let h=2*Math.random()-1;switch(t){case"white":n[e]=h;break;case"pink":s=.99886*s+.0555179*h,i=.99332*i+.0750759*h,o=.969*o+.153852*h,a=.8665*a+.3104856*h,l=.55*l+.5329522*h,c=-.7616*c-.016898*h,n[e]=s+i+o+a+l+c+d+.5362*h,n[e]*=.11,d=.115926*h;break;case"brown":n[e]=(r+.02*h)/1.02,r=n[e],n[e]*=3.5}}},n},[]);let en=(0,c.useCallback)(()=>{T(null),Z("journal")},[Z]),es=(0,c.useCallback)(()=>{O(null),Z("thoughtRecord")},[Z]);(0,c.useCallback)(()=>{T(null),Z("journal-new")},[Z]);let ei=(0,c.useCallback)(e=>{T(e),Z("journal-edit")},[Z]),eo=(0,c.useCallback)(e=>{let n=Date.now();if(E){let n={...E,title:e.title,text:e.text,audioBase64DataUrl:e.audioBase64DataUrl};t(e=>e.map(e=>e.id===E.id?n:e))}else{let r={id:n.toString(),timestamp:n,title:e.title,text:e.text,audioBase64DataUrl:e.audioBase64DataUrl};t(e=>[r,...e].sort((e,t)=>t.timestamp-e.timestamp))}en()},[E,en]),ea=(0,c.useCallback)(e=>{A(e)},[]),el=(0,c.useCallback)(e=>{t(t=>t.filter(t=>t.id!==e))},[]),ed=(0,c.useCallback)(()=>{O(null),Z("thoughtRecord-new")},[Z]),eh=(0,c.useCallback)(e=>{O(e),Z("thoughtRecord-edit")},[Z]),eu=(0,c.useCallback)((e,t)=>{let n=Date.now(),s=`Thought Record - ${new Date(n).toLocaleDateString()}`;if(e)r(n=>n.map(n=>n.id===e?{...n,data:t,title:s}:n));else{let e={id:n.toString(),timestamp:n,title:s,data:t};r(t=>[e,...t].sort((e,t)=>t.timestamp-e.timestamp))}es()},[es]),ep=(0,c.useCallback)(e=>{r(t=>t.filter(t=>t.id!==e))},[]),em=()=>(0,p.c7)(e),eg=()=>$(!0),ex=e=>k(e),ey=(0,c.useCallback)(e=>{w&&k(t=>t?t.copingMechanisms.some(t=>t.id===e.id)?(C({title:"Strategy already added"}),t):(C({title:"Strategy added to your profile!"}),{...t,copingMechanisms:[...t.copingMechanisms,e]}):null)},[w,C]),ev=(0,c.useCallback)(e=>s[e],[s]),eb=(0,c.useCallback)(e=>{U&&i(t=>({...t,[e.date]:e}))},[U]),ew=(0,c.useCallback)(e=>o[e],[o]),ek=(0,c.useCallback)(e=>{U&&a(t=>({...t,[e.weekStartDate]:e}))},[U]),eN=(0,c.useCallback)(e=>{let t={...e,id:Date.now().toString(),addedTimestamp:Date.now(),frequency:e.frequency.trim()||"As needed"};h(e=>[t,...e].sort((e,t)=>t.addedTimestamp-e.addedTimestamp))},[]),ej=(0,c.useCallback)(e=>{h(t=>t.map(t=>t.id===e.id?{...e,frequency:e.frequency.trim()||"As needed"}:t).sort((e,t)=>t.addedTimestamp-e.addedTimestamp))},[]),eS=(0,c.useCallback)(e=>{h(t=>t.filter(t=>t.id!==e)),x(t=>t.map(t=>({...t,medicationIds:t.medicationIds.filter(t=>t!==e)})))},[]),eC=(0,c.useCallback)(e=>{let t={id:Date.now().toString(),medicationId:e.id,medicationName:e.name,dosage:e.dosage,timestamp:Date.now()};m(e=>[t,...e])},[]),eM=(0,c.useCallback)(()=>{m([])},[]),eA=(0,c.useCallback)((e,t)=>{let n={id:Date.now().toString(),name:e,medicationIds:t};x(e=>[n,...e])},[]),eE=(0,c.useCallback)(e=>{x(t=>t.map(t=>t.id===e.id?e:t))},[]),eT=(0,c.useCallback)(e=>{x(t=>t.filter(t=>t.id!==e))},[]),eD=(0,c.useCallback)(e=>{let t=g.find(t=>t.id===e);if(!t)return;let n=t.medicationIds.map(e=>{let t=d.find(t=>t.id===e);return t?{id:`${Date.now()}-${t.id}`,medicationId:t.id,medicationName:t.name,dosage:t.dosage,timestamp:Date.now()}:null}).filter(e=>null!==e);n.length>0&&m(e=>[...n,...e])},[g,d]),eO=(0,c.useCallback)(e=>{let t={...e,id:Date.now().toString()};b(e=>[...e,t])},[]),eI=(0,c.useCallback)(e=>{b(t=>t.map(t=>t.id===e.id?e:t))},[]),eR=(0,c.useCallback)(e=>{b(t=>t.filter(t=>t.id!==e))},[]),eP=(0,c.useCallback)(()=>{t([]),r([])},[]),ez=(0,c.useCallback)(()=>{i({}),a({})},[]),e$=(0,c.useCallback)(()=>{h([]),m([]),x([])},[]),eL=(0,c.useCallback)(()=>{t([]),r([]),i({}),a({}),h([]),m([]),x([]),b([]),k({name:"",strengths:[],copingMechanisms:[],dashboardWidgets:{},favoriteAffirmations:[]})},[]),eB=(0,c.useCallback)(e=>{let n=e.split("\n").map(e=>`<p>${e.trim()||"&nbsp;"}</p>`).join(""),r=Date.now(),s={id:r.toString(),timestamp:r,title:"My Plan",text:n};t(e=>[s,...e].sort((e,t)=>t.timestamp-e.timestamp))},[]);if(!U||!_||!F||null===w)return(0,l.jsx)("div",{className:"min-h-screen flex flex-col bg-background",children:(0,l.jsxs)("div",{className:"flex flex-col flex-grow items-center justify-center",children:[(0,l.jsx)(K,{className:"h-24 w-24 rounded-full mb-6"}),(0,l.jsx)(K,{className:"h-10 w-64 mb-4"}),(0,l.jsx)(K,{className:"h-6 w-96"})]})});if(!w.name)return(0,l.jsx)(pp,{onOnboardingComplete:e=>{k(e)}});let eF=L.endsWith("-new")||L.endsWith("-edit");return(0,l.jsxs)("div",{className:(0,v.cn)("min-h-screen flex flex-col bg-background",eF&&"overflow-hidden"),children:[(0,l.jsx)(N,{onToggleDrawer:()=>W(e=>!e),isDrawerOpen:H,onNavigateToView:Z,currentView:L,theme:F,palette:_,onToggleTheme:Q,onChangePalette:et,profileData:w}),(0,l.jsx)(R,{isOpen:H,onClose:X,onNavigateToView:Z,currentView:L,theme:F,palette:_,onToggleTheme:Q,onChangePalette:et,profileData:w}),(0,l.jsx)("main",{className:"flex-1 flex flex-col",children:(()=>{switch(L){case"dashboard":return(0,l.jsx)(er,{dailyPlans:s,medications:d,medicationGroups:g,profileData:w,onUpdateProfile:ex,onNavigateToView:Z});case"journal":return(0,l.jsx)("div",{className:"relative flex justify-center",children:(0,l.jsx)(ef,{entries:e,onViewEntry:ea,onEdit:ei,onDelete:el})});case"journal-new":case"journal-edit":return(0,l.jsx)(ec,{onSave:eo,onClose:en,initialEntry:E});case"thoughtRecord":return(0,l.jsx)("div",{className:"flex justify-center",children:(0,l.jsx)(nt,{thoughtRecords:n,onNew:ed,onView:P,onEdit:eh,onDelete:ep})});case"thoughtRecord-new":case"thoughtRecord-edit":return(0,l.jsx)("div",{className:"flex justify-center h-full",children:(0,l.jsx)("div",{className:"max-w-3xl w-full",children:(0,l.jsx)(d$,{initialData:D,onSave:eu,onClose:es,isActive:!0})})});case"planner":return(0,l.jsx)("div",{className:"flex justify-center",children:(0,l.jsx)(hv,{getDailyPlan:ev,saveDailyPlan:eb,getWeeklyPlan:ew,saveWeeklyPlan:ek,onSavePlanToJournal:eB,events:y,journalEntries:e,thoughtRecords:n,onAddEvent:eO,onUpdateEvent:eI,onDeleteEvent:eR,onViewJournalEntry:ea,onViewThoughtRecord:P})});case"medication":return(0,l.jsx)("div",{className:"flex justify-center",children:(0,l.jsx)(hE,{medications:d,medicationLogs:f,medicationGroups:g,onAddMedication:eN,onUpdateMedication:ej,onDeleteMedication:eS,onLogMedicationIntake:eC,onClearMedicationLog:eM,onAddMedicationGroup:eA,onUpdateMedicationGroup:eE,onDeleteMedicationGroup:eT,onLogMedicationBundle:eD})});case"affirmations":return(0,l.jsx)(hI,{profileData:w,onUpdateProfile:ex});case"profile":return(0,l.jsx)("div",{className:"flex justify-center",children:(0,l.jsx)(h7,{profileData:w,onUpdateProfile:ex,currentTheme:F,currentPalette:_,onToggleTheme:Q,onChangePalette:et,onDownloadJournal:em,onShowDriveInfo:eg,onClearJournal:eP,onClearPlanner:ez,onClearMedication:e$,onClearAllData:eL,onNavigateToView:Z,onReOnboard:()=>k({...w,name:""})})});case"resources":return(0,l.jsx)("div",{className:"flex justify-center",children:(0,l.jsx)(uo,{onNavigateToView:Z,onAddCopingMechanism:ey,userCopingMechanisms:w.copingMechanisms})});case"understanding-cbt":return(0,l.jsx)("div",{className:"flex justify-center",children:(0,l.jsx)(pc,{onNavigateBack:()=>Z("resources")})});case"crisis-support":return(0,l.jsx)("div",{className:"flex justify-center",children:(0,l.jsx)(pu,{onNavigateBack:()=>Z("resources")})});case"designSystem":return(0,l.jsx)("div",{className:"flex justify-center",children:(0,l.jsx)(uM,{currentPalette:_,onChangePalette:et})});default:return null}})()}),M&&(0,l.jsx)(t9,{entry:M,onClose:()=>A(null)}),I&&(0,l.jsx)(dB,{thoughtRecord:I,onClose:()=>P(null)}),(0,l.jsx)(t7,{open:z,onClose:()=>$(!1),children:(0,l.jsxs)("div",{className:"p-6",children:[(0,l.jsx)("h2",{className:"text-lg font-bold mb-2",children:"Where is my data stored?"}),(0,l.jsx)("p",{className:"mb-4",children:"All your data is stored locally in your browser. You can export your journal and planner data at any time from the Profile page."}),(0,l.jsx)("button",{className:"btn btn-primary",onClick:()=>$(!1),children:"Close"})]})}),(0,l.jsx)(uA.A,{theme:F,onToggleTheme:Q})]})};function pm(){return(0,l.jsx)(pf,{})}}};var t=require("../../webpack-runtime.js");t.C(e);var n=e=>t(t.s=e),r=t.X(0,[719,611,537,504],()=>n(10250));module.exports=r})();